(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{5168:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/hypo",function(){return s(9968)}])},9968:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var n=s(7876),a=s(4232),o=s(9149);let l="https://sharpy-cgm.up.railway.app",i=()=>{let{token:e}=(0,a.useContext)(o.AuthContext),[t,s]=(0,a.useState)(l),[i,r]=(0,a.useState)(!1),[d,c]=(0,a.useState)(null),[u,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null);(0,a.useEffect)(()=>{e&&fetch("/api/user-settings?token=".concat(encodeURIComponent(e))).then(e=>e.json()).then(e=>{e.defaultUser&&e.defaultUser.nightscout_address?s(e.defaultUser.nightscout_address):s(l),r(!0)}).catch(()=>{s(l),r(!0)})},[e]),(0,a.useEffect)(()=>{i&&fetch("".concat(t,"/api/v1/entries.json?count=1")).then(e=>e.json()).then(e=>{e&&e.length>0&&c(e[0].sgv/18)})},[t,i]),(0,a.useEffect)(()=>{null===d||p||m||(d<4.3?f():h(!0))},[d]);let f=()=>{g(!0),fetch("/api/nightscout-hypo",{method:"POST",headers:{"Content-Type":"application/json",...e?{Authorization:"Bearer ".concat(e)}:{}},body:JSON.stringify({glucose:d})}).then(e=>e.json()).then(e=>{x("Hypo registered successfully!")}).catch(()=>x("Failed to register hypo.")).finally(()=>g(!1))};return e?i&&null!==d?(0,n.jsxs)("div",{className:"max-w-lg mx-auto mt-10 p-6 bg-white shadow-md rounded-lg text-center",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Register Hypo"}),(0,n.jsxs)("p",{className:"mb-4",children:["Current Blood Glucose: ",d.toFixed(1)," mmol/L"]}),m&&(0,n.jsx)("div",{className:"mb-4 text-green-600",children:m}),u&&!m&&(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-4 text-yellow-700 font-semibold",children:"Current Reading is too high, are you sure you are treating a hypo?"}),(0,n.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded mr-2",onClick:()=>{h(!1),f()},disabled:p,children:"Yes"}),(0,n.jsx)("button",{className:"bg-gray-400 text-white px-4 py-2 rounded",onClick:()=>h(!1),disabled:p,children:"No"})]})]}):(0,n.jsx)("div",{children:"Loading..."}):(0,n.jsx)("div",{className:"max-w-lg mx-auto mt-10 p-6 bg-white shadow-md rounded-lg text-center",children:"Please log in to register a hypo."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(5168)),_N_E=e.O()}]);