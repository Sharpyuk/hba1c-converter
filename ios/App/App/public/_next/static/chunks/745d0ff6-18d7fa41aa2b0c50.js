"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[723],{2092:(t,e,i)=>{i.d(e,{ui:()=>a.ui});var a=i(1656),s=i(6208),o=Object.defineProperty,r=Object.getOwnPropertyDescriptor,n=(t,e,i,a)=>{for(var s,n=a>1?void 0:a?r(e,i):e,l=t.length-1;l>=0;l--)(s=t[l])&&(n=(a?s(e,i,n):s(n))||n);return a&&n&&o(e,i,n),n},l=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility="5d41402abc4b2a76b9719d911017c592"!=this.md5("hello")}md5cycle(t,e){let i=t[0],a=t[1],s=t[2],o=t[3];i=this.ff(i,a,s,o,e[0],7,-0x28955b88),o=this.ff(o,i,a,s,e[1],12,-0x173848aa),s=this.ff(s,o,i,a,e[2],17,0x242070db),a=this.ff(a,s,o,i,e[3],22,-0x3e423112),i=this.ff(i,a,s,o,e[4],7,-0xa83f051),o=this.ff(o,i,a,s,e[5],12,0x4787c62a),s=this.ff(s,o,i,a,e[6],17,-0x57cfb9ed),a=this.ff(a,s,o,i,e[7],22,-0x2b96aff),i=this.ff(i,a,s,o,e[8],7,0x698098d8),o=this.ff(o,i,a,s,e[9],12,-0x74bb0851),s=this.ff(s,o,i,a,e[10],17,-42063),a=this.ff(a,s,o,i,e[11],22,-0x76a32842),i=this.ff(i,a,s,o,e[12],7,0x6b901122),o=this.ff(o,i,a,s,e[13],12,-0x2678e6d),s=this.ff(s,o,i,a,e[14],17,-0x5986bc72),a=this.ff(a,s,o,i,e[15],22,0x49b40821),i=this.gg(i,a,s,o,e[1],5,-0x9e1da9e),o=this.gg(o,i,a,s,e[6],9,-0x3fbf4cc0),s=this.gg(s,o,i,a,e[11],14,0x265e5a51),a=this.gg(a,s,o,i,e[0],20,-0x16493856),i=this.gg(i,a,s,o,e[5],5,-0x29d0efa3),o=this.gg(o,i,a,s,e[10],9,0x2441453),s=this.gg(s,o,i,a,e[15],14,-0x275e197f),a=this.gg(a,s,o,i,e[4],20,-0x182c0438),i=this.gg(i,a,s,o,e[9],5,0x21e1cde6),o=this.gg(o,i,a,s,e[14],9,-0x3cc8f82a),s=this.gg(s,o,i,a,e[3],14,-0xb2af279),a=this.gg(a,s,o,i,e[8],20,0x455a14ed),i=this.gg(i,a,s,o,e[13],5,-0x561c16fb),o=this.gg(o,i,a,s,e[2],9,-0x3105c08),s=this.gg(s,o,i,a,e[7],14,0x676f02d9),a=this.gg(a,s,o,i,e[12],20,-0x72d5b376),i=this.hh(i,a,s,o,e[5],4,-378558),o=this.hh(o,i,a,s,e[8],11,-0x788e097f),s=this.hh(s,o,i,a,e[11],16,0x6d9d6122),a=this.hh(a,s,o,i,e[14],23,-0x21ac7f4),i=this.hh(i,a,s,o,e[1],4,-0x5b4115bc),o=this.hh(o,i,a,s,e[4],11,0x4bdecfa9),s=this.hh(s,o,i,a,e[7],16,-0x944b4a0),a=this.hh(a,s,o,i,e[10],23,-0x41404390),i=this.hh(i,a,s,o,e[13],4,0x289b7ec6),o=this.hh(o,i,a,s,e[0],11,-0x155ed806),s=this.hh(s,o,i,a,e[3],16,-0x2b10cf7b),a=this.hh(a,s,o,i,e[6],23,0x4881d05),i=this.hh(i,a,s,o,e[9],4,-0x262b2fc7),o=this.hh(o,i,a,s,e[12],11,-0x1924661b),s=this.hh(s,o,i,a,e[15],16,0x1fa27cf8),a=this.hh(a,s,o,i,e[2],23,-0x3b53a99b),i=this.ii(i,a,s,o,e[0],6,-0xbd6ddbc),o=this.ii(o,i,a,s,e[7],10,0x432aff97),s=this.ii(s,o,i,a,e[14],15,-0x546bdc59),a=this.ii(a,s,o,i,e[5],21,-0x36c5fc7),i=this.ii(i,a,s,o,e[12],6,0x655b59c3),o=this.ii(o,i,a,s,e[3],10,-0x70f3336e),s=this.ii(s,o,i,a,e[10],15,-1051523),a=this.ii(a,s,o,i,e[1],21,-0x7a7ba22f),i=this.ii(i,a,s,o,e[8],6,0x6fa87e4f),o=this.ii(o,i,a,s,e[15],10,-0x1d31920),s=this.ii(s,o,i,a,e[6],15,-0x5cfebcec),a=this.ii(a,s,o,i,e[13],21,0x4e0811a1),i=this.ii(i,a,s,o,e[4],6,-0x8ac817e),o=this.ii(o,i,a,s,e[11],10,-0x42c50dcb),s=this.ii(s,o,i,a,e[2],15,0x2ad7d2bb),a=this.ii(a,s,o,i,e[9],21,-0x14792c6f),t[0]=this.add32(i,t[0]),t[1]=this.add32(a,t[1]),t[2]=this.add32(s,t[2]),t[3]=this.add32(o,t[3])}cmn(t,e,i,a,s,o){return e=this.add32(this.add32(e,t),this.add32(a,o)),this.add32(e<<s|e>>>32-s,i)}ff(t,e,i,a,s,o,r){return this.cmn(e&i|~e&a,t,e,s,o,r)}gg(t,e,i,a,s,o,r){return this.cmn(e&a|i&~a,t,e,s,o,r)}hh(t,e,i,a,s,o,r){return this.cmn(e^i^a,t,e,s,o,r)}ii(t,e,i,a,s,o,r){return this.cmn(i^(e|~a),t,e,s,o,r)}md51(t){let e,i=t.length,a=[0x67452301,-0x10325477,-0x67452302,0x10325476];for(e=64;e<=t.length;e+=64)this.md5cycle(a,this.md5blk(t.substring(e-64,e)));t=t.substring(e-64);let s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)s[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(s[e>>2]|=128<<(e%4<<3),e>55)for(this.md5cycle(a,s),e=0;e<16;e++)s[e]=0;return s[14]=8*i,this.md5cycle(a,s),a}md5blk(t){let e=[];for(let i=0;i<64;i+=4)e[i>>2]=t.charCodeAt(i)+(t.charCodeAt(i+1)<<8)+(t.charCodeAt(i+2)<<16)+(t.charCodeAt(i+3)<<24);return e}rhex(t){let e="0123456789abcdef".split(""),i="",a=0;for(;a<4;a++)i+=e[t>>8*a+4&15]+e[t>>8*a&15];return i}hex(t){for(let e=0;e<t.length;e++)t[e]=this.rhex(t[e]);return t.join("")}md5(t){return this.hex(this.md51(t))}add32(t,e){return this.ieCompatibility?this.add32Compat(t,e):this.add32Std(t,e)}add32Std(t,e){return t+e|0}add32Compat(t,e){let i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}};function h(t){return null==t||0===t.length}var d={"01":"GRID","02":"CHARTS","0102":"BOTH"},c=class t{constructor(t){this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=t,this.md5=new l,this.md5.init()}validateLicense(){let e=this.getLicenseDetails(t.licenseKey,t.gridContext),i=`AG ${"BOTH"===e.currentLicenseType?"Grid and ":""}Charts Enterprise`,a="";if("BOTH"===e.suppliedLicenseType?a="AG Grid and AG Charts Enterprise":"GRID"===e.suppliedLicenseType?a="AG Grid Enterprise":void 0!==e.suppliedLicenseType&&(a="AG Charts Enterprise"),e.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(e.expired){let i=t.getChartsReleaseDate(),s=t.formatDate(i);this.outputExpiredKey(e.expiry,s,a)}else e.valid?e.isTrial&&e.trialExpired&&this.outputExpiredTrialKey(e.expiry,i,a):this.outputInvalidLicenseKey(!!e.incorrectLicenseType,i,a)}static extractExpiry(e){let i=e.substring(e.lastIndexOf("_")+1,e.length);return new Date(parseInt(t.decode(i),10))}static extractLicenseComponents(e){let i=e.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),e.length<=32)return{md5:null,license:e,version:null,isTrial:null};let a=i.length-32,s=i.substring(a),o=i.substring(0,a),[r,n,l]=t.extractBracketedInformation(i);return{md5:s,license:o,version:r,isTrial:n,type:l}}getLicenseDetails(e,i=!1){let a,s,o,r="CHARTS";if(h(e))return{licenseKey:e,valid:!1,missing:!0,currentLicenseType:r};let n=t.getChartsReleaseDate(),{md5:l,license:c,version:p,isTrial:u,type:g}=t.extractLicenseComponents(e),y=l===this.md5.md5(c)&&-1===e.indexOf("For_Trialing_ag-Grid_Only"),f=null,m=!1;if(y&&(y=!isNaN((f=t.extractExpiry(c)).getTime())))switch(s=n>f,p){case"legacy":case"2":y=!1;break;case"3":h(g)?y=!1:(o=g,g!==d["02"]&&g!==d["0102"]?(y=!1,m=!0):u&&function(){let t=new Date;a=f<t,s=void 0}())}return y?{licenseKey:e,valid:y,expiry:t.formatDate(f),expired:s,version:p,isTrial:u,trialExpired:a,invalidLicenseTypeForCombo:i?"BOTH"!==o:void 0,incorrectLicenseType:m,currentLicenseType:r,suppliedLicenseType:o}:{licenseKey:e,valid:y,incorrectLicenseType:m,currentLicenseType:r,suppliedLicenseType:o}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!h(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage??""}getHostname(){if(!this.document)return"localhost";let t=this.document.defaultView??window;if(!t)return"localhost";let{hostname:e=""}=t.location;return e}isForceWatermark(){if(!this.document)return!1;let t=this.document?.defaultView??"undefined"!=typeof window?window:void 0;if(!t)return!1;let{pathname:e}=t.location;return!!e&&-1!==e.indexOf("forceWatermark")}isWebsiteUrl(){let t=this.getHostname();return null!==/^((?:[\w-]+\.)?ag-grid\.com)$/.exec(t)}isLocalhost(){let t=this.getHostname();return null!==/^(?:127\.0\.0\.1|localhost)$/.exec(t)}static formatDate(t){let e=t.getDate();return e+" "+["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]+" "+t.getFullYear()}static getChartsReleaseDate(){return new Date(parseInt(t.decode(t.RELEASE_INFORMATION),10))}static decode(e){let i,a,s,o,r,n,l,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="",c=0,p=e.replace(/[^A-Za-z0-9+/=]/g,"");for(;c<p.length;)o=h.indexOf(p.charAt(c++)),r=h.indexOf(p.charAt(c++)),n=h.indexOf(p.charAt(c++)),l=h.indexOf(p.charAt(c++)),i=o<<2|r>>4,a=(15&r)<<4|n>>2,s=(3&n)<<6|l,d+=String.fromCharCode(i),64!=n&&(d+=String.fromCharCode(a)),64!=l&&(d+=String.fromCharCode(s));return t.utf8_decode(d)}static utf8_decode(t){t=t.replace(/rn/g,"n");let e="";for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e+=String.fromCharCode(a):(a>127&&a<2048?e+=String.fromCharCode(a>>6|192):(e+=String.fromCharCode(a>>12|224),e+=String.fromCharCode(a>>6&63|128)),e+=String.fromCharCode(63&a|128))}return e}static setGridContext(e=!1){t.gridContext=e}static setLicenseKey(e){t.licenseKey=e}static extractBracketedInformation(t){if(!t.includes("["))return["legacy",!1,void 0];let e=t.match(/\[(.*?)\]/g).map(t=>t.replace("[","").replace("]",""));if(!e||0===e.length)return["legacy",!1,void 0];let i=1===e.filter(t=>"TRIAL"===t).length,a=e.filter(t=>t.startsWith("v"))[0];return[a?a.replace("v",""):"legacy",i,d[e.filter(t=>d[t])[0]]]}centerPadAndOutput(t){let e=this.totalMessageLength-t.length;console.error(t.padStart(e/2+t.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(t,e="*",i=""){console.error(t.padEnd(this.totalMessageLength-i.length,e)+i)}outputInvalidLicenseKey(e,i,a){t.gridContext||(e?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${a} only and does not cover you for ${i}.`," ","*")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*")),this.padAndOutput("* To troubleshoot your license key visit https://www.ag-grid.com/charts/licensing/."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(e,i,a){t.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${a} expired on ${e}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(e){t.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${e} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${e} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(e,i,a){t.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${a} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${a} released before ${e}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};function p(t,e,i){let a=(e,i,a,s)=>{let o=t[0];for(let r=e;a>0?r<=i:r>i;r+=a){let e=t[r];if(s(o,e))return!0;o=e}return!1},s=Math.floor(t.length/2);return!!a(e,s,e,i)||a(t.length-e,s,-e,i)}c.RELEASE_INFORMATION="MTc0NzEyMDgwMDEzNg==",c.gridContext=!1;var{AxisInterval:u,Property:g}=a.n1,y=class extends u{};n([g],y.prototype,"minSpacing",2);var{BaseProperties:f,ChartAxisDirection:m,Property:x,Group:b}=a.n1,v=class extends f{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};n([x],v.prototype,"enabled",2),n([x],v.prototype,"text",2),n([x],v.prototype,"fontStyle",2),n([x],v.prototype,"fontWeight",2),n([x],v.prototype,"fontSize",2),n([x],v.prototype,"fontFamily",2),n([x],v.prototype,"padding",2),n([x],v.prototype,"color",2),n([x],v.prototype,"parallel",2);var S=class extends f{constructor(){super(...arguments),this.id=(0,s.sX)(this),this.defaultColorRange=[],this.shape="polygon",this.label=new v,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=m.Angle,this.axisInnerRadius=0,this.axisOuterRadius=0,this.lineGroup=new b({name:this.id}),this.rangeGroup=new b({name:this.id}),this.labelGroup=new b({name:this.id}),this._isRange=void 0}assignCrossLineGroup(t,e){t!==this._isRange&&(t?this.rangeGroup.appendChild(e):this.lineGroup.appendChild(e)),this._isRange=t}setSectorNodeProps(t){t.fill=this.fill,t.fillOpacity=this.fillOpacity??1,t.stroke=this.stroke,t.strokeOpacity=this.strokeOpacity??1,t.strokeWidth=this.strokeWidth??1,t.lineDash=this.lineDash}setLabelNodeProps(t,e,i,a,s){let{label:o}=this;t.x=e,t.y=i,t.text=o.text,t.textAlign="center",t.textBaseline=a,t.rotation=s,t.rotationCenterX=e,t.rotationCenterY=i,t.fill=o.color,t.fontFamily=o.fontFamily,t.fontSize=o.fontSize,t.fontStyle=o.fontStyle,t.visible=!0}};n([x],S.prototype,"enabled",2),n([x],S.prototype,"type",2),n([x],S.prototype,"range",2),n([x],S.prototype,"value",2),n([x],S.prototype,"defaultColorRange",2),n([x],S.prototype,"fill",2),n([x],S.prototype,"fillOpacity",2),n([x],S.prototype,"stroke",2),n([x],S.prototype,"strokeWidth",2),n([x],S.prototype,"strokeOpacity",2),n([x],S.prototype,"lineDash",2),n([x],S.prototype,"shape",2),n([x],S.prototype,"label",2);var{ChartAxisDirection:k,getCrossLineValue:D,validateCrossLineValue:M,normalizeAngle360:w,Group:I,Path:C,Sector:A,RotatableText:L,ContinuousScale:T}=a.n1,N=class extends S{constructor(){super(),this.direction=k.Angle,this.polygonNode=new C,this.sectorNode=new A,this.lineNode=new C,this.crossLineRange=new I,this.labelNode=new L,this.ticks=[],this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.crossLineRange.append(this.lineNode),this.labelGroup.append(this.labelNode)}visibilityCheck(){if(!T.is(this.scale))return!0;let[t,e]=this.scale.domain,i=D(this);if(!(0,s.cy)(i))return i>=t&&i<=e;{let[a,s]=i;return a>=t&&a<=e&&s>=a&&s<=e}}update(t){let{scale:e}=this;if(!e||!M(D(this),e)||!this.visibilityCheck()){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.rangeGroup.visible=t,this.lineGroup.visible=t,this.labelGroup.visible=t,this.updateLineNode(t),this.updatePolygonNode(t),this.updateSectorNode(t),this.updateLabelNode(t)}updateLineNode(t){let{scale:e,type:i,value:a,lineNode:s}=this;if(!t||"line"!==i||!e){s.visible=!1;return}let o=e.convert(a);if(isNaN(o)){s.visible=!1;return}let{axisInnerRadius:r,axisOuterRadius:n}=this;s.visible=!0,s.stroke=this.stroke,s.strokeOpacity=this.strokeOpacity??1,s.strokeWidth=this.strokeWidth??1,s.fill=void 0,s.lineDash=this.lineDash;let l=n*Math.cos(o),h=n*Math.sin(o),d=r*Math.cos(o),c=r*Math.sin(o);s.path.clear(!0),s.path.moveTo(d,c),s.path.lineTo(l,h),this.assignCrossLineGroup(!1,this.crossLineRange)}updatePolygonNode(t){let{polygonNode:e,range:i,scale:a,shape:s,type:o,ticks:r}=this;if(!t||"range"!==o||"polygon"!==s||!a||!i){e.visible=!1;return}let{axisInnerRadius:n,axisOuterRadius:l}=this,h=r.indexOf(i[0]),d=r.indexOf(i[1]),c=(h<=d?r.slice(h,d+1):r.slice(h).concat(r.slice(0,d+1))).map(t=>a.convert(t));e.visible=!0,this.setSectorNodeProps(e);let{path:p}=e;p.clear(!0),c.forEach((t,e)=>{let i=l*Math.cos(t),a=l*Math.sin(t);0===e?p.moveTo(i,a):p.lineTo(i,a)}),0===n?p.lineTo(0,0):c.slice().reverse().forEach(t=>{let e=n*Math.cos(t),i=n*Math.sin(t);p.lineTo(e,i)}),e.path.closePath(),this.assignCrossLineGroup(!0,this.crossLineRange)}updateSectorNode(t){let{sectorNode:e,range:i,scale:s,shape:o,type:r}=this;if(!t||"range"!==r||"circle"!==o||!s||!i){e.visible=!1;return}let{axisInnerRadius:n,axisOuterRadius:l}=this,h=i.map(t=>s.convert(t)),d=s.step??0,c=s instanceof a.n1.BandScale?d/2:0;e.visible=!0,this.setSectorNodeProps(e),e.centerX=0,e.centerY=0,e.innerRadius=n,e.outerRadius=l,e.startAngle=h[0]-c,e.endAngle=h[1]+c,this.assignCrossLineGroup(!0,this.crossLineRange)}updateLabelNode(t){let e,i,a,o,{label:r,labelNode:n,range:l,scale:h,type:d,ticks:c}=this;if(!t||!1===r.enabled||!r.text||!h||"range"===d&&!l){n.visible=!1;return}n.visible=!0;let{axisInnerRadius:p,axisOuterRadius:u}=this;if("line"===d){let t=w(h.convert(this.value)),n=1.5*Math.PI,l=(0,s.YX)(t,n)||t>n||t<Math.PI/2,d=(p+u)/2*Math.cos(t),c=(p+u)/2*Math.sin(t);e=d+r.padding*Math.cos(t+Math.PI/2),i=c+r.padding*Math.sin(t+Math.PI/2),o=l?"top":"bottom",a=l?t:t-Math.PI}else{let t,[n,d]=l.map(t=>w(h.convert(t))),p=(n+d)/2;n>d&&(p-=Math.PI),p=w(p);let g=((0,s.YX)(p,0)||p>0)&&p<Math.PI;e=(t="circle"===this.shape||c.length<3?u-r.padding:u*Math.cos(Math.PI/c.length)-r.padding)*Math.cos(p),i=t*Math.sin(p),o=g?"bottom":"top",a=g?p-Math.PI/2:p+Math.PI/2}this.setLabelNodeProps(n,e,i,o,a)}};N.className="AngleCrossLine";var{ChartAxisDirection:O,TextWrapper:P,TextUtils:E,Property:R,toRadians:B,normalizeAngle360:z,normalizeAngle360Inclusive:F,Path:_,RotatableText:W,Transformable:G,BBox:j,Selection:V,Line:$}=a.n1,H=class extends a.n1.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};n([R],H.prototype,"orientation",2);var Y=class extends a.n1.PolarAxis{constructor(t,e){super(t,e),this.startAngle=0,this.endAngle=void 0,this.tickLineGroupSelection=V.select(this.tickLineGroup,$,!1),this.gridLineGroupSelection=V.select(this.gridLineGroup,$,!1),this.labelData=[],this.tickData=[],this.radiusLineGroup=this.axisGroup.appendChild(new a.n1.TransformableGroup),this.radiusLine=this.radiusLineGroup.appendChild(new _),this.includeInvisibleDomains=!0}get direction(){return O.Angle}createLabel(){return new H}calculateRotations(){let t=B(this.startAngle),e=z(t),i=z(t-Math.PI/2);return{rotation:t,parallelFlipRotation:e,regularFlipRotation:i}}calculateTickLayout(t){let{nice:e,scale:i}=this,a=e?i.niceDomain({nice:e,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0},t):t,o=this.generateAngleTicks(a);this.tickData=o;let r=o.map(t=>t.value),n=r.reduce((t,e)=>Math.max("number"==typeof e?(0,s.o3)(e):0,t),0);return{niceDomain:a,tickDomain:a,ticks:r,rawTickCount:void 0,fractionDigits:n,timeInterval:void 0,bbox:this.getBBox()}}update(){super.update(),this.updateRadiusLine(),this.updateGridLines(),this.updateTickLines()}normalizedAngles(){let t=z(-Math.PI/2+B(this.startAngle));return[t,t+(null!=this.endAngle?F(B(this.endAngle)-B(this.startAngle)):2*Math.PI)]}computeRange(){this.range=this.normalizedAngles()}updateSelections(){let t=this.tickData;this.gridLineGroupSelection.update(this.gridLength&&this.gridLine.enabled?t:[]),this.tickLineGroupSelection.update(this.tick.enabled?t:[]),this.tickLabelGroupSelection.update(this.label.enabled?t:[]),this.gridLineGroupSelection.cleanup(),this.tickLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup()}updatePosition(){super.updatePosition();let{translation:t,radiusLineGroup:e}=this,i=Math.floor(t.x),a=Math.floor(t.y);e.translationX=i,e.translationY=a}updateRadiusLine(){let t=this.radiusLine,{path:e}=t;e.clear(!0);let{points:i,closePath:a}=this.getAxisLinePoints();i.forEach(({x:t,y:i,moveTo:a,arc:s,radius:o=0,startAngle:r=0,endAngle:n=0})=>{s?e.arc(t,i,o,r,n):a?e.moveTo(t,i):e.lineTo(t,i)}),a&&e.closePath(),t.visible=this.line.enabled,t.stroke=this.line.stroke,t.strokeWidth=this.line.width,t.fill=void 0}getAxisLinePoints(){let{scale:t,shape:e,gridLength:i}=this,[a,o]=this.range,r=(0,s.YX)(o-a,2*Math.PI),n=[];if("circle"===e)r?n.push({x:i,y:0,moveTo:!0},{x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1}):n.push({x:i*Math.cos(a),y:i*Math.sin(a),moveTo:!0},{x:0,y:0,radius:i,startAngle:z(a),endAngle:z(o),arc:!0,moveTo:!1});else if("polygon"===e){let e=t.ticks({nice:this.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.map(e=>t.convert(e));e&&e.length>2&&e.forEach((t,e)=>{let a=i*Math.cos(t),s=i*Math.sin(t);n.push({x:a,y:s,moveTo:0===e})})}return{points:n,closePath:r}}updateGridLines(){let{scale:t,gridLength:e,gridLine:{style:i,width:a},innerRadiusRatio:s}=this;if(!(i&&e>0))return;let o=e*s,r=i.length;this.gridLineGroupSelection.each((s,n,l)=>{let{value:h}=n,{stroke:d,lineDash:c}=i[l%r],p=t.convert(h);s.x1=o*Math.cos(p),s.y1=o*Math.sin(p),s.x2=e*Math.cos(p),s.y2=e*Math.sin(p),s.stroke=d,s.strokeWidth=a,s.lineDash=c,s.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){let{label:t,tickLabelGroupSelection:e}=this;e.each((e,i,a)=>{let s=this.labelData[a];if(!s||s.hidden){e.visible=!1;return}e.text=s.text,e.setFont(t),e.fill=t.color,e.x=s.x,e.y=s.y,e.textAlign=s.textAlign,e.textBaseline=s.textBaseline,e.visible=!0,s.rotation?(e.rotation=s.rotation,e.rotationCenterX=s.x,e.rotationCenterY=s.y):e.rotation=0})}updateTickLines(){let{scale:t,gridLength:e,tick:i,tickLineGroupSelection:a}=this;a.each((a,s)=>{let{value:o}=s,r=t.convert(o),n=Math.cos(r),l=Math.sin(r);a.x1=e*n,a.y1=e*l,a.x2=(e+i.size)*n,a.y2=(e+i.size)*l,a.stroke=i.stroke,a.strokeWidth=i.width})}createLabelNodeData(t,e,i){let{label:a,gridLength:o,scale:r,tick:n}=this;if(!a.enabled)return[];let l=new W,h=i.x-this.translation.x,d=i.x+i.width-this.translation.x,c=t.map((i,c)=>{let{value:p}=i,u=o+a.spacing+n.size,g=r.convert(p),y=u*Math.cos(g),f=u*Math.sin(g),{textAlign:m,textBaseline:x}=this.getLabelAlign(g),b=c===t.length-1&&p!==t[0]&&(0,s.YX)(z(g),z(r.convert(t[0]))),v=this.getLabelRotation(g),S=this.formatTick(p,c,r.domain);l.text=S,l.x=y,l.y=f,l.setFont(a),l.textAlign=m,l.textBaseline=x,l.rotation=v,v&&(l.rotationCenterX=y,l.rotationCenterY=f);let k=v?G.toCanvas(l):l.getBBox();if(k&&e.hideWhenNecessary&&!v){let t=h-k.x,e=k.x+k.width-d;if(t>1||e>1){let i=k.width-Math.max(t,e);(S=P.wrapText(S,{maxWidth:i,font:a,textWrap:"never"}))===E.EllipsisChar&&(S=""),l.text=S,k=l.getBBox()}}return{text:S,x:y,y:f,textAlign:m,textBaseline:x,hidden:""===S||i.hidden||b,rotation:v,box:k}});return a.avoidCollisions&&this.avoidLabelCollisions(c),c}computeLabelsBBox(t,e){this.labelData=this.createLabelNodeData(this.tickData,t,e);let i=this.labelData.map(({box:t})=>t).filter(t=>null!=t);return this.label.enabled&&0!==i.length?j.merge(i):null}getLabelOrientation(){let{label:t}=this;return t instanceof H?t.orientation:"fixed"}getLabelRotation(t){let e=B(this.label.rotation??0);t=z(t);let i=this.getLabelOrientation();return"parallel"===i?(e+=t,t>=0&&t<Math.PI?e-=Math.PI/2:e+=Math.PI/2):"perpendicular"===i&&(e+=t,t>=Math.PI/2&&t<1.5*Math.PI&&(e+=Math.PI)),e}getLabelAlign(t){let e,i,a=Math.cos(t),o=Math.sin(t),r=this.getLabelOrientation(),n=(0,s.YX)(a,0),l=(0,s.YX)(o,0),h=(0,s.YX)(a,1),d=(0,s.YX)(o,-1),c=a>0&&!n,p=o>0&&!l;return"parallel"===r?(e="center",i=h&&l||p?"top":"bottom"):"perpendicular"===r?(e=d||c?"left":"right",i="middle"):(e="right",n?e="center":c&&(e="left"),i="bottom",l?i="middle":p&&(i="top")),{textAlign:e,textBaseline:i}}updateCrossLines(){let{shape:t,gridLength:e,innerRadiusRatio:i}=this;this.crossLines.forEach(a=>{a instanceof N&&(a.ticks=this.tickData.map(t=>t.value),a.shape=t,a.axisOuterRadius=e,a.axisInnerRadius=e*i)}),super.updateCrossLines()}};Y.CrossLineConstructor=N,n([R],Y.prototype,"startAngle",2),n([R],Y.prototype,"endAngle",2);var{Property:K,CategoryScale:U}=a.n1,X=class extends Y{constructor(t){super(t,new U),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new y}generateAngleTicks(){let{scale:t,gridLength:e}=this,{values:i,minSpacing:a}=this.interval,s=i??t.ticks({nice:this.nice,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks??[];if(s.length<2||null==a)return s.map(t=>({value:t,visible:!0}));let o=s[0],r=t.convert(o),n=e*Math.cos(r),l=e*Math.sin(r);for(let i=1;i<s.length-1;i++){let h=s[i],d=t.convert(h);if(d-r>Math.PI)break;if(Math.sqrt((e*Math.cos(d)-n)**2+(e*Math.sin(d)-l)**2)>a){let t=new Set([o]);return p(s,i,(e,i)=>{t.add(i)}),s.map(e=>{let i=t.has(e);return{value:e,visible:i}})}}return[{value:o,visible:!0}]}avoidLabelCollisions(t){let{minSpacing:e}=this.label;if(t.length<3)return;let i=(t,i)=>{if(t.hidden||i.hidden)return!1;if(null==e)return t.box.collidesBBox(i.box);let a=t.box.clone().grow(e/2),s=i.box.clone().grow(e/2);return a.collidesBBox(s)},a=t[0],o=t.at(-1),r=new Set([a]),n=(0,s.YX)(a.x,o.x)&&(0,s.YX)(a.y,o.y),l=Math.floor(t.length/2);for(let e=1;e<=l;e++){let a=n?t.slice(0,-1):t;if(!p(a,e,i)){p(a,e,(t,e)=>{r.add(e)});break}}t.forEach(t=>{r.has(t)||(t.hidden=!0,t.box=void 0)})}};X.className="AngleCategoryAxis",X.type="angle-category",n([K],X.prototype,"groupPaddingInner",2),n([K],X.prototype,"paddingInner",2),n([K],X.prototype,"interval",2);var Z={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-category",moduleFactory:t=>new X(t)},{range:Q,isDenseInterval:q,LinearScale:J}=a.n1,tt=class t extends J{constructor(){super(...arguments),this.arcLength=0}static getNiceStepAndTickCount(t,e){let[i,a]=e,s=J.getTickStep(i,a,t),o=isNaN(t.maxTickCount)?1/0:t.maxTickCount,r=Math.pow(2,Math.ceil(Math.log(Math.abs(a-i)/s)/Math.log(2)));return r>o&&(r/=2,s*=2),{count:r,step:s}}ticks(e,i=this.domain){let a,{arcLength:s}=this;if(!i||i.length<2||i.some(t=>!isFinite(t))||s<=0)return{ticks:[],count:0};let{nice:o,interval:r}=e,[n,l]=i;if(r){let t=Math.abs(r);if(!q((l-n)/t,this.getPixelRange()))return Q(n,l,t)}if(o&&this.hasNiceRange()){let s=super.niceDomain(e,i);a=t.getNiceStepAndTickCount(e,s).step}else a=J.getTickStep(n,l,e);return Q(n,l,a)}hasNiceRange(){let t=this.range.slice().sort((t,e)=>t-e);return[Math.PI,2*Math.PI].some(e=>(0,s.YX)(e,t[1]-t[0]))}niceDomain(e,i=this.domain){let a=super.niceDomain(e,i);if(!this.hasNiceRange())return a;let s=a[0]>a[1],o=s?a[1]:a[0],{step:r,count:n}=t.getNiceStepAndTickCount(e,a),l=1/r,h=r>=1?Math.ceil(o/r+n)*r:Math.ceil((o+n*r)*l)/l;return s?[h,o]:[o,h]}getPixelRange(){return this.arcLength}},{Property:te,angleBetween:ti,normalisedExtentWithMetadata:ta,findMinMax:ts}=a.n1,to=class extends Y{constructor(t){super(t,new tt),this.shape="circle",this.interval=new y}normaliseDataDomain(t){let{min:e,max:i}=this,{extent:a,clipped:s}=ta(t,e,i);return{domain:a,clipped:s}}updateScale(){super.updateScale(),this.scale.arcLength=this.getRangeArcLength()}getRangeArcLength(){let{range:t}=this;return(ti(Math.min(...t),Math.max(...t))||2*Math.PI)*this.gridLength}generateAngleTicks(t){let e,{scale:i,range:a,nice:s}=this,{values:o,step:r,minSpacing:n,maxSpacing:l}=this.interval;if(null==o){let{arcLength:o}=i,h=l?Math.floor(o/l):1,d=n?Math.floor(o/n):1/0,c=Math.max(h,Math.min(d,Math.floor(4/Math.PI*Math.abs(a[0]-a[1]))));e=i.ticks({nice:s,interval:r,tickCount:c,minTickCount:h,maxTickCount:d},t)?.ticks??[]}else{let[i,a]=ts(t.map(Number));e=o.filter(t=>t>=i&&t<=a).sort((t,e)=>t-e)}return e.map(t=>({value:t,visible:!0}))}avoidLabelCollisions(t){let{minSpacing:e}=this.label,i=(t,i)=>{if(t.hidden||i.hidden)return!1;if(null==e)return t.box.collidesBBox(i.box);let a=t.box.clone().grow(e/2),s=i.box.clone().grow(e/2);return a.collidesBBox(s)},a=t[0],o=t.at(-1);a!==o&&(0,s.YX)(a.x,o.x)&&(0,s.YX)(a.y,o.y)&&(o.hidden=!0);for(let e=1;e<t.length;e*=2){let a=!1;for(let s=e;s<t.length;s+=e){let o=t[s];if(i(t[s-e],o)){a=!0;break}}if(!a)return void t.forEach((t,i)=>{i%e>0&&(t.hidden=!0,t.box=void 0)})}t.forEach((t,e)=>{e>0&&(t.hidden=!0,t.box=void 0)})}};to.className="AngleNumberAxis",to.type="angle-number",n([te],to.prototype,"min",2),n([te],to.prototype,"max",2),n([te],to.prototype,"interval",2);var tr={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-number",moduleFactory:t=>new to(t)},{OrdinalTimeScale:tn,Property:tl,TimeAxisParentLevel:th}=a.n1,td=class extends a.n1.CategoryAxis{constructor(t){super(t,new tn),this.parentLevel=new th}get primaryLabel(){return this.parentLevel.enabled?this.parentLevel.label:void 0}get primaryTick(){return this.parentLevel.enabled?this.parentLevel.tick:void 0}};td.className="OrdinalTimeAxis",td.type="ordinal-time",n([tl],td.prototype,"parentLevel",2);var tc={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ordinal-time",moduleFactory:t=>new td(t)},{ChartAxisDirection:tp,Property:tu,getCrossLineValue:tg,validateCrossLineValue:ty,normalizeAngle360FromDegrees:tf,Group:tm,Path:tx,Sector:tb,RotatableText:tv}=a.n1,tS=class extends v{constructor(){super(...arguments),this.positionAngle=void 0}};n([tu],tS.prototype,"positionAngle",2);var tk=class extends S{constructor(){super(),this.direction=tp.Radius,this.label=new tS,this.polygonNode=new tx,this.sectorNode=new tb,this.crossLineRange=new tm,this.labelNode=new tv,this.outerRadius=0,this.innerRadius=0,this.crossLineRange.append(this.polygonNode),this.crossLineRange.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(t){let{scale:e}=this;if(!e||!ty(tg(this),e)){this.rangeGroup.visible=!1,this.lineGroup.visible=!1,this.labelGroup.visible=!1;return}this.updateRadii();let{innerRadius:i,outerRadius:a}=this;t&&(t=i>=this.axisInnerRadius&&a<=this.axisOuterRadius),this.rangeGroup.visible=t,this.lineGroup.visible=t,this.labelGroup.visible=t,this.updatePolygonNode(t),this.updateSectorNode(t),this.updateLabelNode(t),this.assignCrossLineGroup("range"===this.type,this.crossLineRange)}updateRadii(){let t,e,{range:i,scale:a,type:s,axisInnerRadius:o,axisOuterRadius:r}=this;if(!a)return{innerRadius:0,outerRadius:0};if("line"===s)e=t=r+o-a.convert(this.value);else{let s=Math.abs(a?.bandwidth??0),n=i.map(t=>a.convert(t));t=r+o-Math.max(...n),e=r+o-Math.min(...n)+s}this.outerRadius=t,this.innerRadius=e}drawPolygon(t,e,i){e.forEach((e,a)=>{let s=t*Math.cos(e),o=t*Math.sin(e);0===a?i.path.moveTo(s,o):i.path.lineTo(s,o)}),i.path.closePath()}updatePolygonNode(t){let{gridAngles:e,polygonNode:i,scale:a,shape:s,type:o,innerRadius:r,outerRadius:n}=this;if(!t||"polygon"!==s||!a||!e){i.visible=!1;return}i.visible=!0;let l=this.getPadding();i.path.clear(!0),this.drawPolygon(n-l,e,i);let h=e.slice().reverse();this.drawPolygon("line"===o?n-l:r+l,h,i),this.setSectorNodeProps(i)}updateSectorNode(t){let{axisInnerRadius:e,axisOuterRadius:i,scale:a,sectorNode:o,shape:r,innerRadius:n,outerRadius:l}=this;if(!t||"circle"!==r||!a){o.visible=!1;return}o.visible=!0,o.startAngle=0,o.endAngle=2*Math.PI;let h=this.getPadding(),d=(0,s.qE)(e,n+h,i),c=(0,s.qE)(e,l-h,i);o.innerRadius=Math.min(d,c),o.outerRadius=Math.max(d,c),this.setSectorNodeProps(o)}updateLabelNode(t){let e,{innerRadius:i,label:a,labelNode:o,scale:r,shape:n,type:l}=this;if(!t||!1===a.enabled||!a.text||!r){o.visible=!1;return}let h=tf((a.positionAngle??0)-90),d=((0,s.YX)(h,0)||h>0)&&h<Math.PI,c=d?h-Math.PI/2:h+Math.PI/2,p=this.gridAngles??[],u=(e="line"===l?i+a.padding:"circle"===n||p.length<3?i-a.padding:i*Math.cos(Math.PI/p.length)-a.padding)*Math.cos(h),g=e*Math.sin(h);this.setLabelNodeProps(o,u,g,"line"===l?d?"top":"bottom":d?"bottom":"top",c)}getPadding(){let{scale:t}=this;if(!t)return 0;let e=Math.abs(t.bandwidth??0),i=Math.abs(t.step??0);return t instanceof a.n1.BandScale?(i-e)/2:0}};tk.className="RadiusCrossLine";var{ChartAxisDirection:tD,ZIndexMap:tM,Property:tw,normalizeAngle360:tI,toRadians:tC,Caption:tA,Group:tL,TransformableGroup:tT,Path:tN,Line:tO,Selection:tP,AxisTickGenerator:tE,AxisGroupZIndexMap:tR}=a.n1,tB=class extends a.n1.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};n([tw],tB.prototype,"autoRotate",2),n([tw],tB.prototype,"autoRotateAngle",2);var tz=class extends a.n1.PolarAxis{constructor(t,e){super(t,e),this.positionAngle=0,this.gridLineGroupSelection=tP.select(this.gridLineGroup,tO,!1),this.tickGenerator=new tE(this),this.generatedTicks=void 0,this.headingLabelGroup=this.axisGroup.appendChild(new tT({name:`${this.id}-Axis-heading`})),this.lineNodeGroup=this.axisGroup.appendChild(new tT({name:`${this.id}-Axis-line`})),this.lineNode=this.lineNodeGroup.appendChild(new tO({name:`${this.id}-Axis-line`,zIndex:tR.AxisLine})),this.gridPathGroup=this.gridGroup.appendChild(new tL({name:`${this.id}-gridPaths`,zIndex:tM.AXIS_GRID})),this.gridPathSelection=tP.select(this.gridPathGroup,tN),this.headingLabelGroup.appendChild(this.title.caption.node),this.destroyFns.push(this.title.caption.registerInteraction(this.moduleCtx,"afterend"))}get direction(){return tD.Radius}getAxisTransform(){let t=this.scale.range[0],{translation:e,positionAngle:i,innerRadiusRatio:a}=this,s=t*a,o=tC(i);return{translationX:e.x,translationY:e.y-t-s,rotation:o,rotationCenterX:0,rotationCenterY:t+s}}update(){super.update(),this.updateTitle(),this.updateGridLines();let{enabled:t,stroke:e,width:i}=this.line;this.lineNode.setProperties({stroke:e,strokeWidth:t?i:0,x1:0,y1:this.range[0],x2:0,y2:this.range[1]})}updatePosition(){super.updatePosition();let t=this.getAxisTransform();this.tickLineGroup.setProperties(t),this.tickLabelGroup.setProperties(t),this.lineNodeGroup.setProperties(t),this.headingLabelGroup.setProperties(t)}calculateRotations(){return{rotation:0,parallelFlipRotation:0,regularFlipRotation:-Math.PI/2}}calculateTickLayout(t,e,i){let a=-Math.PI/2,s=this.label.getSideFlag(),o=s*(this.getTickSize()+this.label.spacing+this.seriesAreaPadding),r=this.tickGenerator.generateTicks({domain:t,niceMode:e,visibleRange:[0,1],primaryTickCount:void 0,parallelFlipRotation:0,regularFlipRotation:a,labelX:o,sideFlag:s,removeOverflowLabels:!1}),{tickData:n}=r,{ticks:l,rawTicks:h,rawTickCount:d,tickDomain:c,fractionDigits:p,niceDomain:u=t}=n,g=l.map(t=>this.getTickLabelProps(t,r));return this.generatedTicks={ticks:l,labels:g},{ticks:h,tickDomain:c,niceDomain:u,rawTickCount:d,fractionDigits:p,timeInterval:void 0}}updateSelections(){let{generatedTicks:t}=this;if(!t)return;let{ticks:e,labels:i}=t;this.gridLineGroupSelection.update(this.gridLength?e:[]),this.tickLabelGroupSelection.update(i),this.gridPathSelection.update(this.gridLine.enabled?this.prepareGridPathTickData(e):[]),this.gridLineGroupSelection.cleanup(),this.tickLabelGroupSelection.cleanup(),this.gridPathSelection.cleanup()}updateLabels(){if(!this.label.enabled)return;let t=a.n1.resetAxisLabelSelectionFn();this.tickLabelGroupSelection.each((e,i)=>{e.fill=i.fill,e.fontFamily=i.fontFamily,e.fontSize=i.fontSize,e.fontStyle=i.fontStyle,e.fontWeight=i.fontWeight,e.text=i.text,e.textBaseline=i.textBaseline,e.textAlign=i.textAlign??"center",e.setProperties(t(e,i))})}updateGridLines(){let{gridLine:{style:t,width:e},shape:i,generatedTicks:a}=this;if(!t||!a)return;let o=t.length,r=(i,a)=>{let{stroke:s,lineDash:r}=t[a%o];i.stroke=s,i.strokeWidth=e,i.lineDash=r,i.fill=void 0},[n,l]=this.gridRange??[0,2*Math.PI],h=(0,s.YX)(l-n,2*Math.PI),d="circle"===i?(t,e)=>{let{path:i}=t;i.clear(!0);let a=this.getTickRadius(e);h?(i.moveTo(a,0),i.arc(0,0,a,0,2*Math.PI)):(i.moveTo(a*Math.cos(n),a*Math.sin(n)),i.arc(0,0,a,tI(n),tI(l))),h&&i.closePath()}:(t,e)=>{let{path:i}=t,a=this.gridAngles;if(i.clear(!0),!a||a.length<3)return;let s=this.getTickRadius(e);a.forEach((t,e)=>{let o=s*Math.cos(t),r=s*Math.sin(t);0===e?i.moveTo(o,r):i.lineTo(o,r),a.forEach((t,e)=>{let a=s*Math.cos(t),o=s*Math.sin(t);0===e?i.moveTo(a,o):i.lineTo(a,o)}),i.closePath()}),i.closePath()};this.gridPathSelection.each((t,e,i)=>{r(t,i),d(t,e)})}updateTitle(){let{title:t,range:e}=this,{formatter:i=t=>t.defaultValue}=this.title;t.caption.enabled=t.enabled,t.caption.fontFamily=t.fontFamily,t.caption.fontSize=t.fontSize,t.caption.fontStyle=t.fontStyle,t.caption.fontWeight=t.fontWeight,t.caption.color=t.color,t.caption.wrapping=t.wrapping;let a=!1,s=t.caption.node;t.enabled&&(a=!0,s.rotation=Math.PI/2,s.x=Math.floor((e[0]+e[1])/2),s.y=-tA.SMALL_PADDING,s.textAlign="center",s.textBaseline="bottom",s.text=this.callWithContext(i,this.getTitleFormatterParams(this.scale.domain))),s.visible=a}updateCrossLines(){this.crossLines.forEach(t=>{if(t instanceof tk){let{shape:e,gridAngles:i,range:a,innerRadiusRatio:s}=this,o=a[0];t.shape=e,t.gridAngles=i,t.axisOuterRadius=o,t.axisInnerRadius=o*s}}),super.updateCrossLines()}createLabel(){return new tB}getTickLabelProps(t,e){let{label:i}=this,{rotation:a,textBaseline:s,textAlign:o}=e,r=this.scale.range,n=t.tickLabel??"",l=i.getSideFlag()*(this.getTickSize()+i.spacing+this.seriesAreaPadding);return{...this.getLabelStyles({value:t.tickLabel}),tickId:t.tickId,rotation:a,text:n,textAlign:o,textBaseline:s,visible:""!==n&&null!=n,x:l,y:t.translationY,rotationCenterX:l,rotationCenterY:t.translationY,range:r}}};tz.CrossLineConstructor=tk,n([tw],tz.prototype,"positionAngle",2);var{ProxyPropertyOnWrite:tF,Property:t_,CategoryScale:tW}=a.n1,tG=class extends tz{constructor(t){super(t,new tW),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}normaliseDataDomain(t){return{domain:t,clipped:!1}}prepareGridPathTickData(t){return t.slice().reverse()}getTickRadius(t){let{scale:e,innerRadiusRatio:i}=this,a=e.range[0],s=a*i;if(tW.is(e)){let i=e.domain,a=i.length-1-i.indexOf(t.tick);return 0===a?s:e.inset+e.step*(a-.5)+e.bandwidth/2}{let i=(a-s)/e.domain.length;return a-t.translationY+s-i/2}}};tG.className="RadiusCategoryAxis",tG.type="radius-category",n([t_],tG.prototype,"groupPaddingInner",2),n([tF("scale","paddingInner"),t_],tG.prototype,"paddingInner",2),n([tF("scale","paddingOuter"),t_],tG.prototype,"paddingOuter",2);var tj={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-category",moduleFactory:t=>new tG(t)},{Property:tV,normalisedExtentWithMetadata:t$,LinearScale:tH}=a.n1,tY=class extends tz{constructor(t){super(t,new tH),this.shape="polygon"}prepareGridPathTickData(t){let{scale:e}=this,i=e.domain[1];return t.filter(({tick:t})=>t!==i).sort((t,e)=>e.tick-t.tick)}getTickRadius(t){let{scale:e}=this,i=e.range[0],a=i*this.innerRadiusRatio;return i-t.translationY+a}normaliseDataDomain(t){let{min:e,max:i}=this,{extent:a,clipped:s}=t$(t,e,i);return{domain:a,clipped:s}}};tY.className="RadiusNumberAxis",tY.type="radius-number",n([tV],tY.prototype,"min",2),n([tV],tY.prototype,"max",2);var tK={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-number",moduleFactory:t=>new tY(t)},{ObserveChanges:tU,Property:tX}=a.n1,tZ=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,t.animationManager.skip(!1),this.destroyFns.push(()=>{t.animationManager.skip(!0)})}};n([tU((t,e)=>{t.ctx.animationManager.skip(!e)}),tX],tZ.prototype,"enabled",2),n([tU((t,e)=>{t.ctx.animationManager.defaultDuration=e}),tX],tZ.prototype,"duration",2);var tQ={type:"root",optionsKey:"animation",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new tZ(t),themeTemplate:{animation:{enabled:!0}}},{focusCursorAtEnd:tq}=a.n1,tJ="text-input",t0="canvas-overlay",t1=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1,this.element=t.domManager.addChild(t0,tJ),this.element.classList.add("ag-charts-text-input"),this.destroyFns.push(()=>t.domManager.removeChild(t0,tJ))}setKeyDownHandler(t){this.element.addEventListener("keydown",t),this.destroyFns.push(()=>this.element.removeEventListener("keydown",t))}show(t){this.element.innerHTML='<div contenteditable="plaintext-only" class="ag-charts-text-input__textarea" tabindex="0"></div>';let e=this.element.firstElementChild;(0,s.Bq)(e,"data-preventdefault",!1),e.isContentEditable||(e.contentEditable="true"),e.setAttribute("placeholder",this.ctx.localeManager.t(t.placeholderText??"inputTextareaPlaceholder")),t.styles?.placeholderColor&&e.style.setProperty("--placeholder-text-color",t.styles?.placeholderColor),e.innerText=t.text??"",e.style.color=t.styles?.color??"inherit",e.style.fontFamily=t.styles?.fontFamily??"inherit",e.style.fontSize=t.styles?.fontSize?`${t.styles.fontSize}px`:"inherit",e.style.fontStyle=t.styles?.fontStyle??"inherit",e.style.fontWeight="number"==typeof t.styles?.fontWeight?`${t.styles.fontWeight}`:t.styles?.fontWeight??"inherit",tq(e),e.addEventListener("input",()=>{this.updatePosition(),t.onChange?.(this.getValue(),this.getBBox())}),e.addEventListener("click",t=>{t.stopPropagation()}),t.layout&&(this.layout=t.layout,this.updatePosition()),t.onChange?.(this.getValue(),this.getBBox()),this.visible=!0}hide(){this.element.innerHTML="",this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1}isVisible(){return this.visible}updateColor(t){this.element.firstElementChild&&(this.element.firstElementChild.style.color=t)}updateFontSize(t){if(this.element.firstElementChild)return this.element.firstElementChild.style.fontSize=`${t}px`,this.updatePosition(),this.getBBox()}getValue(){if(this.element.firstElementChild)return this.element.firstElementChild.innerText.trim()}updatePosition(){let{element:t}=this,e=t.firstElementChild;if(!e)return;let i=this.ctx.domManager.getBoundingClientRect(),{width:a,getTextInputCoords:s,getTextPosition:o,alignment:r,textAlign:n}=this.layout;t.style.setProperty("width",a?`${a}px`:"unset");let l=e.getBoundingClientRect(),h=s(l.height),d=h.x;"center"===r?d-=(a??l.width)/2:"right"===r&&(d-=a??l.width);let c=o(),p=h.y;"center"===c?p-=l.height/2:"bottom"===c&&(p-=l.height),t.style.setProperty("top",`${p}px`),t.style.setProperty("left",`${d}px`),t.style.setProperty("max-width",`${i.width-d}px`),t.style.setProperty("text-align",r),e.style.setProperty("text-align",n)}getBBox(){let{left:t,top:e,width:i,height:s}=this.element.getBoundingClientRect();return new a.n1.BBox(t,e,i,s)}},{BaseProperties:t2,Property:t4}=a.n1,t5=class extends t2{constructor(){super(...arguments),this.enabled=!1,this.axes="y"}};n([t4],t5.prototype,"enabled",2),n([t4],t5.prototype,"axes",2);var t3=(t=>(t.Line="line",t.HorizontalLine="horizontal-line",t.VerticalLine="vertical-line",t.DisjointChannel="disjoint-channel",t.ParallelChannel="parallel-channel",t.FibonacciRetracement="fibonacci-retracement",t.FibonacciRetracementTrendBased="fibonacci-retracement-trend-based",t.Callout="callout",t.Comment="comment",t.Note="note",t.Text="text",t.Arrow="arrow",t.ArrowUp="arrow-up",t.ArrowDown="arrow-down",t.DateRange="date-range",t.PriceRange="price-range",t.DatePriceRange="date-price-range",t.QuickDatePriceRange="quick-date-price-range",t))(t3||{}),t6=Object.values(t3),{BaseProperties:t8,Property:t9}=a.n1,t7=class extends t8{};n([t9],t7.prototype,"x",2),n([t9],t7.prototype,"y",2);var et=class extends eS(ek(eb(t8))){},ee=class extends eS(ek(ev(eg(eD(t8))))){constructor(){super(...arguments),this.cornerRadius=2}};n([t9],ee.prototype,"enabled",2),n([t9],ee.prototype,"cornerRadius",2);var ei=class extends ev(t8){},ea=class extends eS(ek(ev(t8))){},es=class extends eD(t8){constructor(){super(...arguments),this.label="",this.position="top",this.alignment="left"}};n([t9],es.prototype,"label",2),n([t9],es.prototype,"position",2),n([t9],es.prototype,"alignment",2);var eo=class extends eD(t8){},er=class extends eD(t8){constructor(){super(...arguments),this.label=""}};function en(t){class e extends em(eb(t)){constructor(){super(...arguments),this.id=(0,s.lk)()}}return e}function el(t){class e extends t{constructor(){super(...arguments),this.start=new t7,this.end=new t7}}return n([t9],e.prototype,"start",2),n([t9],e.prototype,"end",2),e}function eh(t){class e extends t{}return n([t9],e.prototype,"x",2),n([t9],e.prototype,"y",2),e}function ed(t){class e extends t{}return n([t9],e.prototype,"value",2),e}function ec(t){class e extends t{constructor(){super(...arguments),this.background=new ei}}return n([t9],e.prototype,"background",2),e}function ep(t){class e extends t{constructor(){super(...arguments),this.handle=new ea}}return n([t9],e.prototype,"handle",2),e}function eu(t){class e extends t{constructor(){super(...arguments),this.axisLabel=new ee}}return n([t9],e.prototype,"axisLabel",2),e}function eg(t){class e extends t{constructor(){super(...arguments),this.padding=void 0,this.textAlign="center",this.formatter=void 0}}return n([t9],e.prototype,"padding",2),n([t9],e.prototype,"textAlign",2),n([t9],e.prototype,"formatter",2),e}function ey(t){class e extends t{}return e}function ef(t){class e extends t{}return n([t9],e.prototype,"extendStart",2),n([t9],e.prototype,"extendEnd",2),e}function em(t){class e extends t{}return n([t9],e.prototype,"locked",2),e}function ex(t){class e extends t{setLocaleManager(t){this.localeManager??(this.localeManager=t)}}return e}function eb(t){class e extends t{}return n([t9],e.prototype,"visible",2),e}function ev(t){class e extends t{}return n([t9],e.prototype,"fill",2),n([t9],e.prototype,"fillOpacity",2),e}function eS(t){class e extends t{}return n([t9],e.prototype,"stroke",2),n([t9],e.prototype,"strokeOpacity",2),n([t9],e.prototype,"strokeWidth",2),e}function ek(t){class e extends t{constructor(){super(...arguments),this.lineCap=void 0,this.computedLineDash=void 0}}return n([t9],e.prototype,"lineDash",2),n([t9],e.prototype,"lineDashOffset",2),n([t9],e.prototype,"lineStyle",2),e}function eD(t){class e extends t{constructor(){super(...arguments),this.fontSize=12,this.fontFamily="Verdana, sans-serif"}}return n([t9],e.prototype,"fontStyle",2),n([t9],e.prototype,"fontWeight",2),n([t9],e.prototype,"fontSize",2),n([t9],e.prototype,"fontFamily",2),n([t9],e.prototype,"color",2),e}function eM(t){return(0,s.Et)(t)||(0,s.Kg)(t)||(0,s.$P)(t)?{value:t,groupPercentage:0}:t??{value:void 0,groupPercentage:0}}function ew(t){return eM(t)?.value}n([t9],er.prototype,"label",2),n([t9],er.prototype,"position",2),n([t9],er.prototype,"alignment",2);var{clampArray:eI}=a.n1;function eC(t,e){if(null==t.start||null==t.end)return;let i=eA(t.start,e),a=eA(t.end,e);if(null!=i&&null!=a)return{x1:i.x,y1:i.y,x2:a.x,y2:a.y}}function eA(t,e){return{x:eL(t.x,e.xAxis),y:eL(t.y,e.yAxis)}}function eL(t,e){if(null==t)return 0;let{value:i,groupPercentage:a}=eM(t),{scale:s,snapToGroup:o}=e,r=0===s.bandwidth?s.step??0:s.bandwidth??0;return s.convert(i)+(o?r/2:r*a)}function eT(t,e){return{x:eN(t.x,e.xAxis),y:eN(t.y,e.yAxis)}}function eN(t,e){let{scale:i}=e;if(e.continuous&&null==i.step)return e.scaleInvert(t);let a=e.scaleInvertNearest(t),s=0===i.bandwidth?i.step:i.bandwidth??0,o=i.convert(a),r=o+s,n=eI(t,i.range);return{value:a,groupPercentage:o===r?0:(n-o)/(r-o)}}var{BaseProperties:eO}=a.n1,eP=class extends en(el(ep(eO))){constructor(){super(...arguments),this.snapToAngle=45}getDefaultColor(t){}getDefaultOpacity(t){}},{Property:eE}=a.n1,eR=class extends ex(eg(eD(eP))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(t){return this.color}getDefaultOpacity(t){}getPlaceholderColor(){}getPadding(){let{padding:t=0}=this;return{top:t,right:t,bottom:t,left:t}}getText(){let t=0==this.text.length,e=this.text;return t&&(e=this.placeholderText??"",this.localeManager&&(e=this.localeManager.t(e))),{text:e,isPlaceholder:t}}getTextInputCoords(t,e){return eA(this.end,t)}getTextPosition(){return this.position}};n([eE],eR.prototype,"text",2);var{Property:eB,Color:ez}=a.n1,eF={top:6,right:12,bottom:9,left:12},e_=class extends ev(eS(eR)){constructor(){super(...arguments),this.type="callout",this.position="bottom",this.alignment="left"}static is(t){return(0,s.Gv)(t)&&"callout"===t.type}getDefaultColor(t){switch(t){case"fill-color":return this.fill;case"line-color":return this.stroke;default:return this.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;default:return}}getPlaceholderColor(){let{r:t,g:e,b:i}=ez.fromString(this.color??"#888888");return new ez(t,e,i,.66).toString()}getPadding(){let{padding:t}=this;return null==t?{...eF}:{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){let i=super.getTextInputCoords(t,e),a=this.getPadding(),s=a.left??0,o=a.bottom??0;return{x:i.x+s,y:i.y-o}}};n([eB],e_.prototype,"type",2);var{BaseProperties:eW,Property:eG}=a.n1,ej=class extends en(eh(ep(eg(eD(eW))))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}getDefaultColor(t){return this.color}getDefaultOpacity(t){}getPlaceholderColor(){}getPadding(){let{padding:t=0}=this;return{top:t,right:t,bottom:t,left:t}}getText(){let t=0==this.text.length;return{text:t?this.placeholderText??"":this.text,isPlaceholder:t}}getTextInputCoords(t,e){return eA(this,t)}getTextPosition(){return this.position}};n([eG],ej.prototype,"text",2);var{Property:eV,Color:e$}=a.n1,eH={top:8,right:14,bottom:8,left:14},eY=class extends ev(eS(ej)){constructor(){super(...arguments),this.type="comment",this.position="bottom",this.alignment="left"}static is(t){return(0,s.Gv)(t)&&"comment"===t.type}getDefaultColor(t){switch(t){case"fill-color":return this.fill;case"line-color":return this.stroke;default:return this.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;default:return}}getPlaceholderColor(){let{r:t,g:e,b:i}=e$.fromString(this.color??"#888888");return new e$(t,e,i,.66).toString()}getPadding(){let{padding:t,fontSize:e}=this;return null==t?{top:Math.max(.4*e,eH.top),bottom:Math.max(.4*e,eH.bottom),left:Math.max(.8*e,eH.left),right:Math.max(.8*e,eH.right)}:{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){let i=super.getTextInputCoords(t,e),a=this.getPadding();return{x:i.x+a.left,y:i.y-a.bottom}}};n([eV],eY.prototype,"type",2);var{Vec2:eK}=a.n1;function eU(t,e){return t?"dashed":e??"solid"}function eX(t,e){switch(e){case"solid":return[];case"dashed":return[4*t,2*t];case"dotted":return[0,2*t]}}function eZ(t,e,i,a){let s=eU(t,i);return e??t??eX(a??1,s)}function eQ(t,e,i){let a=eU(e,i);return t??"dotted"===a?"round":void 0}var{BaseProperties:eq,Property:eJ}=a.n1,e0=class extends eS(eq){},e1=class extends eD(ev(eS(eq))){constructor(){super(...arguments),this.divider=new e0}};n([eJ],e1.prototype,"divider",2);var e2=class extends ev(eS(ep(eq))){constructor(){super(...arguments),this.statistics=new e1}};n([eJ],e2.prototype,"statistics",2);var e4=class extends ex(ec(eS(ek(eP)))){constructor(){super(...arguments),this.direction="both",this.hasDateRange=!1,this.hasPriceRange=!1,this.statistics=new e1,this.getVolume=()=>void 0,this.text=new es}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return eZ(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return eQ(this.lineCap,this.lineDash,this.lineStyle)}};function e5(t){class e extends t{constructor(){super(...arguments),this.hasDateRange=!0}}return e}function e3(t){class e extends t{constructor(){super(...arguments),this.hasPriceRange=!0}}return e}n([eJ],e4.prototype,"statistics",2),n([eJ],e4.prototype,"text",2);var e6=class extends e5(e4){constructor(){super(...arguments),this.type="date-range",this.direction="horizontal"}static is(t){return(0,s.Gv)(t)&&"date-range"===t.type}};n([eJ],e6.prototype,"type",2),n([eJ],e6.prototype,"extendAbove",2),n([eJ],e6.prototype,"extendBelow",2);var e8=class extends e3(e4){constructor(){super(...arguments),this.type="price-range",this.direction="vertical"}static is(t){return(0,s.Gv)(t)&&"price-range"===t.type}};n([eJ],e8.prototype,"type",2),n([eJ],e8.prototype,"extendLeft",2),n([eJ],e8.prototype,"extendRight",2);var e9=class extends e5(e3(e4)){constructor(){super(...arguments),this.type="date-price-range",this.direction="both"}static is(t){return(0,s.Gv)(t)&&"date-price-range"===t.type}};n([eJ],e9.prototype,"type",2);var e7=class extends e5(e3(e4)){constructor(){super(...arguments),this.type="quick-date-price-range",this.up=new e2,this.down=new e2,this.direction="both"}static is(t){return(0,s.Gv)(t)&&"quick-date-price-range"===t.type}};n([eJ],e7.prototype,"type",2),n([eJ],e7.prototype,"up",2),n([eJ],e7.prototype,"down",2);var{TextWrapper:it,CachedTextMeasurerPool:ie,BBox:ii}=a.n1;function ia(t){return{font:{fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},textAlign:t.textAlign,textBaseline:"center"==t.position?"middle":t.position,lineHeight:1.38,avoidOrphans:!1,textWrap:"always"}}function is(t,e,i){return i?it.wrapText(e,{...ia(t),maxWidth:i}):e}function io(t,e,i,a){let s=a?.width??0,o=a?.height??0;if(!a){let i=null!=t.width?is(t,e,t.width):e;({width:s,height:o}=function(t,e){let i=ia(t),{lineMetrics:a,width:s}=ie.measureLines(e,i);return{width:s,height:a.length*(t.fontSize??14)*1.38}}(t,i))}return new ii(i.x,i.y,s,o)}function ir(t,e,i,a,{x:s,y:o},r){let{visible:n=!0,fontFamily:l,fontSize:h=14,fontStyle:d,fontWeight:c,textAlign:p}=a;r??(r="center"==a.position?"middle":a.position);let u=i?a.getPlaceholderColor():a.color;t.setProperties({x:s,y:o,visible:n,text:e,fill:u,fontFamily:l,fontSize:h,fontStyle:d,fontWeight:c,textAlign:p,lineHeight:1.38*h,textBaseline:r})}var{BaseProperties:il,Property:ih}=a.n1,id=class extends ev(eS(il)){},ic=class extends ev(eS(ej)){constructor(){super(...arguments),this.type="note",this.background=new id,this.position="bottom",this.alignment="center",this.width=200}static is(t){return(0,s.Gv)(t)&&"note"===t.type}getDefaultColor(t){switch(t){case"line-color":return this.fill;case"text-color":return this.color}}getDefaultOpacity(t){switch(t){case"line-color":return this.fillOpacity;case"text-color":return}}getPadding(){let t=this.padding??10;return{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){let{width:i,text:a}=this,o=super.getTextInputCoords(t,e),r=this.getPadding().top,n=io(this,a,o);n.x=(0,s.qE)(i/2,n.x,t.seriesRect.width-i/2);let l=n.y-30-2*r,h=n.y+11+2*r;return l-Math.max(n.height,e)-34<0?(n.y=h,this.position="top"):(n.y=l+r,this.position="bottom"),{x:n.x,y:n.y}}};n([ih],ic.prototype,"type",2),n([ih],ic.prototype,"background",2);var{BaseProperties:ip}=a.n1,iu=class extends en(eh(ep(ip))){getDefaultColor(t){}getDefaultOpacity(t){}},ig=class t extends ev(iu){constructor(){super(...arguments),this.size=32}static is(e){return e instanceof t}getDefaultColor(t){return"fill-color"===t?this.fill:void 0}getDefaultOpacity(t){return"fill-color"===t?this.fillOpacity:void 0}},{BaseProperties:iy,Property:im}=a.n1,ix=class extends en(ed(ep(eu(eS(ek(iy)))))){constructor(){super(...arguments),this.direction="horizontal",this.type="horizontal-line",this.text=new es}static is(t){return(0,s.Gv)(t)&&"horizontal-line"===t.type}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return eZ(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return eQ(this.lineCap,this.lineDash,this.lineStyle)}};n([im],ix.prototype,"type",2),n([im],ix.prototype,"text",2);var ib=class extends en(ed(ep(eu(eS(ek(iy)))))){constructor(){super(...arguments),this.direction="vertical",this.type="vertical-line",this.text=new es}static is(t){return(0,s.Gv)(t)&&"vertical-line"===t.type}getDefaultColor(){return this.stroke}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return eZ(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return eQ(this.lineCap,this.lineDash,this.lineStyle)}};n([im],ib.prototype,"type",2),n([im],ib.prototype,"text",2);var{BaseProperties:iv,Property:iS}=a.n1,ik=class extends en(ec(el(ep(ef(eS(ek(iv))))))){constructor(){super(...arguments),this.type="disjoint-channel",this.text=new er,this.snapToAngle=45}static is(t){return(0,s.Gv)(t)&&"disjoint-channel"===t.type}get bottom(){let t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return"number"==typeof t.start.y&&"number"==typeof t.end.y?(t.start.y-=this.startHeight,t.end.y-=this.endHeight):s.Vy.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return eZ(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return eQ(this.lineCap,this.lineDash,this.lineStyle)}};n([iS],ik.prototype,"type",2),n([iS],ik.prototype,"startHeight",2),n([iS],ik.prototype,"endHeight",2),n([iS],ik.prototype,"text",2);var{Property:iD}=a.n1,iM=class extends ex(ey(ef(eS(ek(eP))))){constructor(){super(...arguments),this.text=new es}getDefaultColor(t){switch(t){case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(){return this.strokeOpacity}getLineDash(){return eZ(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return eQ(this.lineCap,this.lineDash,this.lineStyle)}};n([iD],iM.prototype,"text",2);var iw=class extends iM{constructor(){super(...arguments),this.type="arrow",this.endCap="arrow"}static is(t){return(0,s.Gv)(t)&&"arrow"===t.type}};n([iD],iw.prototype,"type",2);var iI=class extends iM{constructor(){super(...arguments),this.type="line"}static is(t){return(0,s.Gv)(t)&&"line"===t.type}};n([iD],iI.prototype,"type",2);var{Property:iC}=a.n1,iA=class extends iM{constructor(){super(...arguments),this.label=new eo,this.reverse=!1,this.showFill=!0,this.isMultiColor=!0,this.strokes=[],this.bands=10}getDefaultColor(t){switch(t){case"line-color":return this.rangeStroke??this.stroke;case"text-color":return this.text.color}}};n([iC],iA.prototype,"label",2),n([iC],iA.prototype,"reverse",2),n([iC],iA.prototype,"showFill",2),n([iC],iA.prototype,"isMultiColor",2),n([iC],iA.prototype,"strokes",2),n([iC],iA.prototype,"rangeStroke",2),n([iC],iA.prototype,"bands",2);var{Property:iL}=a.n1,iT=class extends iA{constructor(){super(...arguments),this.type="fibonacci-retracement-trend-based",this.endRetracement=new t7}static is(t){return(0,s.Gv)(t)&&"fibonacci-retracement-trend-based"===t.type}};n([iL],iT.prototype,"type",2),n([iL],iT.prototype,"endRetracement",2);var{Property:iN}=a.n1,iO=class extends iA{constructor(){super(...arguments),this.type="fibonacci-retracement"}static is(t){return(0,s.Gv)(t)&&"fibonacci-retracement"===t.type}};n([iN],iO.prototype,"type",2);var{BaseProperties:iP,Property:iE}=a.n1,iR=class extends en(ec(el(ep(ef(eS(ek(iP))))))){constructor(){super(...arguments),this.type="parallel-channel",this.middle=new et,this.text=new er,this.snapToAngle=45}static is(t){return(0,s.Gv)(t)&&"parallel-channel"===t.type}get bottom(){let t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return"number"==typeof t.start.y&&"number"==typeof t.end.y?(t.start.y-=this.height,t.end.y-=this.height):s.Vy.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return eZ(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return eQ(this.lineCap,this.lineDash,this.lineStyle)}};n([iE],iR.prototype,"type",2),n([iE],iR.prototype,"height",2),n([iE],iR.prototype,"middle",2),n([iE],iR.prototype,"text",2);var{Property:iB}=a.n1,iz=class extends ej{constructor(){super(...arguments),this.type="text",this.position="bottom"}static is(t){return(0,s.Gv)(t)&&"text"===t.type}};function iF(t){return e7.is(t)}function i_(t){return iI.is(t)||ix.is(t)||ib.is(t)||iw.is(t)||iG(t)}function iW(t){return ik.is(t)||iR.is(t)}function iG(t){return iO.is(t)||iT.is(t)}function ij(t){return e_.is(t)||eY.is(t)||ic.is(t)||iz.is(t)}function iV(t){return e6.is(t)||e8.is(t)||e9.is(t)||e7.is(t)}function i$(t){return ij(t)&&!ic.is(t)}function iH(t){return i_(t)||iW(t)||iV(t)&&!e7.is(t)}function iY(t){return(i_(t)||iW(t)||iV(t))&&!iF(t)&&(0,s.Gv)(t.text)}function iK(t,e){let i=e?.strokeWidth??t.strokeWidth??1,a=e?.type??t.lineStyle,s=a??eU(t.lineDash,a),o=eX(i,s);t.strokeWidth=i,t.computedLineDash=o,t.lineStyle=s,t.lineCap="dotted"===s?"round":void 0}function iU(t,e,i,a,s,o){switch(e){case"fill-color":"fill"in t&&(t.fill=a),"fillOpacity"in t&&(t.fillOpacity=s),"background"in t&&(t.background.fill=a,t.background.fillOpacity=s);break;case"line-color":("axisLabel"in t&&(t.axisLabel.fill=a,t.axisLabel.fillOpacity=s,t.axisLabel.stroke=a,t.axisLabel.strokeOpacity=s),"fill"in t&&"fillOpacity"in t&&ic.is(t))?(t.fill=a,t.fillOpacity=s):("strokeOpacity"in t&&(t.strokeOpacity=s),"isMultiColor"in t&&"rangeStroke"in t?(t.isMultiColor=o,t.rangeStroke=a):"stroke"in t&&(t.stroke=a));break;case"text-color":"color"in t&&(t.color=i),iY(t)&&(t.text.color=a)}}n([iB],iz.prototype,"type",2);var{deepClone:iX}=a.n1,iZ=class{constructor(){this.mementoOriginatorKey="annotation-defaults",this.colors=new Map(Object.values(t3).map(t=>[t,new Map([["line-color",void 0],["fill-color",void 0],["text-color",void 0]])])),this.fontSizes=new Map([["callout",void 0],["comment",void 0],["text",void 0],["arrow",void 0],["line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineStyles=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextAlignments=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextPositions=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.fibonacciOptions=new Map([["fibonacci-retracement",{bands:void 0,reverse:void 0,showFill:void 0}],["fibonacci-retracement-trend-based",{bands:void 0,reverse:void 0,showFill:void 0}]])}createMemento(){return{colors:iX(this.colors),fontSizes:iX(this.fontSizes),lineStyles:iX(this.lineStyles),lineTextAlignments:iX(this.lineTextAlignments),lineTextPositions:iX(this.lineTextPositions),fibonacciOptions:iX(this.fibonacciOptions)}}guardMemento(t){return!0}restoreMemento(t,e,i){this.colors=iX(i.colors),this.fontSizes=iX(i.fontSizes),this.lineStyles=iX(i.lineStyles),this.lineTextAlignments=iX(i.lineTextAlignments),this.lineTextPositions=iX(i.lineTextPositions),this.fibonacciOptions=iX(i.fibonacciOptions)}setDefaultColor(t,e,i,a,s,o){this.colors.get(t)?.set(e,[i,a,s,o])}setDefaultFontSize(t,e){this.fontSizes.set(t,e)}setDefaultLineStyleType(t,e){let i=this.lineStyles.get(t);i?i.type=e:this.lineStyles.set(t,{type:e})}setDefaultLineStyleWidth(t,e){let i=this.lineStyles.get(t);i?i.strokeWidth=e:this.lineStyles.set(t,{strokeWidth:e})}setDefaultLineTextAlignment(t,e){this.lineTextAlignments.set(t,e)}setDefaultLineTextPosition(t,e){this.lineTextPositions.set(t,e)}setDefaultFibonacciOptions(t,e,i){if("fibonacci-retracement"!=t&&"fibonacci-retracement-trend-based"!=t)return;let a=this.fibonacciOptions.get(t);a[e]=i,this.fibonacciOptions.set(t,a)}applyDefaults(t){for(let[e,i]of this.colors)if(t.type===e)for(let[e,[a,s,o,r]=[]]of i)a&&s&&null!=o&&null!=r&&iU(t,e,a,s,o,r);for(let[e,i]of this.fontSizes)t.type===e&&null!=i&&("fontSize"in t&&(t.fontSize=i),iY(t)&&(t.text.fontSize=i));for(let[e,i]of this.lineStyles)t.type===e&&null!=i&&iK(t,i);for(let[e,i]of this.lineTextPositions)t.type===e&&null!=i&&(t.text.position=i);for(let[e,i]of this.lineTextAlignments)t.type===e&&null!=i&&(t.text.alignment=i);for(let[e,i]of this.fibonacciOptions)t.type===e&&null!=i&&Object.keys(i).forEach(e=>{let a=i[e];null!=a&&t.set({[e]:a})})}},{Color:iQ}=a.n1,iq=t=>{try{let e=iQ.fromString(t),[i,a,s]=e.toHSB();return[i,a,s,e.a]}catch{return}},iJ=class extends a.n1.AnchoredPopover{constructor(t,e){super(t,"color-picker",e),this.hasChanged=!1,this.hideFns.push(()=>{this.hasChanged&&this.onChangeHide?.()})}show(t){this.hasChanged=!1,this.onChangeHide=t.onChangeHide;let{element:e,initialFocus:i}=this.createColorPicker(t),a=this.showWithChildren([e],{initialFocus:i,...t});a.classList.add("ag-charts-color-picker"),a.setAttribute("role","dialog")}createColorPicker(t){let e=t.isMultiColor??!1,[i,a,o,r]=iq(t.color??"#f00")??[0,1,.5,1];r=t.opacity??r;let n=(0,s.n)("div","ag-charts-color-picker__content");n.innerHTML='<div class="ag-charts-color-picker__palette" tabindex="0"></div><div class="ag-charts-color-picker__color-row"><button class="ag-charts-color-picker__multi-color-button" tabindex="0" type="button"></button> <input class="ag-charts-color-picker__hue-input" tabindex="0" type="range" min="0" max="360" value="0"></div><input class="ag-charts-color-picker__alpha-input" tabindex="0" type="range" min="0" max="1" value="1" step="0.01"> <label class="ag-charts-color-picker__color-field"><span class="ag-charts-color-picker__color-label">Color</span> <input class="ag-charts-color-picker__color-input" tabindex="0" value="#000"></label>',n.ariaLabel=this.ctx.localeManager.t("ariaLabelColorPicker");let l=n.querySelector(".ag-charts-color-picker__palette"),h=n.querySelector(".ag-charts-color-picker__hue-input"),d=n.querySelector(".ag-charts-color-picker__multi-color-button"),c=n.querySelector(".ag-charts-color-picker__alpha-input"),p=n.querySelector(".ag-charts-color-picker__color-input"),u=n.querySelector(".ag-charts-color-picker__color-label");d.classList.toggle("ag-charts-color-picker__multi-color-button--hidden",!t.hasMultiColorOption);let g=(s=!0)=>{let l=iQ.fromHSB(i,a,o,r).toHexString();if(n.style.setProperty("--h",`${i}`),n.style.setProperty("--s",`${a}`),n.style.setProperty("--v",`${o}`),n.style.setProperty("--a",`${r}`),n.style.setProperty("--color",l.slice(0,7)),n.style.setProperty("--color-a",l),h.value=`${i}`,c.value=`${r}`,c.classList.toggle("ag-charts-color-picker__alpha-input--opaque",1===r),d.classList.toggle("ag-charts-color-picker__multi-color-button--active",e),u.classList.toggle("ag-charts-color-picker__color-label--multi-color",e),document.activeElement!==p&&(p.value=e?"Multi Colour":l.toUpperCase()),s||null==t.color){let s=iQ.fromHSB(i,a,o,1).toHexString();t.onChange?.(l,s,r,e)}s&&(this.hasChanged=!0)};g(!1);let y=t=>t.preventDefault(),f=t=>t.stopPropagation();return n.addEventListener("mousedown",f),n.addEventListener("touchstart",f),n.addEventListener("touchmove",f),n.addEventListener("keydown",t=>{switch(t.stopPropagation(),t.key){case"Enter":case"Escape":this.hide();break;default:return}t.preventDefault()}),l.addEventListener("pointerdown",t=>{t.preventDefault();let i=t.currentTarget;i.focus();let s=i.getBoundingClientRect(),r=({clientX:t,clientY:i})=>{e=!1,a=Math.min(Math.max((t-s.left)/s.width,0),1),o=1-Math.min(Math.max((i-s.top)/s.height,0),1),g()};r(t),window.addEventListener("pointermove",r),window.addEventListener("pointerup",()=>{window.removeEventListener("pointermove",r)},{once:!0})}),l.addEventListener("touchstart",y,{passive:!1}),l.addEventListener("touchmove",y,{passive:!1}),l.addEventListener("keydown",t=>{if("ArrowLeft"===t.key)a=(0,s.qE)(0,a-.01,1);else if("ArrowRight"===t.key)a=(0,s.qE)(0,a+.01,1);else if("ArrowUp"===t.key)o=(0,s.qE)(0,o+.01,1);else{if("ArrowDown"!==t.key)return;o=(0,s.qE)(0,o-.01,1)}t.preventDefault(),g()}),d.addEventListener("click",()=>{e=!e,g()}),h.addEventListener("input",t=>{e=!1,i=t.currentTarget.valueAsNumber??0,g()}),c.addEventListener("input",t=>{e=!1,r=t.currentTarget.valueAsNumber??0,g()}),p.addEventListener("input",t=>{e=!1;let s=iq(t.currentTarget.value);null!=s&&([i,a,o,r]=s,g())}),p.addEventListener("blur",()=>g()),p.addEventListener("keydown",t=>{"Enter"===t.key&&(t.currentTarget.blur(),g())}),{element:n,initialFocus:l}}};function i0(t){return!(t instanceof a.n1.LogScale)&&!(t instanceof a.n1.BandScale)}var i1=[{label:"toolbarAnnotationsTrendLine",icon:"trend-line-drawing",value:"line"},{label:"toolbarAnnotationsHorizontalLine",icon:"horizontal-line-drawing",value:"horizontal-line"},{label:"toolbarAnnotationsVerticalLine",icon:"vertical-line-drawing",value:"vertical-line"},{label:"toolbarAnnotationsParallelChannel",icon:"parallel-channel-drawing",value:"parallel-channel",visible:i0},{label:"toolbarAnnotationsDisjointChannel",icon:"disjoint-channel-drawing",value:"disjoint-channel",visible:i0}],i2=[{label:"toolbarAnnotationsFibonacciRetracement",icon:"fibonacci-retracement-drawing",value:"fibonacci-retracement"},{label:"toolbarAnnotationsFibonacciRetracementTrendBased",icon:"fibonacci-retracement-trend-based-drawing",value:"fibonacci-retracement-trend-based"}],i4=[{label:"Fibonacci - Extended",value:10},{label:"Fibonacci - 6 Band",value:6},{label:"Fibonacci - 4 Band",value:4}],i5=[{label:"toolbarAnnotationsText",icon:"text-annotation",value:"text"},{label:"toolbarAnnotationsComment",icon:"comment-annotation",value:"comment"},{label:"toolbarAnnotationsCallout",icon:"callout-annotation",value:"callout"},{label:"toolbarAnnotationsNote",icon:"note-annotation",value:"note"}],i3=[{label:"toolbarAnnotationsArrow",icon:"arrow-drawing",value:"arrow"},{label:"toolbarAnnotationsArrowUp",icon:"arrow-up-drawing",value:"arrow-up"},{label:"toolbarAnnotationsArrowDown",icon:"arrow-down-drawing",value:"arrow-down"}],i6=[{label:"toolbarAnnotationsQuickDatePriceRange",icon:"measurer-drawing",value:"quick-date-price-range"},{label:"toolbarAnnotationsDateRange",icon:"date-range-drawing",value:"date-range"},{label:"toolbarAnnotationsPriceRange",icon:"price-range-drawing",value:"price-range"},{label:"toolbarAnnotationsDatePriceRange",icon:"date-price-range-drawing",value:"date-price-range"}],i8=[{strokeWidth:1,label:"1",value:1},{strokeWidth:2,label:"2",value:2},{strokeWidth:3,label:"3",value:3},{strokeWidth:4,label:"4",value:4},{strokeWidth:8,label:"8",value:8}],i9=[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],i7=[{label:"10",value:10},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"22",value:22},{label:"28",value:28},{label:"36",value:36},{label:"46",value:46}],{Color:at,FloatingToolbar:ae,Listeners:ai,Menu:aa,PropertiesArray:as,ToolbarButtonProperties:ao,ToolbarButtonWidget:ar,Property:an}=a.n1,al=class extends ao{constructor(){super(...arguments),this.checkedOverrides=new ao}};n([an],al.prototype,"value",2),n([an],al.prototype,"checkedOverrides",2),n([an],al.prototype,"color",2),n([an],al.prototype,"strokeWidth",2),n([an],al.prototype,"isMultiColor",2);var ah=class extends ar{update(t){super.update(t),"line-stroke-width"===t.value&&this.updateLineStrokeWidth(t),("fill-color"===t.value||"line-color"===t.value||"text-color"===t.value)&&this.updateFillColor(t)}updateFillColor(t){let e=this.getElement();e.classList.add("ag-charts-annotations__color-picker-button"),e.classList.toggle("ag-charts-annotations__color-picker-button--multi-color",t.isMultiColor),e.style.setProperty("--color",t.color??null)}updateLineStrokeWidth(t){let e=this.getElement();e.classList.add("ag-charts-annotations__stroke-width-button"),e.style.setProperty("--stroke-width",`${t.strokeWidth}px`)}},ad=class extends ae{createButtonWidget(){return new ah(this.localeManager)}},ac=class extends a.n1.BaseProperties{constructor(t,e){super(),this.ctx=t,this.getActiveDatum=e,this.enabled=!0,this.buttons=new as(al),this.destroyFns=[],this.events=new ai,this.visibleButtons=[],this.toolbar=new ad(this.ctx,"annotation-options"),this.colorPicker=new iJ(this.ctx),this.textSizeMenu=new aa(this.ctx,"text-size"),this.lineStyleTypeMenu=new aa(this.ctx,"annotations-line-style-type"),this.lineStrokeWidthMenu=new aa(this.ctx,"annotations-line-stroke-width"),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("toolbar-moved",this.onToolbarMoved.bind(this)),t.widgets.seriesWidget.addListener("drag-start",this.onDragStart.bind(this)),t.widgets.seriesWidget.addListener("drag-end",this.onDragEnd.bind(this)),()=>this.colorPicker.destroy())}onDragStart(){this.toolbar.ignorePointerEvents()}onDragEnd(){this.toolbar.capturePointerEvents()}destroy(){for(let t of this.destroyFns)t()}addListener(t,e){return this.events.addListener(t,e)}show(){this.enabled&&this.toolbar.show()}hide(){this.toolbar.hide()}updateButtons(t){if(!this.enabled)return;let e={"line-style-type":iH(t),"line-stroke-width":iH(t),"line-color":i_(t)||iW(t)||iV(t)||e_.is(t)||ic.is(t),"text-color":ij(t)&&!ic.is(t),"fill-color":iW(t)||iV(t)||e_.is(t)||eY.is(t)||ig.is(t),"text-size":i$(t),settings:iY(t),lock:!0,delete:!0};this.visibleButtons=this.buttons.filter(t=>e[t.value]),this.toolbar.clearButtons(),this.toolbar.updateButtons(this.visibleButtons),this.refreshButtons(t)}setAnchorScene(t){this.toolbar.hasBeenDragged()||this.toolbar.setAnchor(t.getAnchor())}hideOverlays(){this.toolbar.clearActiveButton(),this.colorPicker.hide({lastFocus:null}),this.textSizeMenu.hide(),this.lineStyleTypeMenu.hide(),this.lineStrokeWidthMenu.hide(),this.dispatch("hid-overlays")}clearActiveButton(){this.toolbar.clearActiveButton()}updateColors(t){this.updateColorPickerColor("line-color",t.getDefaultColor("line-color"),t.getDefaultOpacity("line-color"),"isMultiColor"in t&&t?.isMultiColor),this.updateColorPickerColor("fill-color",t.getDefaultColor("fill-color"),t.getDefaultOpacity("fill-color"),"isMultiColor"in t&&t?.isMultiColor),this.updateColorPickerColor("text-color",t.getDefaultColor("text-color"),t.getDefaultOpacity("text-color"),"isMultiColor"in t&&t?.isMultiColor)}updateColorPickerColor(t,e,i,a){if(null!=e&&null!=i){let{r:t,g:a,b:s}=at.fromString(e);e=at.fromArray([t,a,s,i]).toHexString()}this.updateButtonByValue(t,{color:e,isMultiColor:a})}updateFontSize(t){this.updateButtonByValue("text-size",{label:null!=t?String(t):void 0})}updateLineStyleType(t){this.updateButtonByValue("line-style-type",{icon:t.icon})}updateStrokeWidth(t){this.updateButtonByValue("line-stroke-width",{label:t.label,strokeWidth:t.value})}dispatch(t,e){this.events.dispatch(t,e)}onButtonPress({event:t,button:e}){let i=this.getActiveDatum();if(i)switch(this.hideOverlays(),e.value){case"line-style-type":{let e=iH(i)?eU(i.lineDash,i.lineStyle):void 0;this.lineStyleTypeMenu.show({items:i9,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStyle"),value:e,sourceEvent:t.sourceEvent,onPress:t=>this.onLineStyleTypeMenuPress(t,i),class:"ag-charts-annotations__line-style-type-menu"});break}case"line-stroke-width":{let e=iH(i)?i.strokeWidth:void 0;this.lineStrokeWidthMenu.show({items:i8,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStrokeWidth"),value:e,sourceEvent:t.sourceEvent,onPress:t=>this.onLineStrokeWidthMenuPress(t,i),class:"ag-charts-annotations__line-stroke-width-menu"});break}case"line-color":case"fill-color":case"text-color":this.toolbar.toggleActiveButtonByIndex(e.index),this.colorPicker.show({color:i?.getDefaultColor(e.value),opacity:i?.getDefaultOpacity(e.value),sourceEvent:t.sourceEvent,hasMultiColorOption:"isMultiColor"in i,isMultiColor:"isMultiColor"in i&&i?.isMultiColor,onChange:null!=i?this.onColorPickerChange.bind(this,e.value,i):void 0,onChangeHide:(t=>{this.dispatch("saved-color",{type:i.type,colorPickerType:e.value,color:i.getDefaultColor(t)})}).bind(this,e.value)});break;case"text-size":{let e=ij(i)?i.fontSize:void 0;this.textSizeMenu.show({items:i7,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsTextSize"),value:e,sourceEvent:t.sourceEvent,onPress:t=>this.onTextSizeMenuPress(t,i),class:"ag-charts-annotations__text-size-menu"});break}case"delete":this.dispatch("pressed-delete");break;case"lock":i.locked=!i.locked,this.refreshButtons(i),this.dispatch("pressed-lock");break;case"settings":this.toolbar.toggleActiveButtonByIndex(e.index),this.dispatch("pressed-settings",t)}}onToolbarMoved(t){let{buttonBounds:e,popoverBounds:i}=t,a={x:i.x,y:i.y+i.height+4},s={y:i.y-4};for(let[t,i]of(this.colorPicker.setAnchor(a,s),e.entries())){let e=this.visibleButtons.at(t);if(!e)continue;let a={x:i.x,y:i.y+i.height-1},s={y:i.y};switch(e.value){case"line-stroke-width":this.lineStrokeWidthMenu.setAnchor(a,s);break;case"line-style-type":this.lineStyleTypeMenu.setAnchor(a,s);break;case"text-size":this.textSizeMenu.setAnchor(a,s)}}}onColorPickerChange(t,e,i,a,s,o){this.dispatch("updated-color",{type:e.type,colorPickerType:t,colorOpacity:i,color:a,opacity:s,isMultiColor:o}),this.updateColorPickerColor(t,i,s,o)}onTextSizeMenuPress(t,e){if(!i$(e))return;let i=t.value;this.dispatch("updated-font-size",{type:e.type,fontSize:i}),this.textSizeMenu.hide(),this.updateFontSize(i)}onLineStyleTypeMenuPress(t,e){if(!iH(e))return;let i=t.value;this.dispatch("updated-line-style",{type:e.type,lineStyleType:i}),this.lineStyleTypeMenu.hide(),this.updateLineStyleType(t)}onLineStrokeWidthMenuPress(t,e){if(!iH(e))return;let i=t.value;this.dispatch("updated-line-width",{type:e.type,strokeWidth:i}),this.lineStrokeWidthMenu.hide(),this.updateStrokeWidth(t)}refreshButtons(t){let e=t.locked??!1;for(let[t,i]of this.visibleButtons.entries())i&&("lock"===i.value?(this.toolbar.toggleSwitchCheckedByIndex(t,e),this.updateButtonByIndex(t,e?i.checkedOverrides.toJson():i.toJson())):this.toolbar.toggleButtonEnabledByIndex(t,!e));i$(t)&&this.updateFontSize(t.fontSize),this.updateColors(t),this.updateLineStyles(t)}updateLineStyles(t){if(!iH(t))return;let e=t.strokeWidth??1,i=eU(t.lineDash,t.lineStyle);this.updateStrokeWidth({strokeWidth:e,value:e,label:String(e)}),this.updateLineStyleType(i9.find(t=>t.value===i)??i9[0])}updateButtonByValue(t,e){let i=this.visibleButtons.findIndex(e=>e.value===t);-1!==i&&this.updateButtonByIndex(i,e)}updateButtonByIndex(t,e){let i=this.visibleButtons.at(t);i&&this.toolbar.updateButtonByIndex(t,{...i.toJson(),...e,value:e.value??i.value})}};n([an],ac.prototype,"enabled",2),n([an],ac.prototype,"buttons",2);var{StateMachine:ap,StateMachineProperty:au,Vec2:ag,Debug:ay}=a.n1,af=class extends ap{constructor(t){let e=({context:e})=>{this.node?.drag(this.datum,this.offset,e,this.snapping),t.update()};super("idle",{idle:{dragStart:{target:"dragging",action:({offset:t,context:e})=>{this.hasMoved=!1,this.dragStart=t,this.offset=t,this.node?.dragStart(this.datum,t,e)}}},dragging:{keyDown:e,keyUp:e,drag:({offset:e,context:i})=>{this.hasMoved=ag.lengthSquared(ag.sub(e,this.dragStart))>0,this.offset=e,this.node?.drag(this.datum,e,i,this.snapping),t.update()},dragEnd:{target:ap.parent,action:()=>{this.node?.stopDragging(),this.hasMoved&&t.recordAction("Move annotation"),t.update()}}}}),this.debug=ay.create(!0,"annotations"),this.hasMoved=!1,this.snapping=!1}};n([au()],af.prototype,"snapping",2),n([au()],af.prototype,"datum",2),n([au()],af.prototype,"node",2);var{Property:am}=a.n1,ax=class extends ig{constructor(){super(...arguments),this.type="arrow-down"}static is(t){return(0,s.Gv)(t)&&"arrow-down"===t.type}};n([am],ax.prototype,"type",2);var ab=class t extends a.n1.Group{constructor(){super(...arguments),this.active=!1,this.locked=!1,this.visible=!1,this.zIndex=1}drag(t){let{handle:e,locked:i}=this;return i?{point:{x:e.x,y:e.y},offset:{x:0,y:0}}:{point:t,offset:{x:t.x-e.x,y:t.y-e.y}}}toggleActive(e){this.active=e,e||(this.handle.strokeWidth=t.INACTIVE_STROKE_WIDTH)}toggleHovered(t){this.glow.visible=!this.locked&&t,this.glow.dirtyPath=!0}toggleDragging(t){this.locked||(this.handle.visible=!t,this.glow.visible=this.glow.visible&&!t,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0)}toggleLocked(t){this.locked=t}getCursor(){}containsPoint(t,e){return this.handle.containsPoint(t,e)}};ab.INACTIVE_STROKE_WIDTH=2;var av=ab,aS=class t extends av{constructor(){super(),this.handle=new a.n1.Marker({shape:"circle"}),this.glow=new a.n1.Marker({shape:"circle"}),this.append([this.handle]),this.handle.size=t.HANDLE_SIZE,this.handle.strokeWidth=av.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2}update(t){this.handle.setProperties({...t,strokeWidth:av.INACTIVE_STROKE_WIDTH})}drag(t){return{point:t,offset:{x:0,y:0}}}};aS.HANDLE_SIZE=7,aS.GLOW_SIZE=9;var ak=class t extends av{constructor(){super(),this.handle=new a.n1.Rect,this.glow=new a.n1.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=t.CORNER_RADIUS,this.handle.width=t.HANDLE_SIZE,this.handle.height=t.HANDLE_SIZE,this.handle.strokeWidth=av.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.cornerRadius=t.CORNER_RADIUS,this.glow.width=t.GLOW_SIZE,this.glow.height=t.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){if(super.toggleLocked(e),e){let e=(t.HANDLE_SIZE-aS.HANDLE_SIZE)/2;this.handle.cornerRadius=1,this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.x+=e,this.handle.y+=e,this.handle.width=aS.HANDLE_SIZE,this.handle.height=aS.HANDLE_SIZE,this.glow.width=aS.GLOW_SIZE,this.glow.height=aS.GLOW_SIZE}else this.handle.cornerRadius=t.CORNER_RADIUS,this.handle.width=t.HANDLE_SIZE,this.handle.height=t.HANDLE_SIZE,this.glow.width=t.GLOW_SIZE,this.glow.height=t.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles)}update(e){if(this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked){delete e.fill,delete e.strokeWidth;let i=(t.HANDLE_SIZE-aS.HANDLE_SIZE)/2;e.x-=i,e.y-=i,this.cachedStyles.x-=i,this.cachedStyles.y-=i}this.handle.setProperties(e),this.glow.setProperties({...e,x:(e.x??this.glow.x)-2,y:(e.y??this.glow.y)-2,strokeWidth:0,fill:e.stroke})}drag(t){return this.locked?{point:t,offset:{x:0,y:0}}:"vertical"===this.gradient?{point:{x:t.x,y:this.handle.y},offset:{x:t.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:t.y},offset:{x:0,y:t.y-this.handle.y}}}getCursor(){if(!this.locked)return"vertical"===this.gradient?"col-resize":"row-resize"}};ak.HANDLE_SIZE=12,ak.GLOW_SIZE=16,ak.CORNER_RADIUS=4;var aD=class t extends av{constructor(){super(),this.handle=new a.n1.Marker({shape:"circle"}),this.glow=new a.n1.Marker({shape:"circle"}),this.append([this.glow,this.handle]),this.handle.size=t.HANDLE_SIZE,this.handle.strokeWidth=av.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.size=t.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){super.toggleLocked(e),e?(this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.size=aS.HANDLE_SIZE,this.glow.size=aS.GLOW_SIZE):(this.handle.size=t.HANDLE_SIZE,this.glow.size=t.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles))}update(t){this.cachedStyles={...t},this.active||delete t.strokeWidth,this.locked&&(delete t.fill,delete t.strokeWidth),this.handle.setProperties(t),this.glow.setProperties({...t,strokeWidth:0,fill:t.stroke})}getCursor(){return"pointer"}};aD.HANDLE_SIZE=11,aD.GLOW_SIZE=17;var{ZIndexMap:aM}=a.n1,aw=class extends a.n1.Group{constructor(){super(...arguments),this.name="AnnotationScene",this.zIndex=aM.CHART_ANNOTATION}static isCheck(t,e){return(0,s.Gv)(t)&&Object.hasOwn(t,"type")&&t.type===e}toggleHovered(t){this.toggleHandles(t)}*nonHandleChildren(){for(let t of this.children())t instanceof av||(yield t)}computeBBoxWithoutHandles(){return a.n1.Transformable.toCanvas(this,a.n1.Group.computeChildrenBBox(this.nonHandleChildren()))}updateNode(t,e,i){return!i&&e?void this.removeChild(e):(i&&null==e&&(e=new t,this.appendChild(e)),e)}},{ContinuousScale:aI,Vec2:aC,toRadians:aA}=a.n1;function aL(t,e,i=!1,a,s=1){return i?eT(aT(t,a?eA(a,e):aC.origin(),s),e):eT(t,e)}function aT(t,e,i){let a=aC.sub(t,e),s=aA(i),o=Math.round(aC.angle(a)/s)*s;return aC.rotate(a,o,e)}function aN(t,e){let i={};for(let[a,o]of(0,s.jO)(t))i[a]=eA(o,e);return i}function aO(t,e,i,a={overflowContinuous:0,translateVectors:void 0,invertYVectors:void 0,snap:void 0}){let{xAxis:s,yAxis:o}=i,r=Object.keys(t),n=[],l=[],h=new Set(a.translateVectors??r),d=new Set(a.invertYVectors??[]),c=new Set([...h,...d]),p=aC.multiply(e,aC.from(1,-1));for(let i of r)c.has(i)&&(t[i]=aC.add(t[i],d.has(i)?p:e),a.snap&&(t[i]=aT(t[i],a.snap.vectors[i],a.snap.angle))),n.push(s.getRangeOverflow(t[i].x)),l.push(o.getRangeOverflow(t[i].y));let u=(t,e)=>Math.abs(t)-Math.abs(e),g=(t,e,i)=>0!==a.overflowContinuous&&aI.is(t)?r.length===c.size?i.toSorted(u).at(-a.overflowContinuous-1)??0:i.filter(t=>0!==t).length<=a.overflowContinuous?0:i.filter((t,i)=>0!==t&&Math.abs(t)<=Math.abs(e)&&c.has(r[i])).toSorted(u).at(-1)??0:i.toSorted(u).at(-1)??0,y=aC.from(g(s.scale,e.x,n),g(o.scale,e.y,l));if(!aC.equal(y,aC.origin()))for(let e of r)c.has(e)&&(t[e]=aC.round(aC.sub(t[e],y),4));let f={};for(let e of r)f[e]=eT(t[e],i);return f}var{Vec2:aP}=a.n1,aE=class extends aw{constructor(){super(...arguments),this.handle=new aD,this.anchor={x:0,y:0,position:"above"}}update(t,e){let i=eA(t,e);this.updateHandle(t,i),this.anchor=this.updateAnchor(t,i,e)}dragStart(t,e,i){this.dragState={offset:e,...aN({handle:t},i)}}drag(t,e,i){let{dragState:a}=this;if(t.locked||!a)return;let{point:s}=aO({point:a.handle},aP.sub(e,a.offset),i);t.x=s.x,t.y=s.y}translate(t,e,i){if(t.locked)return;let{point:a}=aO({point:eA(t,i)},e,i);t.x=a.x,t.y=a.y}toggleHandles(t){this.handle.visible=!!t,this.handle.toggleHovered("handle"===this.activeHandle)}toggleActive(t){this.toggleHandles(t),this.handle.toggleActive(t)}stopDragging(){this.handle.toggleDragging(!1)}copy(t,e,i){let a=eA(t,i),s=eT({x:a.x-30,y:a.y-30},i);return e.x=s.x,e.y=s.y,e}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(t,e){let{handle:i}=this;return this.activeHandle=void 0,!!i.containsPoint(t,e)&&(this.activeHandle="handle",!0)}getNodeAtCoords(t,e){if(this.handle.containsPoint(t,e))return"handle"}updateHandle(t,e,i){let{x:a,y:s}=this.getHandleCoords(t,e,i),o=this.getHandleStyles(t);this.handle.update({...o,x:a,y:s}),this.handle.toggleLocked(t.locked??!1)}updateAnchor(t,e,i){let a=this.getHandleCoords(t,e);return{x:a.x+i.seriesRect.x,y:a.y+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(t,e,i){return{x:e.x,y:e.y}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}},aR=class extends aE{constructor(){super(),this.append([this.handle])}update(t,e){super.update(t,e);let i=eA(t,e);this.updateShape(t,i)}updateShape(t,e){this.updateShapeStyles(t),this.updateShapePath(t,e)}updateShapeStyles(t){let{shape:e}=this;e.fill=t.fill,e.fillOpacity=t.fillOpacity??1}updateShapePath(t,e){let{shape:i}=this;i.x=e.x,i.y=e.y,i.size=t.size}containsPoint(t,e){return super.containsPoint(t,e)||this.shape.containsPoint(t,e)}getNodeAtCoords(t,e){return this.shape.containsPoint(t,e)?"shape":super.getNodeAtCoords(t,e)}},aB=[[.5,0],[1,.5],[.75,.5],[.75,1],[.25,1],[.25,.5],[0,.5]];function az(t){a.n1.drawMarkerUnitPolygon(t,aB)}az.anchor={x:.5,y:0};var aF=class extends aR{constructor(){super(),this.type="arrow-up",this.shape=new a.n1.Marker({shape:az}),this.append([this.shape])}static is(t){return aw.isCheck(t,"arrow-up")}getHandleCoords(t,e){let i=aD.HANDLE_SIZE/2,a=super.getHandleCoords(t,e);return a.y-=i,a}},a_=aB.map(([t,e])=>[t,1-e]);function aW(t){a.n1.drawMarkerUnitPolygon(t,a_)}aW.anchor={x:.5,y:1};var aG=class extends aR{constructor(){super(),this.type="arrow-down",this.shape=new a.n1.Marker({shape:aW}),this.append([this.shape])}static is(t){return aw.isCheck(t,"arrow-down")}updateAnchor(t,e,i){let a=super.updateAnchor(t,e,i);return a.y-=t.size,a}getHandleCoords(t,e){let i=aD.HANDLE_SIZE/2,a=super.getHandleCoords(t,e);return a.y+=i,a}},{StateMachine:aj,StateMachineProperty:aV,Debug:a$}=a.n1,aH=class extends aj{constructor(t){let e=({point:e})=>{let i=this.createDatum();i.set({x:e.x,y:e.y}),t.create(i)};super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},cancel:aj.parent,reset:aj.parent},"waiting-first-render":{render:{target:aj.parent,action:()=>{this.node?.toggleActive(!0),t.showAnnotationOptions(),t.update()}}}}),this.debug=a$.create(!0,"annotations")}};n([aV()],aH.prototype,"node",2);var aY=class extends aH{createDatum(){return new ax}},aK={type:"arrow-down",datum:ax,scene:aG,isDatum:ax.is,translate:(t,e,i,a)=>{ax.is(e)&&aG.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(ax.is(e)&&ax.is(i)&&aG.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{ax.is(e)&&aG.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new aY({...t,create:e("arrow-down")}),dragState:t=>new af(t)},{Property:aU}=a.n1,aX=class extends ig{constructor(){super(...arguments),this.type="arrow-up"}static is(t){return(0,s.Gv)(t)&&"arrow-up"===t.type}};n([aU],aX.prototype,"type",2);var aZ=class extends aH{createDatum(){return new aX}},aQ={type:"arrow-up",datum:aX,scene:aF,isDatum:aX.is,translate:(t,e,i,a)=>{aX.is(e)&&aF.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(aX.is(e)&&aX.is(i)&&aF.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{aX.is(e)&&aF.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new aZ({...t,create:e("arrow-up")}),dragState:t=>new af(t)},{Vec2:aq,Vec4:aJ}=a.n1,a0=class extends aw{constructor(){super(...arguments),this.overflowContinuous=0}extendLine({x1:t,y1:e,x2:i,y2:a},s,o){let r={x1:t,y1:e,x2:i,y2:a};if(!s.extendStart&&!s.extendEnd)return r;let[n,l]=function(t,e){let[i,a]=eK.from(t),s=e.height,o=eK.gradient(a,i,s),r=eK.intercept(a,o,s),n=[{x:i.x,y:s??0},{x:i.x,y:null==s?e.height:s-e.height}];if(o===1/0)return n;let l=[eK.intersectAtY(o,r,0,s),eK.intersectAtY(o,r,e.height,s),eK.intersectAtX(o,r,0,s),eK.intersectAtX(o,r,e.width,s)];return 2!==(l=l.filter(t=>t.x>=e.x&&t.x<=e.width&&t.y>=e.y&&t.y<=e.height).sort((t,e)=>t.x===e.x?0:t.x<e.x?-1:1)).length?n:l}(r,o.yAxis.bounds),h=r.x2<r.x1,d=r.y1>=r.y2,c=r.x2===r.x1;return s.extendEnd&&(c?r.y2=d?l.y:n.y:(r.x2=h?n.x:l.x,r.y2=h?n.y:l.y)),s.extendStart&&(c?r.y1=d?n.y:l.y:(r.x1=h?l.x:n.x,r.y1=h?l.y:n.y)),r}dragStart(t,e,i){this.dragState={offset:e,...aN({start:t.start,end:t.end},i)}}drag(t,e,i,a){t.locked||(this.activeHandle?this.dragHandle(t,e,i,a):this.dragAll(t,e,i))}dragAll(t,e,i){let{dragState:a}=this;a&&this.translatePoints(t,a.start,a.end,aq.sub(e,a.offset),i)}translate(t,e,i){t.locked||this.translatePoints(t,eA(t.start,i),eA(t.end,i),e,i)}copy(t,e,i){let a=eC(t,i);if(!a)return;let s=this.computeBBoxWithoutHandles(),o={x:-s.width/2,y:-s.height/2};return this.translatePoints(e,aJ.start(a),aJ.end(a),o,i),e}translatePoints(t,e,i,a,s){let o=aO(this.getTranslatePointsVectors(e,i),a,s,{overflowContinuous:this.overflowContinuous});t.start.x=o.start.x,t.end.x=o.end.x,t.start.y=o.start.y,t.end.y=o.end.y}getTranslatePointsVectors(t,e){return{start:t,end:e}}},{Vec2:a1,Vec4:a2}=a.n1,a4=class extends a0{constructor(){super(...arguments),this.start=new aD,this.end=new aD,this.anchor={x:0,y:0,position:"above"}}update(t,e){let i=eC(t,e);null!=i&&(this.updateHandles(t,i),this.updateAnchor(t,i,e))}toggleHandles(t){if("boolean"==typeof t)this.start.visible=t,this.end.visible=t;else for(let[e,i]of(0,s.jO)(t))this[e].visible=i;this.start.toggleHovered("start"===this.activeHandle),this.end.toggleHovered("end"===this.activeHandle)}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t)}dragHandle(t,e,i,a){let{activeHandle:s,dragState:o}=this;if(!s||!o)return;this[s].toggleDragging(!0);let r="start"===s?"end":"start",n=a?{vectors:{[s]:eA(t[r],i)},angle:t.snapToAngle}:void 0,{[s]:l}=aO({[s]:o[s]},a1.sub(e,o.offset),i,{overflowContinuous:0,snap:n});t[s].x=l.x,t[s].y=l.y}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(t,e){let{start:i,end:a}=this;return(this.activeHandle=void 0,i.containsPoint(t,e))?(this.activeHandle="start",!0):!!a.containsPoint(t,e)&&(this.activeHandle="end",!0)}getNodeAtCoords(t,e){if(this.start.containsPoint(t,e)||this.end.containsPoint(t,e))return"handle"}updateHandles(t,e,i){this.start.update({...this.getHandleStyles(t,"start"),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t,"end"),...this.getHandleCoords(t,e,"end",i)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1)}updateAnchor(t,e,i,a){this.anchor={x:e.x1+i.seriesRect.x,y:e.y1+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(t,e,i,a){return"start"===i?a2.start(e):a2.end(e)}getHandleStyles(t,e){return{fill:t.handle.fill,stroke:t.handle.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}},{Vec4:a5}=a.n1,a3=class extends a4{constructor(){super(...arguments),this.label=new a.n1.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(t){this.textInputBBox=t,this.markDirty("TextualStartEndScene")}update(t,e){let i=eC(t,e);if(null==i)return;let a=this.getTextBBox(t,i);this.updateLabel(t,a,i),this.updateHandles(t,i,a),this.updateShape(t,a,i),this.updateAnchor(t,i,e,a)}containsPoint(t,e){return super.containsPoint(t,e)||this.label.containsPoint(t,e)}getNodeAtCoords(t,e){return this.label.containsPoint(t,e)?"text":super.getNodeAtCoords(t,e)}getTextBBox(t,e){let{text:i}=t.getText();return io(t,i,a5.end(e),this.textInputBBox)}updateLabel(t,e,i){let{text:a,isPlaceholder:s}=t.getText();ir(this.label,a,s,t,this.getLabelCoords(t,e,i))}updateShape(t,e,i){}getLabelCoords(t,e,i){return a5.end(i)}getHandleStyles(t,e){return{...super.getHandleStyles(t,e),stroke:t.handle.stroke??t.color}}},{drawCorner:a6,Path:a8}=a.n1,a9=class extends a3{constructor(){super(),this.type="callout",this.shape=new a8,this.append([this.shape,this.label,this.start,this.end])}static is(t){return aw.isCheck(t,"callout")}drag(t,e,i,a){t.locked||("end"===this.activeHandle?this.dragHandle(t,e,i,a):this.dragAll(t,e,i))}getLabelCoords(t,e,i){let a=t.getPadding(),{bodyBounds:s={x:0,y:0,width:0,height:0}}=this.getDimensions(t,e,i)??{};return{x:s.x+a.left,y:s.y-a.bottom}}getHandleStyles(t,e){return"start"===e?{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}:{fill:void 0,strokeWidth:0}}updateAnchor(t,e,i,a){let{bodyBounds:s}=this.getDimensions(t,a,e)??{},o=s??a;this.anchor={x:o.x+i.seriesRect.x,y:o.y+i.seriesRect.y-o.height,position:this.anchor.position}}updateShape(t,e,i){let{shape:a}=this;a.fill=t.fill,a.fillOpacity=t.fillOpacity??1,a.stroke=t.stroke,a.strokeWidth=t.strokeWidth??1,a.strokeOpacity=t.strokeOpacity??1;let{tailPoint:s,bodyBounds:o}=this.getDimensions(t,e,i)??{};s&&o&&this.updatePath(s,o)}updatePath(t,e){let{x:i,y:a}=t,{x:s,y:o,width:r,height:n}=e,l=o-n,h=s+r,d=this.calculateCalloutPlacement({x:i,y:a},e),c=[{coordinates:{x0:s,x1:s+8,y0:l+8,y1:l,cx:"topLeft"===d?i:s+8,cy:"topLeft"===d?a:l+8},type:"topLeft"===d?"calloutCorner":"corner"},{coordinates:{x0:s+8,x1:h-8,y0:l,y1:l,cx:i,cy:a},type:"top"===d?"calloutSide":"side"},{coordinates:{x0:h-8,x1:h,y0:l,y1:l+8,cx:"topRight"===d?i:h-8,cy:"topRight"===d?a:l+8},type:"topRight"===d?"calloutCorner":"corner"},{coordinates:{x0:h,x1:h,y0:l+8,y1:o-8,cx:i,cy:a},type:"right"===d?"calloutSide":"side"},{coordinates:{x0:h,x1:h-8,y0:o-8,y1:o,cx:"bottomRight"===d?i:h-8,cy:"bottomRight"===d?a:o-8},type:"bottomRight"===d?"calloutCorner":"corner"},{coordinates:{x0:h-8,x1:s+8,y0:o,y1:o,cx:i,cy:a},type:"bottom"===d?"calloutSide":"side"},{coordinates:{x0:s+8,x1:s,y0:o,y1:o-8,cx:"bottomLeft"===d?i:s+8,cy:"bottomLeft"===d?a:o-8},type:"bottomLeft"===d?"calloutCorner":"corner"},{coordinates:{x0:s,x1:s,y0:o-8,y1:l+8,cx:i,cy:a},type:"left"===d?"calloutSide":"side"}],{path:p}=this.shape;p.clear(),p.moveTo(s,l+8),c.forEach(({coordinates:t,type:e})=>{this.drawPath(p,t,8,e)}),p.closePath()}drawPath(t,{x0:e,y0:i,x1:a,y1:s,cx:o,cy:r},n,l){switch(l){case"calloutCorner":t.lineTo(o,r),t.lineTo(a,s);break;case"corner":a6(t,{x0:e,x1:a,y0:i,y1:s,cx:o,cy:r},n,!1);break;case"calloutSide":if(e!==a){let n=e>a?-1:1,l=Math.min(e,a)+Math.abs(a-e)/2;t.lineTo(l-6*n,i),t.lineTo(o,r),t.lineTo(l+6*n,i),t.lineTo(a,s)}else{let n=i>s?-1:1,l=Math.min(i,s)+Math.abs(i-s)/2;t.lineTo(e,l-6*n),t.lineTo(o,r),t.lineTo(e,l+6*n),t.lineTo(a,s)}break;default:t.lineTo(a,s)}}calculateCalloutPlacement(t,e){let i,a,s=e.x+e.width,o=e.y-e.height;return(t.x>s?i="right":t.x<e.x&&(i="left"),t.y>e.y?a="bottom":t.y<o&&(a="top"),i&&a)?`${a}${i[0].toUpperCase()}${i.substring(1)}`:a??i}getDimensions(t,e,i){let{fontSize:a}=t,s=t.getPadding(),o=s.left+s.right,r=s.top+s.bottom,n=e.width+o,l=Math.max(e.height+r,a+r);return{tailPoint:{x:i.x1,y:i.y1},bodyBounds:{x:e.x,y:e.y,width:n,height:l}}}containsPoint(t,e){let{start:i,end:a,shape:s}=this;if(this.activeHandle=void 0,i.containsPoint(t,e))return this.activeHandle="start",!0;let o=a.containsPoint(t,e)||s.containsPoint(t,e);return o&&(this.activeHandle="end"),o}};function a7({key:t}){return"Escape"===t}function st({key:t,shiftKey:e}){return!e&&"Enter"===t}var{StateMachine:se,StateMachineProperty:si,Debug:sa}=a.n1,ss=class extends se{constructor(t){let e=({point:e})=>{let i=this.createDatum();i.set({start:e,end:e,visible:!0}),t.create(i)},i=({point:e})=>{let{datum:i,node:a}=this;i?.set({end:e}),a?.toggleActive(!0),a?.toggleHandles({end:!1}),t.update()},a=()=>{t.showAnnotationOptions(),this.node?.toggleHandles({end:!0})},s=()=>{t.delete()},o=({textInputValue:e,bbox:i})=>{let{datum:a}=this;if(null!=i&&null!=e&&e.length>0){if(!ij(a))return;let s=is(a,e,i.width);a?.set({text:s}),t.update(),t.recordAction(`Create ${a?.type} annotation`)}else t.delete()};super("start",{start:{click:{target:"waiting-first-render",action:e},dragStart:{target:"waiting-first-render",action:e},cancel:se.parent,reset:se.parent},"waiting-first-render":{render:{target:"end",action:()=>{let{node:t}=this;t?.toggleActive(!0),t?.toggleHandles({start:!0})}}},end:{hover:i,drag:i,click:{target:"edit",action:a},dragEnd:{target:"edit",action:a},reset:{target:se.parent,action:s},cancel:{target:se.parent,action:s}},edit:{onEnter:()=>{t.showTextInput(),this.datum&&(this.datum.visible=!1)},updateTextInputBBox:e=>{this.node?.setTextInputBBox(e),t.update()},color:({colorPickerType:e,colorOpacity:i,color:a,opacity:s,isMultiColor:o})=>{let{datum:r}=this;r&&("text-color"===e&&t.updateTextInputColor(a),iU(r,e,i,a,s,o),t.update())},fontSize:e=>{let{datum:i,node:a}=this;i&&a&&ij(i)&&(i.fontSize=e,t.updateTextInputFontSize(e),t.update())},textInput:[{guard:a7,target:se.parent,action:s},{guard:st,target:se.parent,action:o}],click:{target:se.parent,action:o},dragStart:{target:se.parent,action:o},resize:{target:se.parent,action:o},onExit:()=>{t.hideTextInput(),this.datum&&(this.datum.visible=!0),t.deselect()},cancel:{target:se.parent,action:s}}}),this.debug=sa.create(!0,"annotations")}};n([si()],ss.prototype,"datum",2),n([si()],ss.prototype,"node",2);var so=class extends ss{createDatum(){return new e_}},sr={type:"callout",datum:e_,scene:a9,isDatum:e_.is,translate:(t,e,i,a)=>{if(e_.is(e)&&a9.is(t))return t.translate(e,i,a)},copy:(t,e,i,a)=>{if(e_.is(e)&&e_.is(i)&&a9.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{e_.is(e)&&a9.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new so({...t,create:e("callout")}),dragState:t=>new af(t)},sn=class extends aE{constructor(){super(...arguments),this.label=new a.n1.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(t){this.textInputBBox=t,this.markDirty("TextualPointScene")}update(t,e){let i=eA(t,e),a=this.getTextBBox(t,i,e);this.updateLabel(t,a),this.updateHandle(t,i,a),this.updateShape(t,a),this.anchor=this.updateAnchor(t,a,e)}copy(t,e,i){let a=eA(t,i),s=this.getTextBBox(t,a,i),o=t.getPadding(),r=o.left+o.right,n=o.top+o.bottom,l=(s.width+r)/2,h=s.height+n,d=eT({x:a.x-l,y:a.y-h},i);return e.x=d.x,e.y=d.y,e}containsPoint(t,e){let{label:i}=this;return super.containsPoint(t,e)||i.visible&&i.containsPoint(t,e)}getNodeAtCoords(t,e){return this.label.visible&&this.label.containsPoint(t,e)?"text":super.getNodeAtCoords(t,e)}getTextBBox(t,e,i){let{text:a}=t.getText();return io(t,a,{x:e.x,y:e.y},this.textInputBBox)}updateLabel(t,e){let{text:i,isPlaceholder:a}=t.getText();ir(this.label,i,a,t,this.getLabelCoords(t,e),this.getTextBaseline(t))}updateShape(t,e){}updateAnchor(t,e,i){return{x:e.x+i.seriesRect.x,y:e.y+i.seriesRect.y-e.height,position:this.anchor.position}}getLabelCoords(t,e){return e}getTextBaseline(t){return"center"==t.position?"middle":t.position}getHandleCoords(t,e,i){return i}getHandleStyles(t){let e=super.getHandleStyles(t);return e.stroke=t.handle.stroke??t.color,e}},{drawCorner:sl}=a.n1,sh=class extends sn{constructor(){super(),this.type="comment",this.shape=new a.n1.Path,this.append([this.shape,this.label,this.handle])}static is(t){return aw.isCheck(t,"comment")}updateShape(t,e){let{shape:i}=this;i.fill=t.fill,i.fillOpacity=t.fillOpacity??1,i.stroke=t.stroke??"transparent",i.strokeWidth=t.strokeWidth??1,i.strokeOpacity=t.strokeOpacity??1,this.updatePath(t,e)}getLabelCoords(t,e){let i=t.getPadding();return{x:e.x+i.left,y:e.y-i.bottom}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke??t.fill,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}updateAnchor(t,e,i){let a=super.updateAnchor(t,e,i),s=t.getPadding();return a.y-=s.bottom+s.top,a}updatePath(t,e){let i=t.getPadding(),{x:a,y:s}=e,{width:o,height:r}=e,{fontSize:n}=t,l=i.left+i.right,h=i.top+i.bottom;o+=l;let d=s-(r=Math.max(r+h,n+h)),c=a+o,p=(1.38*n+h)/2,{path:u}=this.shape;u.clear(),u.moveTo(a,s),u.lineTo(a,d+p),sl(u,{x0:a,x1:a+p,y0:d+p,y1:d,cx:a+p,cy:d+p},p,!1),u.lineTo(c-p,d),sl(u,{x0:c-p,x1:c,y0:d,y1:d+p,cx:c-p,cy:d+p},p,!1),u.lineTo(c,s-p),sl(u,{x0:c,x1:c-p,y0:s-p,y1:s,cx:c-p,cy:s-p},p,!1),u.closePath()}containsPoint(t,e){return super.containsPoint(t,e)||this.shape.containsPoint(t,e)}},{StateMachine:sd,StateMachineProperty:sc,Debug:sp}=a.n1,su=class extends sd{constructor(t){let e=({point:e})=>{let i=this.createDatum();i.set({x:e.x,y:e.y}),t.create(i)},i=()=>{t.delete()},a=({textInputValue:e,bbox:i})=>{if(null!=i&&null!=e&&e.length>0){let{datum:a}=this;if(!ij(a))return;let s=is(a,e,i.width);a?.set({text:s}),t.update(),t.recordAction(`Create ${a?.type} annotation`)}else t.delete()};super("start",{start:{click:{target:"waiting-first-render",action:e},dragStart:{target:"waiting-first-render",action:e},cancel:sd.parent,reset:sd.parent},"waiting-first-render":{render:{target:"edit",action:()=>{this.node?.toggleActive(!0),t.showAnnotationOptions(),t.update()}}},edit:{onEnter:()=>{t.showTextInput(),this.datum&&(this.datum.visible=!1)},updateTextInputBBox:e=>{this.node?.setTextInputBBox(e),t.update()},color:({colorPickerType:e,colorOpacity:i,color:a,opacity:s,isMultiColor:o})=>{this.datum&&("text-color"===e&&t.updateTextInputColor(a),iU(this.datum,e,i,a,s,o),t.update())},fontSize:e=>{let{datum:i,node:a}=this;i&&a&&ij(i)&&(i.fontSize=e,t.updateTextInputFontSize(e),t.update())},textInput:[{guard:a7,target:sd.parent,action:i},{guard:st,target:sd.parent,action:a}],click:{target:sd.parent,action:a},dragStart:{target:sd.parent,action:a},resize:{target:sd.parent,action:a},onExit:()=>{t.hideTextInput(),this.datum&&(this.datum.visible=!0),t.deselect()},cancel:{target:sd.parent,action:i}}}),this.debug=sp.create(!0,"annotations")}};n([sc()],su.prototype,"datum",2),n([sc()],su.prototype,"node",2);var sg=class extends su{createDatum(){return new eY}},sy={type:"comment",datum:eY,scene:sh,isDatum:eY.is,translate:(t,e,i,a)=>{eY.is(e)&&sh.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(eY.is(e)&&eY.is(i)&&sh.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{eY.is(e)&&sh.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new sg({...t,create:e("comment")}),dragState:t=>new af(t)},{calculateLabelTranslation:sf,ChartAxisDirection:sm}=a.n1,sx=class extends a.n1.Group{constructor(){super({name:"AnnotationAxisLabelGroup"}),this.label=new a.n1.Text({zIndex:1}),this.rect=new a.n1.Rect;let{label:t}=this;t.fontSize=12,t.fontFamily="Verdana, sans-serif",t.fill="black",t.textBaseline="middle",t.textAlign="center",this.append([this.rect,this.label])}update(t){this.updateLabel(t),this.updateRect(t),this.updatePosition(t)}updateLabel({value:t,styles:e,context:i}){let{fontWeight:a,fontSize:s,fontStyle:o,fontFamily:r,textAlign:n,color:l="white",formatter:h}=e,d=h?h({value:t}):i.scaleValueFormatter()(t);this.label.setProperties({fontWeight:a,fontSize:s,fontStyle:o,fontFamily:r,textAlign:n,fill:l,text:d})}updateRect({styles:t}){let{rect:e}=this,{cornerRadius:i,fill:a,fillOpacity:s,stroke:o,strokeOpacity:r}=t;e.setProperties({cornerRadius:i,fill:a,fillOpacity:s,stroke:o,strokeOpacity:r})}updatePosition({x:t,y:e,context:i,styles:{padding:a}}){let{label:s,rect:o}=this,r=s.getBBox()?.clone(),n=a??8,l=a??5;r.grow(n,"horizontal"),r.grow(l,"vertical");let h=i.direction===sm.X?Math.round(l/2):n,{xTranslation:d,yTranslation:c}=sf({yDirection:!0,padding:i.labelPadding-h,position:i.position??"left",bbox:r}),p=t+d,u=e+c;s.x=p,s.y=u,o.y=u-Math.round(r.height/2),o.x=p-Math.round(r.width/2),o.height=r.height,o.width=r.width}};sx.className="AxisLabel";var{Vec2:sb}=a.n1,sv=class extends a.n1.Line{constructor(){super(...arguments),this.growCollisionBox=9,this.clipMask=new Map}setProperties(t,e){return super.setProperties(t,e),this.updateCollisionBBox(),this}updateCollisionBBox(){let{growCollisionBox:t,strokeWidth:e,x1:i,y1:s,x2:o,y2:r}=this,n=e+t;n%2==0&&(n+=1);let l=sb.from(i,s-Math.floor(n/2)),h=sb.from(o,r),d=sb.distance(l,h);this.collisionBBox=new a.n1.BBox(l.x,l.y,d,n)}isPointInPath(t,e){let{collisionBBox:i,x1:a,y1:s,x2:o,y2:r}=this;if(!i)return!1;let n=sb.from(a,s),l=sb.from(o,r),h=sb.sub(sb.from(t,e),n),d=sb.sub(l,n),c=sb.rotate(h,sb.angle(h,d),n);return i.containsPoint(c.x,c.y)??!1}render(t){this.applyClipMask(t.ctx),super.render(t),this.closeClipMask(t.ctx)}setClipMask(t,e){let i=this.clipMask.get(t);null!=a.n1.jsonDiff(i,e)&&this.markDirty("CollidableLine"),e?this.clipMask.set(t,e):this.clipMask.delete(t)}applyClipMask(t){let{clipMask:e}=this;0!==e.size&&this.clipMask.forEach(e=>{let{x:i,y:a,radius:s}=e;t.save(),t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.ellipse(i,a,s,s,0,2*Math.PI,0,!0),t.clip()})}closeClipMask(t){0!==this.clipMask.size&&t.restore()}},sS=class extends a.n1.TransformableText{constructor(){super(...arguments),this.growCollisionBox={top:4,right:4,bottom:4,left:4}}isPointInPath(t,e){let i=this.fromParentPoint(t,e),a=this.computeBBoxWithoutTransforms();return!!a&&a.grow(this.growCollisionBox).containsPoint(i.x,i.y)}},{Vec2:sk}=a.n1;function sD(t,e,i,a,s,o,r){if(!o||!s||!a)return void e.setClipMask(t);let{alignment:n,position:l}=a,h=sw(i,a.fontSize,r),{point:d,textBaseline:c}=sI(h,l,n);sC(s,o,a,d,h.angle,c);let{x:p,y:u,width:g,height:y}=s.getBBox(),f=sk.length(sk.from(g,y)),m={x:p+g/2,y:u+y/2,radius:f/2+sk.length(h.offset)};return"center"===l?e.setClipMask(t,m):e.setClipMask(t),{clipMask:m,numbers:h}}function sM(t,e,i,a,s,o,r){if(!r||!o)return;let{alignment:n,position:l}=a,[h,d]=e.y1<=i.y1?[e,i]:[i,e],c=h;"bottom"===l?c=d:"inside"===l&&(c={x1:(h.x1+d.x1)/2,y1:(h.y1+d.y1)/2,x2:(h.x2+d.x2)/2,y2:(h.y2+d.y2)/2});let p=sw(c,a.fontSize,s),{point:u,textBaseline:g}=sI(p,"inside"===l?"center":l,n,t);sC(o,r,a,u,p.angle,g)}function sw(t,e,i){let[a,s]=sk.from(t);a.x>s.x&&([a,s]=[s,a]);let o=sk.normalized(sk.sub(s,a)),r=sk.angle(o),n=sk.multiply(o,aD.HANDLE_SIZE/2+(e??14)/2),l=sk.multiply(o,(i??2)/2+(e??14)/3);return{left:a,right:s,normal:o,angle:r,inset:n,offset:l}}function sI({left:t,right:e,normal:i,angle:a,inset:s,offset:o},r,n,l){let h;h="right"===n?sk.sub(e,s):"center"===n?sk.add(t,sk.multiply(i,sk.distance(t,e)/2)):sk.add(t,s);let d="bottom";return"bottom"===r?(h=sk.rotate(o,a+Math.PI/2,h),d="top"):"center"!==r||l?h=sk.rotate(o,a-Math.PI/2,h):d="middle",{point:h,textBaseline:d}}function sC(t,e,i,a,s,o){t.setProperties({text:e,x:a.x,y:a.y,rotation:s,rotationCenterX:a.x,rotationCenterY:a.y,fill:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textAlign:i.alignment,textBaseline:o})}var{ChartAxisDirection:sA,Vec2:sL,Vec4:sT}=a.n1,sN=class extends aw{constructor(){super(),this.type="cross-line",this.line=new sv,this.middle=new ak,this.isHorizontal=!1,this.append([this.line,this.middle])}static is(t){return aw.isCheck(t,"cross-line")}update(t,e){let{seriesRect:i}=e;this.seriesRect=i,this.isHorizontal=ix.is(t);let a=this.isHorizontal?e.yAxis:e.xAxis,s=this.convertCrossLine(t,a);if(null==s){this.visible=!1;return}this.visible=t.visible??!0,this.visible&&(this.updateLine(t,s),this.updateHandle(t,s),this.updateText(t,s),this.updateAxisLabel(t,a,s))}updateLine(t,e){let{line:i}=this,{lineDashOffset:a,stroke:s,strokeWidth:o,strokeOpacity:r}=t,{x1:n,y1:l,x2:h,y2:d}=e;i.setProperties({x1:n,y1:l,x2:h,y2:d,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:a,stroke:s,strokeWidth:o,strokeOpacity:r,fillOpacity:0})}updateHandle(t,e){let{middle:i}=this,{locked:a,stroke:s,strokeWidth:o,strokeOpacity:r}=t,n={fill:t.handle.fill,stroke:t.handle.stroke??s,strokeOpacity:t.handle.strokeOpacity??r,strokeWidth:t.handle.strokeWidth??o},l=sL.sub(sT.center(e),sL.from(i.handle.width/2,i.handle.height/2));i.gradient=this.isHorizontal?"horizontal":"vertical",i.update({...n,...l}),i.toggleLocked(a??!1)}updateText(t,e){this.text=this.updateNode(sS,this.text,!!t.text.label),sD(this.line.id,this.line,e,t.text,this.text,t.text.label,t.strokeWidth)}createAxisLabel(t){let e=new sx;return t.attachLabel(e),e}updateAxisLabel(t,e,i){this.axisLabel||(this.axisLabel=this.createAxisLabel(e));let{axisLabel:a,seriesRect:s}=this,{direction:o,position:r}=e;if(t.axisLabel.enabled){a.visible=this.visible;let n="left"===r||"top"===r?sT.start(i):sT.end(i),l=o===sA.X?n.x:n.y;if(!e.inRange(l)){a.visible=!1;return}let h=ew(t.value);a.update({...sL.add(n,sL.required(s)),value:h,styles:t.axisLabel,context:e})}else a.visible=!1}setAxisLabelOpacity(t){this.axisLabel&&(this.axisLabel.opacity=t)}setAxisLabelVisible(t){this.axisLabel&&(this.axisLabel.visible=t)}toggleHandles(t){this.middle.visible=t,this.middle.toggleHovered("middle"===this.activeHandle)}destroy(){super.destroy(),this.axisLabel?.destroy()}toggleActive(t){this.toggleHandles(t),this.middle.toggleActive(t)}dragStart(t,e,i){let a=ix.is(t)?{x:e.x,y:eL(t.value,i.yAxis)}:{x:eL(t.value,i.xAxis),y:e.y};this.dragState={offset:e,middle:a}}drag(t,e,i){let{activeHandle:a,dragState:s}=this;!t.locked&&s&&(a&&this[a].toggleDragging(!0),this.translatePoint(t,s.middle,sL.sub(e,s.offset),i))}translate(t,e,i){if(t.locked)return;let a=ix.is(t)?sL.from(0,eL(t.value,i.yAxis)):sL.from(eL(t.value,i.xAxis),0);this.translatePoint(t,a,e,i)}translatePoint(t,e,i,a){let s=ix.is(t);s?i.x=0:i.y=0;let{point:o}=aO({point:e},i,a);t.value=s?o.y:o.x}stopDragging(){this.middle.toggleDragging(!1)}copy(t,e,i){let a=ix.is(t),s=this.isHorizontal?i.yAxis:i.xAxis,o=this.convertCrossLine(t,s);if(!o)return;let r=eT({x:o.x1+(a?0:-30),y:o.y1+(a?-30:0)},i);return e.set({value:a?r.y:r.x}),e}getCursor(){return null==this.activeHandle?"pointer":this[this.activeHandle].getCursor()}containsPoint(t,e){let{middle:i,line:a,text:s}=this;return(this.activeHandle=void 0,i.containsPoint(t,e))?(this.activeHandle="middle",!0):a.isPointInPath(t,e)||!!s?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.line.isPointInPath(t,e)?"line":this.middle.containsPoint(t,e)?"handle":void 0}getAnchor(){let t=this.computeBBoxWithoutHandles();return this.isHorizontal?{x:t.x+t.width/2,y:t.y}:{x:t.x+t.width,y:t.y+t.height/2,position:"right"}}convertCrossLine(t,e){let i,a;if(null==t.value)return;let s=0,o=0,{bounds:r}=e,n=eL(t.value,e);return ix.is(t)?(i=r.width,o=n,a=n):(s=n,i=n,a=r.height),{x1:s,y1:o,x2:i,y2:a}}},{StateMachine:sO,StateMachineProperty:sP,Debug:sE}=a.n1,sR=class extends sO{constructor(t,e){let i=({point:i})=>{let a="horizontal"===t,s=a?new ix:new ib;s.set({value:a?i.y:i.x}),e.create(s),e.recordAction(`Create ${a?"horizontal-line":"vertical-line"} annotation`)};super("start",{start:{click:{target:"waiting-first-render",action:i},drag:{target:"waiting-first-render",action:i},reset:sO.parent,cancel:sO.parent},"waiting-first-render":{render:{target:sO.parent,action:()=>{this.node?.toggleActive(!0),e.showAnnotationOptions(),e.update()}}}}),this.debug=sE.create(!0,"annotations")}};n([sP()],sR.prototype,"node",2);var sB={type:"horizontal-line",datum:ix,scene:sN,isDatum:ix.is,translate:(t,e,i,a)=>{ix.is(e)&&sN.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(ix.is(e)&&ix.is(i)&&sN.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{ix.is(e)&&sN.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new sR("horizontal",{...t,create:e("horizontal-line")}),dragState:t=>new af(t)},sz={type:"vertical-line",datum:ib,scene:sN,isDatum:ib.is,translate:(t,e,i,a)=>{ib.is(e)&&sN.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(ib.is(e)&&ib.is(i)&&sN.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{ib.is(e)&&sN.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new sR("vertical",{...t,create:e("vertical-line")}),dragState:t=>new af(t)},{Vec4:sF}=a.n1,s_=class{static updateBackground(t,e,i,a){let{background:s}=this,{seriesRect:o}=a;s.path.clear(!0);let r=sF.from(0,0,o.width,o.height),n=this.getBackgroundPoints(t,e,i,r);for(let t=0;t<n.length;t++){let e=n[t];0===t?s.path.moveTo(e.x,e.y):s.path.lineTo(e.x,e.y)}s.path.closePath(),s.checkPathDirty();let l=this.getBackgroundStyles?.(t)??t.background;s.setProperties({fill:l.fill,fillOpacity:l.fillOpacity})}},sW=class extends a0{constructor(){super(...arguments),this.handles={},this.overflowContinuous=2,this.topLine=new sv,this.bottomLine=new sv,this.background=new a.n1.Path({zIndex:-1}),this.anchor={x:0,y:0},this.updateBackground=s_.updateBackground.bind(this)}update(t,e){let{locked:i,visible:a}=t,s=eC(t,e),o=eC(t.bottom,e);if(null==s||null==o){this.visible=!1;return}this.visible=a??!0;let r=this.extendLine(s,t,e),n=this.extendLine(o,t,e);for(let a of(this.updateLines(t,r,n,e,s,o),this.updateHandles(t,s,o),this.updateText(t,s,o),this.updateBackground(t,r,n,e),this.updateAnchor(s,o),Object.values(this.handles)))a.toggleLocked(i??!1)}toggleHandles(t){let{handles:e}=this;if("boolean"==typeof t){for(let[i,a]of Object.entries(e))a.visible=t,a.toggleHovered(this.activeHandle===i);return}for(let[i,a]of Object.entries(t)){let t=e[i];t.visible=a??!0,t.toggleHovered(this.activeHandle===i)}}toggleActive(t){for(let e of(this.toggleHandles(t),Object.values(this.handles)))e.toggleActive(t)}stopDragging(){let{activeHandle:t,handles:e}=this;null!=t&&e[t].toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return null==this.activeHandle?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(t,e){let{handles:i,topLine:a,bottomLine:s,text:o}=this;for(let[a,s]of(this.activeHandle=void 0,Object.entries(i)))if(s.containsPoint(t,e))return this.activeHandle=a,!0;return a.containsPoint(t,e)||s.containsPoint(t,e)||!!o?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.topLine.containsPoint(t,e)||this.bottomLine.containsPoint(t,e))return"line";for(let[i,a]of Object.entries(this.handles))if(a.containsPoint(t,e))return"handle"}updateAnchor(t,e){let{x:i,y:s}=a.n1.Transformable.toCanvasPoint(this.topLine,(t.x1+t.x2)/2,Math.min(t.y1,t.y2,e.y1,e.y2));this.anchor.x=i,this.anchor.y=s}},{Vec2:sG,Vec4:sj}=a.n1,sV=class extends sW{constructor(){super(),this.type="disjoint-channel",this.handles={topLeft:new aD,topRight:new aD,bottomLeft:new aD,bottomRight:new ak},this.append([this.background,this.topLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return aw.isCheck(t,"disjoint-channel")}dragHandle(t,e,i,a){let{activeHandle:s,handles:o}=this;if(null==s)return;let{offset:r}=o[s].drag(e);o[s].toggleDragging(!0),"bottomRight"===s&&(r.x=0);let n=[],l=[],h=a;switch(s){case"topLeft":n=["topLeft"],l=["bottomLeft"];break;case"bottomLeft":n=["bottomLeft"],l=["topLeft"];break;case"topRight":n=["topRight"],l=["bottomRight"];break;case"bottomRight":n=["bottomLeft","bottomRight"],h=!1}let d=eC(t,i),c=eC(t.bottom,i);if(!d||!c)return;let p={topLeft:sj.start(d),topRight:sj.end(d),bottomLeft:sj.start(c),bottomRight:sj.end(c)},u={vectors:{topLeft:p.topRight,bottomLeft:p.bottomRight,topRight:p.topLeft,bottomRight:p.bottomLeft},angle:t.snapToAngle},g=aO(p,r,i,{overflowContinuous:this.overflowContinuous,translateVectors:n,invertYVectors:l,snap:h?u:void 0});t.start.x=g.topLeft.x,t.start.y=g.topLeft.y,t.end.x=g.topRight.x,t.end.y=g.topRight.y,t.startHeight=g.topLeft.y-g.bottomLeft.y,t.endHeight=g.topRight.y-g.bottomRight.y}getTranslatePointsVectors(t,e){let{bottomLeft:i,bottomRight:a,topLeft:s,topRight:o}=this.handles,r=i.getBBox().y-s.getBBox().y,n=a.getBBox().y-o.getBBox().y,l=sG.add(t,sG.from(0,r)),h=sG.add(e,sG.from(0,n));return{start:t,end:e,bottomStart:l,bottomEnd:h}}updateLines(t,e,i){let{topLine:a,bottomLine:s}=this,{lineDashOffset:o,stroke:r,strokeOpacity:n,strokeWidth:l}=t,h={lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:o,stroke:r,strokeOpacity:n,strokeWidth:l};a.setProperties({...e,...h}),s.setProperties({...i,...h})}updateHandles(t,e,i){let{handles:{topLeft:a,topRight:s,bottomLeft:o,bottomRight:r}}=this,n={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};a.update({...n,...sj.start(e)}),s.update({...n,...sj.end(e)}),o.update({...n,...sj.start(i)}),r.update({...n,...sG.sub(sj.end(i),sG.from(r.handle.width/2,r.handle.height/2))})}updateText(t,e,i){this.text=this.updateNode(sS,this.text,!!t.text.label),sM(!1,e,i,t.text,t.strokeWidth,this.text,t.text.label)}getBackgroundPoints(t,e,i,a){let s=e.x1>e.x2,o=e.y1>e.y2,r=o?a.y2:a.y1,n=o?a.y1:a.y2,l=sG.from(e);return t.extendEnd&&e.y2===n&&l.push(sG.from(s?a.x1:a.x2,o?a.y1:a.y2)),t.extendEnd&&i.y2===r&&l.push(sG.from(s?a.x1:a.x2,o?a.y2:a.y1)),l.push(...sG.from(i).reverse()),t.extendStart&&i.y1===n&&l.push(sG.from(s?a.x2:a.x1,o?a.y1:a.y2)),t.extendStart&&e.y1===r&&l.push(sG.from(s?a.x2:a.x1,o?a.y2:a.y1)),l}},{StateMachine:s$,StateMachineProperty:sH,Debug:sY}=a.n1,sK=class extends s${constructor(t){let e=({point:e})=>{let i=new ik;i.set({start:e,end:e,startHeight:0,endHeight:0}),t.create(i)},i=({offset:e,context:i})=>{let{datum:a,snapping:s}=this;a&&(a.set({end:aL(e,i,s,a.start,a.snapToAngle)}),t.update())},a=()=>{this.node?.toggleHandles({topRight:!0}),t.update()},o=({point:e})=>{let{datum:i,node:a}=this,o=ew(i?.end.y),r=ew(i?.start.y),{y:n}=e;if(null==i||!(0,s.Et)(r)||!(0,s.Et)(o)||!(0,s.Et)(n))return;let l=o-(n??0),h={x:i.start.x,y:r-l},d={x:i.end.x,y:e.y};a?.toggleHandles(!0),t.validatePoint(h,{overflowContinuous:!0})&&t.validatePoint(d,{overflowContinuous:!0})&&(i.set({startHeight:(r-o)*2+l,endHeight:l}),t.recordAction("Create disjoint-channel annotation"),t.showAnnotationOptions(),t.update())},r=()=>t.delete();super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:s$.parent},"waiting-first-render":{render:{target:"end",action:()=>{let{node:t}=this;t?.toggleActive(!0),t?.toggleHandles({topLeft:!0,topRight:!1,bottomLeft:!1,bottomRight:!1})}}},end:{hover:i,drag:i,click:{target:"height",action:a},dragEnd:{target:"height",action:a},reset:{target:s$.parent,action:r},cancel:{target:s$.parent,action:r}},height:{hover:({point:e})=>{let{datum:i,node:a}=this,o=ew(i?.end.y),r=ew(i?.start.y),{y:n}=e;if(null==i||!(0,s.Et)(r)||!(0,s.Et)(o)||!(0,s.Et)(n))return;let l=o-(n??0),h=(r-o)*2+l,d={x:i?.start.x,y:r-h},c={x:i?.end.x,y:e.y};a?.toggleHandles({bottomLeft:!0,bottomRight:!0}),t.validatePoint(d,{overflowContinuous:!0})&&t.validatePoint(c,{overflowContinuous:!0})&&(i.set({startHeight:h,endHeight:l}),t.update())},click:{target:s$.parent,action:o},drag:{target:s$.parent,action:o},reset:{target:s$.parent,action:r},cancel:{target:s$.parent,action:r}}}),this.debug=sY.create(!0,"annotations"),this.snapping=!1}};n([sH()],sK.prototype,"datum",2),n([sH()],sK.prototype,"node",2),n([sH()],sK.prototype,"snapping",2);var sU={type:"disjoint-channel",datum:ik,scene:sV,isDatum:ik.is,translate:(t,e,i,a)=>{ik.is(e)&&sV.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(ik.is(e)&&ik.is(i)&&sV.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{ik.is(e)&&sV.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new sK({...t,create:e("disjoint-channel")}),dragState:t=>new af(t)},sX=[0,23.6,38.2,50,61.8,78.6,100],sZ={10:[...sX,161.8,261.8,361.8,423.6],6:sX,4:sX.filter(t=>78.6!==t&&23.6!==t)};function sQ({x1:t,y1:e,x2:i,y2:a},s,o,r,n=10){let l=e-a,h=o?-1:1,d=r,c=[];return sZ[n].forEach((e,a)=>{let o=r+e/100*l*h,n=s.yAxis.scaleInvert(o);c.push({id:a,x1:t,x2:i,y1:d,y2:o,tag:+(100!=e),label:{x1:Math.min(t,i)-10,x2:i,y1:o,y2:o,text:`${(e/100).toFixed(3)} (${n.toFixed(2)})`}}),d=o}),c}var{Vec2:sq,Vec4:sJ}=a.n1,s0=class extends aw{constructor(){super(),this.trendLine=new sv,this.rangeFillsGroup=new a.n1.Group({name:`${this.id}-range-fills`}),this.rangeFillsGroupSelection=a.n1.Selection.select(this.rangeFillsGroup,a.n1.Range),this.rangeStrokesGroup=new a.n1.Group({name:`${this.id}-range-strokes`}),this.rangeStrokesGroupSelection=a.n1.Selection.select(this.rangeStrokesGroup,sv),this.labelsGroup=new a.n1.Group({name:`${this.id}-ranges-labels`}),this.labelsGroupSelection=a.n1.Selection.select(this.labelsGroup,sS),this.anchor={x:0,y:0,position:"above"},this.append([this.trendLine,this.rangeFillsGroup,this.rangeStrokesGroup,this.labelsGroup])}update(t,e){let i=eC(t,e);if(null==i){this.visible=!1;return}if(i=sJ.round(i),this.visible=t.visible??!0,!this.visible)return;this.updateLine(t,i,this.trendLine),this.updateHandles(t,i),this.updateAnchor(t,i,e);let{reverse:a}=t,s=this.extendLine(i,t,e),o=a?s.y1:s.y2,r=a?s.y2:s.y1,n=sQ(s,e,t.reverse,o,t.bands);this.updateRanges(t,n,e);let l={...s,y1:r,y2:r};this.updateText(t,l)}extendLine({x1:t,y1:e,x2:i,y2:a},s,o){let r={x1:t,y1:e,x2:i,y2:a};if(!s.extendStart&&!s.extendEnd)return r;let{x:n,width:l}=o.xAxis.bounds;return s.extendEnd&&(r[t>i?"x1":"x2"]=n+l),s.extendStart&&(r[t>i?"x2":"x1"]=n),r}updateLine(t,e,i){if(!e||!i)return;let{lineDashOffset:a,strokeWidth:s,strokeOpacity:o,stroke:r}=t;i.setProperties({...e,lineCap:t.getLineCap(),lineDash:[3,4],lineDashOffset:a,strokeWidth:s,strokeOpacity:o,fillOpacity:0,stroke:r})}updateRangeStrokes(t){let{lineDashOffset:e,strokeWidth:i,strokeOpacity:a,strokes:s,rangeStroke:o,isMultiColor:r}=t;this.rangeStrokesGroupSelection.each((n,{x1:l,x2:h,y2:d,tag:c},p)=>{let u=r?s[p%s.length]:o;n.setProperties({x1:l,x2:h,y1:d,y2:d,stroke:u,strokeOpacity:a,strokeWidth:i,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,tag:c})})}updateRanges(t,e,i){let a=t=>t.id;this.rangeFillsGroupSelection.update(e,void 0,a),this.rangeStrokesGroupSelection.update(e,void 0,a),this.labelsGroupSelection.update(e,void 0,a),this.updateRangeFills(t),this.updateRangeStrokes(t),this.updateRangeLabels(t,i)}updateRangeFills(t){let{lineDashOffset:e,strokeWidth:i,strokeOpacity:a,strokes:s,rangeStroke:o,showFill:r,isMultiColor:n}=t;this.rangeFillsGroupSelection.each((l,{x1:h,x2:d,y1:c,y2:p},u)=>{let g=n?s[u%s.length]:o;if(!r){l.visible=!1;return}l.setProperties({x1:h,x2:d,y1:c,y2:p,startLine:!1,endLine:!1,stroke:g,strokeOpacity:a,fill:g,fillOpacity:(a??1)*.15,strokeWidth:i,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,visible:!0})})}updateRangeLabels(t,{xAxis:e}){let{rangeStrokesGroupSelection:i}=this,{strokes:a,strokeWidth:s,rangeStroke:o,isMultiColor:r,label:{fontFamily:n,fontSize:l,fontStyle:h,fontWeight:d,color:c}}=t,p={fontFamily:n,fontSize:l,fontStyle:h,fontWeight:d},u=this.checkWithinBounds(e,p,this.labelsGroupSelection.at(0));this.labelsGroupSelection.each((t,e,n)=>{let l=c??(r?a[n%a.length]:o),h=i.at(n);if(!h)return;let{text:d,...g}=e.label;if(u)t.setProperties({...p,text:d,x:g.x1,y:g.y1,textBaseline:"middle",textAlign:"end",fill:l}),sD(t.id,h,g);else{let e={...p,label:d,position:"center",alignment:"left",color:l};sD(t.id,h,g,e,t,d,s)}})}checkWithinBounds(t,e,i){if(!i)return!1;let{text:a,...s}=i.datum.label;i.setProperties({...e,text:a,x:s.x1,y:s.y1,textBaseline:"middle",textAlign:"end"});let{x:o}=i.getBBox();return o>=t.bounds.x&&o<=t.bounds.x+t.bounds.width}updateText(t,e){let i=this.rangeStrokesGroupSelection.selectByTag(0)[0];if(!i)return;let{text:a,strokeWidth:s}=t;this.text=this.updateNode(sS,this.text,!!a.label),sD(i.id,i,e,a,this.text,a.label,s)}updateAnchor(t,e,i,s){let o=sJ.topCenter(e);sq.apply(this.anchor,a.n1.Transformable.toCanvasPoint(this.trendLine,o.x,o.y))}containsPoint(t,e){let{trendLine:i,rangeStrokesGroupSelection:a,text:s}=this,o=!1;return a.each(i=>o||(o=i.isPointInPath(t,e))),o||i.isPointInPath(t,e)||!!s?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.trendLine.isPointInPath(t,e)?"line":void 0}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}drag(t,e,i,a){t.locked||(this.activeHandle?this.dragHandle(t,e,i,a):this.dragAll(t,e,i))}getAnchor(){return this.anchor}getCursor(){return"pointer"}},{ContinuousScale:s1}=a.n1;function s2(t,e,i={overflowContinuous:!1},a){if(null==e.x||null==e.y)return a&&s.Vy.warnOnce(`${a}requires both an [x] and [y] property, ignoring.`),!1;let{xAxis:o,yAxis:r}=t,n=i.overflowContinuous&&s1.is(o.scale),l=i.overflowContinuous&&s1.is(r.scale),h=n||s4(e.x,o),d=l||s4(e.y,r);if(h&&d)return!0;if(a){let t="x & y domains";h&&(t="y domain"),d&&(t="x domain");let i=ew(e.x),o=ew(e.y);s.Vy.warnOnce(`${a}is outside the ${t}, ignoring. - x: [${i}], y: ${o}]`)}return!1}function s4(t,e){let{domain:i}=e.scale,a=ew(t);return!i||null==a||!e.continuous||a>=i[0]&&a<=i.at(-1)}var{Vec2:s5,Vec4:s3}=a.n1,s6=class extends s0{constructor(){super(),this.type="fibonacci-retracement-trend-based",this.endRetracementLine=new sv,this.start=new aD,this.end=new aD,this.endRetracement=new aD,this.append([this.endRetracementLine,this.start,this.end,this.endRetracement])}static is(t){return aw.isCheck(t,"fibonacci-retracement-trend-based")}update(t,e){let{coords1:i,coords2:a}=this.getCoords(t,e);if(null==i||null==a){this.visible=!1;return}if(i=s3.round(i),a=s3.round(a),this.visible=t.visible??!0,!this.visible)return;(void 0==t.endRetracement.x||void 0==t.endRetracement.y)&&(a=void 0),this.updateLine(t,i,this.trendLine),this.updateLine(t,a,this.endRetracementLine),this.updateHandles(t,i,a),this.updateAnchor(t,a??i,e);let{reverse:s,bands:o}=t,r=function(t,e){let{x2:i,y1:a,y2:s}=t,o=a-s;return null==e?{x1:i,x2:i,y1:s-o,y2:s}:{x1:e.x1,x2:e.x2,y1:e.y2-o,y2:e.y2}}(i,a),n=this.extendLine(r,t,e),l=n.y2,h=n.y1,d=a?sQ(n,e,s,l,o):[];this.updateRanges(t,d,e);let c={...n,y1:h,y2:h};this.updateText(t,c)}containsPoint(t,e){let{start:i,end:a,endRetracement:s,endRetracementLine:o}=this;return(this.activeHandle=void 0,i.containsPoint(t,e))?(this.activeHandle="start",!0):a.containsPoint(t,e)?(this.activeHandle="end",!0):s.containsPoint(t,e)?(this.activeHandle="endRetracement",!0):o.isPointInPath(t,e)||super.containsPoint(t,e)}getNodeAtCoords(t,e){return this.start.containsPoint(t,e)||this.end.containsPoint(t,e)||this.endRetracement.containsPoint(t,e)?"handle":this.endRetracementLine.isPointInPath(t,e)?"line":super.getNodeAtCoords(t,e)}dragStart(t,e,i){this.dragState={offset:e,...aN({start:t.start,end:t.end,endRetracement:t.endRetracement},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1),this.endRetracement.toggleDragging(!1)}dragAll(t,e,i){let{dragState:a}=this;a&&this.translatePoints({datum:t,start:a.start,end:a.end,endRetracement:a.endRetracement,translation:s5.sub(e,a.offset),context:i})}dragHandle(t,e,i,a){let{activeHandle:s,dragState:o}=this;if(!s||!o)return;this[s].toggleDragging(!0);let r=a?this.snapToAngle(t,e,i):eT(this[s].drag(e).point,i);r&&s2(i,r)&&(t[s].x=r.x,t[s].y=r.y)}snapToAngle(t,e,i){let{activeHandle:a}=this,s=["start","end","endRetracement"];if(!a)return;let o=(s.indexOf(a)+1)%s.length,r=s[o];return this[a].toggleDragging(!0),eT(aT(e,eA(t[r],i),t.snapToAngle),i)}translatePoints({datum:t,start:e,end:i,endRetracement:a,translation:s,context:o}){let r=aO({start:e,end:i,endRetracement:a},s,o,{overflowContinuous:2});t.start.x=r.start.x,t.end.x=r.end.x,t.endRetracement.x=r.endRetracement.x,t.start.y=r.start.y,t.end.y=r.end.y,t.endRetracement.y=r.endRetracement.y}translate(t,e,i){this.translatePoints({datum:t,start:eA(t.start,i),end:eA(t.end,i),endRetracement:eA(t.endRetracement,i),translation:e,context:i})}copy(t,e,i){let{coords1:a,coords2:s}=this.getCoords(t,i);if(!a||!s)return;let o=this.computeBBoxWithoutHandles();return this.translatePoints({datum:e,start:s3.start(a),end:s3.end(a),endRetracement:s3.end(s),translation:{x:-o.width/2,y:-o.height/2},context:i}),e}getCoords(t,e){return{coords1:eC(t,e),coords2:eC({start:t.end,end:t.endRetracement},e)}}toggleHandles(t){if("boolean"==typeof t)this.start.visible=t,this.end.visible=t,this.endRetracement.visible=t;else for(let[e,i]of(0,s.jO)(t))this[e].visible=i;this.start.toggleHovered("start"===this.activeHandle),this.end.toggleHovered("end"===this.activeHandle),this.endRetracement.toggleHovered("endRetracement"===this.activeHandle)}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t),this.endRetracement.toggleActive(t)}updateHandles(t,e,i,a){this.start.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"end",a)}),i&&this.endRetracement.update({...this.getHandleStyles(t),...this.getHandleCoords(t,i,"endRetracement",a)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1),this.endRetracement.toggleLocked(t.locked??!1)}getHandleCoords(t,e,i,a){return"start"===i?s3.start(e):s3.end(e)}},{StateMachine:s8,StateMachineProperty:s9,Debug:s7}=a.n1,ot=class extends s8{constructor(t){let e=({point:e})=>{let i=this.createDatum();i.set({start:e,end:e}),t.create(i)},i=({offset:e,context:i})=>{let{datum:a,snapping:s}=this;a&&(a.set({end:aL(e,i,s,a.start,a.snapToAngle)}),t.update())},a=()=>{let{datum:e}=this;e&&(e.endRetracement.x=e.end.x,e.endRetracement.y=e.end.y,this.node?.toggleHandles({end:!0}),t.update())},s=()=>{this.node?.toggleHandles({endRetracement:!0}),t.update()},o=()=>t.delete();super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:s8.parent},"waiting-first-render":{render:{target:"end",action:()=>{let{node:t}=this;t?.toggleActive(!0),t?.toggleHandles({start:!0,end:!1,endRetracement:!1})}}},end:{hover:i,click:{target:"endRetracement",action:a},drag:i,dragEnd:{target:"endRetracement",action:a},reset:{target:s8.parent,action:o},cancel:{target:s8.parent,action:o},onExit:()=>{t.showAnnotationOptions(),t.recordAction(`Create ${this.datum?.type} annotation`)}},endRetracement:{hover:({offset:e,context:i})=>{let{datum:a,snapping:s}=this;a&&(a.set({endRetracement:aL(e,i,s,a.end,a.snapToAngle)}),t.update())},click:{target:s8.parent,action:s},drag:{target:s8.parent,action:s},reset:{target:s8.parent,action:o},cancel:{target:s8.parent,action:o}}}),this.debug=s7.create(!0,"annotations"),this.snapping=!1}createDatum(){return new iT}};n([s9()],ot.prototype,"datum",2),n([s9()],ot.prototype,"node",2),n([s9()],ot.prototype,"snapping",2);var oe={type:"fibonacci-retracement-trend-based",datum:iT,scene:s6,isDatum:iT.is,translate:(t,e,i,a)=>{iT.is(e)&&s6.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(iT.is(e)&&iT.is(i)&&s6.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{iT.is(e)&&s6.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new ot({...t,create:e("fibonacci-retracement-trend-based")}),dragState:t=>new af(t)},{Vec2:oi,Vec4:oa}=a.n1,os=class extends s0{constructor(){super(),this.type="fibonacci-retracement",this.start=new aD,this.end=new aD,this.append([this.start,this.end])}static is(t){return aw.isCheck(t,"fibonacci-retracement")}containsPoint(t,e){let{start:i,end:a}=this;return(this.activeHandle=void 0,i.containsPoint(t,e))?(this.activeHandle="start",!0):a.containsPoint(t,e)?(this.activeHandle="end",!0):super.containsPoint(t,e)}getNodeAtCoords(t,e){return this.start.containsPoint(t,e)||this.end.containsPoint(t,e)?"handle":super.getNodeAtCoords(t,e)}dragStart(t,e,i){this.dragState={offset:e,...aN({start:t.start,end:t.end},i)}}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}dragAll(t,e,i){let{dragState:a}=this;a&&this.translatePoints({datum:t,start:a.start,end:a.end,translation:oi.sub(e,a.offset),context:i})}dragHandle(t,e,i,a){let{activeHandle:s,dragState:o}=this;if(!s||!o)return;this[s].toggleDragging(!0);let r=a?this.snapToAngle(t,e,i):eT(this[s].drag(e).point,i);r&&s2(i,r)&&(t[s].x=r.x,t[s].y=r.y)}snapToAngle(t,e,i){let{activeHandle:a}=this,s=["start","end"].find(t=>t!==a);if(a&&s)return this[a].toggleDragging(!0),eT(aT(e,eA(t[s],i),t.snapToAngle),i)}translatePoints({datum:t,start:e,end:i,translation:a,context:s}){let o=aO({start:e,end:i},a,s,{overflowContinuous:1});t.start.x=o.start.x,t.end.x=o.end.x,t.start.y=o.start.y,t.end.y=o.end.y}translate(t,e,i){this.translatePoints({datum:t,start:eA(t.start,i),end:eA(t.end,i),translation:e,context:i})}copy(t,e,i){let a=eC(t,i);if(!a)return;let s=this.computeBBoxWithoutHandles();return this.translatePoints({datum:e,start:{x:a.x1,y:a.y1},end:{x:a.x2,y:a.y2},translation:{x:-s.width/2,y:-s.height/2},context:i}),e}toggleHandles(t){if("boolean"==typeof t)this.start.visible=t,this.end.visible=t;else for(let[e,i]of(0,s.jO)(t))this[e].visible=i;this.start.toggleHovered("start"===this.activeHandle),this.end.toggleHovered("end"===this.activeHandle)}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t)}updateHandles(t,e,i,a){this.start.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t),...this.getHandleCoords(t,e,"end",a)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1)}getHandleCoords(t,e,i,a){return"start"===i?oa.start(e):oa.end(e)}},{StateMachine:oo,StateMachineProperty:or,Debug:on}=a.n1,ol=class extends oo{constructor(t){let e=({point:e})=>{let i=this.createDatum();i.set({start:e,end:e}),t.create(i)},i=({offset:e,context:i})=>{let{datum:a,snapping:s}=this;a&&(a.set({end:aL(e,i,s,a.start,a.snapToAngle)}),t.update())},a=()=>{this.node?.toggleHandles({end:!0}),t.update()},s=()=>t.delete();super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:oo.parent},"waiting-first-render":{render:{target:"end",action:()=>{let{node:t}=this;t?.toggleActive(!0),t?.toggleHandles({start:!0,end:!1})}}},end:{hover:i,click:{target:oo.parent,action:a},drag:i,dragEnd:{target:oo.parent,action:a},reset:{target:oo.parent,action:s},cancel:{target:oo.parent,action:s},onExit:()=>{t.showAnnotationOptions(),t.recordAction(`Create ${this.datum?.type} annotation`)}}}),this.debug=on.create(!0,"annotations"),this.snapping=!1}};n([or()],ol.prototype,"datum",2),n([or()],ol.prototype,"node",2),n([or()],ol.prototype,"snapping",2);var oh=class extends ol{createDatum(){return new iw}},od=class extends ol{createDatum(){return new iI}},oc=class extends ol{createDatum(){return new iO}},op={type:"fibonacci-retracement",datum:iO,scene:os,isDatum:iO.is,translate:(t,e,i,a)=>{iO.is(e)&&os.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(iO.is(e)&&iO.is(i)&&os.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{iO.is(e)&&os.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new oc({...t,create:e("fibonacci-retracement")}),dragState:t=>new af(t)},{Vec2:ou}=a.n1,og=class extends a.n1.Group{},oy=class extends og{constructor(){super(),this.type="arrow",this.path=new a.n1.Path,this.armLength=6,this.append([this.path])}update(t){let{path:e}=this,{x:i,y:a,angle:s,...o}=t,r=ou.from(i,a),n=3*Math.PI/4,l=this.armLength+(t.strokeWidth??0)*2,h=ou.rotate(ou.from(0,l),s+n,r),d=ou.rotate(ou.from(l,0),s-n,r);e.setProperties(o),e.fillOpacity=0,e.path.clear(),e.path.moveTo(h.x,h.y),e.path.lineTo(r.x,r.y),e.path.lineTo(d.x,d.y)}},{Vec2:of,Vec4:om}=a.n1,ox=class extends a4{constructor(){super(),this.type="line",this.line=new sv,this.append([this.line,this.start,this.end])}static is(t){return aw.isCheck(t,"line")}update(t,e){let i=eC(t,e);if(null==i){this.visible=!1;return}i=om.round(i),this.visible=t.visible??!0,this.visible&&(this.updateLine(t,i,e),this.updateHandles(t,i),this.updateText(t,i),this.updateCaps(t,i),this.updateAnchor(t,i,e))}updateLine(t,e,i){let{line:a}=this,{lineDashOffset:s,stroke:o,strokeWidth:r,strokeOpacity:n}=t,l=this.extendLine(e,t,i);a.setProperties({...l,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:s,stroke:o,strokeWidth:r,strokeOpacity:n,fillOpacity:0})}updateText(t,e){this.text=this.updateNode(sS,this.text,!!t.text.label),sD(this.line.id,this.line,e,t.text,this.text,t.text.label,t.strokeWidth)}updateCaps(t,e){if(!t.startCap&&this.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),!t.endCap&&this.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),!t.startCap&&!t.endCap)return;let{stroke:i,strokeWidth:a,strokeOpacity:s}=t,[o,r]=of.from(e),n=of.angle(of.sub(r,o));t.startCap&&(this.startCap&&this.startCap.type!==t.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),null==this.startCap&&(this.startCap=new oy,this.append([this.startCap])),this.startCap.update({x:o.x,y:o.y,angle:n-Math.PI,stroke:i,strokeWidth:a,strokeOpacity:s})),t.endCap&&(this.endCap&&this.endCap.type!==t.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),null==this.endCap&&(this.endCap=new oy,this.append([this.endCap])),this.endCap.update({x:r.x,y:r.y,angle:n,stroke:i,strokeWidth:a,strokeOpacity:s}))}updateAnchor(t,e,i,s){let o=om.topCenter(e);of.apply(this.anchor,a.n1.Transformable.toCanvasPoint(this.line,o.x,o.y))}containsPoint(t,e){let{line:i,text:a}=this;return super.containsPoint(t,e)||i.isPointInPath(t,e)||!!a?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.line.isPointInPath(t,e)?"line":super.getNodeAtCoords(t,e)}getHandleCoords(t,e,i,a){let{startCap:s,endCap:o}=this,[r,n]=of.from(e),l=of.angle(of.sub(n,r));return s&&(r=of.rotate(of.from(0,-aD.HANDLE_SIZE/2),l,r)),o&&(n=of.rotate(of.from(0,aD.HANDLE_SIZE/2),l,n)),"start"===i?r:n}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}},ob={type:"line",datum:iI,scene:ox,isDatum:iI.is,translate:(t,e,i,a)=>{iI.is(e)&&ox.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(iI.is(e)&&iI.is(i)&&ox.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{iI.is(e)&&ox.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new od({...t,create:e("line")}),dragState:t=>new af(t)},ov={type:"arrow",datum:iw,scene:ox,isDatum:iw.is,translate:(t,e,i,a)=>{iw.is(e)&&ox.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(iw.is(e)&&iw.is(i)&&ox.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{iw.is(e)&&ox.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new oh({...t,create:e("arrow")}),dragState:t=>new af(t)};function oS(t,e=0,i=0){let s=e;for(let e of t)if(Array.isArray(e)){for(let t of e)ok(t,s);s+=a.n1.Group.computeChildrenBBox(e).width+i}else ok(e,s),s+=e.getBBox().width+i}function ok(t,e){"x1"in t?(t.x2=e+(t.x2-t.x1),t.x1=e):t.x=e}function oD(t,e){"y1"in t?(t.y2=e+(t.y2-t.y1),t.y1=e):t.y=e}function oM(t,e){"x1"in t?(t.x1+=e,t.x2+=e):t.x+=e}function ow(t,e){"y1"in t?(t.y1+=e,t.y2+=e):t.y+=e}var{Vec4:oI}=a.n1,oC=class extends a.n1.Group{constructor(){super(),this.name="MeasurerStatisticsScene",this.background=new a.n1.Rect,this.dateRangeBarsText=new a.n1.Text,this.dateRangeDivider=new a.n1.Line,this.dateRangeValueText=new a.n1.Text,this.priceRangeValueText=new a.n1.Text,this.priceRangeDivider=new a.n1.Line,this.priceRangePercentageText=new a.n1.Text,this.volumeText=new a.n1.Text,this.volumeFormatter=new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}),this.append([this.background,this.dateRangeBarsText,this.dateRangeDivider,this.dateRangeValueText,this.priceRangeValueText,this.priceRangeDivider,this.priceRangePercentageText,this.volumeText])}update(t,e,i,s,o,r,n){this.verticalDirection=r;let l=this.updateStatistics(t,e,i,n),h=a.n1.Group.computeChildrenBBox(l.flat());h.grow(10),this.updateBackground(t,h,10),this.reposition(l,10,o),this.checkVisibility(t,o,s)}checkVisibility(t,e,i){let s=oI.from(new a.n1.BBox(0,0,e.seriesRect.width,e.seriesRect.height));oI.collides(i,s)?this.visible=t.visible??!0:this.visible=!1}updateStatistics(t,e,i,s){let{dateRangeBarsText:o,dateRangeDivider:r,dateRangeValueText:n,priceRangeValueText:l,priceRangeDivider:h,priceRangePercentageText:d,volumeText:c}=this,p=t.statistics.fontSize+3,u=this.getTextStyles(t),g={...this.getDividerStyles(t),x1:0,y1:0,x2:0,y2:p},y=[o,r,n],f=[l,h,d],m=[];return e.priceRange&&(l.setProperties({...u,text:this.formatPriceRangeValue(e.priceRange.value,s)}),h.setProperties(g),d.setProperties({...u,text:this.formatPriceRangePercentage(e.priceRange.percentage,s)}),oS(f,i.x,8),m.push(f)),e.dateRange&&(o.setProperties({...u,text:this.formatDateRangeBars(e.dateRange.bars,s)}),r.setProperties(g),n.setProperties({...u,text:this.formatDateRangeValue(e.dateRange.value)}),oS(y,i.x,8),m.push(y)),null!=e.volume?(c.setProperties({...u,x:i.x,text:this.formatVolume(e.volume,s),visible:!0}),m.push(c)):c.visible=!1,!function(t,e=0,i=0){let s=e;for(let e of t)if(Array.isArray(e)){for(let t of e)oD(t,s);s+=a.n1.Group.computeChildrenBBox(e).height+i}else oD(e,s),s+=e.getBBox().height+i}(m,i.y,6),h.y1+=-2,h.y2+=-2,r.y1+=-2,r.y2+=-2,m}updateBackground(t,e,i){let a=this.getBackgroundStyles(t);this.background.setProperties({...a,...e,x:e.x-e.width/2+i,y:e.y})}reposition(t,e,i){let{width:s,height:o}=i.seriesRect,r=oI.from(this.background.getBBox()),n=0;r.x1<0&&(n=-r.x1),r.x2>s&&(n=s-r.x2);let l=Math.min(e,o-r.y2);for(let e of t)if(Array.isArray(e)){let t=a.n1.Group.computeChildrenBBox(e).width;for(let i of e)oM(i,n-t/2),ow(i,l)}else oM(e,n-e.getBBox().width/2),ow(e,l);this.background.x+=n,this.background.y+=l}getTextStyles(t){return{fill:t.statistics.color,fontFamily:t.statistics.fontFamily,fontSize:t.statistics.fontSize,fontStyle:t.statistics.fontStyle,fontWeight:t.statistics.fontWeight,textBaseline:"top"}}getDividerStyles(t){return{stroke:t.statistics.divider.stroke,strokeOpacity:t.statistics.divider.strokeOpacity,strokeWidth:t.statistics.divider.strokeWidth}}getBackgroundStyles(t){return{fill:t.statistics.fill,stroke:t.statistics.stroke,strokeOpacity:t.statistics.strokeOpacity,strokeWidth:t.statistics.strokeWidth,cornerRadius:4}}formatDateRangeBars(t,e){return e?.t("measurerDateRangeBars",{value:t})??`${t}`}formatDateRangeValue(t){let e=[],i=t>=0?"":"-",a=Math.floor((t=Math.abs(t))/6e4),s=Math.floor(t/36e5),o=Math.floor(t/864e5),r=s%24,n=a%60;return o>=1&&e.push(`${o}d`),s>=1&&(t<864e5||0!==r)&&e.push(`${r}h`),(t<36e5||0!==n)&&e.push(`${n}m`),e[0]=`${i}${e[0]}`,e.join(" ")}formatPriceRangeValue(t,e){return e?.t("measurerPriceRangeValue",{value:Number(t.toFixed(2))})??`${t}`}formatPriceRangePercentage(t,e){return e?.t("measurerPriceRangePercent",{value:t})??`${t}`}formatVolume(t,e){let i=isNaN(t)?"":this.volumeFormatter.format(t);return e?.t("measurerVolume",{value:i})??i}},oA=class extends oC{getDirectionStyles(t){return"down"===this.verticalDirection?t.down.statistics:t.up.statistics}getTextStyles(t){let e=this.getDirectionStyles(t);return{...super.getTextStyles(t),fill:e.color,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight}}getDividerStyles(t){let e=this.getDirectionStyles(t);return{stroke:e.divider.stroke,strokeOpacity:e.divider.strokeOpacity,strokeWidth:e.divider.strokeWidth}}getBackgroundStyles(t){let e=this.getDirectionStyles(t);return{...super.getBackgroundStyles(t),fill:e.fill,stroke:e.stroke,strokeOpacity:e.strokeOpacity,strokeWidth:e.strokeWidth}}},{Vec2:oL,Vec4:oT}=a.n1,oN=class extends a4{constructor(){super(),this.type="measurer",this.horizontalLine=new sv,this.verticalLine=new sv,this.horizontalStartLine=new sv,this.horizontalEndLine=new sv,this.verticalStartLine=new sv,this.verticalEndLine=new sv,this.horizontalEndCap=new oy,this.verticalEndCap=new oy,this.background=new a.n1.Path({zIndex:-1}),this.updateBackground=s_.updateBackground.bind(this),this.statistics=this.createStatisticsScene(),this.statistics.zIndex=1,this.append([this.background,this.verticalStartLine,this.verticalEndLine,this.horizontalStartLine,this.horizontalEndLine,this.horizontalLine,this.verticalLine,this.horizontalEndCap,this.verticalEndCap,this.start,this.end,this.statistics])}static is(t){return aw.isCheck(t,"measurer")}createStatisticsScene(){return new oC}update(t,e){let i=eC(t,e);if(null==i){this.visible=!1;return}if(this.visible=t.visible??!0,!this.visible)return;let a=this.extendPerpendicular(i,t,e),s={...a,y2:a.y1},o={...a,y1:a.y2};this.verticalDirection=i.y1<i.y2?"down":"up",this.updateVisibilities(t),this.updateLines(t,i),this.updateHandles(t,i),this.updateText(t,i),this.updateCaps(t,i),this.updateBoundingLines(t,a),this.updateBackground(t,s,o,e),this.updateStatistics(t,i,e),this.updateAnchor(t,i,e)}extendPerpendicular(t,e,i){let a={x1:Math.min(t.x1,t.x2),x2:Math.max(t.x1,t.x2),y1:Math.min(t.y1,t.y2),y2:Math.max(t.y1,t.y2)},[s,o]=oL.from(i.yAxis.bounds);return e6.is(e)?(e.extendAbove&&(a.y1=s.y),e.extendBelow&&(a.y2=o.y)):e8.is(e)&&(e.extendLeft&&(a.x1=s.x),e.extendRight&&(a.x2=o.x)),a}updateVisibilities(t){let{horizontalStartLine:e,horizontalEndLine:i,horizontalEndCap:a,verticalStartLine:s,verticalEndLine:o,verticalEndCap:r}=this,{direction:n}=t;s.visible="vertical"!==n,o.visible="vertical"!==n,a.visible="vertical"!==n,e.visible="horizontal"!==n,i.visible="horizontal"!==n,r.visible="horizontal"!==n}updateLines(t,e){let{horizontalLine:i,verticalLine:a}=this,{direction:s}=t,{x1:o,y1:r,x2:n,y2:l}=e,h=oL.round(oT.center(e),0),d=this.getLineStyles(t);"vertical"!==s&&i.setProperties({...d,x1:o,x2:n,y1:h.y,y2:h.y}),"horizontal"!==s&&a.setProperties({...d,x1:h.x,x2:h.x,y1:r,y2:l})}updateText(t,e){let i,a,{direction:s}=t,o=oL.round(oT.center(e),0),r={...e};"vertical"===s?(i=this.verticalLine,r.x1=o.x,r.x2=o.x):(i=this.horizontalLine,r.y1=o.y,r.y2=o.y),this.text=this.updateNode(sS,this.text,!!t.text.label);let{id:n}=i,l=sD(n,i,r,t.text,this.text,t.text.label,t.strokeWidth);if("both"===s&&l&&this.text){let t=oT.from(this.text.getBBox()),{offset:e}=l.numbers;t.x1<=o.x+e.x&&t.x2>=o.x-e.x&&(a={x:o.x,y:l.clipMask.y,radius:this.text.getBBox().height/2+oL.length(e)})}this.verticalLine.setClipMask(n,a)}updateCaps(t,e){let{horizontalEndCap:i,verticalEndCap:a}=this,{direction:s}=t,{x1:o,y1:r,x2:n,y2:l}=e,h=oL.round(oT.center(e),0),{stroke:d,strokeWidth:c,strokeOpacity:p}=this.getLineStyles(t),u={stroke:d,strokeWidth:c,strokeOpacity:p};if("vertical"!==s){let t=o<=n?0:Math.PI,e=n;"horizontal"===s&&(e+=o<=n?-2:2),i.update({...u,x:e,y:h.y,angle:t})}if("horizontal"!==s){let t=r<=l?Math.PI/2:-(Math.PI/2),e=l;"vertical"===s&&(e+=r<=l?-2:2),a.update({...u,x:h.x,y:e,angle:t})}}updateBoundingLines(t,e){let{verticalStartLine:i,verticalEndLine:a,horizontalStartLine:s,horizontalEndLine:o}=this,{direction:r}=t,{x1:n,y1:l,x2:h,y2:d}=e,c=this.getLineStyles(t);"horizontal"===r&&(i.setProperties({...c,x1:n,y1:l,x2:n,y2:d}),a.setProperties({...c,x1:h,y1:l,x2:h,y2:d})),"vertical"===r&&(s.setProperties({...c,x1:n,y1:l,x2:h,y2:l}),o.setProperties({...c,x1:n,y1:d,x2:h,y2:d}))}updateStatistics(t,e,i){let a=oL.add(oT.bottomCenter(e),oL.from(0,10)),s={volume:this.getVolume(t)};t.hasPriceRange&&(s.priceRange={percentage:this.getPriceRangePercentage(t),value:this.getPriceRangeValue(t)}),t.hasDateRange&&(s.dateRange={bars:this.getDateRangeBars(e,i),value:this.getDateRangeValue(t)}),this.statistics.update(t,s,a,e,i,this.verticalDirection,t.localeManager)}updateAnchor(t,e,i,s){let o=oT.topCenter(e);oL.apply(this.anchor,a.n1.Transformable.toCanvasPoint(this.horizontalLine,o.x,o.y))}getBackgroundPoints(t,e,i,a){let[s,o]=oL.from(e),[r,n]=oL.from(i);return[s,o,n,r]}getLineStyles(t){let{lineDashOffset:e,stroke:i,strokeWidth:a,strokeOpacity:s}=t;return{lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,stroke:i,strokeWidth:a,strokeOpacity:s,fillOpacity:0}}getBackgroundStyles(t){let{background:e}=t;return{fill:e.fill,fillOpacity:e.fillOpacity}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}containsPoint(t,e){let{horizontalLine:i,text:a,verticalLine:s,horizontalStartLine:o,horizontalEndLine:r,verticalStartLine:n,verticalEndLine:l}=this;return super.containsPoint(t,e)||i.isPointInPath(t,e)||s.isPointInPath(t,e)||o.visible&&o.isPointInPath(t,e)||r.visible&&r.isPointInPath(t,e)||n.visible&&n.isPointInPath(t,e)||l.visible&&l.isPointInPath(t,e)||!!a?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.start.containsPoint(t,e)||this.end.containsPoint(t,e)?"handle":"line"}getDateRangeBars(t,e){let{step:i}=e.xAxis.scale,a=t.x1<=t.x2?1:-1;return i?Math.round(oT.width(t)/i)*a:0}getDateRangeValue(t){let e=ew(t.start.x),i=ew(t.end.x);if(!(0,s.$P)(e)||!(0,s.$P)(i))throw Error("Can not create a date range measurement of non-date x-axis.");return i.getTime()-e.getTime()}getPriceRangePercentage(t){if(null==t.start.y||null==t.end.y)throw Error("Can not create a price range measurement of a non-numeric y-axis");let e=ew(t.end.y),i=ew(t.start.y);if(!(0,s.Et)(e)||!(0,s.Et)(i))throw Error("Can not create a price range measurement of a non-numeric y-axis");return(e-i)/i}getPriceRangeValue(t){if(null==t.start.y||null==t.end.y)throw Error("Can not create a price range measurement of a non-numeric y-axis");let e=ew(t.end.y),i=ew(t.start.y);if(!(0,s.Et)(e)||!(0,s.Et)(i))throw Error("Can not create a price range measurement of a non-numeric y-axis");return e-i}getVolume(t){return t.getVolume(t.start.x,t.end.x)}},oO=class extends oN{constructor(){super(...arguments),this.type="quick-measurer"}static is(t){return aw.isCheck(t,"quick-measurer")}createStatisticsScene(){return new oA}getDirectionStyles(t){return"down"===this.verticalDirection?t.down:t.up}getLineStyles(t){let e=this.getDirectionStyles(t);return{...super.getLineStyles(t),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity}}getBackgroundStyles(t){let e=this.getDirectionStyles(t);return{fill:e.fill,fillOpacity:e.fillOpacity}}getHandleStyles(t){let e=this.getDirectionStyles(t);return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}},{StateMachine:oP,StateMachineProperty:oE,Debug:oR}=a.n1,oB=class extends oP{constructor(t){let e=({point:e})=>{let i=this.createDatum();i.set({start:e,end:e}),t.create(i)},i=({point:e})=>{let{datum:i,node:a}=this;i?.set({end:e}),a?.toggleActive(!0),a?.toggleHandles({end:!1}),t.update()},a=()=>{this.node?.toggleHandles({end:!0})},s=()=>t.delete();super("start",{start:{reset:oP.parent,click:{target:"end",action:e},drag:{target:"end",action:e}},end:{hover:i,drag:i,click:{target:oP.parent,action:a},dragEnd:{target:oP.parent,action:a},reset:{target:oP.parent,action:s},cancel:{target:oP.parent,action:s},onExit:()=>{t.showAnnotationOptions(),iF(this.datum)||t.recordAction(`Create ${this.node?.type} annotation`)}}}),this.debug=oR.create(!0,"annotations")}};n([oE()],oB.prototype,"datum",2),n([oE()],oB.prototype,"node",2);var oz=class extends oB{createDatum(){return new e6}},oF=class extends oB{createDatum(){return new e8}},o_=class extends oB{createDatum(){return new e9}},oW=class extends oB{createDatum(){return new e7}},oG={type:"date-range",datum:e6,scene:oN,isDatum:e6.is,translate:(t,e,i,a)=>{e6.is(e)&&oN.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(e6.is(e)&&e6.is(i)&&oN.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{e6.is(e)&&oN.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new oz({...t,create:e("date-range")}),dragState:t=>new af(t)},oj={type:"price-range",datum:e8,scene:oN,isDatum:e8.is,translate:(t,e,i,a)=>{e8.is(e)&&oN.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(e8.is(e)&&e8.is(i)&&oN.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{e8.is(e)&&oN.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new oF({...t,create:e("date-range")}),dragState:t=>new af(t)},oV={type:"date-price-range",datum:e9,scene:oN,isDatum:e9.is,translate:(t,e,i,a)=>{e9.is(e)&&oN.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(e9.is(e)&&e9.is(i)&&oN.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{e9.is(e)&&oN.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new o_({...t,create:e("date-range")}),dragState:t=>new af(t)},o$={type:"quick-date-price-range",datum:e7,scene:oO,isDatum:e7.is,translate:(t,e,i,a)=>{e7.is(e)&&oO.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(e7.is(e)&&e7.is(i)&&oO.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{e7.is(e)&&oO.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new oW({...t,create:e("quick-date-price-range")}),dragState:t=>new af(t)},{ZIndexMap:oH,TextWrapper:oY}=a.n1,oK=class extends sn{constructor(){super(),this.type="note",this.shape=new a.n1.Rect,this.iconBackground=new a.n1.SvgPath("M22 1.83333C22 0.820811 21.1792 0 20.1667 0H1.83333C0.820811 0 0 0.82081 0 1.83333V13.9868C0 14.9994 0.820811 15.8202 1.83333 15.8202L5.88971 15.8202C6.44575 15.8202 6.97175 16.0725 7.31971 16.5062L9.57006 19.3112C10.304 20.2259 11.6962 20.2259 12.4301 19.3112L14.6804 16.5062C15.0284 16.0725 15.5544 15.8202 16.1104 15.8202L20.1667 15.8202C21.1792 15.8202 22 14.9994 22 13.9868V1.83333Z"),this.iconLines=new a.n1.SvgPath("M17.1114 5.75C17.1114 6.16421 16.7756 6.5 16.3614 6.5H5.63916C5.22495 6.5 4.88916 6.16421 4.88916 5.75V5.75C4.88916 5.33579 5.22495 5 5.63916 5H16.3614C16.7756 5 17.1114 5.33579 17.1114 5.75V5.75ZM17.1114 9.25C17.1114 9.66421 16.7756 10 16.3614 10H5.63916C5.22495 10 4.88916 9.66421 4.88916 9.25V9.25C4.88916 8.83579 5.22495 8.5 5.63916 8.5H16.3614C16.7756 8.5 17.1114 8.83579 17.1114 9.25V9.25Z"),this.active=!1,this.shape.visible=!1,this.label.visible=!1,this.iconBackground.fillShadow=new a.n1.DropShadow,this.append([this.shape,this.label,this.iconBackground,this.iconLines,this.handle])}static is(t){return aw.isCheck(t,"note")}update(t,e){this.updateIcon(t,e),super.update(t,e)}getTextBBox(t,e,i){let a=super.getTextBBox(t,e,i);a.x-=t.width/2,a.x=(0,s.qE)(0,a.x,i.seriesRect.width-t.width);let o=t.getPadding().top,r=a.y-30-2*o,n=a.y+aD.HANDLE_SIZE+2*o;return r-a.height-34<0?(a.y=n,t.position="top"):(a.y=r+o,t.position="bottom"),a}updateLabel(t,e){let i=!1!==t.visible&&this.label.visible;super.updateLabel(t,e),this.label.visible=i,this.label.text=oY.wrapText(t.text,{font:{fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},avoidOrphans:!1,textAlign:t.textAlign,textBaseline:"hanging",textWrap:"always",maxWidth:200})}updateShape(t,e){let{shape:i}=this;i.fill=t.background.fill,i.fillOpacity=t.background.fillOpacity??1,i.stroke=t.background.stroke,i.strokeOpacity=t.background.strokeOpacity??1,i.strokeWidth=t.background.strokeWidth??1,i.cornerRadius=4;let a=t.getPadding().top,s="top"===t.position;i.x=e.x-a,i.width=t.width+2*a,i.height=e.height+2*a,i.y=e.y+(s?0:-e.height)-a}updateIcon(t,e){let{active:i,iconBackground:a,iconLines:s}=this,{x:o,y:r}=eA(t,e);a.x=o-11,a.y=r-20,s.x=a.x,s.y=a.y,a.fill=t.fill,a.fillOpacity=t.fillOpacity??1,a.stroke=t.stroke,a.strokeOpacity=t.strokeOpacity??1,a.strokeWidth=t.strokeWidth??1,s.fill=t.stroke,i?a.fillShadow.color=t.fill??"rgba(0, 0, 0, 0.22)":a.fillShadow.color="rgba(0, 0, 0, 0.22)"}updateAnchor(t,e,i){let a=t.getPadding().top,s="top"===t.position;return{x:e.x+i.seriesRect.x+t.width/2,y:e.y+i.seriesRect.y+(s?1:-1)*(e.height+a),position:s?"below":"above"}}getLabelCoords(t,e){let i="top"===t.position,a=t.getPadding().top+1.38*t.fontSize/2;return{x:e.x,y:e.y+(i?a/2:0)}}getTextBaseline(t){return"top"===t.position?"middle":t.position}getHandleCoords(t,e,i){return{x:e.x,y:e.y+aD.HANDLE_SIZE/2+4}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.fill,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}toggleHovered(t){super.toggleHovered(t),this.label.visible=t,this.shape.visible=t,this.zIndex=t?oH.CHART_ANNOTATION_FOCUSED:oH.CHART_ANNOTATION}toggleActive(t){super.toggleActive(t),this.label.visible=t,this.shape.visible=t,this.active=t}containsPoint(t,e){return!!(this.shape.visible&&this.shape.containsPoint(t,e)||this.iconBackground.containsPoint(t,e))||super.containsPoint(t,e)}},oU=class extends su{createDatum(){return new ic}},oX={type:"note",datum:ic,scene:oK,isDatum:ic.is,translate:(t,e,i,a)=>{ic.is(e)&&oK.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(ic.is(e)&&ic.is(i)&&oK.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{ic.is(e)&&oK.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new oU({...t,create:e("note")}),dragState:t=>new af(t)},{Vec2:oZ,Vec4:oQ}=a.n1,oq=class extends sW{constructor(){super(),this.type="parallel-channel",this.handles={topLeft:new aD,topMiddle:new ak,topRight:new aD,bottomLeft:new aD,bottomMiddle:new ak,bottomRight:new aD},this.middleLine=new sv,this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return aw.isCheck(t,"parallel-channel")}dragHandle(t,e,i,a){let{activeHandle:s,handles:o}=this;if(null==s)return;let{offset:r}=o[s].drag(e);o[s].toggleDragging(!0),("topMiddle"===s||"bottomMiddle"===s)&&(r.x=0);let n=[],l=a;switch(s){case"topLeft":case"bottomLeft":n=["topLeft","bottomLeft"];break;case"topMiddle":n=["topLeft","topRight"],r.y-=ak.HANDLE_SIZE/2,l=!1;break;case"topRight":case"bottomRight":n=["topRight","bottomRight"];break;case"bottomMiddle":n=["bottomLeft","bottomRight"],r.y-=ak.HANDLE_SIZE/2,l=!1}let h=eC(t,i),d=eC(t.bottom,i);if(!h||!d)return;let c={topLeft:oQ.start(h),topRight:oQ.end(h),bottomLeft:oQ.start(d),bottomRight:oQ.end(d)},p={vectors:{topLeft:c.topRight,bottomLeft:c.bottomRight,topRight:c.topLeft,bottomRight:c.bottomLeft},angle:t.snapToAngle},u=aO(c,r,i,{overflowContinuous:this.overflowContinuous,translateVectors:n,snap:l?p:void 0});t.start.x=u.topLeft.x,t.start.y=u.topLeft.y,t.end.x=u.topRight.x,t.end.y=u.topRight.y,t.height=u.topLeft.y-u.bottomLeft.y}getTranslatePointsVectors(t,e){let{bottomLeft:i,topLeft:a}=this.handles,s=i.getBBox().y-a.getBBox().y,o=oZ.add(t,oZ.from(0,s)),r=oZ.add(e,oZ.from(0,s));return{start:t,end:e,bottomStart:o,bottomEnd:r}}containsPoint(t,e){return super.containsPoint(t,e)||this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(t,e)}getNodeAtCoords(t,e){return this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(t,e)?"line":super.getNodeAtCoords(t,e)}updateLines(t,e,i,a,s,o){let{topLine:r,middleLine:n,bottomLine:l}=this,{lineDashOffset:h,stroke:d,strokeOpacity:c,strokeWidth:p}=t,u=t.getLineDash(),g={lineCap:t.getLineCap(),lineDash:u,lineDashOffset:h,stroke:d,strokeOpacity:c,strokeWidth:p};r.setProperties({...e,...g}),l.setProperties({...i,...g});let y=this.extendLine({x1:s.x1,y1:o.y1+(s.y1-o.y1)/2,x2:s.x2,y2:o.y2+(s.y2-o.y2)/2},t,a);n.setProperties({...y,lineDash:t.middle.lineDash??u,lineDashOffset:t.middle.lineDashOffset??h,stroke:t.middle.stroke??d,strokeOpacity:t.middle.strokeOpacity??c,strokeWidth:t.middle.strokeWidth??p,visible:t.middle.visible??!0})}updateHandles(t,e,i){let{handles:{topLeft:a,topMiddle:s,topRight:o,bottomLeft:r,bottomMiddle:n,bottomRight:l}}=this,h={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};a.update({...h,...oQ.start(e)}),o.update({...h,...oQ.end(e)}),r.update({...h,...oQ.start(i)}),l.update({...h,...oQ.end(i)}),s.update({...h,...oZ.sub(oQ.center(e),oZ.from(s.handle.width/2,s.handle.height/2))}),n.update({...h,...oZ.sub(oQ.center(i),oZ.from(n.handle.width/2,n.handle.height/2))})}updateText(t,e,i){this.text=this.updateNode(sS,this.text,!!t.text.label),sM(!0,e,i,t.text,t.strokeWidth,this.text,t.text.label)}getBackgroundPoints(t,e,i,a){let s=e.x1>e.x2,o=e.y1>e.y2,r=e.x1!==i.x1&&e.y1!==i.y1,n=e.x2!==i.x2&&e.y2!==i.y2,l=oZ.from(e);return t.extendEnd&&n&&l.push(oZ.from(s?a.x1:a.x2,o?a.y1:a.y2)),l.push(...oZ.from(i).reverse()),t.extendStart&&r&&l.push(oZ.from(s?a.x2:a.x1,o?a.y2:a.y1)),l}},{StateMachine:oJ,StateMachineProperty:o0,Debug:o1}=a.n1,o2=class extends oJ{constructor(t){let e=({point:e})=>{let i=new iR;i.set({start:e,end:e,height:0}),t.create(i)},i=({offset:e,context:i})=>{let{datum:a,snapping:s}=this;a&&(a.set({end:aL(e,i,s,a.start,a.snapToAngle)}),t.update())},a=()=>{this.node?.toggleHandles({topRight:!0}),t.update()},o=({point:e})=>{let{datum:i,node:a}=this,o=ew(i?.end.y),r=ew(i?.start.y),{y:n}=e;if(null==i||!(0,s.Et)(r)||!(0,s.Et)(o)||!(0,s.Et)(n))return;let l=o-(n??0);a?.toggleHandles(!0),t.validatePoint({x:i.start.x,y:r-l},{overflowContinuous:!0})&&t.validatePoint({x:i.end.x,y:e.y},{overflowContinuous:!0})&&(i.set({height:l}),t.recordAction("Create parallel-channel annotation"),t.showAnnotationOptions(),t.update())},r=()=>t.delete();super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},reset:oJ.parent},"waiting-first-render":{render:{target:"end",action:()=>{let{node:t}=this;t?.toggleActive(!0),t?.toggleHandles({topLeft:!0,topMiddle:!1,topRight:!1,bottomLeft:!1,bottomMiddle:!1,bottomRight:!1})}}},end:{hover:i,drag:i,click:{target:"height",action:a},dragEnd:{target:"height",action:a},reset:{target:oJ.parent,action:r},cancel:{target:oJ.parent,action:r}},height:{hover:({point:e})=>{let{datum:i,node:a}=this,o=ew(i?.end.y),r=ew(i?.start.y),{y:n}=e;if(null==i||!(0,s.Et)(r)||!(0,s.Et)(o)||!(0,s.Et)(n))return;let l=o-(n??0);a?.toggleHandles({bottomLeft:!0,bottomRight:!0}),t.validatePoint({x:i.start.x,y:r-l},{overflowContinuous:!0})&&t.validatePoint({x:i.end.x,y:e.y},{overflowContinuous:!0})&&(i.set({height:l}),t.update())},click:{target:oJ.parent,action:o},drag:{target:oJ.parent,action:o},reset:{target:oJ.parent,action:r},cancel:{target:oJ.parent,action:r}}}),this.debug=o1.create(!0,"annotations"),this.snapping=!1}};n([o0()],o2.prototype,"datum",2),n([o0()],o2.prototype,"node",2),n([o0()],o2.prototype,"snapping",2);var o4={type:"parallel-channel",datum:iR,scene:oq,isDatum:iR.is,translate:(t,e,i,a)=>{iR.is(e)&&oq.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(iR.is(e)&&iR.is(i)&&oq.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{iR.is(e)&&oq.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new o2({...t,create:e("parallel-channel")}),dragState:t=>new af(t)},o5=class extends sn{constructor(){super(),this.type="text",this.append([this.label,this.handle])}static is(t){return aw.isCheck(t,"text")}getHandleCoords(t,e){let i=aD.HANDLE_SIZE/2;return{x:e.x+i,y:e.y+2+i}}},o3=class extends su{createDatum(){return new iz}},o6={type:"text",datum:iz,scene:o5,isDatum:iz.is,translate:(t,e,i,a)=>{iz.is(e)&&o5.is(t)&&t.translate(e,i,a)},copy:(t,e,i,a)=>{if(iz.is(e)&&iz.is(i)&&o5.is(t))return t.copy(e,i,a)},update:(t,e,i)=>{iz.is(e)&&o5.is(t)&&t.update(e,i)},createState:(t,{createDatum:e})=>new o3({...t,create:e("text")}),dragState:t=>new af(t)},o8={[ob.type]:ob,[sB.type]:sB,[sz.type]:sz,[o4.type]:o4,[sU.type]:sU,[op.type]:op,[oe.type]:oe,[sr.type]:sr,[sy.type]:sy,[oX.type]:oX,[o6.type]:o6,[ov.type]:ov,[aQ.type]:aQ,[aK.type]:aK,[oG.type]:oG,[oj.type]:oj,[oV.type]:oV,[o$.type]:o$};function o9(t){for(let{isDatum:e}of Object.values(o8))if(e(t))return t}var{ActionOnSet:o7,ParallelStateMachine:rt,StateMachine:re,StateMachineProperty:ri,Debug:ra}=a.n1,rs=class extends rt{constructor(t){super(new ro(t=>{this.snapping=t}),new rr(()=>{this.node=null==this.active?void 0:t.node(this.active)}),new rn(t,e=>{this.active=e,this.datum=null==this.active?void 0:t.datum(this.active),this.node=null==this.active?void 0:t.node(this.active)})),this.snapping=!1}getActive(){return this.active}isActive(t){return t===this.active}};n([ri()],rs.prototype,"snapping",2),n([ri()],rs.prototype,"datum",2),n([ri()],rs.prototype,"node",2);var ro=class extends re{constructor(t){super("idle",{idle:{hover:({shiftKey:e})=>t(e),keyDown:({shiftKey:e})=>t(e),keyUp:({shiftKey:e})=>t(e),click:({shiftKey:e})=>t(e),drag:({shiftKey:e})=>t(e)},dragging:{},translating:{},"text-input":{}})}},rr=class extends re{constructor(t){super("idle",{idle:{onEnter:t,render:t},dragging:{onEnter:t,render:t},translating:{onEnter:t,render:t},"text-input":{render:t}})}},rn=class extends re{constructor(t,e){let i=()=>{null!=this.active&&t.delete(this.active),this.active=void 0,t.select()},a={createDatum:e=>i=>{t.create(e,i),this.active=t.selectLast()}},s={...t,delete:i,showTextInput:()=>{null!=this.active&&t.showTextInput(this.active)},deselect:()=>{let e=this.active;this.active=void 0,this.hovered=void 0,t.select(this.active,e)},showAnnotationOptions:()=>{null!=this.active&&t.showAnnotationOptions(this.active)}},o=Object.fromEntries(Object.entries(o8).map(([t,e])=>[t,e.createState(s,a)])),r=Object.fromEntries(Object.entries(o8).map(([e,i])=>[e,i.dragState(t,a)])),n=({colorPickerType:e,colorOpacity:i,color:a,opacity:s,isMultiColor:o})=>{this.datum&&("text-color"===e&&t.updateTextInputColor(a),iU(this.datum,e,i,a,s,o),t.update())},l=e=>{let{datum:i,node:a}=this;i&&a&&(ij(i)?(i.fontSize=e,t.updateTextInputFontSize(e)):iY(i)&&(i.text.fontSize=e),t.update())},h=e=>{let{node:i}=this;i&&"setTextInputBBox"in i&&(i.setTextInputBBox(e),t.update())},d=({textInputValue:e,bbox:i})=>{let{datum:a}=this;if(null!=i&&null!=e&&e.length>0){if(!ij(a))return;let s=is(a,e,i.width);a.set({text:s}),t.update(),t.recordAction(`Change ${a.type} annotation text`)}else t.delete(this.active),t.recordAction(`Delete ${a?.type} annotation`)},c=()=>{t.updateTextInputBBox(void 0)},p=()=>null!=this.active,u=()=>{let{active:t,datum:e}=this;return null!=t&&!!e&&iY(e)&&!e.locked},g=()=>null!=this.active&&!iF(this.datum);super("idle",{idle:{onEnter:()=>{t.select(this.active,this.active),this.hoverCoords&&(this.hovered=t.hoverAtCoords(this.hoverCoords,this.active,this.hovered))},hover:({offset:e})=>{this.hovered=t.hoverAtCoords(e,this.active,this.hovered),this.hoverCoords=e},translate:{guard:p,target:"translating",action:({translation:e})=>{t.startInteracting(),t.translate(this.active,e),t.update()}},copy:{guard:g,action:()=>{this.copied=t.copy(this.active)}},cut:{guard:g,action:()=>{this.copied=t.copy(this.active),i()}},paste:{guard:()=>null!=this.copied,action:()=>{t.paste(this.copied)}},selectLast:()=>{let e=this.active;this.active=t.selectLast(),t.select(this.active,e)},click:[{guard:()=>{let{active:t,hovered:e,datum:i}=this;return null!=t&&e===t&&!!i&&ij(i)&&!i.locked},target:"text-input"},{action:()=>{let e=this.active;this.active=this.hovered,t.select(this.active,e)}}],dblclick:{guard:u,action:({offset:e})=>{let i="text"===t.getNodeAtCoords(e,this.active)?"text":"line";t.showAnnotationSettings(this.active,void 0,i)}},dragStart:[{guard:()=>null!=this.hovered,target:"dragging",action:()=>{let e=this.active;this.active=this.hovered,t.select(this.active,e),t.startInteracting()}},{action:()=>{let e=this.active;this.active=this.hovered,t.select(this.active,e)}}],color:{guard:p,action:n},fontSize:{guard:p,action:l},lineProps:{guard:p,action:e=>{let i=o9(this.datum);i?.set(e),t.update(),t.recordAction(`Change ${i?.type} ${Object.entries(e).map(([t,e])=>`${t} to ${e}`).join(", ")}`)}},lineStyle:{guard:p,action:e=>{let{datum:i,node:a}=this;i&&a&&iH(i)&&(iK(i,e),t.update())}},lineText:{guard:p,action:e=>{let i=o9(this.datum);iY(i)&&(iW(i)&&"center"===e.position&&(e.position="inside"),i.text.set(e),t.update())}},updateTextInputBBox:{guard:p,action:h},toolbarPressSettings:{guard:u,action:e=>{t.showAnnotationSettings(this.active,e)}},reset:()=>{null!=this.active&&this.node?.toggleActive(!1),this.hovered=void 0,this.active=void 0,t.select(this.active,this.active),t.resetToIdle()},delete:()=>{null!=this.active&&(t.delete(this.active),iF(this.datum)||t.recordAction(`Delete ${this.datum?.type} annotation`))},deleteAll:()=>{t.deleteAll()},...o},dragging:{onEnter:(e,i)=>{if(null==this.active)return;let a=t.getAnnotationType(this.active);a&&(this.transitionRoot(a),this.transitionRoot("dragStart",i))},...r},translating:{onEnter:()=>{},translate:{guard:p,target:"translating",action:({translation:e})=>{t.startInteracting(),t.translate(this.active,e),t.update()}},translateEnd:{guard:p,target:"idle"},onExit:()=>{t.stopInteracting(),t.update(),t.recordAction("Translate annotation")}},"text-input":{onEnter:()=>{if(null==this.active)return;let e=o9(this.datum);e&&"getTextInputCoords"in e&&(t.startInteracting(),t.showTextInput(this.active),e.visible=!1,t.update())},updateTextInputBBox:{guard:p,action:h},resize:{target:"idle",action:d},click:{target:"idle",action:d},drag:{target:"idle",action:d},textInput:[{guard:a7,target:"idle",action:c},{guard:st,target:"idle",action:d}],color:{guard:p,action:n},fontSize:{guard:p,action:l},cancel:{target:"idle",action:c},onExit:()=>{t.stopInteracting(),t.hideTextInput();let e=this.active;if(this.active=this.hovered=void 0,t.select(this.active,e),null==e)return;let i=t.datum(e),a=t.node(e);i&&a&&(i.visible=!0)}}}),this.setActive=e,this.debug=ra.create(!0,"annotations"),this.snapping=!1}};n([o7({changeValue(t){this.setActive(t)}}),ri()],rn.prototype,"active",2),n([ri()],rn.prototype,"hovered",2),n([ri()],rn.prototype,"hoverCoords",2),n([ri()],rn.prototype,"copied",2),n([ri()],rn.prototype,"snapping",2),n([ri()],rn.prototype,"datum",2),n([ri()],rn.prototype,"node",2);var{ActionOnSet:rl,LayoutElement:rh,Menu:rd,PropertiesArray:rc,ToolbarButtonProperties:rp,Property:ru,ChartAxisDirection:rg}=a.n1,ry=class extends rp{};n([ru],ry.prototype,"value",2);var rf=class extends a.n1.BaseProperties{constructor(t){super(),this.ctx=t,this.enabled=!0,this.padding=20,this.buttons=new rc(ry),this.events=new a.n1.Listeners,this.annotationMenu=new rd(this.ctx,"annotations"),this.destroyFns=[],this.toolbar=t.sharedToolbar.getSharedToolbar("annotations");let e=this.onKeyDown.bind(this);this.toolbar.addListener("keydown",e),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onToolbarButtonPress.bind(this)),t.layoutManager.registerElement(rh.ToolbarLeft,this.onLayoutStart.bind(this)),()=>{this.toolbar.removeListener("keydown",e),this.toolbar.destroy()})}destroy(){for(let t of this.destroyFns)t()}addListener(t,e){return this.events.addListener(t,e)}toggleVisibility(t){this.toolbar.setHidden(!t)}toggleClearButtonEnabled(t){let e=this.buttons.findIndex(t=>"clear"===t.value);this.toolbar.toggleButtonEnabledByIndex(e,t)}resetButtonIcons(){for(let[t,e]of this.buttons.entries())switch(e.value){case"line-menu":this.updateButtonByIndex(t,{icon:"trend-line-drawing",value:"line-menu"});break;case"fibonacci-menu":this.updateButtonByIndex(t,{icon:"fibonacci-retracement-drawing",value:"fibonacci-menu"});break;case"text-menu":this.updateButtonByIndex(t,{icon:"text-annotation",value:"text-menu"});break;case"shape-menu":this.updateButtonByIndex(t,{icon:"arrow-drawing",value:"shape-menu"});break;case"measurer-menu":this.updateButtonByIndex(t,{icon:"measurer-drawing",value:"measurer-menu"})}}hideOverlays(){this.annotationMenu.hide()}clearActiveButton(){this.toolbar.clearActiveButton()}dispatch(t,e){this.events.dispatch(t,e)}onLayoutStart(t){this.enabled&&(this.toolbar.updateButtons(this.buttons),this.toolbar.layout(t.layoutBox,this.padding))}refreshButtonsEnabled(t){for(let[e,i]of this.buttons.entries())i&&this.toolbar.toggleButtonEnabledByIndex(e,t)}onToolbarButtonPress({event:t,button:e,buttonBounds:i}){let a=this.ctx.axisManager.getAxisContext(rg.Y)[0].scale;switch(e.value){case"clear":this.dispatch("pressed-clear");break;case"line-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsLineAnnotations",i1.filter(t=>!t.visible||t.visible(a)));break;case"fibonacci-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsFibonacciAnnotations",i2);break;case"text-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsTextAnnotations",i5);break;case"shape-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsShapeAnnotations",i3);break;case"measurer-menu":this.onToolbarButtonPressShowMenu(t,i,e.value,"toolbarAnnotationsMeasurerAnnotations",i6)}}onToolbarButtonPressShowMenu(t,e,i,a,s){this.dispatch("pressed-show-menu");let o=this.buttons.findIndex(t=>t.value===i);this.toolbar.toggleActiveButtonByIndex(o),this.annotationMenu.setAnchor({x:e.x+e.width+6,y:e.y}),this.annotationMenu.show({items:s,ariaLabel:this.ctx.localeManager.t(a),class:"ag-charts-annotations__toolbar-menu",sourceEvent:t.sourceEvent,onPress:this.onButtonPressMenuCreateAnnotation.bind(this,i)})}onButtonPressMenuCreateAnnotation(t,e){let i=this.buttons.findIndex(e=>e.value===t);this.updateButtonByIndex(i,{icon:e.icon}),this.dispatch("pressed-create-annotation",{annotation:e.value}),this.annotationMenu.hide()}onKeyDown({sourceEvent:t}){"Escape"===t.key&&this.dispatch("cancel-create-annotation")}updateButtonByIndex(t,e){let i=this.buttons.at(t);i&&(i.set({...i.toJson(),...e,value:e.value??i.value}),this.toolbar.updateButtonByIndex(t,{...i.toJson()}))}};n([ru,rl({changeValue(t){this.toolbar?.setHidden(!t)}})],rf.prototype,"enabled",2),n([ru],rf.prototype,"padding",2),n([ru],rf.prototype,"buttons",2);var{BaseModuleInstance:rm,InteractionState:rx,Property:rb,ChartAxisDirection:rv,getIconClassNames:rS}=a.n1,rk="ag-charts-annotations__axis-button",rD=class extends rm{constructor(t,e,i,a){super(),this.ctx=t,this.axisCtx=e,this.onButtonClick=i,this.seriesRect=a,this.enabled=!0,this.snap=!1,this.padding=0,this.button=this.setup(),this.toggleVisibility(!1),this.updateButtonElement(),this.snap=!!e.scale.bandwidth,t.domManager.addEventListener("focusin",({target:e})=>{let i=e instanceof HTMLElement?e:void 0;i&&t.domManager.contains(i,"series-area")||i===this.button.getElement()||this.hide()}),this.destroyFns.push(t.widgets.seriesWidget.addListener("drag-move",t=>this.onMouseDrag(t)),t.widgets.seriesWidget.addListener("mousemove",t=>this.onMouseMove(t)),t.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseLeave()),t.widgets.seriesDragInterpreter.addListener("click",t=>this.onClick(t)),t.chartEventManager.addListener("series-focus-change",()=>this.onKeyPress()),t.zoomManager.addListener("zoom-pan-start",()=>this.hide()),t.zoomManager.addListener("zoom-change",()=>this.hide()),()=>this.destroyElements(),()=>this.button.destroy())}update(t,e){this.seriesRect=t,this.padding=e}setup(){let t=new a.uB.ButtonWidget;return t.addClass(rk),t.setTabIndex(-1),t.setAriaLabel(this.ctx.localeManager.t("ariaLabelAddHorizontalLine")),this.ctx.widgets.seriesWidget.getElement().appendChild(t.getElement()),t}destroyElements(){this.ctx.domManager.removeChild("canvas-overlay",rk)}onMouseMove(t){this.ctx.interactionManager.isState(rx.Clickable)&&this.show(t)}onMouseDrag(t){this.ctx.interactionManager.isState(rx.AnnotationsMoveable)&&this.show(t)}onMouseLeave(){this.ctx.interactionManager.isState(rx.Clickable)&&this.hide()}onClick(t){this.ctx.interactionManager.isState(rx.Clickable)&&"touch"===t.device&&this.show(t)}show(t){let{sourceEvent:e,currentX:i,currentY:a}=t;if(!(this.enabled&&this.ctx.widgets.seriesWidget.getElement().contains(e.target)))return void this.hide();this.toggleVisibility(!0);let s=this.getButtonCoordinates({x:i,y:a});this.coords={x:s.x+this.button.clientWidth/2,y:s.y+this.button.clientHeight/2},this.updatePosition(s)}hide(){this.toggleVisibility(!1)}onKeyPress(){this.snap&&this.ctx.interactionManager.isState(rx.Default)||this.hide()}getButtonCoordinates({x:t,y:e}){let{axisCtx:{direction:i,position:a},seriesRect:s,snap:o,axisCtx:r,padding:n}=this,{clientWidth:l,clientHeight:h}=this.button,[d,c]=[0,s.height],[p,u]=[0,s.width];if(o&&(t=eL(eN(t-s.x,r),r)+s.x,e=eL(eN(e-s.y,r),r)+s.y),i===rv.X){let i=h-Math.max(0,n-5);t-=l/2,e="top"===a?d-h+i:c-i}else{let i=l-Math.max(0,n-9);t="left"===a?p-l+i:u-i,e-=h/2}return{x:t,y:e}}toggleVisibility(t){let{button:e}=this;if(null==e)return;let i=this.enabled&&t;this.toggleClass("-hidden",!i)}toggleClass(t,e){this.button.toggleClass(`${rk}-${t}`,e)}updatePosition({x:t,y:e}){this.button.getElement().style.transform=`translate(${Math.round(t)}px, ${Math.round(e)}px)`}updateButtonElement(){let{button:t}=this;t.addListener("click",()=>this.onButtonClick(this.coords)),t.addListener("touchend",()=>this.onButtonClick(this.coords)),t.addListener("drag-start",()=>{}),t.setInnerHTML(`<span class="${rS("zoom-in")} ${rk}-icon"></span>`)}};n([rb],rD.prototype,"enabled",2);var{Color:rM,DraggablePopover:rw,NativeWidget:rI,Vec2:rC,createButton:rA,createCheckbox:rL,createSelect:rT,createTextArea:rN,initRovingTabIndex:rO,getIconClassNames:rP,mapValues:rE}=a.n1,rR=class t extends rw{constructor(t,e){super(t,e),this.dragHandleDraggingClass="ag-charts-dialog__drag-handle--dragging",this.colorPicker=new iJ(this.ctx,{detached:!0}),this.destroyFns.push(t.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)))}showWithChildren(t,e){let i=super.showWithChildren(t,e);return i.classList.add("ag-charts-dialog"),i.setAttribute("role","dialog"),i.addEventListener("mousedown",t=>{t.target.classList?.contains("ag-charts-dialog__color-picker-button")||this.colorPicker.hide()}),i.addEventListener("keydown",this.onKeyDown.bind(this)),(0,s.zk)().requestAnimationFrame(()=>this.reposition()),this.colorPicker.attachTo(this),i}updatePosition(t){super.updatePosition(t);let{anchor:e,fallbackAnchor:i}=this.getColorPickerAnchors()??{};e&&this.colorPicker.setAnchor(e,i)}createTabs(t,e,i){let a=(0,s.n)("div","ag-charts-dialog__tabs"),o=rE(i,()=>(0,s.wW)()),r=rE(i,()=>(0,s.wW)());for(let[t,e]of(0,s.jO)(i))(0,s.Wp)(e.panel,{id:r[t],role:"tabpanel","aria-labelledby":o[t]});let n=t=>{for(let[e,a]of(0,s.jO)(i))a.panel.classList.toggle("ag-charts-dialog__tab-panel--active",e===t),d[e].classList.toggle("ag-charts-dialog__tab-button--active",e===t),(0,s.Bq)(d[e],"aria-selected",e===t),e===t&&a.onShow?.()},l=new rI((0,s.n)("div","ag-charts-dialog__header"));l.addListener("drag-start",t=>{let{sourceEvent:e}=t;e.target instanceof Element&&e.target.classList.contains("ag-charts-dialog__header")&&this.onDragStart(t)}),l.addListener("drag-move",t=>this.onDragMove(t)),l.addListener("drag-end",()=>this.onDragEnd());let h=new rz;this.setDragHandle(h);let d=rE(i,(t,e)=>rA({label:this.ctx.localeManager.t(t.label),onPress:()=>n(e)},{id:o[e],class:"ag-charts-dialog__tab-button",role:"tab","aria-controls":r[e]})),c=(0,s.n)("div","ag-charts-dialog__tab-list");(0,s.Wp)(c,{role:"tablist","aria-label":this.ctx.localeManager.t(t)}),c.append(...Object.values(d));let p=this.createHeaderCloseButton();return l.getElement().append(h.getElement(),c,p),a.append(l.getElement(),...Object.values(i).map(t=>t.panel)),n(e),rO({orientation:"horizontal",buttons:Object.values(d)}),{tabs:a,initialFocus:d[e]}}createTabPanel(){return(0,s.n)("div","ag-charts-dialog__tab-panel")}createInputGroupLine(){return(0,s.n)("div","ag-charts-dialog__input-group-line")}createRadioGroup({label:t,options:e,value:i,onChange:a}){let o=this.createInputGroup(t);(0,s.Wp)(o,{role:"radiogroup",tabindex:-1,"aria-label":this.ctx.localeManager.t(t)});let r="ag-charts-dialog__button--active",n=[];for(let t of e){let{icon:e,altText:s}=t,l=this.ctx.localeManager.t(s),h=rA({icon:e,altText:l,onPress:()=>{for(let t of Array.from(o.children))t.classList.remove(r),t.ariaChecked="false";h.classList.add(r),h.ariaChecked="true",a(t.value)}},{"aria-checked":t.value===i,class:"ag-charts-dialog__button",role:"radio",title:l});t.value===i&&h.classList.add(r),o.appendChild(h),n.push(h)}return rO({orientation:"horizontal",buttons:n}),o}createSelect({altText:t,label:e,options:i,value:a,onChange:s}){let o=this.createInputGroup(e),r=this.ctx.localeManager.t(t),n=rT({value:a,options:i,onChange:s},{class:"ag-charts-dialog__select","aria-label":r,title:r});return o.append(n),o}createTextArea({placeholder:t,value:e,onChange:i}){return rN({value:e,onChange:i},{placeholder:t?this.ctx.localeManager.t(t):void 0})}createCheckbox({label:t,checked:e,onChange:i}){let a=(0,s.wW)(),o=this.createInputGroup(t,{for:a}),r=rL({checked:e,onChange:i},{class:"ag-charts-dialog__checkbox",role:"switch",id:a});return o.append(r),o}createColorPicker({color:t,opacity:e,label:i,altText:a,onChange:s,onChangeHide:o,isMultiColor:r,hasMultiColorOption:n}){let l=this.createInputGroup(i),h=this.ctx.localeManager.t(a),d=rA({label:h,onPress:i=>{let{anchor:a,fallbackAnchor:l}=this.getColorPickerAnchors(d)??{};this.colorPicker.show({anchor:a,fallbackAnchor:l,color:t,opacity:e,isMultiColor:r,hasMultiColorOption:n,sourceEvent:i,onChange:(t,e,i,a)=>{d.style.setProperty("--color",t),d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color",a),s(t,e,i,a)},onChangeHide:o})}},{"aria-label":h,tabindex:0,class:"ag-charts-dialog__color-picker-button",title:h});if(r)d.classList.toggle("ag-charts-dialog__color-picker-button--multi-color");else if(t){let i=rM.fromString(t),a=new rM(i.r,i.g,i.b,e);d.style.setProperty("--color",a.toHexString())}return l.append(d),this.hideFns.push(()=>{this.colorPicker.hide()}),l}createHeaderCloseButton(){return rA({icon:"close",altText:this.ctx.localeManager.t("iconAltTextClose"),onPress:()=>this.hide()},{class:"ag-charts-dialog__close-button"})}createInputGroup(t,e){let i=(0,s.n)("div","ag-charts-dialog__input-group"),a=(0,s.n)("label","ag-charts-dialog__input-group-label");return a.innerText=this.ctx.localeManager.t(t),(0,s.Bq)(a,"for",e?.for),i.appendChild(a),i}onLayoutComplete(t){this.seriesRect=t.series.paddedRect,this.reposition()}onKeyDown(t){t.altKey||t.ctrlKey||t.metaKey||t.isComposing||"Escape"!==t.key||this.hide()}reposition(){let e,{seriesRect:i,ctx:a}=this,s=a.domManager.getBoundingClientRect(),o=this.getPopoverElement();if(!i||!o)return;let r=rC.from(0,i.y),n=rC.from(s.width,i.height),l=rC.from(o),h=rC.from(.5,1);if(i.width>1e3){let i=rC.sub(rC.add(r,rC.multiply(n,h)),rC.multiply(l,h));e=rC.sub(i,rC.from(0,t.offset))}else{let i=rC.sub(rC.add(r,n),l);e=rC.sub(i,t.offset)}this.updatePosition(e)}getColorPickerAnchors(t){if(t&&(this.colorPickerAnchorElement=t),!this.colorPickerAnchorElement)return;let e=this.colorPickerAnchorElement.getBoundingClientRect(),i=this.ctx.domManager.getBoundingClientRect(),a=rC.sub(rC.from(e.x,e.y),rC.from(i.left,i.top));return{anchor:rC.add(a,rC.from(0,e.height+5)),fallbackAnchor:rC.sub(a,rC.from(0,5))}}};rR.offset=60;var rB=rR,rz=class extends rI{constructor(){super((0,s.n)("div","ag-charts-dialog__drag-handle"));let t=new rI((0,s.n)("span",rP("drag-handle")));t.setAriaHidden(!0),this.addChild(t)}},{Listeners:rF,focusCursorAtEnd:r_}=a.n1,rW=class extends rB{constructor(t){super(t,"settings"),this.events=new rF,this.hideFns.push(()=>this.events.dispatch("hidden"))}addListener(t,e){return this.events.addListener(t,e)}show(t,e){let i=this.createLinearLineTab(t,e),a=this.createLinearTextTab(t,e),s="dialogHeaderLine";iW(t)?s="dialogHeaderChannel":iG(t)?s="dialogHeaderFibonacciRange":"date-range"===t.type?s="dialogHeaderDateRange":"price-range"===t.type?s="dialogHeaderPriceRange":"date-price-range"===t.type&&(s="dialogHeaderDatePriceRange");let{tabs:o,initialFocus:r}=this.createTabs("ariaLabelSettingsTabBar",e.initialSelectedTab,{line:{label:s,panel:i},text:{label:"dialogHeaderText",panel:a.panel,onShow:a.onShow}});e.initialFocus=r,this.showWithChildren([o],e).classList.add("ag-charts-dialog--annotation-settings")}createLinearLineTab(t,e){let i=this.createTabPanel(),a=this.createInputGroupLine(),s=this.createInputGroupLine(),o="isMultiColor"in t,r=this.createColorPickerInput("line-color",t.getDefaultColor("line-color"),t.getDefaultOpacity("line-color"),!!o&&t.isMultiColor,o,e.onChangeLineColor,e.onChangeHideLineColor),n=this.createStrokeWidthSelect(t.strokeWidth??2,e.onChangeLineStyleWidth),l=this.createLineStyleRadioGroup(t.lineStyle??"solid",e.onChangeLineStyleType);if(a.append(r),"background"in t){let i=this.createColorPickerInput("fill-color",t.getDefaultColor("fill-color"),t.getDefaultOpacity("fill-color"),!1,!1,e.onChangeFillColor,e.onChangeHideFillColor);a.append(i),s.append(n)}else"showFill"in t?(a.append(this.createCheckbox({label:"dialogInputShowFill",checked:t.showFill??!0,onChange:t=>e.onChangeLine({showFill:t})})),s.append(n)):a.append(n);return s.append(l),i.append(a,s),"bands"in t&&i.append(this.createFibonacciRatioSelect(t.bands??10,t=>e.onChangeLine({bands:t}))),"extendStart"in t&&"extendEnd"in t&&i.append(this.createCheckbox({label:iW(t)?"dialogInputExtendChannelStart":"dialogInputExtendLineStart",checked:t.extendStart??!1,onChange:t=>e.onChangeLine({extendStart:t})}),this.createCheckbox({label:iW(t)?"dialogInputExtendChannelEnd":"dialogInputExtendLineEnd",checked:t.extendEnd??!1,onChange:t=>e.onChangeLine({extendEnd:t})})),"extendAbove"in t&&"extendBelow"in t&&i.append(this.createCheckbox({label:"dialogInputExtendAbove",checked:t.extendAbove??!1,onChange:t=>e.onChangeLine({extendAbove:t})}),this.createCheckbox({label:"dialogInputExtendBelow",checked:t.extendBelow??!1,onChange:t=>e.onChangeLine({extendBelow:t})})),"extendLeft"in t&&"extendRight"in t&&i.append(this.createCheckbox({label:"dialogInputExtendLeft",checked:t.extendLeft??!1,onChange:t=>e.onChangeLine({extendLeft:t})}),this.createCheckbox({label:"dialogInputExtendRight",checked:t.extendRight??!1,onChange:t=>e.onChangeLine({extendRight:t})})),"reverse"in t&&"showFill"in t&&i.append(this.createCheckbox({label:"dialogInputReverse",checked:t.reverse??!1,onChange:t=>e.onChangeLine({reverse:t})})),i}createLinearTextTab(t,e){let i=this.createTabPanel(),a=this.createTextArea({placeholder:"inputTextareaPlaceholder",value:t.text.label,onChange:t=>e.onChangeText({label:t})}),s=this.createFontSizeSelect(t.text.fontSize,e.onChangeTextFontSize),o=this.createColorPickerInput("text-color",t.text.color,1,!1,!1,e.onChangeTextColor,e.onChangeHideTextColor),r="inside"===t.text.position?"center":t.text.position,n=this.createPositionRadioGroup(r??"top",t=>e.onChangeText({position:t})),l=this.createAlignmentRadioGroup(t.text.alignment??"center",t=>e.onChangeText({alignment:t})),h=this.createInputGroupLine();return h.append(s,o,n,l),i.append(a,h),{panel:i,onShow:()=>r_(a)}}createColorPickerInput(t,e,i,a,s,o,r){return this.createColorPicker({label:"fill-color"===t?"dialogInputFillColorPicker":"dialogInputColorPicker",altText:"fill-color"===t?"dialogInputFillColorPickerAltText":"dialogInputColorPickerAltText",color:e,opacity:i,isMultiColor:a,hasMultiColorOption:s,onChange:o,onChangeHide:r})}createStrokeWidthSelect(t,e){return this.createSelect({label:"dialogInputStrokeWidth",altText:"dialogInputStrokeWidthAltText",options:i8.map(({label:t,value:e})=>({label:t,value:`${e}`})),value:String(t),onChange:t=>e(Number(t))})}createFibonacciRatioSelect(t,e){return this.createSelect({label:"dialogInputFibonacciBands",altText:"dialogInputFibonacciBandsAltText",options:i4.map(({label:t,value:e})=>({label:t,value:`${e}`})),value:String(t),onChange:t=>e(Number(t))})}createLineStyleRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputLineStyle",options:[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],value:t,onChange:e})}createFontSizeSelect(t,e){return this.createSelect({label:"dialogInputFontSize",altText:"dialogInputFontSizeAltText",options:i7.map(({label:t,value:e})=>({label:t,value:String(e)})),value:String(t),onChange:t=>e(Number(t))})}createPositionRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputPosition",options:[{icon:"position-top",altText:"iconAltTextPositionTop",value:"top"},{icon:"position-center",altText:"iconAltTextPositionCenter",value:"center"},{icon:"position-bottom",altText:"iconAltTextPositionBottom",value:"bottom"}],value:t,onChange:e})}createAlignmentRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputAlign",options:[{icon:"align-left",altText:"iconAltTextAlignLeft",value:"left"},{icon:"align-center",altText:"iconAltTextAlignCenter",value:"center"},{icon:"align-right",altText:"iconAltTextAlignRight",value:"right"}],value:t,onChange:e})}};function rG(t){return t.gridPadding+t.seriesAreaPadding+t.tickSize+t.label.spacing}var{ChartUpdateType:rj,InteractionState:rV,ObserveChanges:r$,PropertiesArray:rH,Property:rY,ChartAxisDirection:rK,Vec2:rU,keyProperty:rX,valueProperty:rZ,Selection:rQ,BBox:rq}=a.n1,rJ=class t extends a.n1.BaseModuleInstance{constructor(e){super(),this.ctx=e,this.enabled=!0,this.toolbar=new rf(this.ctx),this.optionsToolbar=new ac(this.ctx,()=>{let t=this.state.getActive();if(null!=t)return o9(this.annotationData.at(t))}),this.axesButtons=new t5,this.snap=!1,this.data=void 0,this.xKey=void 0,this.volumeKey=void 0,this.annotationData=new rH(t.createAnnotationDatum),this.defaults=new iZ,this.container=new a.n1.Group({name:"static-annotations"}),this.annotations=new rQ(this.container,this.createAnnotationScene.bind(this)),this.settingsDialog=new rW(this.ctx),this.textInput=new t1(this.ctx),this.postUpdateFns=[],this.state=this.setupStateMachine(),this.setupListeners(),this.setupDOM(),this.ctx.historyManager.addMementoOriginator(e.annotationManager),this.ctx.historyManager.addMementoOriginator(this.defaults),this.textInput.setKeyDownHandler(this.onTextInput.bind(this))}setupStateMachine(){let{ctx:t}=this;return new rs({resetToIdle:()=>{t.domManager.updateCursor("annotations"),this.popAnnotationState(rV.Annotations),this.hideOverlays(),this.optionsToolbar.hide(),this.deleteEphemeralAnnotations(),this.update()},hoverAtCoords:(e,i,a)=>{let s;return this.annotations.each((t,a,o)=>{let r=t.containsPoint(e.x,e.y);r&&(s??(s=o)),t.toggleHovered(r||i===o)}),null!=s?t.tooltipManager.suppressTooltip("annotations"):this.isAnnotationState()||t.tooltipManager.unsuppressTooltip("annotations"),this.ctx.domManager.updateCursor("annotations",null==s?void 0:this.annotations.at(s)?.getCursor()),s!==a&&this.update(),s},getNodeAtCoords:(t,e)=>{let i=this.annotations.at(e);if(i)return i.getNodeAtCoords(t.x,t.y)},translate:(t,e)=>{let i=this.annotations.at(t),a=o9(this.annotationData.at(t));if(i&&a)return this.translateNode(i,a,e)},copy:t=>{let e=this.annotations.at(t),i=o9(this.annotationData.at(t));if(e&&i)return this.createAnnotationDatumCopy(e,i)},paste:t=>{this.createAnnotation(t.type,t,!1),this.postUpdateFns.push(()=>{this.state.transitionAsync("selectLast"),this.state.transitionAsync("copy")})},select:(t,e)=>{let{annotations:i,optionsToolbar:a,toolbar:s}=this;this.hideOverlays(),s.clearActiveButton(),s.resetButtonIcons();let o=null!=t?i.at(t):null,r=null!=e?i.at(e):null;(r!==o||null==o)&&(r?.toggleActive(!1),a.hide(),o?(this.pushAnnotationState(rV.AnnotationsSelected),o.toggleActive(!0),a.updateButtons(this.annotationData.at(t)),this.postUpdateFns.push(()=>{a.show(),a.setAnchorScene(o)})):(this.popAnnotationState(rV.AnnotationsSelected),this.popAnnotationState(rV.Annotations)),this.deleteEphemeralAnnotations(),this.update())},selectLast:()=>(this.pushAnnotationState(rV.AnnotationsSelected),this.annotationData.length-1),startInteracting:()=>{this.pushAnnotationState(rV.Annotations)},stopInteracting:()=>{this.popAnnotationState(rV.Annotations)},create:(t,e)=>{this.createAnnotation(t,e)},delete:t=>{this.annotationData.splice(t,1)},deleteAll:()=>{this.annotationData.splice(0,this.annotationData.length)},validatePoint:(t,e)=>{let i=this.getAnnotationContext();return!i||s2(i,t,e)},getAnnotationType:t=>(function(t){for(let e of t6)if(e===t)return e})(this.annotationData[t].type),datum:t=>this.annotationData.at(t),node:t=>this.annotations.at(t),recordAction:t=>{this.recordActionAfterNextUpdate(t)},update:()=>{this.postUpdateFns.push(()=>{let t=this.state.getActive(),e=null!=t?this.annotations.at(t):null;null!=e&&this.optionsToolbar.setAnchorScene(e)}),this.update()},showTextInput:t=>{let e=o9(this.annotationData.at(t));if(!this.annotations.at(t)||!e||!("getTextInputCoords"in e)||!("getTextPosition"in e))return;let i={color:e.color,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight,placeholderColor:e.getPlaceholderColor()},a=this.getAnnotationContext();this.textInput.show({styles:i,layout:{getTextInputCoords:t=>rU.add(e.getTextInputCoords(a,t),rU.required(this.seriesRect)),getTextPosition:()=>e.getTextPosition(),alignment:e.alignment,textAlign:e.textAlign,width:e.width},text:e.text,placeholderText:e.placeholderText,onChange:(t,e)=>{this.state.transition("updateTextInputBBox",e)}}),this.ctx.domManager.updateCursor("annotations")},hideTextInput:()=>{this.textInput.hide()},updateTextInputColor:t=>{this.textInput.updateColor(t)},updateTextInputFontSize:t=>{let e=this.textInput.updateFontSize(t);this.state.transition("updateTextInputBBox",e)},updateTextInputBBox:t=>{this.state.transition("updateTextInputBBox",t)},showAnnotationOptions:t=>{let e=this.annotations.at(t);!e||iF(this.annotationData.at(t))||(this.optionsToolbar.updateButtons(this.annotationData.at(t)),this.optionsToolbar.show(),this.optionsToolbar.setAnchorScene(e))},showAnnotationSettings:(t,e,i="line")=>{let a=this.annotationData.at(t);if(!i_(a)&&!iW(a)&&!iV(a)||iF(a))return;let s=t=>(e,i,s,o)=>{this.setColorAndDefault(a.type,t,e,i,s,o),this.optionsToolbar.updateColorPickerColor(t,i,s,o)},o=t=>()=>{this.recordActionAfterNextUpdate(`Change ${a.type} ${t} to ${a.getDefaultColor(t)}`,["annotations","defaults"]),this.update()},r={initialSelectedTab:i,ariaLabel:this.ctx.localeManager.t("ariaLabelAnnotationSettingsDialog"),sourceEvent:e,onChangeLine:t=>{this.state.transition("lineProps",t),null!=t.bands&&this.defaults.setDefaultFibonacciOptions(a.type,"bands",t.bands),null!=t.reverse&&this.defaults.setDefaultFibonacciOptions(a.type,"reverse",t.reverse),null!=t.showFill&&this.defaults.setDefaultFibonacciOptions(a.type,"showFill",t.showFill)},onChangeText:t=>{this.state.transition("lineText",t),t.alignment&&this.defaults.setDefaultLineTextAlignment(a.type,t.alignment),t.position&&this.defaults.setDefaultLineTextPosition(a.type,t.position),this.recordActionAfterNextUpdate(`Change ${a.type} text ${Object.keys(t).map(e=>`${e} to ${t[e]}`).join(", ")}`)},onChangeFillColor:s("fill-color"),onChangeHideFillColor:o("fill-color"),onChangeLineColor:s("line-color"),onChangeHideLineColor:o("line-color"),onChangeLineStyleType:t=>{this.setLineStyleTypeAndDefault(a.type,t),this.optionsToolbar.updateLineStyleType(i9.find(e=>e.value===t)??i9[0])},onChangeLineStyleWidth:t=>{this.setLineStyleWidthAndDefault(a.type,t),this.optionsToolbar.updateStrokeWidth({strokeWidth:t,value:t,label:String(t)})},onChangeTextColor:s("text-color"),onChangeHideTextColor:o("text-color"),onChangeTextFontSize:t=>{this.setFontSizeAndDefault(a.type,t)}};this.settingsDialog.show(a,r)}})}setupListeners(){let{ctx:t,optionsToolbar:e,settingsDialog:i,toolbar:a}=this,{seriesWidget:s,seriesDragInterpreter:o,chartWidget:r}=t.widgets;this.destroyFns.push(o.addListener("click",this.hoverTouchPreHandler.bind(this)),o.addListener("drag-start",this.hoverTouchPreHandler.bind(this)),o.addListener("drag-move",this.dragMoveTouchPreHandler.bind(this)),o.addListener("mousemove",this.onHover.bind(this)),o.addListener("click",this.onClick.bind(this)),o.addListener("dblclick",this.onDoubleClick.bind(this)),o.addListener("drag-start",this.onDragStart.bind(this)),o.addListener("drag-move",this.onDrag.bind(this)),o.addListener("drag-end",this.onDragEnd.bind(this)),s.addListener("keydown",this.onKeyDown.bind(this)),s.addListener("keyup",this.onKeyUp.bind(this)),r.addListener("click",this.onCancel.bind(this)),t.annotationManager.addListener("restore-annotations",this.onRestoreAnnotations.bind(this)),t.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),t.updateService.addListener("pre-scene-render",this.onPreRender.bind(this)),t.zoomManager.addListener("zoom-change",()=>this.onResize()),t.domManager.addListener("resize",()=>this.onResize()),a.addListener("cancel-create-annotation",()=>{this.cancel(),this.reset(),this.update()}),a.addListener("pressed-create-annotation",({annotation:t})=>{this.cancel(),this.pushAnnotationState(rV.Annotations),this.state.transition(t),this.update()}),a.addListener("pressed-clear",()=>{this.clear(),this.recordActionAfterNextUpdate("Clear all")}),a.addListener("pressed-show-menu",()=>{this.cancel(),this.reset()}),a.addListener("pressed-unrelated",()=>{this.reset()}),e.addListener("pressed-delete",()=>{this.cancel(),this.delete(),this.reset()}),e.addListener("pressed-settings",({sourceEvent:t})=>{this.state.transition("toolbarPressSettings",t)}),e.addListener("pressed-lock",()=>{this.update()}),e.addListener("hid-overlays",()=>{this.settingsDialog.hide()}),e.addListener("saved-color",({type:t,colorPickerType:e,color:i})=>{this.recordActionAfterNextUpdate(`Change ${t} ${e} to ${i}`,["annotations","defaults"])}),e.addListener("updated-color",({type:t,colorPickerType:e,colorOpacity:i,color:a,opacity:s,isMultiColor:o})=>{this.setColorAndDefault(t,e,i,a,s,o)}),e.addListener("updated-font-size",({type:t,fontSize:e})=>{this.setFontSizeAndDefault(t,e)}),e.addListener("updated-line-style",({type:t,lineStyleType:e})=>{this.setLineStyleTypeAndDefault(t,e)}),e.addListener("updated-line-width",({type:t,strokeWidth:e})=>{this.setLineStyleWidthAndDefault(t,e)}),i.addListener("hidden",()=>{this.optionsToolbar.clearActiveButton()}))}setupDOM(){let{ctx:t,toolbar:e}=this;this.destroyFns.push(t.annotationManager.attachNode(this.container),()=>t.domManager.removeStyles(rk),()=>e.destroy())}async processData(t){if(!this.enabled||null==this.data||null==this.xKey||null==this.volumeKey)return;let e=[rX(this.xKey,void 0,{id:"date"}),rZ(this.volumeKey,"number",{id:"volume"})],{dataModel:i,processedData:a}=await t.request("annotations",this.data,{props:e});this.dataModel=i,this.processedData=a}createAnnotationScene(t){if(t.type in o8)return new o8[t.type].scene;throw Error(`AG Charts - Cannot create annotation scene of type [${t.type}], expected one of [${Object.keys(o8)}], ignoring.`)}static createAnnotationDatum(t){if(t.type in o8)return new o8[t.type].datum().set(t);throw Error(`AG Charts - Cannot create annotation datum of unknown type [${t.type}], expected one of [${Object.keys(o8)}], ignoring.`)}createAnnotation(t,e,i=!0){if(this.annotationData.push(e),i){let i=this.ctx.annotationManager.getAnnotationTypeStyles(t);i&&e.set(i),this.defaults.applyDefaults(e)}this.injectDatumDependencies(e),this.update()}injectDatumDependencies(t){"setLocaleManager"in t&&t.setLocaleManager(this.ctx.localeManager),"getVolume"in t&&(t.getVolume=this.getDatumRangeVolume.bind(this))}getDatumRangeVolume(t,e){let{dataModel:i,processedData:a}=this,o=ew(t),r=ew(e);if(!(0,s.vd)(o)||!(0,s.vd)(r)||!i||!a||null==this.volumeKey)return;o>r&&([o,r]=[r,o]);let n=i.resolveKeysById({id:"annotations"},"date",a),l=i.resolveColumnById({id:"annotations"},"volume",a),h=0;for(let t=0;t<a.input.count;t++){let e=n[t];(0,s.vd)(e)&&e>=o&&e<=r&&(h+=l[t])}return h}translateNode(t,e,i){let a=this.getAnnotationConfig(e),s=this.getAnnotationContext();s&&a.translate(t,e,i,s)}createAnnotationDatumCopy(t,e){let i=this.getAnnotationConfig(e),a=new i.datum;a.set(e.toJson());let s=this.getAnnotationContext();if(s)return i.copy(t,e,a,s)}getAnnotationConfig(t){if(t.type in o8)return o8[t.type];throw Error(`AG Charts - Cannot get annotation config of unknown type [${t.type}], expected one of [${Object.keys(o8)}], ignoring.`)}onRestoreAnnotations(t){this.enabled&&(this.clear(),this.annotationData.set(t.annotations),this.postUpdateFns.push(()=>{this.ctx.annotationManager.fireChangedEvent()}),this.update())}onLayoutComplete(t){let e=t.series.paddedRect;for(let i of(this.seriesRect=e,this.container.setClipRect(e),t.axes??[]))i.direction===a.n1.ChartAxisDirection.X?this.xAxis=this.getAxis(i,e,this.xAxis?.button):this.yAxis=this.getAxis(i,e,this.yAxis?.button);this.showAnnotations()?this.animateAnnotations({from:0,to:1,phase:"trailing"}):this.animateAnnotations({from:1,to:0,phase:"remove"})}showAnnotations(){if(!this.yAxis||!this.xAxis)return!1;let t=this.ctx.chartService.series.some(t=>t.hasData),e=this.yAxis.context.seriesIds().some(t=>{let e=this.ctx.chartService.series.find(e=>e.id===t);return e?.visible});return t&&e}animateAnnotations({from:t,to:e,phase:i}){let{annotations:a}=this;this.ctx.animationManager?.animate({from:t,to:e,id:"chart-annotations",phase:i,groupId:"opacity",onUpdate(t){a.each(e=>{e.opacity=t,"setAxisLabelOpacity"in e&&e.setAxisLabelOpacity(t)})},onStop(){a.each(t=>{t.opacity=e,"setAxisLabelOpacity"in t&&t.setAxisLabelOpacity(e)})}})}onPreRender(){this.updateAnnotations(),this.state.transition("render")}getAxis(t,e,i){let a=this.ctx.axisManager.getAxisContext(t.direction)[0],{position:s="bottom",direction:o}=a,r=t.gridPadding+t.seriesAreaPadding,n=new rq(0,0,e.width,e.height).grow(r,s),l=a.direction===rK.X?"vertical":"horizontal",{axesButtons:h,snap:d}=this;if(this.enabled&&h.enabled&&("xy"===h.axes||h.axes===o)){i??(i=new rD(this.ctx,{...a,snapToGroup:d},t=>this.onAxisButtonClick(t,l),e));let s=rG(t);i.update(e,s)}else i?.destroy(),i=void 0;return{layout:t,context:a,bounds:n,button:i}}recordActionAfterNextUpdate(t,e=["annotations"]){let{defaults:i,ctx:{annotationManager:a,historyManager:s}}=this,o=e.map(t=>"defaults"===t?i:a);this.postUpdateFns.push(()=>{s.record(t,...o),a.fireChangedEvent()})}setColorAndDefault(t,e,i,a,s,o){this.state.transition("color",{colorPickerType:e,colorOpacity:i,color:a,opacity:s,isMultiColor:o}),this.defaults.setDefaultColor(t,e,i,a,s,o)}setFontSizeAndDefault(t,e){this.state.transition("fontSize",e),this.defaults.setDefaultFontSize(t,e),this.recordActionAfterNextUpdate(`Change ${t} font size to ${e}`,["annotations","defaults"])}setLineStyleTypeAndDefault(t,e){this.state.transition("lineStyle",{type:e}),this.defaults.setDefaultLineStyleType(t,e),this.recordActionAfterNextUpdate(`Change ${t} line style to ${e}`,["annotations","defaults"])}setLineStyleWidthAndDefault(t,e){this.state.transition("lineStyle",{strokeWidth:e}),this.defaults.setDefaultLineStyleWidth(t,e),this.recordActionAfterNextUpdate(`Change ${t} stroke width to ${e}`,["annotations","defaults"])}updateAnnotations(){let{annotationData:t,annotations:e,seriesRect:i,ctx:{annotationManager:a}}=this,s=this.getAnnotationContext();if(!i||!s)return;a.updateData(t.toJson().filter(t=>!iF(t)));let o=this.showAnnotations();this.toolbar.refreshButtonsEnabled(o),this.toolbar.toggleClearButtonEnabled(t.length>0&&o),e.update(t??[],void 0,t=>t.id).each((t,e)=>{if(!o){t.visible=!1,"setAxisLabelVisible"in t&&t.setAxisLabelVisible(!1);return}"setAxisLabelVisible"in t&&t.setAxisLabelVisible(!0),this.injectDatumDependencies(e);for(let{update:i}of Object.values(o8))i(t,e,s)}),this.postUpdateFns.forEach(t=>t()),this.postUpdateFns=[]}getAnnotationContext(){let{seriesRect:t,xAxis:e,yAxis:i,snap:a}=this;if(t&&e&&i)return{seriesRect:t,xAxis:{...e.context,bounds:e.bounds,labelPadding:rG(e.layout),snapToGroup:a},yAxis:{...i.context,bounds:i.bounds,labelPadding:rG(e.layout),snapToGroup:a}}}onHover(t){let{state:e}=this,i=this.getAnnotationContext();if(!i)return;let a=t.sourceEvent.shiftKey,s=rU.from(t),o=eT(s,i);e.transition("hover",{offset:s,point:o,shiftKey:a,context:i})}onClick(t){let{state:e}=this,i=this.getAnnotationContext();if(!i)return;let a=t.sourceEvent.shiftKey,s=eT(rU.from(t),i),o=this.textInput.getValue(),r=this.textInput.getBBox();e.transition("click",{point:s,shiftKey:a,textInputValue:o,bbox:r})}onDoubleClick(t){let{state:e}=this;if(!this.getAnnotationContext())return;let i=rU.from(t);e.transition("dblclick",{offset:i})}onAxisButtonClick(t,e){this.cancel(),this.reset();let i=this.getAnnotationContext();if(!this.annotationData||!i)return;let{state:a}=this;if(this.pushAnnotationState(rV.Annotations),a.transition("horizontal"===e?"horizontal-line":"vertical-line"),this.optionsToolbar.hide(),!t)return;let s=eT(t,i);s2(i,s)&&(a.transition("click",{point:s,shiftKey:!1}),this.update())}onResize(){let t=this.textInput.getValue(),e=this.textInput.getBBox();this.state.transition("resize",{textInputValue:t,bbox:e})}hoverTouchPreHandler(t){"touch"===t.device&&this.onHover(t)}dragMoveTouchPreHandler(t){"touch"===t.device&&this.ctx.interactionManager.isState(rV.AnnotationsSelected)&&t.sourceEvent.preventDefault()}onDragStart(t){if(!this.ctx.interactionManager.isState(rV.AnnotationsDraggable))return;let e=this.getAnnotationContext();if(!e)return;let i=rU.from(t),a=eT(i,e),s=this.textInput.getValue(),o=this.textInput.getBBox();this.state.transition("dragStart",{context:e,offset:i,point:a,textInputValue:s,bbox:o})}onDrag(t){if(!this.ctx.interactionManager.isState(rV.AnnotationsDraggable))return;let e=this.getAnnotationContext();if(!e)return;let i=rU.from(t),a=eT(i,e),s=t.sourceEvent.shiftKey,o=this.textInput.getValue(),r=this.textInput.getBBox();this.state.transition("drag",{context:e,offset:i,point:a,shiftKey:s,textInputValue:o,bbox:r})}onDragEnd(){this.state.transition("dragEnd")}onCancel(t){let{sourceEvent:e}=t??{};e?.currentTarget===e?.target&&(this.cancel(),this.reset())}onDelete(){this.textInput.isVisible()||(this.cancel(),this.delete(),this.reset(),this.update())}onTextInput(t){let{state:e}=this,i=this.getAnnotationContext();if(!i)return;let{key:a,shiftKey:s}=t,o=this.textInput.getValue(),r=this.textInput.getBBox();e.transition("textInput",{key:a,shiftKey:s,textInputValue:o,bbox:r,context:i})}onKeyDown(t){let{state:e}=this,i=this.getAnnotationContext();if(!i)return;let{sourceEvent:a}=t,{shiftKey:s,ctrlKey:o,metaKey:r}=a,n=o||s;e.transition("keyDown",{shiftKey:s,context:i});let l={x:0,y:0},h=Math.max(i?.xAxis.scale.bandwidth??0,n?10:1),d=Math.max(i?.yAxis.scale.bandwidth??0,n?10:1);switch(a.key){case"ArrowDown":l.y=d;break;case"ArrowUp":l.y=-d;break;case"ArrowLeft":l.x=-h;break;case"ArrowRight":l.x=h;break;case"Escape":this.onCancel();return;case"Backspace":case"Delete":this.onDelete();return}if((l.x||l.y)&&(e.transition("translate",{translation:l}),a.stopPropagation(),a.preventDefault()),o||r)switch(a.key){case"c":e.transition("copy");return;case"x":e.transition("cut"),this.recordActionAfterNextUpdate("Cut annotation");return;case"v":e.transition("paste"),this.recordActionAfterNextUpdate("Paste annotation");return}}onKeyUp(t){let{shiftKey:e}=t.sourceEvent,i=this.getAnnotationContext();i&&(this.state.transition("keyUp",{shiftKey:e,context:i}),this.state.transition("translateEnd"))}clear(){this.cancel(),this.deleteAll(),this.reset()}reset(){this.state.transition("reset")}cancel(){this.state.transition("cancel")}delete(){this.state.transition("delete")}deleteAll(){this.state.transition("deleteAll")}deleteEphemeralAnnotations(){for(let[t,e]of this.annotationData.entries())iF(e)&&this.annotationData.splice(t,1)}hideOverlays(){this.settingsDialog.hide(),this.toolbar.hideOverlays(),this.optionsToolbar.hideOverlays()}pushAnnotationState(t){this.ctx.interactionManager.pushState(t),this.ctx.tooltipManager.suppressTooltip("annotations")}popAnnotationState(t){this.ctx.interactionManager.popState(t),this.ctx.tooltipManager.unsuppressTooltip("annotations")}isAnnotationState(){return this.ctx.interactionManager.isState(rV.Annotations)||this.ctx.interactionManager.isState(rV.AnnotationsSelected)}update(t=rj.PRE_SCENE_RENDER){this.ctx.updateService.update(t)}};n([r$((t,e,i)=>{let{ctx:{annotationManager:a,stateManager:s}}=t;e!==i&&(t.toolbar?.toggleVisibility(!!e),!1===i&&!0===e?s.restoreState(a):!1===e&&t.clear())}),rY],rJ.prototype,"enabled",2),n([rY],rJ.prototype,"toolbar",2),n([rY],rJ.prototype,"optionsToolbar",2),n([rY],rJ.prototype,"axesButtons",2),n([rY],rJ.prototype,"snap",2);var{FONT_SIZE_RATIO:r0,ThemeSymbols:r1}=a.n1,r2={stroke:{$ref:"foregroundColor"},strokeOpacity:1,strokeWidth:2},r4={fill:r1.DEFAULT_ANNOTATION_HANDLE_FILL,strokeOpacity:1,strokeWidth:2},r5={color:{$ref:"backgroundColor"},fontSize:{$rem:[r0.LARGE]},fontFamily:{$ref:"fontFamily"}},r3={...r5,enabled:!0,fill:{$ref:"foregroundColor"},fontSize:{$ref:"fontSize"}},r6={...r5,textAlign:"left"},r8={...r5,position:"top",alignment:"center",color:{$ref:"textColor"}},r9={...r5,position:"top",alignment:"center",color:{$ref:"textColor"}},r7={...r5,fontSize:{$ref:"fontSize"},color:r1.DEFAULT_ANNOTATION_STATISTICS_COLOR,fill:r1.DEFAULT_ANNOTATION_STATISTICS_FILL,stroke:r1.DEFAULT_ANNOTATION_STATISTICS_STROKE,strokeWidth:1,divider:{stroke:r1.DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,strokeWidth:1,strokeOpacity:.5}},nt={...r2,background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...r4},text:{...r8},statistics:{...r7}},ne={type:"root",optionsKey:"annotations",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new rJ(t),themeTemplate:{annotations:{enabled:!1,line:{...r2,handle:{...r4},text:{...r8}},"horizontal-line":{...r2,handle:{...r4},axisLabel:{...r3},text:{...r8}},"vertical-line":{...r2,handle:{...r4},axisLabel:{...r3},text:{...r8}},"disjoint-channel":{...r2,background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...r4},text:{...r9}},"parallel-channel":{...r2,middle:{lineDash:[6,5],strokeWidth:1},background:{fill:{$ref:"foregroundColor"},fillOpacity:.075},handle:{...r4},text:{...r9}},"fibonacci-retracement":{...r2,strokes:r1.DEFAULT_FIBONACCI_STROKES,rangeStroke:{$ref:"foregroundColor"},handle:{...r4},text:{...r8,position:"center"},label:{...r5,color:void 0,fontSize:{$round:[{$mul:[{$ref:"fontSize"},10/12]}]}}},"fibonacci-retracement-trend-based":{...r2,strokes:r1.DEFAULT_FIBONACCI_STROKES,rangeStroke:{$ref:"foregroundColor"},handle:{...r4},text:{...r8,position:"center"},label:{...r5,color:void 0,fontSize:{$round:[{$mul:[{$ref:"fontSize"},10/12]}]}}},callout:{...r2,...r6,color:{$ref:"textColor"},handle:{...r4},fill:{$ref:"foregroundColor"},fillOpacity:.075},comment:{...r6,fontWeight:700,handle:{...r4},fill:{$ref:"foregroundColor"}},note:{...r6,color:r1.DEFAULT_TEXTBOX_COLOR,fill:r1.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_COLOR,stroke:{$ref:"backgroundColor"},strokeWidth:1,strokeOpacity:1,handle:{...r4},background:{fill:r1.DEFAULT_TEXTBOX_FILL,stroke:r1.DEFAULT_TEXTBOX_STROKE,strokeWidth:1}},text:{...r6,color:{$ref:"textColor"},handle:{...r4}},arrow:{...r2,handle:{...r4},text:{...r8}},"arrow-up":{fill:{$palette:"up.fill"},handle:{...r4,stroke:{$ref:"foregroundColor"}}},"arrow-down":{fill:{$palette:"down.fill"},handle:{...r4,stroke:{$ref:"foregroundColor"}}},"date-range":{...nt},"price-range":{...nt},"date-price-range":{...nt},"quick-date-price-range":{up:{...r2,fill:r1.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2,handle:{...r4},statistics:{...r7,color:"#fff",fill:r1.DEFAULT_FINANCIAL_CHARTS_ANNOTATION_BACKGROUND_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...r2,stroke:r1.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,fill:r1.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,fillOpacity:.2,handle:{...r4,stroke:r1.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE},statistics:{...r7,color:"#fff",fill:r1.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}},axesButtons:{},toolbar:{buttons:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextAnnotations",value:"text-menu"},{icon:"trend-line-drawing",tooltip:"toolbarAnnotationsLineAnnotations",value:"line-menu"},{icon:"arrow-drawing",tooltip:"toolbarAnnotationsShapeAnnotations",value:"shape-menu"},{icon:"delete",tooltip:"toolbarAnnotationsClearAll",value:"clear"}],padding:{$ref:"padding"}},optionsToolbar:{buttons:[{icon:"text-annotation",tooltip:"toolbarAnnotationsTextColor",value:"text-color"},{icon:"line-color",tooltip:"toolbarAnnotationsLineColor",value:"line-color"},{icon:"fill-color",tooltip:"toolbarAnnotationsFillColor",value:"fill-color"},{tooltip:"toolbarAnnotationsTextSize",value:"text-size"},{tooltip:"toolbarAnnotationsLineStrokeWidth",value:"line-stroke-width"},{icon:"line-style-solid",tooltip:"toolbarAnnotationsLineStyle",value:"line-style-type"},{icon:"settings",tooltip:"toolbarAnnotationsSettings",value:"settings"},{icon:"unlocked",tooltip:"toolbarAnnotationsLock",ariaLabel:"toolbarAnnotationsLock",checkedOverrides:{icon:"locked",tooltip:"toolbarAnnotationsUnlock"},value:"lock"},{icon:"delete",tooltip:"toolbarAnnotationsDelete",value:"delete"}]}}}},{BaseProperties:ni,ObserveChanges:na,ProxyProperty:ns,Property:no,calculatePlacement:nr}=a.n1,nn=class extends ni{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),this.onLoad?.())},this.imageElement=(0,s.n)("img"),this.imageElement.onload=this.onImageLoad,this.node=new a.n1.Image(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(t,e){this.containerWidth=t,this.containerHeight=e;let i=nr(this.imageElement.width,this.imageElement.height,{width:t,height:e},this);return this.node.setProperties(this.complete?{visible:!0,opacity:this.opacity,...i}:{visible:!1}),i}};n([no],nn.prototype,"top",2),n([no],nn.prototype,"right",2),n([no],nn.prototype,"bottom",2),n([no],nn.prototype,"left",2),n([no],nn.prototype,"width",2),n([no],nn.prototype,"height",2),n([no],nn.prototype,"opacity",2),n([ns("imageElement.src"),na(t=>t.loadedSynchronously=t.complete)],nn.prototype,"url",2);var{ActionOnSet:nl,Property:nh}=a.n1,nd=class extends a.n1.Background{constructor(){super(...arguments),this.image=new nn}onLayoutComplete(t){if(super.onLayoutComplete(t),this.image){let{width:e,height:i}=t.chart;this.image.performLayout(e,i)}}onImageLoad(){this.ctx.updateService.update(a.n1.ChartUpdateType.SCENE_RENDER)}};n([nh,nl({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],nd.prototype,"image",2);var nc={type:"root",optionsKey:"background",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new nd(t)},{ActionOnSet:np,LayoutElement:nu,Menu:ng,Property:ny}=a.n1,nf=[{label:"toolbarSeriesTypeOHLC",icon:"ohlc-series",value:"ohlc"},{label:"toolbarSeriesTypeCandles",icon:"candlestick-series",value:"candlestick"},{label:"toolbarSeriesTypeHollowCandles",icon:"hollow-candlestick-series",value:"hollow-candlestick"},{label:"toolbarSeriesTypeLine",icon:"line-series",value:"line"},{label:"toolbarSeriesTypeStepLine",icon:"step-line-series",value:"step-line"},{label:"toolbarSeriesTypeHLC",icon:"hlc-series",value:"hlc"},{label:"toolbarSeriesTypeHighLow",icon:"high-low-series",value:"high-low"}],nm=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.menu=new ng(this.ctx,"chart-toolbar"),this.toolbar=t.sharedToolbar.getSharedToolbar("chartToolbar"),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPressed.bind(this)),t.layoutManager.registerElement(nu.ToolbarLeft,this.onLayoutStart.bind(this)),()=>this.toolbar.destroy())}onLayoutStart(t){this.enabled&&(this.updateButton(),this.toolbar.layout(t.layoutBox))}onButtonPressed({event:t,buttonBounds:e}){this.menu.setAnchor({x:e.x+e.width+6,y:e.y}),this.menu.show({items:nf,menuItemRole:"menuitemradio",ariaLabel:this.ctx.localeManager.t("toolbarSeriesTypeDropdown"),class:"ag-charts-chart-toolbar__menu",value:this.getChartType(),sourceEvent:t.sourceEvent,onPress:t=>{this.setChartType(t.value),this.hidePopover()},onHide:()=>{this.toolbar.clearActiveButton()}}),this.toolbar.toggleActiveButtonByIndex(0)}updateButton(){let t=this.getChartType(),e=nf.find(e=>e.value===t)?.icon;null!=e&&this.toolbar.updateButtons([{icon:e,tooltip:"toolbarSeriesTypeDropdown"}])}hidePopover(){this.toolbar.clearActiveButton(),this.menu.hide()}setChartType(t){this.ctx.chartService.publicApi?.updateDelta({chartType:t}).catch(t=>s.Vy.error(t))}getChartType(){let t=this.ctx.chartService.publicApi?.getOptions()?.chartType;return null!=t&&nf.some(e=>e.value===t)?t:"candlestick"}};n([ny,np({changeValue(t){this.toolbar?.setHidden(!t)}})],nm.prototype,"enabled",2);var nx={type:"root",optionsKey:"chartToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new nm(t)};function nb(t,e,i){var a;let s=!0;if("separator"===e.type){let t=i.at(i.length-1);s=void 0!==t&&"separator"!==t.type}if(s&&(a=e.showOn??"always",s="always"===a||("series-area"===a?"series-area"===t||"series-node"===t:a===t)),s){let t=new nk(e);return i.push(t),t}}function nv(t,e,i,a){e.isVisible(i)&&nb(t,e.builtins.items[i],a)}function nS(t,e,i,a){for(let o of i)if("string"==typeof o){let{builtins:i}=e;if((0,s.bX)(o,i.lists))for(let s of i.lists[o])nv(t,e,s,a);else nv(t,e,o,a)}else{let i=nb(t,o,a);o.items&&i&&o.items.length>0&&nS(t,e,o.items,i.items)}a[a.length-1]?.type==="separator"&&a.pop()}var nk=class{constructor(t){this.type="action",this.showOn="always",this.label="",this.iconUrl=void 0,this.enabled=!0,this.items=[],this.action=void 0,t&&this.setOptions(t),this.items=[]}setField(t,e,i){e[t]=i}setOptions(t){let e;for(e in t)void 0!==t[e]&&this.setField(e,this,t[e])}},nD="ag-charts-context-menu",nM="ag-charts-dark-context-menu",{Deprecated:nw,Property:nI,ContextMenuRegistry:nC}=a.n1,nA="context-menu",nL="Use [items] instead",nT=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,this.darkTheme=!1,this.items=["defaults"],this.pickedNode=void 0,this.showEvent=void 0,this.x=0,this.y=0,this.menuWidget=new a.uB.MenuWidget;let e=this;if(this.deprecationMap={extraActions:{get items(){return e.extraActions??[]},showOn:"always"},extraSeriesAreaActions:{get items(){return e.extraSeriesAreaActions??[]},showOn:"series-area"},extraNodeActions:{get items(){return e.extraNodeActions??[]},showOn:"series-node"},extraLegendItemActions:{get items(){return e.extraLegendItemActions??[]},showOn:"legend-item"}},this.interactionManager=t.interactionManager,this.registry=t.contextMenuRegistry,this.element=t.domManager.addChild("canvas-overlay",nA),this.element.classList.add(nD),this.element.style.display="none",this.element.addEventListener("contextmenu",t=>t.preventDefault()),this.element.addEventListener("focusout",({relatedTarget:t})=>{(null==t||t instanceof Node&&!this.element.contains(t))&&this.hide()}),this.destroyFns.push(()=>this.element.parentNode?.removeChild(this.element),()=>this.menuWidget.destroy(),t.domManager.addListener("hidden",()=>this.hide()),this.menuWidget.addListener("close-widget",()=>this.onClose())),this.menuWidget.addClass(`${nD}__menu`),"undefined"!=typeof MutationObserver){let t=new MutationObserver(()=>{this.element.contains(this.menuWidget.getElement())&&this.reposition()});t.observe(this.element,{childList:!0}),this.mutationObserver=t,this.destroyFns.push(()=>t.disconnect())}this.ctx.contextMenuRegistry.builtins.items.download.action=()=>{let e=t.chartService.title,i="image";e?.enabled&&e?.text!==void 0&&(i=e.text.replace(/\.+/,"")),this.ctx.chartService.publicApi?.download({fileName:i}).catch(t=>{s.Vy.error("Unable to download chart",t)})},this.destroyFns.push(this.registry.addListener("context-complete",t=>this.onContext(t)))}createDeprecatedAdaptorItems(){let t=[];for(let e of Object.keys(this.deprecationMap)){let{items:i,showOn:a}=this.deprecationMap[e];for(let{action:e,label:s}of(t.push("separator"),i))t.push({type:"action",showOn:a,enabled:!0,label:s,action:e})}return t}expandItemsOptions(t){let e=[],i=this.createDeprecatedAdaptorItems();return nS(t,this.ctx.contextMenuRegistry,this.items,e),nS(t,this.ctx.contextMenuRegistry,i,e),e}onContext(t){if(!this.enabled)return;t.widgetEvent.sourceEvent.preventDefault(),this.showEvent=t.widgetEvent.sourceEvent,this.x=t.x,this.y=t.y,this.pickedNode=void 0,this.pickedLegendItem=void 0,nC.check("series-node",t)?this.pickedNode=t.context.pickedNode:nC.check("legend-item",t)&&(this.pickedLegendItem=t.context.legendItem);let e=this.expandItemsOptions(t.showOn);0!==e.length&&this.show(t.widgetEvent,e)}show(t,e){this.interactionManager.pushState(a.n1.InteractionState.ContextMenu),this.element.classList.toggle(nM,this.darkTheme),this.element.style.display="block";let i="touch"!==t.sourceEvent.pointerType&&void 0;void 0!==i&&this.ctx.chartService.overrideFocusVisible(i),this.createMenu(e),this.element.appendChild(this.menuWidget.getElement()),this.menuWidget.open(t,{overrideFocusVisible:i})}hide(){this.menuWidget.close()}onClose(){this.interactionManager.popState(a.n1.InteractionState.ContextMenu),this.element.removeChild(this.menuWidget.getElement()),this.element.style.display="none"}onSubMenuOpen(t,e){let i=t.getBounds();t.setFocusOverride(!0),t.getElement().insertAdjacentElement("afterend",e.getElement()),e.getElement().style.position="absolute";let a=this.ctx.domManager.getBoundingClientRect(),s=t.getBoundingClientRect(),o=a.right-s.right,r=s.left-a.left,{offsetWidth:n,offsetHeight:l}=e.getElement(),h=i.y;if(a.height>l){let t=a.bottom-s.top;t<l&&(h-=l-t)}if(o>=n)e.setBounds({x:i.x+i.width,y:h});else{let t=i.x-n,a=r+t;a>=0?e.setBounds({x:t,y:h}):e.setBounds({x:t-a,y:h})}}onSubMenuClose(t,e){t.setFocusOverride(void 0),e.remove()}createMenu(t){let{menuWidget:e}=this;e.clear(),e.toggleClass(nM,this.darkTheme),e.setTabIndex(-1),this.createMenuItems(e,t)}createMenuItems(t,e){for(let i of e)switch(i.type){case"separator":let e=t.addSeparator();e.classList.add(`${nD}__divider`),e.classList.toggle(nM,this.darkTheme),this.initTableCells(e);break;case"action":if(0===i.items.length){let e=new a.uB.MenuItemWidget;this.initButtonElement(e,i),t.addChild(e)}else{let{subMenuButton:e,subMenu:a}=t.addSubMenu();a.addClass(`${nD}__menu`),a.addListener("open-widget",()=>this.onSubMenuOpen(e,a)),a.addListener("close-widget",()=>this.onSubMenuClose(e,a)),this.initButtonElement(e,i),this.createMenuItems(a,i.items)}break;default:throw Error("unhandled case")}}createButtonOnClick(t,e){return nC.checkCallback("legend-item",t,e)?t=>{let i=t.sourceEvent;if(this.pickedLegendItem){let{seriesId:t,itemId:a}=this.pickedLegendItem;e({type:"contextmenu",seriesId:t,itemId:a,event:i}),this.hide()}else s.Vy.error("legend item not found")}:nC.checkCallback("series-area",t,e)?()=>{e({type:"seriesContextMenuAction",event:this.showEvent}),this.hide()}:nC.checkCallback("series-node",t,e)?()=>{let{pickedNode:t,showEvent:i}=this,a=t?.series.createNodeContextMenuActionEvent(i,t);a?e(a):s.Vy.error("series node not found"),this.hide()}:()=>{e({type:"contextMenuEvent",event:this.showEvent}),this.hide()}}initTableCells(t){let e=(0,s.n)("div"),i=(0,s.n)("div"),a=(0,s.n)("div");return e.classList.toggle("ag-charts-context-menu__icon",!0),i.classList.toggle("ag-charts-context-menu__label",!0),a.classList.toggle("ag-charts-context-menu__rightarrowhead",!0),e.ariaHidden="true",i.role="presentation",a.ariaHidden="true",t.append(e,i,a),{cellIcon:e,cellLabel:i,cellArrow:a}}initButtonElement(t,e){t.addClass(`${nD}__item`),t.toggleClass(nM,this.darkTheme),t.setEnabled(e.enabled);let i=this.ctx.localeManager.t(e.label),o=`${nD}__cellpadding`,{cellIcon:r,cellLabel:n,cellArrow:l}=this.initTableCells(t.getElement());if(n.textContent=i,n.classList.add(o),null!=e.iconUrl){let t=(0,s.n)("img");t.src=e.iconUrl,r.append(t),r.classList.add(o)}e.items.length>0&&(l.textContent="❯",l.classList.add(o));let{showOn:h,action:d}=e;if(null!=d){let e=this.createButtonOnClick(h,d);t.addListener("click",e),t.addListener("keydown",t=>{a.n1.isButtonClickEvent(t.sourceEvent)&&(t.sourceEvent.preventDefault(),e(t))})}t.addListener("mousemove",()=>t.focus({preventScroll:!0}))}reposition(){let{x:t,y:e}=this;this.element.style.top="unset",this.element.style.bottom="unset";let i=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:a,offsetHeight:o}=this.element;t=(0,s.qE)(0,t,i.width-a),e=(0,s.qE)(0,e,i.height-o),this.element.style.left=`${t}px`,this.element.style.top=`calc(${e}px - 0.5em)`}destroy(){super.destroy(),this.mutationObserver?.disconnect(),this.ctx.domManager.removeStyles(nA),this.ctx.domManager.removeChild("canvas-overlay",nA)}};n([nI],nT.prototype,"enabled",2),n([nI],nT.prototype,"darkTheme",2),n([nI],nT.prototype,"items",2),n([nw(nL)],nT.prototype,"extraActions",2),n([nw(nL)],nT.prototype,"extraNodeActions",2),n([nw(nL)],nT.prototype,"extraSeriesAreaActions",2),n([nw(nL)],nT.prototype,"extraLegendItemActions",2);var nN={type:"root",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],optionsKey:"contextMenu",moduleFactory:t=>new nT(t),themeTemplate:{contextMenu:{enabled:!0,darkTheme:a.n1.ThemeSymbols.IS_DARK_THEME}}},{BaseProperties:nO,Property:nP}=a.n1,nE=class extends a.n1.ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0}};n([nP],nE.prototype,"enabled",2),n([nP],nE.prototype,"xOffset",2),n([nP],nE.prototype,"yOffset",2),n([nP],nE.prototype,"format",2),n([nP],nE.prototype,"renderer",2);var nR=class extends nO{constructor(t,e,i){super(),this.domManager=t,this.id=(0,s.sX)(this),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.renderer=void 0,this.element=t.addChild("canvas-overlay",`crosshair-label-${this.id}`),this.element.classList.add("ag-charts-crosshair-label"),(0,s.Bq)(this.element,"aria-hidden",!0),this.element.setAttribute("data-key",e),this.element.setAttribute("data-axis-id",i)}show(t){let{element:e}=this,i=t.x+this.xOffset,a=t.y+this.yOffset;e.style.top=`${Math.round(a)}px`,e.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml(t){void 0!==t&&(this.element.innerHTML=t)}getBBox(){let{element:t}=this;return new a.n1.BBox(t.clientLeft,t.clientTop,t.clientWidth,t.clientHeight)}toggle(t){this.element.classList.toggle("ag-charts-crosshair-label--hidden",!t)}destroy(){this.domManager.removeChild("canvas-overlay",`crosshair-label-${this.id}`)}toLabelHtml(t,e){if("string"==typeof t)return t;e=e??{};let{text:i=e.text??"",color:a=e.color,backgroundColor:s=e.backgroundColor,opacity:o=e.opacity??1}=t,r=`opacity: ${o}; background-color: ${s?.toLowerCase()}; color: ${a}`;return`<div class="ag-charts-crosshair-label-content" style="${r}">
                    <span>${i}</span>
                </div>`}};n([nP],nR.prototype,"enabled",2),n([nP],nR.prototype,"xOffset",2),n([nP],nR.prototype,"yOffset",2),n([nP],nR.prototype,"format",2),n([nP],nR.prototype,"renderer",2);var{Group:nB,TranslatableGroup:nz,Line:nF,BBox:n_,InteractionState:nW,Property:nG,ZIndexMap:nj,formatNumber:nV,ChartAxisDirection:n$}=a.n1,nH=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.id=(0,s.sX)(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new nE,this.seriesRect=new n_(0,0,0,0),this.bounds=new n_(0,0,0,0),this.crosshairGroup=new nz({name:"crosshairs",zIndex:nj.SERIES_CROSSHAIR}),this.lineGroup=this.crosshairGroup.appendChild(new nB({name:`${this.id}-crosshair-lines`,zIndex:nj.SERIES_CROSSHAIR})),this.lineGroupSelection=a.n1.Selection.select(this.lineGroup,nF,!1),this.activeHighlight=void 0,this.axisCtx=t.parent,this.labels={},this.hideCrosshairs(),t.domManager.addEventListener("focusin",({target:e})=>{let i=e instanceof HTMLElement&&t.domManager.contains(e,"series-area");this.crosshairGroup.visible&&!i&&(this.hideCrosshairs(),this.ctx.updateService.update(a.n1.ChartUpdateType.PERFORM_LAYOUT))}),this.destroyFns.push(t.scene.attachNode(this.crosshairGroup),t.widgets.seriesWidget.addListener("mousemove",t=>this.onMouseHoverLike(t)),t.widgets.seriesWidget.addListener("drag-move",t=>this.onMouseHoverLike(t)),t.widgets.seriesWidget.addListener("mouseleave",()=>this.onMouseOut()),t.widgets.seriesDragInterpreter.addListener("click",t=>this.onClick(t)),t.chartEventManager.addListener("series-focus-change",()=>this.onKeyPress()),t.zoomManager.addListener("zoom-pan-start",()=>this.onMouseOut()),t.zoomManager.addListener("zoom-change",()=>this.onMouseOut()),t.highlightManager.addListener("highlight-change",t=>this.onHighlightChange(t)),t.layoutManager.addListener("layout:complete",t=>this.layout(t)),()=>Object.values(this.labels).forEach(t=>t.destroy()))}layout({series:{rect:t,visible:e},axes:i}){if(!e||!i||!this.enabled)return;this.seriesRect=t;let{position:a="left",axisId:s}=this.axisCtx,o=i.find(t=>t.id===s);if(!o)return;this.axisLayout=o,this.bounds=t.clone().grow(o.gridPadding+o.seriesAreaPadding,a);let{crosshairGroup:r,bounds:n}=this;r.translationX=Math.round(n.x),r.translationY=Math.round(n.y);let l=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(l),this.updateLines(),this.updateLabels(l)}updateSelections(t){this.lineGroupSelection.update(t,t=>t.append(new nF),t=>t)}updateLabels(t){let{labels:e,ctx:i}=this;for(let a of t)this.label.enabled&&(e[a]??(e[a]=new nR(i.domManager,a,this.axisCtx.axisId))),e[a]&&this.updateLabel(e[a]);this.labelFormatter=this.axisCtx.scaleValueFormatter(this.label.format)}updateLabel(t){let{enabled:e,xOffset:i,yOffset:a,format:s,renderer:o}=this.label;t.enabled=e,t.xOffset=i,t.yOffset=a,t.format=s,t.renderer=o}updateLines(){let{lineGroupSelection:t,bounds:e,stroke:i,strokeWidth:a,strokeOpacity:s,lineDash:o,lineDashOffset:r,axisLayout:n}=this;if(!n)return;let l=this.isVertical();t.each(t=>{t.stroke=i,t.strokeWidth=a,t.strokeOpacity=s,t.lineDash=o,t.lineDashOffset=r,t.y1=0,t.y2=l?e.height:0,t.x1=0,t.x2=l?0:e.width})}isVertical(){return this.axisCtx.direction===n$.X}isHover(t){return"mousemove"===t.type||"click"===t.type||"touch"===t.device&&"hover"===this.ctx.chartService.touch.dragAction}formatValue(t){let{labelFormatter:e,axisLayout:i}=this;if(e){let i=this.cachedCallWithContext(e,t);if(null!=i)return i}if("number"==typeof t){let e=(i?.label.fractionDigits??0)+ +!(0,s.Fq)(t);return nV(t,e)}return String(t??"")}onClick(t){"touch"===t.device&&this.onMouseHoverLike(t)}onMouseHoverLike(t){if(!this.enabled||this.snap)return;let e=this.isHover(t)?nW.Clickable:nW.AnnotationsMoveable;this.ctx.interactionManager.isState(e)&&(this.updatePositions(this.getData(t)),this.crosshairGroup.visible=!0,this.ctx.updateService.update(a.n1.ChartUpdateType.SCENE_RENDER))}onMouseOut(){this.ctx.interactionManager.isState(nW.Clickable)&&(this.hideCrosshairs(),this.ctx.updateService.update(a.n1.ChartUpdateType.SCENE_RENDER))}onKeyPress(){this.enabled&&!this.snap&&this.ctx.interactionManager.isState(nW.Default)&&this.hideCrosshairs()}onHighlightChange(t){if(!this.enabled)return;let{crosshairGroup:e,axisCtx:i}=this,{datum:a,series:s}=t.currentHighlight??{},o=a&&(s?.axes.x?.id===i.axisId||s?.axes.y?.id===i.axisId);if(this.activeHighlight=o?t.currentHighlight:void 0,this.activeHighlight){if(this.snap){let t=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(t),e.visible=!0}}else this.hideCrosshairs()}isInRange(t){return this.axisCtx.inRange(t)}updatePositions(t){let{seriesRect:e,lineGroupSelection:i}=this;i.each((i,a)=>{let s=t[a];if(!s){i.visible=!1,this.hideLabel(a);return}i.visible=!0;let{value:o,position:r}=s,n=0,l=0;this.isVertical()?i.x=Math.round(n=r):i.y=Math.round(l=r),this.label.enabled?this.showLabel(n+e.x,l+e.y,o,a):this.hideLabel(a)})}getData(t){let{axisCtx:e}=this,{datum:i,xKey:a="",yKey:s=""}=this.activeHighlight??{},{currentX:o,currentY:r}=t,n=this.isVertical(),l=n?o:r,h=i?.[n?a:s]??"";return e.continuous&&(h=e.scaleInvert(l)),{pointer:{position:l,value:h}}}getActiveHighlightData(t){let{axisCtx:e}=this,{datum:i,series:a,xKey:s="",aggregatedValue:o,cumulativeValue:r,midPoint:n}=t,l=a.getKeyProperties(e.direction),h=(e.scale.bandwidth??0)/2,d=a.axes[e.direction]?.id===e.axisId,c=l.indexOf("yKey")>-1&&d,p=l.indexOf("xKey")>-1&&d,u=o??r;if(c&&void 0!==u){let t=e.scale.convert(u)+h;return this.isInRange(t)?{yKey:{value:u,position:t}}:{}}if(p){let t=(this.isVertical()?n?.x:n?.y)??0,a=e.continuous?e.scaleInvert(t):i[s];return this.isInRange(t)?{xKey:{value:a,position:t}}:{}}let g={};return l.forEach(t=>{let s=i[a.properties[t]],o=e.scale.convert(s)+h;this.isInRange(o)&&(g[t]={value:s,position:o})}),g}getLabelHtml(t,e){let i=this.axisLayout?.label?.fractionDigits??0,a={text:this.formatValue(t)};return this.label.renderer?e.toLabelHtml(this.label.renderer({value:t,fractionDigits:i}),a):e.toLabelHtml(a)}showLabel(t,e,i,a){if(!this.axisLayout)return;let{bounds:s}=this,o=this.labels[a],r=this.getLabelHtml(i,o);o.setLabelHtml(r);let{width:n,height:l}=o.getBBox(),h=this.axisCtx.position,d=this.axisLayout.label.spacing+this.axisLayout.tickSize;this.axisCtx.direction===n$.X?(d-=4,o.show({x:t-n/2,y:"bottom"===h?s.y+s.height+d:s.y-l-d})):(d-=8,o.show({x:"right"===h?s.x+s.width+d:s.x-n-d,y:e-l/2}))}hideCrosshairs(){for(let t of(this.crosshairGroup.visible=!1,Object.keys(this.labels)))this.hideLabel(t)}hideLabel(t){this.labels[t]?.toggle(!1)}cachedCallWithContext(t,...e){let{callbackCache:i,chartService:a}=this.ctx;return i.call(this.axisCtx,a,t,...e)}};n([nG],nH.prototype,"enabled",2),n([nG],nH.prototype,"stroke",2),n([nG],nH.prototype,"lineDash",2),n([nG],nH.prototype,"lineDashOffset",2),n([nG],nH.prototype,"strokeWidth",2),n([nG],nH.prototype,"strokeOpacity",2),n([nG],nH.prototype,"snap",2),n([nG],nH.prototype,"label",2);var nY={type:"axis-option",optionsKey:"crosshair",packageType:"enterprise",chartTypes:["cartesian"],axisTypes:["category","ordinal-time","unit-time","number","log","time"],moduleFactory:t=>new nH(t),themeTemplate:{crosshair:{snap:!0,stroke:{$ref:"subtleTextColor"},strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}}}},{ActionOnSet:nK,Property:nU}=a.n1,nX=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.enabled=!1,this.getData=()=>Promise.resolve(),this.dataService=t.dataService}updateCallback(t,e){this.dataService&&(t&&null!=e?this.dataService.updateCallback(e):this.dataService.clearCallback())}};n([nK({newValue(t){this.updateCallback(t,this.getData)}}),nU],nX.prototype,"enabled",2),n([nK({newValue(t){this.updateCallback(this.enabled,t)}}),nU],nX.prototype,"getData",2),n([nK({newValue(t){this.dataService.requestThrottle=t}})],nX.prototype,"requestThrottle",2),n([nK({newValue(t){this.dataService.dispatchThrottle=t}})],nX.prototype,"updateThrottle",2),n([nK({newValue(t){this.dataService.dispatchOnlyLatest=!t}})],nX.prototype,"updateDuringInteraction",2);var nZ={type:"root",optionsKey:"dataSource",packageType:"enterprise",chartTypes:["cartesian","hierarchy","polar","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new nX(t),themeTemplate:{dataSource:{enabled:!1}}},{nearestSquaredInContainer:nQ,partialAssign:nq,mergeDefaults:nJ,BBox:n0}=a.n1,n1=class{constructor(t){this.components=t,this.union=n0.merge(t)}containsPoint(t,e){if(!this.union.containsPoint(t,e))return!1;for(let i of this.components)if(i.containsPoint(t,e))return!0;return!1}},n2=class extends a.n1.Group{constructor(){super(),this.capLength=NaN,this._datum=void 0,this.whiskerPath=new a.n1.Path,this.capsPath=new a.n1.Path,this.bboxes=new n1([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(t){this._datum=t}calculateCapLength(t,e){let{lengthRatio:i=1,length:a}=t,{lengthRatioMultiplier:s,lengthMax:o}=e;return Math.min(a??i*s,o)}getItemStylerParams(t,e,i){let{datum:a}=this;if(null==a||null==t.itemStyler)return;let{xLowerKey:s,xUpperKey:o,yLowerKey:r,yUpperKey:n}=t;return{...e,datum:a.datum,seriesId:a.datum.seriesId,xKey:a.xKey,yKey:a.yKey,xLowerKey:s,xUpperKey:o,yLowerKey:r,yUpperKey:n,highlighted:i}}formatStyles(t,e,i,a){let{cap:s,...o}=t,r=this.getItemStylerParams(e,t,a);if(null!=r&&null!=e.itemStyler){let t=i.callWithContext(e.itemStyler,r);o=nJ(t,o),s=nJ(t?.cap,t,s)}return{whiskerStyle:o,capsStyle:s}}applyStyling(t,e){nq(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],t,e)}update(t,e,i,a){if(void 0===this.datum)return;let{whiskerStyle:s,capsStyle:o}=this.formatStyles(t,e,i,a),{xBar:r,yBar:n,capDefaults:l}=this.datum,h=this.whiskerPath;this.applyStyling(h,s),h.path.clear(!0),void 0!==n&&(h.path.moveTo(n.lowerPoint.x,n.lowerPoint.y),h.path.lineTo(n.upperPoint.x,n.upperPoint.y)),void 0!==r&&(h.path.moveTo(r.lowerPoint.x,r.lowerPoint.y),h.path.lineTo(r.upperPoint.x,r.upperPoint.y)),h.path.closePath(),this.capLength=this.calculateCapLength(o??{},l);let d=this.capLength/2,c=this.capsPath;this.applyStyling(c,o),c.path.clear(!0),void 0!==n&&(c.path.moveTo(n.lowerPoint.x-d,n.lowerPoint.y),c.path.lineTo(n.lowerPoint.x+d,n.lowerPoint.y),c.path.moveTo(n.upperPoint.x-d,n.upperPoint.y),c.path.lineTo(n.upperPoint.x+d,n.upperPoint.y)),void 0!==r&&(c.path.moveTo(r.lowerPoint.x,r.lowerPoint.y-d),c.path.lineTo(r.lowerPoint.x,r.lowerPoint.y+d),c.path.moveTo(r.upperPoint.x,r.upperPoint.y-d),c.path.lineTo(r.upperPoint.x,r.upperPoint.y+d)),c.path.closePath()}updateBBoxes(){let{capLength:t,whiskerPath:e,capsPath:i}=this,{yBar:a,xBar:s}=this.datum??{},o=t/2,r=[];if(void 0!==a){let s=a.lowerPoint.y-a.upperPoint.y;r.push(new n0(a.lowerPoint.x,a.upperPoint.y,e.strokeWidth,s),new n0(a.lowerPoint.x-o,a.lowerPoint.y,t,i.strokeWidth),new n0(a.upperPoint.x-o,a.upperPoint.y,t,i.strokeWidth))}if(void 0!==s){let a=s.upperPoint.x-s.lowerPoint.x;r.push(new n0(s.lowerPoint.x,s.upperPoint.y,a,e.strokeWidth),new n0(s.lowerPoint.x,s.lowerPoint.y-o,i.strokeWidth,t),new n0(s.upperPoint.x,s.upperPoint.y-o,i.strokeWidth,t))}this.bboxes.components=r,this.bboxes.union=n0.merge(r)}containsPoint(t,e){return this.bboxes.containsPoint(t,e)}pickNode(t,e){return this.containsPoint(t,e)?this:void 0}nearestSquared(t,e,i){let{bboxes:a}=this;if(a.union.distanceSquared(t,e)>i)return{nearest:void 0,distanceSquared:1/0};let{distanceSquared:s}=n0.nearestBox(t,e,a.components);return{nearest:this,distanceSquared:s}}},n4=class extends a.n1.Group{nearestSquared(t,e){let{nearest:i,distanceSquared:a}=nQ(t,e,{children:this.children()});if(void 0!==i&&!isNaN(a))return{datum:i.datum,distanceSquared:a}}},{BaseProperties:n5,Property:n3}=a.n1,n6=class extends n5{};n([n3],n6.prototype,"visible",2),n([n3],n6.prototype,"stroke",2),n([n3],n6.prototype,"strokeWidth",2),n([n3],n6.prototype,"strokeOpacity",2),n([n3],n6.prototype,"lineDash",2),n([n3],n6.prototype,"lineDashOffset",2),n([n3],n6.prototype,"length",2),n([n3],n6.prototype,"lengthRatio",2);var n8=class extends n5{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new n6}};n([n3],n8.prototype,"yLowerKey",2),n([n3],n8.prototype,"yLowerName",2),n([n3],n8.prototype,"yUpperKey",2),n([n3],n8.prototype,"yUpperName",2),n([n3],n8.prototype,"xLowerKey",2),n([n3],n8.prototype,"xLowerName",2),n([n3],n8.prototype,"xUpperKey",2),n([n3],n8.prototype,"xUpperName",2),n([n3],n8.prototype,"visible",2),n([n3],n8.prototype,"stroke",2),n([n3],n8.prototype,"strokeWidth",2),n([n3],n8.prototype,"strokeOpacity",2),n([n3],n8.prototype,"lineDash",2),n([n3],n8.prototype,"lineDashOffset",2),n([n3],n8.prototype,"itemStyler",2),n([n3],n8.prototype,"cap",2);var{fixNumericExtent:n9,groupAccumulativeValueProperty:n7,mergeDefaults:lt,valueProperty:le,ChartAxisDirection:li}=a.n1,la=class t extends a.n1.BaseModuleInstance{constructor(t){super(),this.properties=new n8;let e=function(t){for(let e of a.On)if(e===t.series.type)return t.series;throw Error(`AG Charts - unsupported series type '${t.series.type}', error bars supported series types: ${a.On.join(", ")}`)}(t),{annotationGroup:i,annotationSelections:s}=e;this.cartesianSeries=e,this.groupNode=new n4({name:`${i.id}-errorBars`}),i.appendChild(this.groupNode),this.selection=a.n1.Selection.select(this.groupNode,()=>this.errorBarFactory()),s.add(this.selection),e.addEventListener("seriesVisibilityChange",t=>this.onToggleSeriesItem(t)),this.destroyFns.push(e.addListener("data-processed",t=>this.onDataProcessed(t)),e.addListener("data-update",t=>this.onDataUpdate(t)),t.highlightManager.addListener("highlight-change",t=>this.onHighlightChange(t)),()=>i.removeChild(this.groupNode),()=>s.delete(this.selection))}hasErrorBars(){let{xLowerKey:t,xUpperKey:e,yLowerKey:i,yUpperKey:a}=this.properties;return(0,s.vM)(t)&&(0,s.vM)(e)||(0,s.vM)(i)&&(0,s.vM)(a)}isStacked(){let t=this.cartesianSeries.seriesGrouping?.stackCount;return null!=t&&t>0}getUnstackPropertyDefinition(t){let e=[],{xLowerKey:i,xUpperKey:a,yLowerKey:s,yUpperKey:o,xErrorsID:r,yErrorsID:n}=this.getMaybeFlippedKeys(),{xScaleType:l,yScaleType:h}=t;return null!=s&&null!=o&&e.push(le(s,h,{id:`${n}-lower`}),le(o,h,{id:`${n}-upper`})),null!=i&&null!=a&&e.push(le(i,l,{id:`${r}-lower`}),le(a,l,{id:`${r}-upper`})),e}getStackPropertyDefinition(t){let e=[],{cartesianSeries:i}=this,{xLowerKey:a,xUpperKey:s,yLowerKey:o,yUpperKey:r,xErrorsID:n,yErrorsID:l}=this.getMaybeFlippedKeys(),{xScaleType:h,yScaleType:d}=t,c=i.seriesGrouping?.groupIndex??i.id,p={invalidValue:null,missingValue:0,separateNegative:!0,...i.visible?{}:{forceValue:0}},u=(t,e,i,a)=>n7(t,"normal","current",{id:`${e}-${i}`,groupId:`errorGroup-${c}-${i}`,...p},a),g=(t,i,a,s)=>{e.push(...u(t,a,"lower",s),...u(i,a,"upper",s))};return null!=o&&null!=r&&g(o,r,l,d),null!=a&&null!=s&&g(a,s,n,h),e}getPropertyDefinitions(t){return this.isStacked()?this.getStackPropertyDefinition(t):this.getUnstackPropertyDefinition(t)}onDataProcessed(t){this.dataModel=t.dataModel,this.processedData=t.processedData}getDomain(t){let{xLowerKey:e,xUpperKey:i,xErrorsID:a,yLowerKey:o,yUpperKey:r,yErrorsID:n}=this.getMaybeFlippedKeys();if(t===li.X?(0,s.vM)(e)&&(0,s.vM)(i):(0,s.vM)(o)&&(0,s.vM)(r)){let{dataModel:e,processedData:i,cartesianSeries:s}=this;if(null!=e&&null!=i){let o={x:a,y:n}[t],r=e.getDomain(s,`${o}-lower`,"value",i),l=e.getDomain(s,`${o}-upper`,"value",i);return n9([Math.min(...r,...l),Math.max(...r,...l)])}}return[]}onDataUpdate(t){this.dataModel=t.dataModel,this.processedData=t.processedData,(0,s.vM)(t.dataModel)&&(0,s.vM)(t.processedData)&&(this.createNodeData(),this.update())}getNodeData(){return this.hasErrorBars()?this.cartesianSeries.contextNodeData?.nodeData:void 0}createNodeData(){let t=this.getNodeData(),e=this.cartesianSeries.axes[li.X]?.scale,i=this.cartesianSeries.axes[li.Y]?.scale;if(e&&i&&t)for(let a=0;a<t.length;a++){let{midPoint:o,xLower:r,xUpper:n,yLower:l,yUpper:h}=this.getDatum(t,a);if(null!=o){let d,c;(0,s.vM)(r)&&(0,s.vM)(n)&&(d={lowerPoint:{x:this.convert(e,r),y:o.y},upperPoint:{x:this.convert(e,n),y:o.y}}),(0,s.vM)(l)&&(0,s.vM)(h)&&(c={lowerPoint:{x:o.x,y:this.convert(i,l)},upperPoint:{x:o.x,y:this.convert(i,h)}}),t[a].xBar=d,t[a].yBar=c}}}getMaybeFlippedKeys(){let{xLowerKey:t,xUpperKey:e,yLowerKey:i,yUpperKey:a}=this.properties,[s,o]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([t,i]=[i,t],[e,a]=[a,e],[s,o]=[o,s]),{xLowerKey:t,xUpperKey:e,xErrorsID:s,yLowerKey:i,yUpperKey:a,yErrorsID:o}}static getDatumKey(t,e,i){if(null==e)return;let a=t.datum[e];if(null!=a)return"number"!=typeof a?void s.Vy.warnOnce(`Found [${e}] error value of type ${typeof a}. Expected number type`):a+i}getDatum(e,i){let{xLowerKey:a,xUpperKey:s,yLowerKey:o,yUpperKey:r}=this.getMaybeFlippedKeys(),n=e[i],l=null!=n.cumulativeValue&&this.isStacked()?n.cumulativeValue-n.yValue:0,[h,d]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:n.midPoint,xLower:t.getDatumKey(n,a,h),xUpper:t.getDatumKey(n,s,h),yLower:t.getDatumKey(n,o,d),yUpper:t.getDatumKey(n,r,d)}}convert(t,e){let i=(t.bandwidth??0)/2;return t.convert(e)+i}update(){let t=this.getNodeData();null!=t&&(this.selection.update(t),this.selection.each((t,e,i)=>this.updateNode(t,e,i)))}updateNode(t,e,i){t.datum=e,t.update(this.getDefaultStyle(),this.properties,this.cartesianSeries,!1),t.updateBBoxes()}pickNodeExact(t){let{x:e,y:i}=t,a=this.groupNode.pickNode(e,i);if(null!=a)return{datum:a.datum,distanceSquared:0}}pickNodeNearest(t){return this.groupNode.nearestSquared(t.x,t.y)}pickNodeMainAxisFirst(t){return this.groupNode.nearestSquared(t.x,t.y)}getTooltipParams(){let{xLowerKey:t,xUpperKey:e,yLowerKey:i,yUpperKey:a,xLowerName:s=t,xUpperName:o=e,yLowerName:r=i,yUpperName:n=a}=this.properties;return{xLowerKey:t,xLowerName:s,xUpperKey:e,xUpperName:o,yLowerKey:i,yLowerName:r,yUpperKey:a,yUpperName:n}}onToggleSeriesItem(t){this.groupNode.visible=t.visible}makeStyle(t){return{visible:t.visible,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,stroke:t.stroke,strokeWidth:t.strokeWidth,strokeOpacity:t.strokeOpacity,cap:lt(this.properties.cap,t)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(t,e,i){let a=this.getNodeData();if(null!=a){for(let s=0;s<a.length;s++)if(t===a[s]){this.selection.at(s)?.update(e,this.properties,this.cartesianSeries,i);break}}}onHighlightChange(t){let{previousHighlight:e,currentHighlight:i}=t;i?.series===this.cartesianSeries&&this.restyleHighlightChange(i,this.getHighlightStyle(),!0),e?.series===this.cartesianSeries&&this.restyleHighlightChange(e,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new n2}getWhiskerProperties(){let{stroke:t,strokeWidth:e,visible:i,strokeOpacity:a,lineDash:s,lineDashOffset:o}=this.properties;return{stroke:t,strokeWidth:e,visible:i,strokeOpacity:a,lineDash:s,lineDashOffset:o}}},ls={type:"series-option",identifier:"error-bars",optionsKey:"errorBar",packageType:"enterprise",chartTypes:["cartesian"],seriesTypes:a.On,moduleFactory:t=>new la(t),themeTemplate:{series:{errorBar:{visible:!0,stroke:{$ref:"foregroundColor"},strokeWidth:1,strokeOpacity:1,cap:{length:void 0,lengthRatio:void 0}}}}},{ZIndexMap:lo,ActionOnSet:lr,Property:ln,ProxyPropertyOnWrite:ll}=a.n1,lh=class extends a.n1.Background{constructor(){super(...arguments),this.image=new nn,this.fill="transparent",this.fillOpacity=void 0}createNode(){return new a.n1.Group({name:"foreground",zIndex:lo.FOREGROUND})}onLayoutComplete(t){super.onLayoutComplete(t);let{width:e,height:i}=t.chart,a={x:0,y:0,width:e,height:i};this.image&&(a=this.image.performLayout(e,i)),this.text&&this.updateTextNode(a)}onImageLoad(){this.ctx.updateService.update(a.n1.ChartUpdateType.SCENE_RENDER)}updateTextNode(t){let{textNode:e}=this;e.fontWeight="bold",e.fontFamily="Impact, sans-serif",e.fontSize=19,e.opacity=.7,e.fill="#9b9b9b",e.textBaseline="top";let i=this.textNode.getBBox();e.x=t.x+t.width/2-i.width/2,e.y=t.y+t.height+10}};n([ln,lr({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],lh.prototype,"image",2),n([ln,ll("rectNode","fill")],lh.prototype,"fill",2),n([ln,ll("rectNode","fillOpacity")],lh.prototype,"fillOpacity",2);var ld={type:"root",optionsKey:"foreground",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new lh(t)},{TranslatableGroup:lc,SceneChangeDetection:lp}=a.n1,lu=class extends lc{constructor(){super(...arguments),this.inset=0,this.cornerRadius=0}applyClip(t,e){let{cornerRadius:i,inset:a}=this,{x:s,y:o,width:r,height:n}=e;t.beginPath(),t.roundRect(s+a,o+a,r-2*a,n-2*a,i),t.clip()}};n([lp()],lu.prototype,"inset",2),n([lp()],lu.prototype,"cornerRadius",2);var{Property:lg,ZIndexMap:ly,ActionOnSet:lf,CategoryAxis:lm,TextUtils:lx,Padding:lb,Group:lv,BBox:lS,ProxyProperty:lk}=a.n1,lD=class{constructor(){this.top=0,this.bottom=0}};n([lg],lD.prototype,"top",2),n([lg],lD.prototype,"bottom",2);var lM=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.padding=new lD,this.root=new lv({name:"root"}),this.seriesRoot=this.root.appendChild(new lu({name:"Series-root",zIndex:ly.SERIES_LAYER,renderToOffscreenCanvas:!0})),this.axisGridGroup=this.root.appendChild(new lv({name:"Axes-Grids",zIndex:ly.AXIS_GRID})),this.axisGroup=this.root.appendChild(new lv({name:"Axes-Grids",zIndex:ly.AXIS_GRID})),this.axisLabelGroup=this.root.appendChild(new lv({name:"Axes-Labels",zIndex:ly.SERIES_LABEL})),this.axisCrosslineRangeGroup=this.root.appendChild(new lv({name:"Axes-Crosslines-Range",zIndex:ly.SERIES_CROSSLINE_RANGE})),this.axisCrosslineLineGroup=this.root.appendChild(new lv({name:"Axes-Crosslines-Line",zIndex:ly.SERIES_CROSSLINE_LINE})),this.axisCrosslineLabelGroup=this.root.appendChild(new lv({name:"Axes-Crosslines-Label",zIndex:ly.SERIES_LABEL})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.axes=[],this.series=[]}destroy(){this._destroyed||(this.destroySeries(this.series),this.axes.forEach(t=>t.destroy()),this.axes=[],this._destroyed=!0)}onSeriesChange(t,e){let i=e?.filter(e=>!t.includes(e))??[];for(let a of(this.destroySeries(i),t)){if(e?.includes(a))continue;a.attachSeries(this.seriesRoot,this.seriesRoot,void 0);let t=this;a.chart={get mode(){return"standalone"},get isMiniChart(){return!0},get seriesRect(){return t.seriesRect}},a.resetAnimation("initial"===this.miniChartAnimationPhase?"initial":"disabled")}}destroySeries(t){t?.forEach(t=>{t.destroy(),t.detachSeries(this.seriesRoot,this.seriesRoot,void 0),t.chart=void 0})}assignSeriesToAxes(){this.axes.forEach(t=>{t.boundSeries=this.series.filter(e=>e.axes[t.direction]===t)})}assignAxesToSeries(){let t={};this.axes.forEach(e=>{let i=e.direction;(t[i]??(t[i]=[])).push(e)}),this.series.forEach(e=>{e.directions.forEach(i=>{let a=t[i];if(!a)return void s.Vy.warnOnce(`no available axis for direction [${i}]; check series and axes configuration.`);let o=e.getKeys(i),r=this.findMatchingAxis(a,o);if(!r)return void s.Vy.warnOnce(`no matching axis for direction [${i}] and keys [${o}]; check series and axes configuration.`);e.axes[i]=r})})}findMatchingAxis(t,e){for(let i of t){if(!i.keys.length)return i;if(e){for(let t of e)if(i.keys.includes(t))return i}}}updateData(t){this.series.forEach(e=>e.setChartData(t)),"initial"===this.miniChartAnimationPhase&&this.ctx.animationManager.onBatchStop(()=>{this.miniChartAnimationPhase="ready",this.series.forEach(t=>t.resetAnimation("disabled"))})}async processData(t){for(let e of(this.series.some(t=>t.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes()),await Promise.all(this.series.map(e=>(e.resetDatumCallbackCache(),e.processData(t)))),this.axes))e.processData()}computeAxisPadding(){let t=new lb;return this.enabled&&this.axes.forEach(({position:e,thickness:i,line:a,label:s})=>{let o;null!=e&&(o=i||(a.enabled?a.width:0)+(s.enabled?lx.getLineHeight(s.fontSize??0)+s.spacing:0),t[e]=Math.ceil(o))}),t}async layout(t,e){let{padding:i}=this,a=null!=this.seriesRect,s=new lS(0,0,t,e-(i.top+i.bottom));this.seriesRect=s,this.seriesRoot.translationY=i.top,this.seriesRoot.setClipRectCanvasSpace(new lS(0,-i.top,t,e)),this.axes.forEach(i=>{let{position:o="left"}=i;switch(o){case"top":case"bottom":i.range=[0,s.width],i.gridLength=s.height;break;case"right":case"left":{let t=i instanceof lm;i.range=t?[0,s.height]:[s.height,0],i.gridLength=s.width}}i.gridPadding=0,i.translation.x=0,i.translation.y=0,"right"===o?i.translation.x=t:"bottom"===o&&(i.translation.y=e),a||i.resetAnimation("initial"),i.calculateLayout(),i.update()}),await Promise.all(this.series.map(t=>t.update({seriesRect:s})))}};n([lg],lM.prototype,"enabled",2),n([lk(["seriesRoot","inset"])],lM.prototype,"inset",2),n([lk(["seriesRoot","cornerRadius"])],lM.prototype,"cornerRadius",2),n([lf({changeValue(t,e=[]){let i={axisNode:this.axisGroup,gridNode:this.axisGridGroup,labelNode:this.axisLabelGroup,crossLineLineNode:this.axisCrosslineLineGroup,crossLineRangeNode:this.axisCrosslineRangeGroup,crossLineLabelNode:this.axisCrosslineLabelGroup};for(let a of e)t.includes(a)||(a.detachAxis(i),a.destroy());for(let a of t)e?.includes(a)||a.attachAxis(i)}})],lM.prototype,"axes",2),n([lf({changeValue(t,e){this.onSeriesChange(t,e)}})],lM.prototype,"series",2);var{SliderWidget:lw}=a.n1,lI=class{constructor(t,e){for(let[i,a]of(this.ctx=t,this.sliderHandlers=e,this._min=0,this._max=1,this.minRange=.001,this.dragStartX=0,this.ctx=t,this.toolbar=t.proxyInteractionService.createProxyContainer({type:"toolbar",domManagerId:"navigator-toolbar",classList:["ag-charts-proxy-navigator-toolbar"],orientation:"vertical",ariaLabel:{id:"ariaLabelNavigator"}}),this.sliders=[t.proxyInteractionService.createProxyElement({type:"slider",domIndex:1,ariaLabel:{id:"ariaLabelNavigatorMinimum"},parent:this.toolbar,cursor:"ew-resize"}),t.proxyInteractionService.createProxyElement({type:"slider",domIndex:-1/0,ariaLabel:{id:"ariaLabelNavigatorRange"},parent:this.toolbar,cursor:"grab"}),t.proxyInteractionService.createProxyElement({type:"slider",domIndex:2,ariaLabel:{id:"ariaLabelNavigatorMaximum"},parent:this.toolbar,cursor:"ew-resize"})],["min","pan","max"].entries())){let t=this.sliders[i];t.step=lw.STEP_HUNDRETH,t.keyboardStep=lw.STEP_ONE,t.orientation="horizontal",t.setPreventsDefault(!1),t.addListener("drag-start",t=>this.onDragStart(i,t,a)),t.addListener("drag-move",e=>this.onDrag(t,e,a)),t.addListener("drag-end",()=>this.updateSliderRatios()),t.addListener("contextmenu",e=>this.onContextMenu(t,e))}this.sliders[0].addListener("change",()=>this.onMinSliderChange()),this.sliders[1].addListener("change",()=>this.onPanSliderChange()),this.sliders[2].addListener("change",()=>this.onMaxSliderChange()),this.updateSliderRatios(),this.updateVisibility(!1)}destroy(){this.toolbar.destroy()}updateVisibility(t){this.toolbar.setHidden(!t)}updateZoom(){let{_min:t,_max:e}=this;if(null!=t&&null!=e)return this.ctx.zoomManager.updateZoom("navigator",{x:{min:t,max:e}})}updateBounds(t){this.toolbar.setBounds(t)}updateSliderBounds(t,e){this.sliders[t].setBounds(e)}updateMinMax(t,e){this._min=t,this._max=e,this.updateSliderRatios()}updateSliderRatios(){let{_min:t,_max:e}=this;t=Math.round(100*t)/100,e=Math.round(100*e)/100;let i=this.ctx.localeManager.t("ariaValuePanRange",{min:t,max:e});this.sliders[0].setValueRatio(t),this.sliders[1].setValueRatio(t,{ariaValueText:i}),this.sliders[2].setValueRatio(e)}toCanvasOffsets(t){return{offsetX:this.dragStartX+t.originDeltaX}}moveToFront(t){if(1===t)return;let e=this.sliders[t],i=this.sliders[2-t];this.toolbar.moveChild(i,e.domIndex-1)}onDragStart(t,e,i){let a=this.sliders[t],s=this.toolbar.cssLeft(),o=a.cssLeft();this.dragStartX=s+o+e.offsetX,this.moveToFront(t),"touch"===e.device&&e.sourceEvent.preventDefault(),this.sliderHandlers.onDragStart(i,this.toCanvasOffsets(e))}onDrag(t,e,i){"touch"===e.device&&e.sourceEvent.preventDefault(),this.sliderHandlers.onDrag(i,this.toCanvasOffsets(e))}onContextMenu(t,e){let{offsetX:i,offsetY:a}=e,{x:s,y:o}=this.toolbar.getBounds(),{x:r,y:n}=t.getBounds();this.ctx.contextMenuRegistry.dispatchContext("always",{widgetEvent:e,canvasX:i+s+r,canvasY:a+o+n},void 0)}onPanSliderChange(){let t=this.sliders[1].getValueRatio(),e=this._max-this._min;this._min=(0,s.qE)(0,t,1-e),this._max=this._min+e,this.updateZoom()}onMinSliderChange(){this._min=this.sliders[0].clampValueRatio(0,this._max-this.minRange),this.updateZoom()}onMaxSliderChange(){this._max=this.sliders[2].clampValueRatio(this._min+this.minRange,1),this.updateZoom()}},{Property:lC,SceneChangeDetection:lA,BBox:lL,ExtendedPath2D:lT}=a.n1,lN=class extends a.n1.Path{constructor(){super(...arguments),this.zIndex=3,this.centerX=0,this.centerY=0,this.width=8,this.height=16,this.cornerRadius=4,this.grip=!0,this.gripPath=new lT}setCenter(t,e){this.dirtyPath=!0,(this.centerX!==t||this.centerY!==e)&&(this.centerX=t,this.centerY=e,this.markDirty("center"))}static align(t,e,i,a,s,o,r,n,l){let h=t.align(i+s*r)+l,d=h+t.align(i+s*r,s*(n-r))-2*l,c=t.align(a+o/2);t.setCenter(h,c),e.setCenter(d,c)}computeBBox(){let{centerX:t,centerY:e,width:i,height:a}=this;return new lL(t-i/2,e-a/2,i,a)}isPointInPath(t,e){return this.getBBox().containsPoint(t,e)}updatePath(){let{centerX:t,centerY:e,path:i,gripPath:a,strokeWidth:s,cornerRadius:o,grip:r}=this,n=s/2,l=this.layerManager?.canvas?.pixelRatio??1;i.clear(),a.clear();let h=Math.floor(this.width/2*l)/l,d=Math.floor(this.height/2*l)/l;if(i.roundRect(t-h+n,e-d+n,2*(h-n),2*(d-n),o),r)for(let i=-.5;i<=.5;i+=1)for(let s=-1;s<=1;s+=1)a.arc(t+3*i,e+3*s,1,0,2*Math.PI),a.closePath()}renderFill(t,e){let{stroke:i}=this;super.renderFill(t,e),t.fillStyle="string"==typeof i?i:"black",t.fill(this.gripPath.getPath2D())}};lN.className="RangeHandle",n([lC,lA()],lN.prototype,"width",2),n([lC,lA()],lN.prototype,"height",2),n([lC,lA()],lN.prototype,"cornerRadius",2),n([lC,lA()],lN.prototype,"grip",2);var{Path:lO,BBox:lP,ExtendedPath2D:lE,clippedRoundRect:lR,Property:lB,SceneChangeDetection:lz}=a.n1,lF=class extends lO{constructor(){super(...arguments),this.cornerRadius=4,this.zIndex=2,this.x=0,this.y=0,this.width=200,this.height=30,this.min=0,this.max=1,this.visiblePath=new lE}layout(t,e,i,a,s,o){s=isNaN(s)?this.min:s,o=isNaN(o)?this.max:o,(t!==this.x||e!==this.y||i!==this.width||this.height!==a||s!==this.min||o!==this.max)&&(this.x=t,this.y=e,this.width=i,this.height=a,this.min=s,this.max=o,this.dirtyPath=!0,this.markDirty("RangeMask.layout"))}computeBBox(){let{x:t,y:e,width:i,height:a}=this;return new lP(t,e,i,a)}computeVisibleRangeBBox(){let{x:t,y:e,width:i,height:a,min:s,max:o}=this,r=t+i*s;return new lP(r,e,t+i*o-r,a)}updatePath(){let{path:t,visiblePath:e,x:i,y:a,width:s,height:o,min:r,max:n,strokeWidth:l,cornerRadius:h}=this,d=l/2;t.clear(),e.clear();let c=this.align(i)+d,p=this.align(a)+d,u=this.align(i,s)-2*d,g=this.align(a,o)-2*d,y=this.align(i+s*r)+d,f=y+this.align(i+s*r,s*(n-r))-2*d,m={topLeft:h,topRight:h,bottomRight:h,bottomLeft:h};lR(t,c,p,u,g,m,new lP(c,p,y-c,g)),lR(t,c,p,u,g,m,new lP(f,p,u+c-f,g)),f-y>1&&lR(e,c,p,u,g,m,new lP(y,p,f-y,g))}renderStroke(t,e){super.renderStroke(t,e),super.renderStroke(t,this.visiblePath.getPath2D())}};lF.className="RangeMask",n([lB,lz()],lF.prototype,"cornerRadius",2);var l_=class extends a.n1.Group{constructor(t){super({name:"rangeSelectorGroup",zIndex:a.n1.ZIndexMap.NAVIGATOR}),this.x=0,this.y=0,this.width=200,this.height=30,this.lOffset=0,this.rOffset=0,this.background=this.appendChild(new a.n1.TranslatableGroup({name:"navigator-background",zIndex:1})),this.append(t)}layout(t,e,i,a,s,o){this.x=t,this.y=e,this.width=i,this.height=a,this.lOffset=s,this.rOffset=o,this.background.translationX=t,this.background.translationY=e,this.markDirty("RangeSelector")}updateBackground(t,e){null!=t&&this.background.removeChild(t),null!=e&&this.background.appendChild(e),this.markDirty("RangeSelector")}computeBBox(){let{x:t,y:e,width:i,height:s,lOffset:o,rOffset:r}=this;return new a.n1.BBox(t-o,e,i+(o+r),s)}},{BaseModuleInstance:lW,ObserveChanges:lG,Property:lj}=a.n1,lV=class extends lW{constructor(t){super(),this.ctx=t,this.enabled=!1,this.mask=new lF,this.minHandle=new lN,this.maxHandle=new lN,this.maskVisibleRange={id:"navigator-mask-visible-range",getBBox:()=>this.mask.computeVisibleRangeBBox(),toCanvasBBox:()=>this.mask.computeVisibleRangeBBox(),fromCanvasPoint:(t,e)=>({x:t,y:e})},this.height=30,this.cornerRadius=0,this.spacing=10,this.x=0,this.y=0,this.width=0,this.rangeSelector=new l_([this.mask,this.minHandle,this.maxHandle]),this.destroyFns.push(t.scene.attachNode(this.rangeSelector),this.ctx.localeManager.addListener("locale-changed",()=>this.updateZoom()),this.ctx.layoutManager.registerElement(a.n1.LayoutElement.Navigator,t=>this.onLayoutStart(t)),this.ctx.layoutManager.addListener("layout:complete",t=>this.onLayoutComplete(t)),t.zoomManager.addListener("zoom-change",t=>this.onZoomChange(t))),this.domProxy=new lI(t,this),this.updateGroupVisibility(),this.miniChart=new lM(t)}updateBackground(t,e){this.rangeSelector?.updateBackground(t,e)}updateGroupVisibility(){let{enabled:t}=this;null!=this.rangeSelector&&t!==this.rangeSelector.visible&&(this.rangeSelector.visible=t,this.domProxy.updateVisibility(t),t?this.updateZoom():this.ctx.zoomManager.updateZoom("navigator"))}onLayoutStart(t){if(this.enabled){let{layoutBox:e}=t,i=this.height+this.spacing;e.shrink(i,"bottom"),this.y=e.y+e.height+this.spacing}else this.y=0;if(this.enabled&&this.miniChart){let{top:e,bottom:i}=this.miniChart.computeAxisPadding();t.layoutBox.shrink(e+i,"bottom"),this.y-=i,this.miniChart.inset=this.mask.strokeWidth/2,this.miniChart.cornerRadius=this.mask.cornerRadius}}onLayoutComplete(t){let{x:e,width:i}=t.series.rect,{y:a,height:o}=this;if(this.domProxy.updateVisibility(this.enabled),this.enabled){let{_min:t,_max:s}=this.domProxy;this.layoutNodes(e,a,i,o,t,s),this.domProxy.updateBounds({x:e,y:a,width:i,height:o})}this.x=e,this.width=i,this.miniChart?.layout(i,o).catch(t=>s.Vy.error(t))}canDrag(){return this.enabled&&this.ctx.interactionManager.isState(a.n1.InteractionState.ZoomDraggable)}onDragStart(t,{offsetX:e}){this.canDrag()&&("pan"===t&&(this.panStart=(e-this.x)/this.width-this.domProxy._min),this.ctx.zoomManager.fireZoomPanStartEvent("navigator"))}onDrag(t,{offsetX:e}){if(!this.canDrag())return;let{panStart:i,x:a,width:o}=this,{minRange:r}=this.domProxy,{_min:n,_max:l}=this.domProxy,h=(e-a)/o;if("min"===t)n=(0,s.qE)(0,h,l-r);else if("max"===t)l=(0,s.qE)(n+r,h,1);else if("pan"===t&&null!=i){let t=l-n;l=(n=(0,s.qE)(0,h-i,1-t))+t}this.domProxy._min=n,this.domProxy._max=l,this.updateZoom()}onZoomChange(t){let{x:e}=t;if(!e)return;let{x:i,y:a,width:s,height:o}=this,{min:r,max:n}=e;this.domProxy.updateMinMax(r,n),this.layoutNodes(i,a,s,o,r,n)}layoutNodes(t,e,i,a,s,o){let{rangeSelector:r,mask:n,minHandle:l,maxHandle:h}=this;n.layout(t,e,i,a,s,o),r.layout(t,e,i,a,l.width/2,h.width/2),lN.align(l,h,t,e,i,a,s,o,n.strokeWidth/2),s+(o-s)/2<.5?(l.zIndex=3,h.zIndex=4):(l.zIndex=4,h.zIndex=3),[l,this.maskVisibleRange,h].forEach((i,a)=>{let s=i.getBBox(),o={x:s.x-t,y:s.y-e,height:s.height,width:s.width};this.domProxy.updateSliderBounds(a,o)})}updateZoom(){this.enabled&&this.domProxy.updateZoom()}updateData(t){return this.miniChart?.updateData(t)}async processData(t){if(this.miniChart)return this.miniChart?.processData(t)}};n([lG((t,e,i)=>{t.updateBackground(i?.root,e?.root)})],lV.prototype,"miniChart",2),n([lj,lG((t,e)=>{t.ctx.zoomManager.setNavigatorEnabled(!!e),t.updateGroupVisibility()})],lV.prototype,"enabled",2),n([lj],lV.prototype,"height",2),n([lj,lG((t,e)=>{t.mask.cornerRadius=e})],lV.prototype,"cornerRadius",2),n([lj],lV.prototype,"spacing",2);var l$={type:"root",optionsKey:"navigator",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new lV(t),removable:!1,themeTemplate:{navigator:{enabled:!1,height:18,cornerRadius:4,mask:{fill:{$ref:"foregroundColor"},fillOpacity:.1,stroke:{$ref:"borderColor"},strokeWidth:1},minHandle:{fill:{$ref:"backgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},maxHandle:{fill:{$ref:"backgroundColor"},stroke:{$ref:"borderColor"},strokeWidth:1,width:12,height:24,cornerRadius:4},miniChart:{enabled:!1,label:{color:{$ref:"textColor"},fontSize:{$rem:[a.n1.FONT_SIZE_RATIO.SMALLER]},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},spacing:5},padding:{top:0,bottom:0}}}}},{ToolbarButtonProperties:lH,Property:lY}=a.n1,lK=class extends lH{};n([lY],lK.prototype,"value",2);var{ChartAxisDirection:lU,LayoutElement:lX,PropertiesArray:lZ,Toolbar:lQ,Property:lq}=a.n1,lJ=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.buttons=new lZ(lK),this.verticalSpacing=10,this.container=t.domManager.addChild("canvas-overlay","range-buttons"),this.container.role="presentation",this.toolbar=new lQ(this.ctx.localeManager),this.toolbar.addClass("ag-charts-range-buttons"),this.container.append(this.toolbar.getElement()),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),t.layoutManager.registerElement(lX.ToolbarBottom,this.onLayoutStart.bind(this)),t.zoomManager.addListener("zoom-change",this.onZoomChanged.bind(this)),this.teardown.bind(this))}teardown(){this.container.removeChild(this.toolbar.getElement()),this.toolbar.destroy()}onLayoutStart(t){let{buttons:e,ctx:i,enabled:a,toolbar:s,verticalSpacing:o}=this,{layoutBox:r}=t;if(!a||!i.zoomManager.isZoomEnabled())return void s.setHidden(!0);s.setHidden(!1),s.updateButtons(e);let n=s.getBounds().height;s.setBounds({x:r.x,y:r.y+r.height-n,width:r.width,height:n}),r.shrink({bottom:n+o})}onZoomChanged(){this.toolbar.clearActiveButton()}onButtonPress({button:{index:t}}){let{zoomManager:e}=this.ctx,i=this.buttons.at(t);if(!i)return;let{value:a}=i;"number"==typeof a?e.extendToEnd("zoom-buttons",lU.X,a):Array.isArray(a)?e.updateWith("zoom-buttons",lU.X,()=>a):"function"==typeof a&&e.updateWith("zoom-buttons",lU.X,a),this.toolbar.toggleActiveButtonByIndex(t)}};n([lq],lJ.prototype,"enabled",2),n([lq],lJ.prototype,"buttons",2);var l0={type:"root",optionsKey:"ranges",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new lJ(t),themeTemplate:{ranges:{enabled:!1,buttons:[{label:"toolbarRange1Month",ariaLabel:"toolbarRange1MonthAria",value:2592e6},{label:"toolbarRange3Months",ariaLabel:"toolbarRange3MonthsAria",value:7776e6},{label:"toolbarRange6Months",ariaLabel:"toolbarRange6MonthsAria",value:15552e6},{label:"toolbarRangeYearToDate",ariaLabel:"toolbarRangeYearToDateAria",value:(t,e)=>[new Date(`${new Date(e).getFullYear()}-01-01`).getTime(),e]},{label:"toolbarRange1Year",ariaLabel:"toolbarRange1YearAria",value:31536e6},{label:"toolbarRangeAll",ariaLabel:"toolbarRangeAllAria",value:(t,e)=>[t,e]}]}}},l1=class t extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.activeSections=new Set,this.sectionButtons={annotations:[],chartToolbar:[]},this.container=this.ctx.domManager.addChild("canvas-overlay","shared-toolbar"),this.container.role="presentation"}getSharedToolbar(t){return this.sharedToolbar||this.createSharedToolbar(),this.toolbarWithSection(t)}createSharedToolbar(){this.sharedToolbar=new a.n1.Toolbar(this.ctx.localeManager,"vertical"),this.sharedToolbar.addClass("ag-charts-shared-toolbar"),this.container.append(this.sharedToolbar.getElement()),this.destroyFns.push(()=>{this.sharedToolbar&&(this.container.removeChild(this.sharedToolbar.getElement()),this.sharedToolbar.destroy(),this.sharedToolbar=void 0)})}toolbarWithSection(e){let i=this.sharedToolbar,a={layout:(t,a)=>{if(null!=this.firstLayoutSection&&this.firstLayoutSection!==e&&this.activeSections.has(this.firstLayoutSection))return;this.firstLayoutSection=e;let s=i.getBounds().width;i.setBounds({x:t.x,y:t.y,width:s}),t.shrink({left:s+i.horizontalSpacing+(a??0)})},addToolbarListener:(t,a)=>i.addToolbarListener(t,t=>{let i=this.getSectionIndex(e,t.button.index);i<0||a({...t,button:this.sectionButtons[e][i]})}),updateButtons:a=>{this.sectionButtons[e]=a;let s=t.SECTION_ORDER.flatMap(t=>this.sectionButtons[t]);i.updateButtons(s)},updateButtonByIndex:(t,a)=>{i.updateButtonByIndex(this.getIndex(e,t),a)},toggleActiveButtonByIndex:t=>{i.toggleActiveButtonByIndex(this.getIndex(e,t))},toggleButtonEnabledByIndex:(t,a)=>{i.toggleButtonEnabledByIndex(this.getIndex(e,t),a)},setHidden:a=>{a?this.activeSections.delete(e):this.activeSections.add(e);let s=0;for(let o of t.SECTION_ORDER){if(o!==e){s+=this.sectionButtons[o].length;continue}for(let t of this.sectionButtons[e].keys())i.setButtonHiddenByIndex(s+t,a)}},destroy:()=>{a.setHidden(!0),0===this.activeSections.size&&this.destroy()},clearActiveButton:i.clearActiveButton.bind(i),addListener:i.addListener.bind(i),removeListener:i.removeListener.bind(i)};return a.setHidden(!1),a}getIndex(e,i){let a=0;for(let s of t.SECTION_ORDER){if(s===e)return a+i;a+=this.sectionButtons[s].length}return -1}getSectionIndex(e,i){let a=0;for(let s of t.SECTION_ORDER){if(s===e){if(i>=a+this.sectionButtons[e].length)return -1;return i-a}a+=this.sectionButtons[s].length}return -1}};l1.SECTION_ORDER=["chartToolbar","annotations"];var l2={type:"context",contextKey:"sharedToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new l1(t)},{CachedTextMeasurerPool:l4,ZIndexMap:l5,LayoutElement:l3,Property:l6,BaseProperties:l8,valueProperty:l9,TextUtils:l7,Group:ht,Label:he,Rect:hi,Text:ha}=a.n1,hs={ohlc:62,candlestick:62,"hollow-candlestick":62,line:96,"step-line":96,hlc:184,"high-low":800},ho={up:"positive",down:"negative"},hr={hlc:"altNeutral"},hn=class extends l8{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};n([l6],hn.prototype,"fill",2),n([l6],hn.prototype,"fillOpacity",2);var hl=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.openKey=void 0,this.highKey=void 0,this.lowKey=void 0,this.closeKey=void 0,this.volumeKey=void 0,this.title=new he,this.positive=new he,this.negative=new he,this.neutral=new he,this.altNeutral=new he,this.background=new hn,this.layoutStyle="block",this.id="status-bar",this.data=void 0,this.layer=new ht({name:"StatusBar",zIndex:l5.STATUS_BAR}),this.labelGroup=this.layer.appendChild(new a.n1.TranslatableGroup),this.backgroundNode=this.labelGroup.appendChild(new hi),this.labels=[{label:"O",configuration:2,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),id:"openValue",key:"openKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:16,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:256,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),style:"neutral",id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:8,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:512,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),style:"neutral",id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:4,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:128,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),id:"closeValue",key:"closeKey",style:"neutral",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"",configuration:64,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),style:"neutral",id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})},{label:"Vol",configuration:32,title:this.labelGroup.appendChild(new ha),value:this.labelGroup.appendChild(new ha),id:"volumeValue",key:"volumeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})}],this.highlightManager=t.highlightManager,this.labelGroup.visible=!1,this.destroyFns.push(t.scene.attachNode(this.layer),t.layoutManager.registerElement(l3.Overlay,t=>this.startPerformLayout(t)),t.layoutManager.addListener("layout:complete",t=>this.onLayoutComplete(t)),t.highlightManager.addListener("highlight-change",()=>this.updateHighlight()))}async processData(t){if(!this.enabled||null==this.data)return;let e=[];for(let t of this.labels){let{id:i,key:a}=t,s=this[a];null==s?t.domain=void 0:e.push(l9(s,"number",{id:i}))}if(0===e.length)return;let{processedData:i,dataModel:a}=await t.request(this.id,this.data,{props:e});for(let t of this.labels){let{id:e,key:s}=t;null!=this[s]&&(t.domain=a.getDomain(this,e,"value",i))}}startPerformLayout(t){let e;if(this.labelGroup.translationX=0,this.labelGroup.translationY=0,!this.enabled)return;let{layoutBox:i}=t;this.labelGroup.translationY=i.y+0;let a=Math.max(this.title.fontSize,this.positive.fontSize,this.negative.fontSize),s=l7.getLineHeight(a),o=hs[this.getChartType()]??0,r=0,n="alphabetic";if("block"===this.layoutStyle)i.shrink(0+s+8,"top"),e=a+(s-a)/2;else{let{title:t}=this.ctx.chartService;if(n="top",e=0+t.padding,t.enabled){let e=t.node.getBBox();r=e.x+e.width+12}else r=t.padding}for(let{label:t,configuration:i,title:a,value:s,domain:l,formatter:h}of this.labels){if(null==l||(o&i)==0){a.visible=!1,s.visible=!1;continue}let d=Math.max(l4.measureText(h.format(l[0]),{font:this.positive.getFont(),textBaseline:n,textAlign:"left"}).width,l4.measureText(h.format(l[1]),{font:this.positive.getFont(),textBaseline:n,textAlign:"left"}).width,l4.measureText(h.format(l[0]),{font:this.negative.getFont(),textBaseline:n,textAlign:"left"}).width,l4.measureText(h.format(l[1]),{font:this.negative.getFont(),textBaseline:n,textAlign:"left"}).width);a.visible=!0,s.visible=!0;let c=l4.measureText(t,{font:this.title.getFont(),textBaseline:n,textAlign:"left"});a.setFont(this.title),a.fill=this.title.color,a.text=t,a.textBaseline=n,a.y=e,a.x=r,r+=c.width+4,s.textBaseline=n,s.y=e,s.x=r,r+=d+12}this.backgroundNode.x=0,this.backgroundNode.y=0,this.backgroundNode.width=r-12,this.backgroundNode.height=s+0+8,this.backgroundNode.fill=this.background.fill,this.backgroundNode.fillOpacity=this.background.fillOpacity}onLayoutComplete(t){this.labelGroup.translationX=t.series.rect.x,this.updateHighlight()}updateHighlight(){if(!this.enabled)return;let t=this.highlightManager.getActiveHighlight(),e=t?.datum??this.data?.at(-1);if(null==e){this.labelGroup.visible=!1;return}this.labelGroup.visible=!0;let i=t?.itemId,a=null!=i?ho[i]:void 0;for(let{domain:t,value:i,key:s,formatter:o,style:r}of(null==a&&null!=this.openKey&&null!=this.closeKey&&(a=e[this.openKey]<e[this.closeKey]?"positive":"negative"),this.labels)){if(null==t)continue;let n=r??a??"neutral";"neutral"===n&&(n=hr[this.getChartType()]??n);let l=this[s],h=null!=l?e?.[l]:void 0;i.setFont(this[n]),i.fill=this[n].color,i.text="number"==typeof h?o.format(h):""}}getChartType(){let t=this.ctx.chartService.publicApi?.getOptions()?.chartType;return(null==t||null==hs[t])&&(t="candlestick"),t}};n([l6],hl.prototype,"enabled",2),n([l6],hl.prototype,"openKey",2),n([l6],hl.prototype,"highKey",2),n([l6],hl.prototype,"lowKey",2),n([l6],hl.prototype,"closeKey",2),n([l6],hl.prototype,"volumeKey",2),n([l6],hl.prototype,"title",2),n([l6],hl.prototype,"positive",2),n([l6],hl.prototype,"negative",2),n([l6],hl.prototype,"neutral",2),n([l6],hl.prototype,"altNeutral",2),n([l6],hl.prototype,"background",2),n([l6],hl.prototype,"layoutStyle",2);var hh={type:"root",identifier:"status-bar",optionsKey:"statusBar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new hl(t),themeTemplate:{statusBar:{enabled:!1,layoutStyle:a.n1.ThemeSymbols.DEFAULT_CAPTION_LAYOUT_STYLE,title:{color:{$ref:"textColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},positive:{color:{$palette:"up.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},negative:{color:{$palette:"down.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},neutral:{color:{$palette:"neutral.stroke"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}},background:{fill:{$ref:"backgroundColor"},fillOpacity:.5},altNeutral:{color:"gray",fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"}}}}},{BaseProperties:hd,CartesianAxis:hc,ChartAxisDirection:hp,ContinuousScale:hu,ChartUpdateType:hg,ObserveChanges:hy,TooltipManager:hf,Property:hm,findMinMax:hx,isObjectWithStringProperty:hb}=a.n1,hv=a.n1.Debug.create("sync");function hS(t,e,i){let a=t.getKeys(e),s=t.getKeys(i);return t.shouldFlipXY?.()?[s,a]:[a,s]}function hk(t="x"){switch(t){case"x":return[hp.X];case"y":return[hp.Y];case"xy":return[hp.X,hp.Y]}}var hD=class extends hd{constructor(t){super(),this.moduleContext=t,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0,this.domainMode="key",this.domainSync=new s.iN}updateSiblings(t){let{syncManager:e}=this.moduleContext;for(let i of e.getGroupSiblings(t??this.groupId))hv("ChartSync.updateSiblings()",i.id,i),this.updateChart(i)}updateChart(t,e=hg.PROCESS_DOMAIN){hv("ChartSync.updateChart()",t.id,hg[e],t),e===hg.PROCESS_DOMAIN?t.ctx.updateService.update(e,{forceNodeDataRefresh:!0}):t.ctx.updateService.update(e)}enabledZoomSync(){let{syncManager:t,zoomManager:e}=this.moduleContext;this.disableZoomSync?.(),this.disableZoomSync=e.addListener("zoom-change",()=>{for(let e of t.getGroupSiblings(this.groupId))e.modulesManager.getModule("sync")?.zoom&&e.ctx.zoomManager.updateZoom("sync",this.mergeZoom(e))})}enabledNodeInteractionSync(){let{highlightManager:t}=this.moduleContext;this.disableNodeInteractionSync?.(),this.disableNodeInteractionSync=t.addListener("highlight-change",this.onHighlightChange.bind(this))}onHighlightChange(t){let{syncManager:e}=this.moduleContext;if(t.callerId.endsWith("-sync"))return;hv("ChartSync.onHighlightChange()",t);let i=t.currentHighlight?.series,[a]=hk(this.axes),o=a===hp.X?hp.Y:hp.X,[r,n]=i?hS(i,a,o):[],l=r?.[0]?t.currentHighlight?.datum?.[r[0]]:void 0,h=(0,s.$P)(l);if(h&&(l=l.getTime()),!t.currentHighlight?.datum){for(let t of e.getGroupSiblings(this.groupId))t.modulesManager.getModule("sync")?.nodeInteraction&&(t.ctx.highlightManager.updateHighlight(`${t.id}-sync`),t.ctx.tooltipManager.removeTooltip(`${t.id}-sync`));return}let d="multi-series"===e.getGroupSyncMode(this.groupId);this.findMatchingHighlightNodes(a,o,d?n:[],h,l,t)}findMatchingHighlightNodes(t,e,i,a,o,r){let{syncManager:n}=this.moduleContext;for(let l of(hv("ChartSync.findMatchingHighlightNodes()",{mainDirection:t,secondaryKeys:i}),n.getGroupSiblings(this.groupId))){if(!l.modulesManager.getModule("sync")?.nodeInteraction)continue;let n=!1;for(let r of l.axes){if(!hc.is(r)||r.direction!==t)continue;let h=l.series.filter(a=>{if(!a.visible)return!1;if(i.length>0){let[,s]=hS(a,t,e);return i.every(t=>s.includes(t))}return!0}).map(this.findMatchingNodes(r,t,a,o)).filter(s.vM);if(1===h.length&&h[0]?.nodeDatum!==l.ctx.highlightManager.getActiveHighlight()){this.dispatchHighlightUpdate(l,h[0].nodeDatum),n=!0;break}}n||(hv("ChartSync.findMatchingHighlightNodes() - no matching nodes",l.id,r),this.dispatchHighlightUpdate(l))}}findMatchingNodes(t,e,i,a){return s=>{let o=s.getKeys(t.direction);if(t.keys.length&&!t.keys.some(t=>o.includes(t)))return;let r=s.contextNodeData?.nodeData??[];if(!r?.length)return;let n=r[0],l=`${e}Key`;if(!hb(n,l))return;let h=n[l],d=r.find(t=>{let e=t.datum[h];return i?e.getTime()===a:e===a});return d?{series:s,nodeDatum:d}:null}}dispatchHighlightUpdate(t,e){hv("ChartSync.dispatchHighlightUpdate()",t.id,e),t.ctx.highlightManager.updateHighlight(`${t.id}-sync`,e);let i=e?.series.tooltipEnabled??t.tooltip.enabled;if(e&&i){let i=t.seriesAreaBoundingBox,a=i.x+(e.midPoint?.x??e.point?.x??0),s=i.y+(e.midPoint?.y??e.point?.y??0),o=hf.makeTooltipMeta({type:"pointermove",canvasX:a,canvasY:s},e.series,e,void 0);t.ctx.tooltipManager.updateTooltip(`${t.id}-sync`,o,t.getTooltipContent(e.series,e.datumIndex,e))}else t.ctx.tooltipManager.removeTooltip(`${t.id}-sync`);this.updateChart(t,hg.SERIES_UPDATE)}async getSyncedDomain(t){if(!hc.is(t)||"xy"!==this.axes&&this.axes!==t.direction)return;let{groupState:e,directionDomains:i,domainsByKey:a,positionDomains:s}=this.updateDomainState(t);return(this.validateAxis(t,e),await this.waitForDomainsToBeReady(),"position"===this.domainMode)?this.calculateDerivedDomain(t,s):"direction"===this.domainMode||0===t.keys.length?this.calculateDerivedDomain(t,i):this.calculateKeyDerivedDomain(t,a)}updateDomainState(t){var e,i,a,s,o;let{syncManager:r}=this.moduleContext,n=r.getChart().id,l=t.id,h=r.getGroupState(this.groupId);if(!h)throw Error("AG Charts - no GroupState for groupId: "+this.groupId);let d=h.domains??(h.domains={}),c=d[e=t.direction]??(d[e]={derived:[],sources:{},dirty:!0});((i=c.sources)[n]??(i[n]={}))[l]=t.dataDomain.domain,c.dirty=!0;let p=h.domainsByKey??(h.domainsByKey={});for(let e of t.keys??[]){let i=p[e]??(p[e]={derived:[],sources:{},dirty:!0});((a=i.sources)[n]??(a[n]={}))[l]=t.dataDomain.domain,i.dirty=!0}let u=h.domainsByPosition??(h.domainsByPosition={}),g=u[s=t.position]??(u[s]={derived:[],sources:{},dirty:!0});return((o=g.sources)[n]??(o[n]={}))[l]=t.dataDomain.domain,g.dirty=!0,{groupState:h,directionDomains:c,domainsByKey:p,positionDomains:g}}validateAxis(t,e){let i="multi-series"===this.moduleContext.syncManager.getGroupSyncMode(this.groupId);hk(this.axes).includes(t.direction)&&(i?this.validateMultiSeries(t,e):this.validateSingleSeries(t,e))}validateMultiSeries(t,e){let{min:i,max:a,nice:o,reverse:r}=t,n=new Set(t.boundSeries.flatMap(e=>e.getKeys(t.direction)));for(let t of e.members){let{axes:e,modulesManager:l}=t,h=hk(l.getModule("sync")?.axes),d=e.filter(t=>h.includes(t.direction)).filter(t=>t.boundSeries.some(e=>e.getKeys(t.direction).some(t=>n.has(t))));if(0===d.length)continue;let[c]=d;if(c.min!==i||c.max!==a||c.nice!==o||c.reverse!==r){s.Vy.warnOnce("To allow synchronization, ensure that all synchronized axes with matching keys have matching min, max, nice, and reverse properties."),this.enabled=!1;return}}}validateSingleSeries(t,e){let[{axes:i}]=e.members,{direction:a,min:o,max:r,nice:n,reverse:l}=t;for(let t of i)if(a===t.direction&&(n!==t.nice||l!==t.reverse||o!==t.min&&((0,s.Bf)(o)||(0,s.Bf)(t.min))||r!==t.max&&((0,s.Bf)(r)||(0,s.Bf)(t.max)))){s.Vy.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),this.enabled=!1;return}}calculateDerivedDomain(t,e){if(!e.dirty)return e.derived;let i=e.derived;return e.derived=(0,s.Am)(Object.values(e.sources).map(t=>Object.values(t)).flat(2)),hu.is(t.scale)&&(e.derived=hx(e.derived)),e.dirty=!1,(0,s.r1)(i,e.derived)||(hv(t.id,"updated",t.keys,{before:i,after:e.derived}),this.updateSiblings()),e.derived}calculateKeyDerivedDomain(t,e){let i=[],a=[],o=!1;for(let r of t.keys??[]){let n=e[r],l=n.derived;if(i.push(...l),!n.dirty){a.push(...n.derived);continue}n.derived=(0,s.Am)(Object.values(n.sources).map(t=>Object.values(t)).flat(2)),hu.is(t.scale)&&(n.derived=hx(n.derived)),a.push(...n.derived),n.dirty=!1,o||(o=!(0,s.r1)(l,n.derived))}return hu.is(t.scale)&&(i=hx(i),a=hx(a)),o&&!(0,s.r1)(i,a)&&(hv(t.id,"updated",t.keys,{before:i,after:a}),this.updateSiblings()),a}removeAxis(t){if(!hc.is(t)||"xy"!==this.axes&&this.axes!==t.direction)return;let{syncManager:e}=this.moduleContext,i=e.getGroupState(this.groupId),a=e.getChart().id,s=t.id;for(let e of(delete i?.domains?.[t.direction]?.sources?.[a]?.[s],t.keys??[]))delete i?.domainsByKey?.[e]?.sources?.[a]?.[s];delete i?.domainsByPosition?.[t.position]?.sources?.[a]?.[s]}async waitForDomainsToBeReady(){let{syncManager:t}=this.moduleContext,e=0;for(;t.getGroupMembers(this.groupId).some(t=>"init"===t.syncStatus);)hv("ChartSync.waitForDomainsToBeReady() - waiting for all domains to be calculated",this.groupId),await this.domainSync.await(),e++;e>0&&hv("ChartSync.waitForDomainsToBeReady() - waited for",e,"iterations"),this.domainSync.notify()}mergeZoom(t){let{zoomManager:e}=this.moduleContext;if("xy"===this.axes)return e.getZoom();let i=t.ctx.zoomManager.getZoom()??{};return i[this.axes]=e.getZoom()?.[this.axes],i}onEnabledChange(){let{syncManager:t}=this.moduleContext;this.enabled?t.subscribe(this.groupId):t.unsubscribe(this.groupId),this.updateSiblings(),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(t,e){if(!this.enabled||t===e)return;let{syncManager:i}=this.moduleContext;i.unsubscribe(e),i.subscribe(t),this.updateSiblings(e),this.updateSiblings(t)}onAxesChange(){if(!this.enabled)return;let{syncManager:t}=this.moduleContext;this.updateChart(t.getChart())}onNodeInteractionChange(){this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():this.disableNodeInteractionSync?.()}onZoomChange(){this.enabled&&this.zoom?this.enabledZoomSync():this.disableZoomSync?.()}destroy(){let{syncManager:t}=this.moduleContext;t.unsubscribe(this.groupId),this.updateSiblings(),this.disableZoomSync?.()}};hD.className="Sync",n([hm,hy(t=>t.onEnabledChange())],hD.prototype,"enabled",2),n([hm,hy((t,e,i)=>t.onGroupIdChange(e,i))],hD.prototype,"groupId",2),n([hm,hy(t=>t.onAxesChange())],hD.prototype,"axes",2),n([hm,hy(t=>t.onNodeInteractionChange())],hD.prototype,"nodeInteraction",2),n([hm,hy(t=>t.onZoomChange())],hD.prototype,"zoom",2),n([hm,hy(t=>t.onAxesChange())],hD.prototype,"domainMode",2);var hM={type:"root",optionsKey:"sync",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new hD(t),themeTemplate:{sync:{enabled:!1}}},{Property:hw}=a.n1,hI="#2196f3",hC=class extends a.n1.Rect{constructor(){super(...arguments),this.fill=hI,this.fillOpacity=.2,this.zIndex=a.n1.ZIndexMap.ZOOM_SELECTION}updateValid(){this.fill=hI}updateInvalid(){this.fill="#8a8a8a"}};hC.className="ZoomRect",n([hw],hC.prototype,"fill",2),n([hw],hC.prototype,"fillOpacity",2);var hA={min:0,max:1},hL=hA.max-hA.min,hT="middle",hN=(t,e=hA.min,i=hA.max)=>(0,s.qE)(e,t,i);function hO(){return{x:{...hA},y:{...hA}}}function hP(t){return t.x.max-t.x.min}function hE(t){return t.y.max-t.y.min}function hR(t,e,i=1e-10){return(0,s.YX)(t.min,e.min,i)&&(0,s.YX)(t.max,e.max,i)}function hB(t,e,i){return hR(t.x,e.x,i)&&hR(t.y,e.y,i)}function hz(t){return{x:{min:t?.x?.min??hA.min,max:t?.x?.max??hA.max},y:{min:t?.y?.min??hA.min,max:t?.y?.max??hA.max}}}function hF(t,e,i){if(!t)return{x:0,y:0};let a=hN(e-t.x,0,t.x+t.width),s=hN(i-t.y,0,t.y+t.height),o=1/t.width*a,r=1-1/t.height*s;return{x:hN(o),y:hN(r)}}function h_(t,e,i){return{x:{min:t.x.min+e,max:t.x.max+e},y:{min:t.y.min+i,max:t.y.max+i}}}function hW(t,e,i){return{x:{min:t.x.min,max:t.x.min+hP(t)*e},y:{min:t.y.min,max:t.y.min+hE(t)*i}}}function hG(t,e,i){let a=hP(t),s=hE(t),o=t.x.min+a/2,r=t.y.min+s/2;return{x:{min:o-a*e/2,max:o+a*e/2},y:{min:r-s*i/2,max:r+s*i/2}}}function hj(t,e,i,a){let{min:s,max:o}=e,r=s+(o-s)/2,n=t.max-t.min;switch(i){case"start":return{min:s,max:e.min+n};case"end":return{min:e.max-n,max:o};case"middle":return{min:r-n/2,max:r+n/2};case"pointer":var l=t,h=e,d=a??r;let c=l.max-l.min,p=d-d*(1-(h.max-h.min-c));return{min:l.min+p,max:l.max+p};default:return{min:s,max:o}}}function hV(t){return{x:h$(t.x),y:h$(t.y)}}function h$(t){let e=t.max-t.min,i=t.max>hA.max?hA.max-e:t.min,a=t.min<hA.min?e:t.max;return{min:i=Math.max(hA.min,i),max:a=Math.min(hA.max,a)}}var hH=class{update(t,e,i,s,o,r){return this.oldZoom??(this.oldZoom=hz(e===a.n1.ChartAxisDirection.X?{...o,x:r}:{...o,y:r})),this.updateCoords(t.currentX,t.currentY),this.updateZoom(e,i,s)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(t,e){this.coords?(this.coords.x2=t,this.coords.y2=e):this.coords={x1:t,y1:e,x2:t,y2:e}}updateZoom(t,e,i){let{coords:s,oldZoom:o}=this,r=hz(o);if(!s||!o)return t===a.n1.ChartAxisDirection.X?r.x:r.y;let n=hF(i,s.x1,s.y1),l=hF(i,s.x2,s.y2);if(t===a.n1.ChartAxisDirection.X){let t=(l.x-n.x)*hP(o);return r.x.max+=t,r.x=hj(r.x,o.x,e,n.x),(r=hV(r)).x}let h=(l.y-n.y)*hE(o);return r.y.max-=h,r.y=hj(r.y,o.y,e,n.y),(r=hV(r)).y}},hY=class{constructor(t,e,i,a,s,o){this.contextMenuRegistry=t,this.zoomManager=e,this.getModuleProperties=i,this.getRect=a,this.updateZoom=s,this.isZoomValid=o}registerActions(t){let{contextMenuRegistry:e}=this;if(t)e.setVisible("zoom-to-cursor",!0),e.setVisible("pan-to-cursor",!0);else{e.setVisible("zoom-to-cursor",!1),e.setVisible("pan-to-cursor",!1);return}e.builtins.items["zoom-to-cursor"].action=this.onZoomToHere.bind(this),e.builtins.items["pan-to-cursor"].action=this.onPanToHere.bind(this);let i=t=>{let e=this.getRect();if(!e)return!0;let i=hF(e,t.x,t.y);return null!=this.iterateFindNextZoomAtPoint(i)},a=()=>!hB(hz(this.zoomManager.getZoom()),hO()),s=e.addListener("context-setup",t=>{e.builtins.items["zoom-to-cursor"].enabled=i(t),e.builtins.items["pan-to-cursor"].enabled=a()});return()=>{s(),e.setVisible("zoom-to-cursor",!1),e.setVisible("pan-to-cursor",!1)}}computeOrigin(t){let e=this.getRect(),{enabled:i}=this.getModuleProperties();if(i&&e&&t?.target&&t instanceof MouseEvent)return hF({x:0,y:0,width:e.width,height:e.height},t.offsetX,t.offsetY)}onZoomToHere({event:t}){let e=this.computeOrigin(t);if(!e)return;let i=this.iterateFindNextZoomAtPoint(e);null!=i&&this.updateZoom(i)}onPanToHere({event:t}){let e=this.computeOrigin(t);if(!e)return;let i=hz(this.zoomManager.getZoom()),a=hP(i),s=hE(i),o=e.x*a,r=e.y*s,n=hL/2,l={x:{min:e.x-n,max:e.x+n},y:{min:e.y-n,max:e.y+n}};l=h_(l=hG(l,a,s),i.x.min-e.x+o,i.y.min-e.y+r),this.updateZoom(hV(l))}iterateFindNextZoomAtPoint(t){let{scrollingStep:e}=this.getModuleProperties();for(let i=e;i<=1-e;i+=e){let e=this.getNextZoomAtPoint(t,i);if(this.isZoomValid(e))return e}}getNextZoomAtPoint(t,e){let{isScalingX:i,isScalingY:a}=this.getModuleProperties(),s=hz(this.zoomManager.getZoom()),o=t.x*hP(s),r=t.y*hE(s),n=hL/2,l={x:{min:t.x-n,max:t.x+n},y:{min:t.y-n,max:t.y+n}};return hV(l=h_(l=hG(l,i?hP(s)*e:hL,a?hE(s)*e:hL),s.x.min-t.x+o,s.y.min-t.y+r))}},{BBoxValues:hK,ChartAxisDirection:hU}=a.n1,hX=class{constructor(t){this.axesHandlers=t,this.axes=[]}destroy(){this.axes.forEach(t=>t.div.destroy())}update(t,e){if(this.axes.forEach(e=>e.div.setHidden(!t)),!t)return;let{X:i,Y:s}=a.n1.ChartAxisDirection,o=[...e.axisManager.getAxisContext(i),...e.axisManager.getAxisContext(s)],{removed:r,added:n}=this.diffAxisIds(o);for(let t of(r.length>0&&(this.axes=this.axes.filter(t=>!r.includes(t.axisId)||(t.div.destroy(),!1))),n)){let{axisId:i,direction:a}=t;this.axes.push(this.initAxis(e,i,this.axesHandlers,a))}for(let t of this.axes){let e=o.find(e=>e.axisId===t.axisId).getCanvasBounds();t.div.setHidden(hK.isEmpty(e)),void 0!==e&&t.div.setBounds(e)}}toggleAxisDraggingCursor(t,e){for(let i of this.axes)i.direction===t&&i.div.setCursor(e?this.getCursor(t):void 0)}getCursor(t){return t===hU.X?"ew-resize":"ns-resize"}initAxis(t,e,i,a){let s=t.proxyInteractionService.createProxyElement({type:"region",domManagerId:e,where:"afterend"});return s.setCursor(this.getCursor(a)),s.addListener("drag-start",t=>{"touch"===t.device&&t.sourceEvent.preventDefault(),i.onDragStart(e,a)}),s.addListener("drag-move",t=>i.onDrag(t)),s.addListener("drag-end",i.onDragEnd),s.addListener("dblclick",()=>i.onDoubleClick(e,a)),{axisId:e,div:s,direction:a}}diffAxisIds(t){let e=this.axes.map(t=>t.axisId),i=t.map(t=>t.axisId);return{removed:e.filter(t=>!i.includes(t)),added:t.filter(t=>!e.includes(t.axisId))}}},hZ={off:1,short:.01,long:.002},hQ=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}get decelerationValue(){let{deceleration:t}=this;return Math.max("number"==typeof t?t:hZ[t]??1,1e-4)}addListener(t,e){return this.onUpdate=e,()=>{this.onUpdate=void 0}}stopInteractions(){null!=this.inertiaHandle&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(t){this.updateCoords(t.currentX,t.currentY);let{x1:e=0,y1:i=0,x2:a=0,y2:s=0}=this.coords??{};this.onUpdate?.({type:"update",deltaX:e-a,deltaY:i-s})}start(){this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){let{coordsHistory:t}=this,e=0,i=0,a=0;if(t.length>0){let s=this.zoomCoordsHistoryIndex%16,o=s-1;o<0&&(o=t.length-1);let r=s;r>=t.length&&(r=0);let n=t[o],l=t[r];e=n.x-l.x,i=n.y-l.y,a=n.t-l.t}if(this.coords=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,a>0&&this.decelerationValue<1){let t=e/a,o=i/a,r=Math.hypot(t,o),n=Math.atan2(o,t),l=performance.now();this.inertiaHandle=(0,s.zk)().requestAnimationFrame(t=>{this.animateInertia(t,t,l,r,n)})}}recordCurrentZoomCoords(){let{coords:t,coordsHistory:e,zoomCoordsHistoryIndex:i}=this;if(!t)return;let{x2:a,y2:s}=t,o=Date.now();e[i%16]={x:a,y:s,t:o},this.zoomCoordsHistoryIndex+=1}animateInertia(t,e,i,a,s){let o=1-this.decelerationValue,r=-a/Math.log(o),n=a*(o**(e-i)-1)/Math.log(o),l=a*(o**(t-i)-1)/Math.log(o);this.onUpdate?.({type:"update",deltaX:-Math.cos(s)*(l-n),deltaY:-Math.sin(s)*(l-n)}),l>=r-1||(this.inertiaHandle=requestAnimationFrame(e=>{this.animateInertia(e,t,i,a,s)}))}updateCoords(t,e){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:t,y2:e}:this.coords={x1:t,y1:e,x2:t,y2:e}}translateZooms(t,e,i,a){let o=hF(t,t.x+Math.abs(i),t.y+t.height-Math.abs(a)),r=Math.sign(i)*o.x,n=-Math.sign(a)*o.y,l={};for(let[t,{direction:i,zoom:a}]of(0,s.jO)(e)){if(a&&a.min===hA.min&&a.max===hA.max)continue;let e=hz({[i]:a});e=hV(h_(e,r*hP(e),n*hE(e))),l[t]={direction:i,zoom:e[i]}}return l}},hq=class{update(t,e,i,a){let s=t.deltaX*e*200;return this.translateZooms(i,a,s)}translateZooms(t,e,i){let o={},r=hF(t,t.x+Math.abs(i),0),n=i<0?-r.x:r.x;for(let[t,{direction:i,zoom:r}]of(0,s.jO)(e)){if(i!==a.n1.ChartAxisDirection.X)continue;let e=hz({x:r});e=hV(h_(e,n*hP(e),0)),o[t]={direction:i,zoom:e.x}}return o}},hJ=class{updateAxes(t,e,i,o){let r=t.sourceEvent,n={},{anchorPointX:l,anchorPointY:h,isScalingX:d,isScalingY:c,scrollingStep:p}=e,u=hF(i,r.offsetX??r.clientX,r.offsetY??r.clientY);for(let[e,{direction:i,zoom:r}]of(0,s.jO)(o)){if(null==r)continue;let s={...r},o=p*t.deltaY*(r.max-r.min);if(i===a.n1.ChartAxisDirection.X&&d)s.max+=o,s=hj(s,r,l,u.x);else{if(i!==a.n1.ChartAxisDirection.Y||!c)continue;s.max+=o,s=hj(s,r,h,u.y)}n[e]={direction:i,zoom:h$(s)}}return n}update(t,e,i,a){let{anchorPointX:s,anchorPointY:o,isScalingX:r,isScalingY:n,scrollingStep:l}=e,h=t.offsetX+i.x,d=t.offsetY+i.y,c=hF(i,h,d),p=t.deltaY,u=hz(a);return u.x.max+=r?l*p*hP(a):0,u.y.max+=n?l*p*hE(a):0,r&&(u.x=hj(u.x,a.x,s,c.x)),n&&(u.y=hj(u.y,a.y,o,c.y)),u=hV(u)}updateDelta(t,e,i){let{anchorPointX:a,anchorPointY:s,isScalingX:o,isScalingY:r,scrollingStep:n}=e,l=hz(i);return l.x.max+=o?-(n*t)*hP(i):0,l.y.max+=r?-(n*t)*hE(i):0,o&&(l.x=hj(l.x,i.x,a)),r&&(l.y=hj(l.y,i.y,s)),l=hV(l)}},h0=class{constructor(t,e,i){this.rect=t,this.getZoom=e,this.isZoomValid=i,this.rect.visible=!1}update(t,e,i){let a=t.currentX+(i?.x??0),s=t.currentY+(i?.y??0);this.rect.visible=!0,this.updateCoords(a,s,e,i),this.updateRect(i)}stop(t,e,i){var a;let s=hz();if(!t||!e)return s;this.coords&&(s=this.createZoomFromCoords(e,i));let o=e.width/t.width,r=e.height/t.height;return s=hV({x:{min:(a=s).x.min*o,max:a.x.max*o},y:{min:a.y.min*r,max:a.y.max*r}}),this.reset(),s}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible&&this.rect.width>0&&this.rect.height>0}updateCoords(t,e,i,a){if(!this.coords){this.coords={x1:t,y1:e,x2:t,y2:e};return}let{coords:s}=this;if(s.x2=t,s.y2=e,!a)return;let{isScalingX:o,isScalingY:r,keepAspectRatio:n}=i,l=this.getNormalisedDimensions();if(n&&o&&r){let t=a.width/a.height;s.y2<s.y1?s.y2=Math.min(s.y1-l.width/t,s.y1):s.y2=Math.max(s.y1+l.width/t,s.y1)}o||(s.x1=a.x,s.x2=a.x+a.width),r||(s.y1=a.y,s.y2=a.y+a.height)}updateRect(t){if(!t)return;let{rect:e}=this,i=this.getNormalisedDimensions(),{width:a,height:s}=i,{x:o,y:r}=i;o=Math.max(o,t.x),o-=Math.max(0,o+a-(t.x+t.width)),r=Math.max(r,t.y),r-=Math.max(0,r+s-(t.y+t.height)),e.x=o,e.y=r,e.width=a,e.height=s;let n=this.createZoomFromCoords(t,this.getZoom());this.isZoomValid(n)?e.updateValid():e.updateInvalid()}createZoomFromCoords(t,e){let i=hz(e),a=this.getNormalisedDimensions(),s=hF(t,a.x,a.y+a.height),o=hW(i,a.width/t.width,a.height/t.height);return hV(o=h_(o,s.x*hP(i),s.y*hE(i)))}getNormalisedDimensions(){let{x1:t=0,y1:e=0,x2:i=0,y2:a=0}=this.coords??{};return{x:t<=i?t:i,y:e<=a?e:a,width:t<=i?i-t:t-i,height:e<=a?a-e:e-a}}},{ActionOnSet:h1,BaseProperties:h2,ChartAxisDirection:h4,NativeWidget:h5,PropertiesArray:h3,Toolbar:h6,ToolbarButtonProperties:h8,Property:h9}=a.n1,h7=class extends h8{};n([h9],h7.prototype,"value",2),n([h9],h7.prototype,"section",2);var dt=class extends h2{constructor(t,e,i,a,o,r,n){super(),this.ctx=t,this.getModuleProperties=e,this.getResetZoom=i,this.updateZoom=a,this.updateAxisZoom=o,this.resetZoom=r,this.isZoomValid=n,this.enabled=!1,this.buttons=new h3(h7),this.visible="hover",this.verticalSpacing=10,this.detectionRange=38,this.destroyFns=[],this.container=new h5((0,s.n)("div")),this.container.addClass("ag-charts-zoom-buttons"),t.domManager.addChild("canvas-overlay","zoom-buttons",this.container.getElement()),this.toolbar=new h6(t.localeManager),this.container.addChild(this.toolbar),this.toolbar.getElement().style.transform="translateY(54px)",this.toggleVisibility("always"===this.visible),this.destroyFns.push(this.toolbar.addToolbarListener("button-pressed",this.onButtonPress.bind(this)),this.toolbar.addToolbarListener("button-focused",this.onButtonFocus.bind(this)),t.widgets.containerWidget.addListener("mousemove",this.onHover.bind(this)),t.widgets.containerWidget.addListener("mouseleave",this.onLeave.bind(this)),t.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),this.teardown.bind(this))}destroy(){for(let t of this.destroyFns)t()}toggleVisibleZoomed(t){"zoomed"===this.visible&&this.toggleVisibility(!t)}teardown(){this.ctx.domManager.removeChild("canvas-overlay","zoom-buttons"),this.container.destroy()}onLayoutComplete(t){let{buttons:e,container:i}=this,{rect:a}=t.series;this.toolbar.updateButtons(e),this.toggleButtons();let s=i.getBounds().height;i.setBounds({y:a.y+a.height-s})}onHover(t){if(!this.enabled||"hover"!==this.visible||this.toolbar.isHidden())return;let{container:e,detectionRange:i,ctx:{scene:a}}=this,{currentY:s,sourceEvent:{target:o}}=t,r=e.getElement(),n=s>r.offsetTop-i&&s<a.canvas.element.offsetHeight||o===r;this.toggleVisibility(n)}onLeave(){"hover"===this.visible&&this.toggleVisibility(!1)}toggleVisibility(t,e=!1){let{container:i,toolbar:a,verticalSpacing:s}=this;a.toggleClass("ag-charts-zoom-buttons__toolbar--hidden",!t);let o=a.getElement();o.style.transitionDuration=e?"0s":"",o.style.transform=t?"translateY(0)":`translateY(${i.getBounds().height+s}px)`}toggleButtons(){let t=hz(this.ctx.zoomManager.getZoom());if(!(this.previousZoom&&hB(this.previousZoom,t)))for(let[e,i]of(this.previousZoom=t,this.buttons.entries())){let a=!0;switch(i?.value){case"pan-start":case"pan-left":a=t.x.min>hA.min;break;case"pan-end":case"pan-right":a=t.x.max<hA.max;break;case"zoom-out":a=!hB(t,hO());break;case"zoom-in":a=this.isZoomValid(this.getNextZoomStateUnified("zoom-in",t,this.getModuleProperties()));break;case"reset":a=!hB(t,this.getResetZoom())}this.toolbar.toggleButtonEnabledByIndex(e,a)}}onButtonPress({button:t}){if(!this.enabled||this.toolbar.isHidden())return;let e=this.getModuleProperties();if(e.independentAxes&&"reset"!==t.value){let i=this.ctx.zoomManager.getAxisZooms();for(let[a,{direction:o,zoom:r}]of(0,s.jO)(i))null!=r&&this.onButtonPressAxis(t,e,a,o,r)}else this.onButtonPressUnified(t,e)}onButtonFocus(t){this.toggleVisibility(!0,!0)}onButtonPressAxis(t,e,i,a,s){let{isScalingX:o,isScalingY:r,scrollingStep:n}=e,l={...s},h=s.max-s.min;switch(t.value){case"pan-start":l.max=h,l.min=0;break;case"pan-end":l.min=l.max-h,l.max=hA.max;break;case"pan-left":l.min-=h*n,l.max-=h*n;break;case"pan-right":l.min+=h*n,l.max+=h*n;break;case"zoom-in":case"zoom-out":{let i=a===h4.X,h="zoom-in"===t.value?1-n:1+n;i&&o||!i&&r||(h=1);let d=i?this.getAnchorPointX(e):this.getAnchorPointY(e);l.max=l.min+(l.max-l.min)*h,l=hj(l,s,d)}}this.updateAxisZoom(i,a,h$(l))}onButtonPressUnified(t,e){let{scrollingStep:i}=e,a=hz(this.ctx.zoomManager.getZoom()),s=hz(a);switch(t.value){case"reset":this.resetZoom();return;case"pan-start":s.x.max=hP(s),s.x.min=0;break;case"pan-end":s.x.min=hA.max-hP(s),s.x.max=hA.max;break;case"pan-left":s=h_(s,-hP(s)*i,0);break;case"pan-right":s=h_(s,hP(s)*i,0);break;case"zoom-in":case"zoom-out":s=this.getNextZoomStateUnified(t.value,a,e)}this.updateZoom(hV(s))}getNextZoomStateUnified(t,e,i){let{isScalingX:a,isScalingY:s,scrollingStep:o}=i,r="zoom-in"===t?1-o:1+o,n=hW(e,a?r:1,s?r:1);return n.x=hj(n.x,e.x,this.getAnchorPointX(i)),n.y=hj(n.y,e.y,this.getAnchorPointY(i)),n}getAnchorPointX(t){let e=this.anchorPointX??t.anchorPointX;return"pointer"===e?"end":e}getAnchorPointY(t){let e=this.anchorPointY??t.anchorPointY;return"pointer"===e?hT:e}};function de({min:t,max:e},i,a,s){return 0===s?0:1e6*((i-a)/s*(e-t)+t)}function di(t,e,i,a){0===e&&(e=30),0===a&&(a=30);let s=t-e,o=i-a,r=i+a;return!(t+e<o||r<s)}n([h9,h1({changeValue(t){this.toolbar?.setHidden(!t)}})],dt.prototype,"enabled",2),n([h9],dt.prototype,"buttons",2),n([h9,h1({changeValue(t,e){null!=e&&this.toggleVisibility("always"===t)}})],dt.prototype,"visible",2),n([h9],dt.prototype,"anchorPointX",2),n([h9],dt.prototype,"anchorPointY",2);var da=class{constructor(){this.touchStart={origins:[{identifier:0,normalX:NaN,normalY:NaN},{identifier:0,normalX:NaN,normalY:NaN}]},this.initialZoom={x:{min:0,max:1},y:{min:0,max:1}},this.previous={a1:NaN,a2:NaN,b1:NaN,b2:NaN}}start(t,e,i){if(2!==t.sourceEvent.targetTouches.length)return!1;t.sourceEvent.preventDefault();let a=Array.from(t.sourceEvent.targetTouches),{x:s,y:o,width:r,height:n}=e.getBoundingClientRect();for(let t of(this.initialZoom.x.min=i.x?.min??0,this.initialZoom.x.max=i.x?.max??1,this.initialZoom.y.min=i.y?.min??0,this.initialZoom.y.max=i.y?.max??1,this.touchStart.origins.forEach(t=>t.identifier=0),this.previous.a1=NaN,this.previous.a2=NaN,this.previous.b1=NaN,this.previous.b2=NaN,[0,1])){let e=a[t].clientX,i=o+n-a[t].clientY;this.touchStart.origins[t].identifier=a[t].identifier,this.touchStart.origins[t].normalX=de(this.initialZoom.x,e,s,r),this.touchStart.origins[t].normalY=de(this.initialZoom.y,i,o,n)}let[l,h]=a,[d,c]=this.touchStart.origins,p=di(l.clientX,l.radiusX,h.clientX,h.radiusX);return di(l.clientY,l.radiusY,h.clientY,h.radiusY)&&(d.normalY=c.normalY=(d.normalY+c.normalY)/2),p&&(d.normalX=c.normalX=(d.normalX+c.normalX)/2),!0}update(t,e){t.sourceEvent.preventDefault();let i=Array.from(t.sourceEvent.targetTouches),{x:a,y:s,width:o,height:r}=e.getBoundingClientRect(),{origins:n}=this.touchStart,l=[0,1].map(t=>i.find(e=>e.identifier===n[t].identifier)),h=n[0].normalX,d=n[1].normalX,c=l[0].clientX,p=l[1].clientX,u=n[0].normalY,g=n[1].normalY,y=s+r-l[0].clientY,f=s+r-l[1].clientY;return this.twitchTolerantZoomPan4(h,d,c,p,u,g,y,f,a,s,o,r)}end(t){let e=Array.from(t.sourceEvent.targetTouches).map(t=>t.identifier);return!e.includes(this.touchStart.origins[0].identifier)||!e.includes(this.touchStart.origins[1].identifier)}twitchTolerantZoomPan4(t,e,i,a,s,o,r,n,l,h,d,c){let{initialZoom:p,previous:u}=this;return{x:ds(t,e,i,a,u,"a1","a2",l,d,p.x),y:ds(s,o,r,n,u,"b1","b2",h,c,p.y)}}};function ds(t,e,i,a,s,o,r,n,l,h){if(t!=e){let h=s[o],d=s[r];return Math.abs(i-h)+Math.abs(a-d)<=1?(i=h,a=d):(s[o]=i,s[r]=a),function(t,e,i,a,s,o){[t,e]=[Math.min(t,e),Math.max(t,e)],[i,a]=[Math.min(i,a),Math.max(i,a)];let r=1e6*(i-s)/o,n=1e6*(a-s)/o,l=(i-s)/(a-s),h=(t-l*e)/(1e6-r+l*(n-1e6)),d=(e+(n-1e6)*h)/n;return{min:h,max:d}}(t,e,i,a,n,l)}{let e=de(h,i,n,l),s=(t-(e+de(h,a,n,l))/2)/1e6;return{min:h.min+s,max:h.max+s}}}var{ActionOnSet:dr,ChartAxisDirection:dn,ChartUpdateType:dl,Deprecated:dh,Property:dd,InteractionState:dc,ProxyProperty:dp}=a.n1,du=t=>(0,s.GB)(t,10),dg="zoom-cursor",dy="zoom-tooltip",df=class extends a.n1.BaseProperties{constructor(t){super(),this.onChange=t,this.enabled=!1,this.padding=0}};n([dd,dr({changeValue(t){this.onChange({enabled:t,padding:this.padding})}})],df.prototype,"enabled",2),n([dd,dr({changeValue(t){this.onChange({enabled:this.enabled,padding:t})}})],df.prototype,"padding",2);var dm=class extends a.n1.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.enableAxisDragging=!0,this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.enableTwoFingerZoom=!0,this.panKey="alt",this.axes="x",this.scrollingStep=hL/10,this.keepAspectRatio=!1,this.minVisibleItems=2,this.anchorPointX="end",this.anchorPointY=hT,this.autoScaling=new df(t=>{this.ctx.zoomManager.setAutoScaleYAxis(t.enabled,t.padding)}),this.buttons=new dt(this.ctx,this.getModuleProperties.bind(this),this.getResetZoom.bind(this),this.updateZoom.bind(this),this.updateAxisZoom.bind(this),this.resetZoom.bind(this),this.isZoomValid.bind(this)),this.axisDragger=new hH,this.panner=new hQ,this.scroller=new hJ,this.scrollPanner=new hq,this.twoFingers=new da,this.deceleration="short",this.dragState=0,this.isState=t=>this.ctx.interactionManager.isState(t),this.destroyContextMenuActions=void 0,this.isFirstWheelEvent=!0,this.debouncedWheelReset=(0,s.sg)(()=>{this.isFirstWheelEvent=!0},100);let e=new hC;this.selector=new h0(e,this.getZoom.bind(this),this.isZoomValid.bind(this)),this.contextMenu=new hY(t.contextMenuRegistry,t.zoomManager,this.getModuleProperties.bind(this),()=>this.paddedRect,this.updateZoom.bind(this),this.isZoomValid.bind(this)),this.domProxy=new hX({onDragStart:(t,e)=>this.onAxisDragStart(t,e),onDrag:t=>{this.onDragMove({...t,currentX:t.offsetX,currentY:t.offsetY})},onDragEnd:()=>this.onDragEnd(),onDoubleClick:(t,e)=>{this.hoveredAxis={id:t,direction:e},this.onDoubleClick(),this.hoveredAxis=void 0}}),this.destroyFns.push(t.scene.attachNode(e),t.chartEventManager.addListener("series-keynav-zoom",t=>this.onNavZoom(t)),t.widgets.seriesDragInterpreter.addListener("dblclick",t=>this.onDoubleClick(t)),t.widgets.seriesDragInterpreter.addListener("drag-move",t=>this.onDragMove(t)),t.widgets.seriesDragInterpreter.addListener("drag-start",t=>this.onDragStart(t)),t.widgets.seriesDragInterpreter.addListener("drag-end",()=>this.onDragEnd()),t.widgets.seriesWidget.addListener("wheel",t=>this.onWheel(t)),t.widgets.seriesWidget.addListener("touchstart",(t,e)=>this.onTouchStart(t,e)),t.widgets.seriesWidget.addListener("touchmove",(t,e)=>this.onTouchMove(t,e)),t.widgets.seriesWidget.addListener("touchend",t=>this.onTouchEnd(t)),t.widgets.seriesWidget.addListener("touchcancel",t=>this.onTouchEnd(t)),t.updateService.addListener("process-data",t=>this.onProcessData(t)),t.layoutManager.addListener("layout:complete",t=>this.onLayoutComplete(t)),t.zoomManager.addListener("zoom-change",t=>this.onZoomChange(t)),t.zoomManager.addListener("zoom-pan-start",t=>this.onZoomPanStart(t)),this.panner.addListener("update",t=>this.onPanUpdate(t)),()=>this.teardown())}teardown(){this.ctx.zoomManager.setZoomModuleEnabled(!1),this.buttons.destroy(),this.destroyContextMenuActions?.()}onEnabledChange(t){this.ctx.zoomManager.setZoomModuleEnabled(t),this.contextMenu&&(this.destroyContextMenuActions?.(),this.destroyContextMenuActions=this.contextMenu.registerActions(t))}isIgnoredTouch(t){if(t?.device!=="touch")return!1;if("drag"!==this.ctx.chartService.touch.dragAction)return!0;if(this.enableSelecting)return!1;if(!this.enablePanning)return!0;let{x:e,y:i}=this.getZoom();return 0===e.min&&1===e.max&&0===i.min&&1===i.max}onDoubleClick(t){let{enabled:e,enableDoubleClickToReset:i,hoveredAxis:a,ctx:{zoomManager:s}}=this;e&&i&&this.isState(dc.ZoomClickable)&&(a?s.resetAxisZoom("zoom",a.id):t?.preventZoomDblClick||this.resetZoom())}onDragStart(t){let{enabled:e,enableAxisDragging:i,enablePanning:a,enableSelecting:s,hoveredAxis:o,ctx:{domManager:r,zoomManager:n}}=this;if(!e||!this.hoveredAxis&&(!this.isState(dc.ZoomDraggable)||0!==this.dragState||this.isIgnoredTouch(t)))return;this.panner.stopInteractions();let l=0;if(i&&o)l=1;else if(null!=t){let e=this.isPanningKeyPressed(t.sourceEvent);a&&(!s||e)?(r.updateCursor(dg,"grabbing"),l=2,this.panner.start()):s&&!e&&(l=3)}0!==(this.dragState=l)&&n.fireZoomPanStartEvent("zoom")}onDragMove(t){let{anchorPointX:e,anchorPointY:i,axisDragger:s,dragState:o,enabled:r,paddedRect:n,panner:l,selector:h,seriesRect:d,shouldFlipXY:c,hoveredAxis:p,ctx:{interactionManager:u,tooltipManager:g,updateService:y,zoomManager:f}}=this;if(!r||!n||!d||!p&&(!this.isState(dc.ZoomDraggable)||this.isIgnoredTouch(t)))return;u.pushState(a.n1.InteractionState.ZoomDrag),"touch"===t.device&&t.sourceEvent.preventDefault();let m=this.getZoom();switch(o){case 1:{if(!p)break;let{id:a,direction:o}=p,r=o===dn.X?e:i;c&&(r=o===dn.X?i:e);let n=f.getAxisZoom(a),l=s.update(t,o,r,d,m,n);f.setAxisManuallyAdjusted("zoom",a),this.updateAxisZoom(a,o,l);break}case 2:l.update(t);break;case 3:h.update(t,this.getModuleProperties(),n);break;case 0:return}g.updateTooltip(dy),y.update(dl.PERFORM_LAYOUT,{skipAnimations:!0})}onDragEnd(){let{axisDragger:t,dragState:e,enabled:i,panner:s,selector:o,ctx:{domManager:r,interactionManager:n,tooltipManager:l}}=this;if(n.popState(a.n1.InteractionState.ZoomDrag),i&&0!==e){switch(e){case 1:this.hoveredAxis=void 0,t.stop();break;case 2:s.stop();break;case 3:{if(!o.didUpdate())break;let t=this.getZoom(),e=o.stop(this.seriesRect,this.paddedRect,t);this.updateZoom(e)}}this.dragState=0,r.updateCursor(dg),l.removeTooltip(dy)}}onNavZoom(t){let{enabled:e,enableScrolling:i,scroller:s}=this;this.ctx.interactionManager.isState(a.n1.InteractionState.Default)&&e&&i&&(t.widgetEvent.sourceEvent.preventDefault(),this.updateZoom(s.updateDelta(t.delta,this.getModuleProperties(),this.getZoom())))}onWheel(t){let{enabled:e,enablePanning:i,enableScrolling:a,paddedRect:s}=this;if(!e||!a||!s||!this.isState(dc.ZoomWheelable))return;let{deltaX:o,deltaY:r}=t.sourceEvent,n=null!=o&&null!=r&&Math.abs(o)>Math.abs(r);i&&n?this.onWheelPanning(t):this.onWheelScrolling(t)}onWheelPanning(t){let{scrollingStep:e,scrollPanner:i,seriesRect:a,ctx:{zoomManager:o}}=this;if(!a)return;t.sourceEvent.preventDefault();let r=i.update(t,e,a,o.getAxisZooms());for(let[t,{direction:e,zoom:i}]of(0,s.jO)(r))this.updateAxisZoom(t,e,i)}onWheelScrolling(t){let{enableAxisDragging:e,enableIndependentAxes:i,hoveredAxis:o,scroller:r,seriesRect:n,ctx:{zoomManager:l}}=this;if(!n)return;let h=this.getZoom(),d=t.deltaY>0&&this.isMaxZoom(h),c=e&&null!=o,p=this.isScalingX(),u=this.isScalingY();c&&(u=!(p=o.direction===a.n1.ChartAxisDirection.X));let g=this.getModuleProperties({isScalingX:p,isScalingY:u}),y=!0;if(!0===i){let e=r.updateAxes(t,g,n,l.getAxisZooms());for(let[t,{direction:i,zoom:a}]of(0,s.jO)(e))(!c||o.id===t)&&y&&(y=this.updateAxisZoom(t,i,a))}else{let e=r.update(t,g,n,this.getZoom());y=this.updateUnifiedZoom(e)}d||(d=t.deltaY<0&&!y),this.isFirstWheelEvent&&d||t.sourceEvent.preventDefault(),this.isFirstWheelEvent=!1,this.debouncedWheelReset()}onAxisDragStart(t,e){this.hoveredAxis={id:t,direction:e},this.onDragStart(void 0)}onTouchStart(t,e){this.enableTwoFingerZoom&&0===this.dragState&&this.twoFingers.start(t,e,this.getZoom())&&(this.dragState=4)}onTouchMove(t,e){if(!this.enableTwoFingerZoom||4!==this.dragState)return;let i=this.twoFingers.update(t,e);this.updateZoom(hV(i))}onTouchEnd(t){this.enableTwoFingerZoom&&4===this.dragState&&(t.sourceEvent.preventDefault(),this.twoFingers.end(t)&&(this.dragState=0))}onProcessData(t){this.shouldFlipXY=t.series.shouldFlipXY}onLayoutComplete(t){this.domProxy.update(this.enableAxisDragging,this.ctx),this.enabled&&(this.seriesRect=t.series.rect,this.paddedRect=t.series.paddedRect,this.enableAxisDragging&&this.toggleAxisDraggingCursors())}onZoomChange(t){"zoom"!==t.callerId&&this.panner.stopInteractions();let e=this.getZoom();this.buttons.toggleVisibleZoomed(this.isMaxZoom(e))}onZoomPanStart(t){"zoom"===t.callerId&&this.panner.stopInteractions()}onPanUpdate(t){let{panner:e,seriesRect:i,ctx:{tooltipManager:a,zoomManager:o}}=this;if(!i)return;let r=e.translateZooms(i,o.getAxisZooms(),t.deltaX,t.deltaY);for(let[t,{direction:e,zoom:i}]of(0,s.jO)(r))this.updateAxisZoom(t,e,i);a.updateTooltip(dy)}isPanningKeyPressed(t){switch(this.panKey){case"alt":return t.altKey;case"ctrl":return t.ctrlKey;case"shift":return t.shiftKey;case"meta":return t.metaKey}}isScalingX(){return"xy"===this.axes||(this.shouldFlipXY?"y"===this.axes:"x"===this.axes)}isScalingY(){return"xy"===this.axes||(this.shouldFlipXY?"x"===this.axes:"y"===this.axes)}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}isMaxZoom(t){return hB(t,hO())}isZoomValid(t){let{minVisibleItems:e,minVisibleItemsX:i,minVisibleItemsY:a,ctx:{zoomManager:s}}=this;if(0===e)return!0;let o=this.getZoom(),r=du(hP(t))<du(hP(o)),n=du(hE(t))<du(hE(o));return!r&&!n||(null!=i&&r?s.isVisibleItemsCountAtLeast(t,i):null!=a&&n?s.isVisibleItemsCountAtLeast(t,a):s.isVisibleItemsCountAtLeast(t,e))}isAxisZoomValid(t,e){let{minVisibleItems:i,minVisibleItemsX:a,minVisibleItemsY:s,ctx:{zoomManager:o}}=this,r=this.getZoom(),n=e.max-e.min,l=r[t].max-r[t].min,h={...r,[t]:e},d=t===dn.X?a:s;return n>=l||o.isVisibleItemsCountAtLeast(h,d??i)}resetZoom(){this.ctx.zoomManager.resetZoom("zoom")}updateZoom(t){this.enableIndependentAxes?this.updatePrimaryAxisZooms(t):this.updateUnifiedZoom(t)}updateUnifiedZoom(t){return this.isZoomValid(t)?(this.ctx.zoomManager.updateZoom("zoom",t),!0):(this.ctx.updateService.update(dl.SCENE_RENDER,{skipAnimations:!0}),!1)}updatePrimaryAxisZooms(t){this.updatePrimaryAxisZoom(t,dn.X),this.updatePrimaryAxisZoom(t,dn.Y)}updatePrimaryAxisZoom(t,e){let i=this.ctx.zoomManager.getPrimaryAxisId(e);null!=i&&this.updateAxisZoom(i,e,t[e])}updateAxisZoom(t,e,i){let{enableIndependentAxes:a,ctx:{zoomManager:s}}=this;if(!i)return!1;let o=this.getZoom();return!0!==a?(o[e]=i,this.updateUnifiedZoom(o)):!!this.isAxisZoomValid(e,i)&&(s.updateAxisZoom("zoom",t,i),!0)}toggleAxisDraggingCursors(){let{anchorPointX:t,anchorPointY:e,domProxy:i}=this,a=this.getZoom(),s=hP(a)!==hL,o=hE(a)!==hL;if(!s){let e=hW(a,.999,1);e.x=hj(e.x,a.x,t),s=this.isZoomValid(e)}if(!o){let t=hW(a,1,.999);t.y=hj(t.y,a.y,e),o=this.isZoomValid(t)}i.toggleAxisDraggingCursor(dn.X,s),i.toggleAxisDraggingCursor(dn.Y,o)}getZoom(){return hz(this.ctx.zoomManager.getZoom())}getResetZoom(){return hz(this.ctx.zoomManager.getRestoredZoom())}getModuleProperties(t){return{anchorPointX:t?.anchorPointX??this.getAnchorPointX(),anchorPointY:t?.anchorPointY??this.getAnchorPointY(),enabled:t?.enabled??this.enabled,independentAxes:t?.independentAxes??!0===this.enableIndependentAxes,isScalingX:t?.isScalingX??this.isScalingX(),isScalingY:t?.isScalingY??this.isScalingY(),keepAspectRatio:t?.keepAspectRatio??this.keepAspectRatio,scrollingStep:t?.scrollingStep??this.scrollingStep}}};n([dr({newValue(t){this.onEnabledChange(t)}}),dd],dm.prototype,"enabled",2),n([dd],dm.prototype,"enableAxisDragging",2),n([dd],dm.prototype,"enableDoubleClickToReset",2),n([dr({changeValue(t){this.ctx.zoomManager.setIndependentAxes(!!t)}}),dd],dm.prototype,"enableIndependentAxes",2),n([dd],dm.prototype,"enablePanning",2),n([dd],dm.prototype,"enableScrolling",2),n([dd],dm.prototype,"enableSelecting",2),n([dd],dm.prototype,"enableTwoFingerZoom",2),n([dd],dm.prototype,"panKey",2),n([dd],dm.prototype,"axes",2),n([dd],dm.prototype,"scrollingStep",2),n([dd],dm.prototype,"keepAspectRatio",2),n([dd],dm.prototype,"minVisibleItems",2),n([dh("Use [minVisibleItems] instead."),dd],dm.prototype,"minVisibleItemsX",2),n([dh("Use [minVisibleItems] instead."),dd],dm.prototype,"minVisibleItemsY",2),n([dd],dm.prototype,"anchorPointX",2),n([dd],dm.prototype,"anchorPointY",2),n([dd],dm.prototype,"autoScaling",2),n([dd],dm.prototype,"buttons",2),n([dp("panner.deceleration"),dd],dm.prototype,"deceleration",2);var dx={type:"root",optionsKey:"zoom",packageType:"enterprise",chartTypes:["cartesian","topology"],moduleFactory:t=>new dm(t),themeTemplate:{zoom:{anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:{enabled:!0,visible:"hover",buttons:[{icon:"zoom-out",tooltip:"toolbarZoomZoomOut",value:"zoom-out",section:"scale"},{icon:"zoom-in",tooltip:"toolbarZoomZoomIn",value:"zoom-in",section:"scale"},{icon:"pan-left",tooltip:"toolbarZoomPanLeft",value:"pan-left",section:"pan"},{icon:"pan-right",tooltip:"toolbarZoomPanRight",value:"pan-right",section:"pan"},{icon:"reset",tooltip:"toolbarZoomReset",value:"reset",section:"reset"}]},enabled:!1,enableAxisDragging:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,enableTwoFingerZoom:!0,deceleration:"short",minVisibleItems:2,panKey:"alt",scrollingStep:.1,autoScaling:{enabled:!1,padding:.05}}}},{BaseProperties:db,AxisTicks:dv,ZIndexMap:dS,ProxyProperty:dk,Property:dD,LayoutElement:dM,Group:dw,Rect:dI,Marker:dC,TranslatableGroup:dA,BBox:dL}=a.n1,dT=class extends db{constructor(){super(...arguments),this.thickness=16,this.preferredLength=100}};n([dD],dT.prototype,"thickness",2),n([dD],dT.prototype,"preferredLength",2);var dN=class{constructor(t){this.axisTicks=t}};n([dk("axisTicks.label")],dN.prototype,"label",2),n([dk("axisTicks.interval")],dN.prototype,"interval",2),n([dk("axisTicks.padding")],dN.prototype,"padding",2);var dO=class{constructor(t){this.ctx=t,this.id=(0,s.sX)(this),this.legendGroup=new dA({name:"legend",zIndex:dS.LEGEND}),this.gradientRect=new dI,this.arrow=new dC({shape:"triangle"}),this.ticksGroup=new dw({name:"legend-axis-group"}),this.destroyFns=[],this.enabled=!1,this.position="bottom",this.reverseOrder=!1,this.gradient=new dT,this.spacing=20,this.data=[],this.highlightManager=t.highlightManager,this.axisTicks=new dv,this.axisTicks.attachAxis(this.ticksGroup),this.scale=new dN(this.axisTicks),this.legendGroup.append([this.gradientRect,this.arrow,this.ticksGroup]),this.destroyFns.push(t.highlightManager.addListener("highlight-change",()=>this.onChartHoverChange()),t.layoutManager.registerElement(dM.Legend,t=>this.onStartLayout(t)),()=>this.legendGroup.remove())}isVertical(){return"right"===this.position||"left"===this.position}destroy(){this.destroyFns.forEach(t=>t())}attachLegend(t){t.appendChild(this.legendGroup)}onStartLayout(t){let[e]=this.data;if(!this.enabled||!e?.enabled||"gradient"!==e.legendType){this.legendGroup.visible=!1;return}let{colorRange:i}=this.normalizeColorArrays(e);this.updateGradientRect(t.layoutBox,i);let a=this.updateAxis(e)??new dL(0,0,0,0),{left:s,top:o}=this.getMeasurements(t.layoutBox,a);this.updateArrow(),this.legendGroup.visible=!0,this.legendGroup.translationX=s,this.legendGroup.translationY=o}normalizeColorArrays(t){let e=t.colorDomain.slice(),i=t.colorRange.slice();if(e.length===i.length)return{colorDomain:e,colorRange:i};e.length>i.length&&i.splice(e.length);let[a,s]=e,o=i.length;return{colorDomain:e=i.map((t,e)=>0===e?a:e===o-1?s:a+(s-a)*e/(o-1)),colorRange:i}}updateGradientRect(t,e){let i,{gradientRect:a}=this,{preferredLength:s,thickness:o}=this.gradient;this.isVertical()?(i=0,a.width=o,a.height=Math.min(t.height,s)):(i=90,a.width=Math.min(t.width,s),a.height=o),a.fill={type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:e.map((t,i)=>({stop:i/(e.length-1),color:t})),rotation:i}}updateAxis(t){let{axisTicks:e}=this,i=this.isVertical(),a=this.reverseOrder!==i;return e.position=this.position,e.translationX=i?this.gradient.thickness:0,e.translationY=i?0:this.gradient.thickness,e.scale.domain=a?t.colorDomain.slice().reverse():t.colorDomain,e.scale.range=i?[0,this.gradientRect.height]:[0,this.gradientRect.width],e.calculateLayout()}updateArrow(){let t=this.highlightManager.getActiveHighlight(),{arrow:e}=this;if(t?.colorValue==null){e.visible=!1;return}let{scale:i,label:a}=this.axisTicks,s=a.fontSize??0,o=i.convert(t.colorValue),{x:r,y:n}=this.gradientRect,l=Math.PI;this.isVertical()?(r-=s/2,n+=o,l/=2):(r+=o,n-=s/2),e.visible=!0,e.fill=a.color,e.rotation=l,e.size=s,e.translationX=r,e.translationY=n}getMeasurements(t,e){let{x:i,y:a}=t,{width:s,height:o}=this.gradientRect;switch(this.isVertical()?s+=e.width+5:o+=e.height+5,this.position){case"left":a+=t.height/2-o/2,t.shrink(s+this.spacing,"left");break;case"right":i+=t.width-s,a+=t.height/2-o/2,t.shrink(s+this.spacing,"right");break;case"top":i+=t.width/2-s/2,t.shrink(o+this.spacing,"top");break;case"bottom":i+=t.width/2-s/2,a+=t.height-o,t.shrink(o+this.spacing,"bottom")}return{top:a,left:i}}onChartHoverChange(){this.enabled&&this.updateArrow()}};dO.className="GradientLegend",n([dD],dO.prototype,"enabled",2),n([dD],dO.prototype,"position",2),n([dD],dO.prototype,"reverseOrder",2),n([dD],dO.prototype,"gradient",2),n([dD],dO.prototype,"spacing",2);var dP={type:"legend",optionsKey:"gradientLegend",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],identifier:"gradient",moduleFactory:t=>new dO(t),themeTemplate:{enabled:!1,position:"bottom",spacing:20,scale:{padding:13,label:{color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"}},interval:{minSpacing:15}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1},removable:"standalone-only"};function dE(t,e){let i=t.addChild("canvas-overlay","watermark"),a=(0,s.n)("span");a.innerText=e,i.addEventListener("animationend",()=>{t.removeChild("canvas-overlay","watermark"),t.removeStyles("watermark")}),i.classList.add("ag-watermark"),i.appendChild(a)}var{ordinalTimeAxisOptionsDefs:dR,angleNumberAxisOptionsDefs:dB,angleCategoryAxisOptionsDefs:dz,radiusNumberAxisOptionsDefs:dF,radiusCategoryAxisOptionsDefs:d_}=a.n1,{Chart:dW,Property:dG}=a.n1,dj=class extends dW{getChartType(){return"flow-proportion"}async updateData(){await super.updateData();let t=this.getOptions();this.nodes!==t.nodes&&(this.nodes=t.nodes);let{nodes:e}=this;this.series.forEach(t=>{("sankey"===t.type||"chord"===t.type)&&t.setChartNodes(e)})}performLayout(t){let{seriesRoot:e,annotationRoot:i}=this,{layoutBox:a}=t;a.shrink(this.seriesArea.padding.toJson());let s=a.clone();for(let t of(this.seriesRect=s,this.animationRect=s,e.visible=this.series.some(t=>t.visible),[e,i]))t.translationX=Math.floor(s.x),t.translationY=Math.floor(s.y);this.ctx.layoutManager.emitLayoutComplete(t,{series:{visible:e.visible,rect:s,paddedRect:s}})}};dj.className="FlowProportionChart",dj.type="flow-proportion",n([dG],dj.prototype,"nodes",2);var{isAgFlowProportionChartOptions:dV,flowProportionChartOptionsDefs:d$}=a.n1,{Chart:dH}=a.n1,dY=class extends dH{getChartType(){return"gauge"}performLayout(t){let{seriesRoot:e,annotationRoot:i,series:a,seriesArea:s}=this,{layoutBox:o}=t,r=o.clone();for(let t of(o.shrink(s.padding.toJson()),this.seriesRect=r.clone().translate(r.x-o.x,r.y-o.y),this.animationRect=o,e.visible=a.some(t=>t.visible),[e,i]))t.translationX=Math.floor(o.x),t.translationY=Math.floor(o.y);this.ctx.layoutManager.emitLayoutComplete(t,{series:{visible:e.visible,rect:r,paddedRect:o}})}getAriaLabel(){let t=[],e=this.getCaptionText();for(let i of(0!==e.length&&t.push(e),this.series))t.push(i.getCaptionText());let i=t.join(". ");return this.ctx.localeManager.t("ariaAnnounceGaugeChart",{caption:i})}};dY.className="GaugeChart",dY.type="gauge";var{isAgGaugeChartOptions:dK,gaugeChartOptionsDefs:dU}=a.n1,{Chart:dX}=a.n1,dZ=class extends dX{getChartType(){return"hierarchy"}performLayout(t){let{seriesRoot:e,annotationRoot:i}=this,{layoutBox:a}=t;a.shrink(this.seriesArea.padding.toJson());let s=a.clone();for(let t of(this.seriesRect=s,this.animationRect=s,[e,i]))t.translationX=Math.floor(s.x),t.translationY=Math.floor(s.y);e.visible=this.series[0].visible,e.setClipRect(s.clone()),this.ctx.layoutManager.emitLayoutComplete(t,{series:{visible:!0,rect:s,paddedRect:s}})}getAriaLabel(){let t=this.getCaptionText();return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:t})}};dZ.className="HierarchyChart",dZ.type="hierarchy";var{isAgHierarchyChartOptions:dQ,hierarchyChartOptionsDefs:dq}=a.n1,{Chart:dJ}=a.n1,d0=class extends dJ{getChartType(){return"standalone"}performLayout(t){let{seriesRoot:e,annotationRoot:i}=this,{layoutBox:a}=t;a.shrink(this.seriesArea.padding.toJson());let s=a.clone();for(let t of(this.seriesRect=s,this.animationRect=s,[e,i]))t.translationX=Math.floor(a.x),t.translationY=Math.floor(a.y);e.visible=this.series[0].visible,this.ctx.layoutManager.emitLayoutComplete(t,{series:{visible:!0,rect:s,paddedRect:a}})}getAriaLabel(){let t=this.getCaptionText();return this.ctx.localeManager.t("ariaAnnounceHierarchyChart",{caption:t})}};d0.className="StandaloneChart",d0.type="standalone";var{isAgStandaloneChartOptions:d1,standaloneChartOptionsDefs:d2}=a.n1,{Chart:d4,MercatorScale:d5,NumberAxis:d3,Property:d6}=a.n1;function d8(t){return"map-shape"===t.type||"map-line"===t.type||"map-marker"===t.type||"map-shape-background"===t.type||"map-line-background"===t.type}var d9=class extends d4{constructor(t,e){super(t,e),this.xAxis=new d3(this.getModuleContext()),this.xAxis.position="bottom",this.yAxis=new d3(this.getModuleContext()),this.yAxis.position="left",this.ctx.zoomManager.updateAxes([this.xAxis,this.yAxis])}getChartType(){return"topology"}async updateData(){await super.updateData();let t=this.getOptions();this.topology!==t.topology&&(this.topology=t.topology);let{topology:e}=this;this.series.forEach(t=>{d8(t)&&t.setChartTopology(e)})}performLayout(t){let e,{seriesRoot:i,annotationRoot:a}=this,{layoutBox:s}=t;s.shrink(this.seriesArea.padding.toJson());let o=s.clone();this.seriesRect=o,this.animationRect=o;let r=this.series.filter(d8),n=r.reduce((t,e)=>{if(!e.visible)return t;let i=e.topologyBounds;return null==i?t:null==t?i:(t.merge(i),t)},void 0);if(null!=n){let{lon0:t,lat0:i,lon1:a,lat1:s}=n,r=[[t,i],[a,s]],l=d5.bounds(r),{width:h,height:d}=o,c=Math.min(h/l.width,d/l.height),p=l.width*c,u=l.height*c,g=(h-p)/2,y=(d-u)/2,f=this.ctx.zoomManager.getAxisZoom(this.xAxis.id),m=this.ctx.zoomManager.getAxisZoom(this.yAxis.id),x=(g+p-g)/(f.max-f.min),b=g-x*f.min,v=(y+u-y)/(1-m.min-(1-m.max)),S=y-v*(1-m.max);e=new d5(r,[[b,S],[b+x,S+v]])}r.forEach(t=>{t.scale=e});let l=this.series.some(t=>t.visible);for(let t of(i.visible=l,[i,a]))t.translationX=Math.floor(o.x),t.translationY=Math.floor(o.y),t.setClipRect(o.clone());this.ctx.layoutManager.emitLayoutComplete(t,{series:{visible:l,rect:o,paddedRect:o}})}};d9.className="TopologyChart",d9.type="topology",n([d6],d9.prototype,"topology",2);var{isAgTopologyChartOptions:d7,topologyChartOptionsDefs:ct}=a.n1,{annotationCalloutStylesDefs:ce,annotationNoteStylesDefs:ci,annotationTextStylesDef:ca,annotationCommentStylesDefs:cs,annotationMeasurerStylesDefs:co,annotationShapeStylesDefs:cr,annotationChannelTextDefs:cn,annotationCrossLineStyleDefs:cl,annotationFibonacciStylesDefs:ch,annotationLineStyleDefs:cd,annotationLineTextDefs:cc,annotationDisjointChannelStyleDefs:cp,annotationParallelChannelStyleDefs:cu}=a.n1,cg=(0,s.fd)({__type:(0,s.mw)((0,s.dY)("date")),value:(0,s.or)(s.Yj,s.ai)},"a serializable date object"),cy=(0,s.or)(s.Yj,s.ai,cg),cf=(0,s.or)(cy,(0,s.fd)({value:cy,groupPercentage:(0,s.fN)(-1,1)})),cm={...cn,label:s.Yj},cx={...cc,label:s.Yj},cb={x:cf,y:s.ai},cv=(0,s.is)({line:{...cd,start:cb,end:cb,text:cx},"horizontal-line":{...cl,value:cf,text:cx},"vertical-line":{...cl,value:cf,text:cx},"disjoint-channel":{...cp,startHeight:s.Ly,endHeight:s.Ly,start:cb,end:cb,text:cm},"parallel-channel":{...cu,height:s.Ly,start:cb,end:cb,text:cm},"fibonacci-retracement":{...ch,start:cb,end:cb,text:cx,reverse:s.zM},"fibonacci-retracement-trend-based":{...ch,start:cb,end:cb,endRetracement:cb,text:cx,reverse:s.zM},callout:{...ce,start:cb,end:cb,text:s.Yj},comment:{...cs,...cb,text:s.Yj},note:{...ci,...cb,text:s.Yj},text:{...ca,...cb,text:s.Yj},arrow:{...cd,text:cx,start:cb,end:cb},"arrow-up":{...cr,...cb},"arrow-down":{...cr,...cb},"date-range":{...co,extendAbove:s.zM,extendBelow:s.zM,text:cx,start:cb,end:cb},"price-range":{...co,extendLeft:s.zM,extendRight:s.zM,text:cx,start:cb,end:cb},"date-price-range":{...co,text:cx,start:cb,end:cb}},"an annotation initial state object"),cS={chartType:(0,s.KC)("candlestick","hollow-candlestick","ohlc","line","step-line","hlc","high-low"),annotations:(0,s.J$)(cv),legend:(0,s.J$)({visible:s.zM,seriesId:s.Yj,itemId:s.Yj,legendItemName:s.Yj},"legend state array"),zoom:{rangeX:{start:(0,s.or)(s.ai,cg),end:(0,s.or)(s.ai,cg)},rangeY:{start:(0,s.or)(s.ai,cg),end:(0,s.or)(s.ai,cg)},ratioX:{start:s.CG,end:s.CG},ratioY:{start:s.CG,end:s.CG},autoScaledAxes:(0,s.jk)((0,s.dY)("y"))}},{ScalableGroup:ck,Rect:cD,Line:cM,BBox:cw,Selection:cI,applyShapeFillBBox:cC}=a.n1,cA=class extends ck{constructor(){super(),this.append([new cD({tag:0}),new cD({tag:2}),new cD({tag:1}),new cM({tag:3}),new cM({tag:3}),new cM({tag:4}),new cM({tag:4})])}updateDatumStyles(t,e,i,a,s){var o,r,n,l;let{bandwidth:h,scaledValues:{xValue:d,medianValue:c}}=t,{minValue:p,q1Value:u,q3Value:g,maxValue:y}=t.scaledValues;(i&&!a||!i&&a)&&([y,g,u,p]=[p,u,g,y]);let f=(t,e,a,s)=>i?{y:t,x:e,width:s,height:a}:{x:t,y:e,width:a,height:s},m=(t,e,a)=>i?{y1:t,y2:e,x:a}:{x1:t,x2:e,y:a},x=(t,e,a)=>i?{x1:e,x2:a,y:t}:{x:t,y1:e,y2:a},{fill:b,fillOpacity:v,stroke:S,strokeWidth:k,strokeOpacity:D,lineDash:M,lineDashOffset:w,cornerRadius:I,cap:C,whisker:A}=e,L=cI.select(this,cD),[T]=L.selectByTag(0),[N]=L.selectByTag(2),[O]=L.selectByTag(1),P=L.selectByTag(3),E=L.selectByTag(4);A.strokeWidth>h&&(A.strokeWidth=h);let R=f(u,d,g-u,h);N.setProperties(R),T.setProperties(R),T.setProperties({cornerRadius:I});let B=Math.max(Math.round(c-k/2),u+k),z=Math.min(Math.round(c+k/2),g-k);O.setProperties(R),O.setProperties({visible:B<z,cornerRadius:I,clipBBox:(o=B,r=d+k,n=z-B,l=Math.max(0,h-2*k),{x:o,y:r,width:n,height:l}=f(o,r,n,l),new cw(o,r,n,l))});let F=Math.floor(d+h*(1-C.lengthRatio)/2),_=Math.ceil(d+h*(1+C.lengthRatio)/2);for(let t of(E[0].setProperties(x(p,F,_)),E[1].setProperties(x(y,F,_)),P[0].setProperties(m(Math.round(p+A.strokeWidth/2),u,Math.floor(d+h/2))),P[1].setProperties(m(g,Math.round(y-A.strokeWidth/2),Math.floor(d+h/2))),cC(T,b,s),T.setProperties({fill:b,fillOpacity:v,strokeWidth:2*k,strokeOpacity:0}),O.setProperties({fill:S,fillOpacity:D,strokeWidth:0}),[...P,...E]))t.setProperties(A);N.setProperties({stroke:S,strokeWidth:k,strokeOpacity:D,lineDash:M,lineDashOffset:w,cornerRadius:I,fillOpacity:0})}distanceSquared(t,e){let i=cI.selectByClass(this,cD,cM);return a.n1.nearestSquared(t,e,i).distanceSquared}get midPoint(){let t=this.datum;return void 0===t.midPoint?(s.Vy.error("BoxPlotGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):t.midPoint}},{BaseProperties:cL,FillGradientDefaults:cT,FillPatternDefaults:cN,FillImageDefaults:cO,AbstractBarSeriesProperties:cP,SeriesTooltip:cE,Property:cR,mergeDefaults:cB}=a.n1,cz=class extends cL{constructor(){super(...arguments),this.lengthRatio=.5}};n([cR],cz.prototype,"lengthRatio",2);var cF=class extends cL{};n([cR],cF.prototype,"stroke",2),n([cR],cF.prototype,"strokeWidth",2),n([cR],cF.prototype,"strokeOpacity",2),n([cR],cF.prototype,"lineDash",2),n([cR],cF.prototype,"lineDashOffset",2);var c_=class extends cP{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new cT,this.fillPatternDefaults=new cN,this.fillImageDefaults=new cO,this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new cz,this.whisker=new cF,this.tooltip=new cE}toJson(){let{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:a,lineDashOffset:s}=this,o=super.toJson();return o.whisker=cB(o.whisker,{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:a,lineDashOffset:s}),o}};n([cR],c_.prototype,"xKey",2),n([cR],c_.prototype,"minKey",2),n([cR],c_.prototype,"q1Key",2),n([cR],c_.prototype,"medianKey",2),n([cR],c_.prototype,"q3Key",2),n([cR],c_.prototype,"maxKey",2),n([cR],c_.prototype,"xName",2),n([cR],c_.prototype,"yName",2),n([cR],c_.prototype,"minName",2),n([cR],c_.prototype,"q1Name",2),n([cR],c_.prototype,"medianName",2),n([cR],c_.prototype,"q3Name",2),n([cR],c_.prototype,"maxName",2),n([cR],c_.prototype,"fill",2),n([cR],c_.prototype,"fillGradientDefaults",2),n([cR],c_.prototype,"fillPatternDefaults",2),n([cR],c_.prototype,"fillImageDefaults",2),n([cR],c_.prototype,"fillOpacity",2),n([cR],c_.prototype,"stroke",2),n([cR],c_.prototype,"strokeWidth",2),n([cR],c_.prototype,"strokeOpacity",2),n([cR],c_.prototype,"lineDash",2),n([cR],c_.prototype,"lineDashOffset",2),n([cR],c_.prototype,"cornerRadius",2),n([cR],c_.prototype,"itemStyler",2),n([cR],c_.prototype,"cap",2),n([cR],c_.prototype,"whisker",2),n([cR],c_.prototype,"tooltip",2);var{extractDecoratedProperties:cW,fixNumericExtent:cG,keyProperty:cj,mergeDefaults:cV,SeriesNodePickMode:c$,SMALLEST_KEY_INTERVAL:cH,valueProperty:cY,diff:cK,animationValidation:cU,computeBarFocusBounds:cX,createDatumId:cZ,ContinuousScale:cQ,ChartAxisDirection:cq,motion:cJ,isGradientFill:c0,getShapeStyle:c1}=a.n1,c2=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.xKey=a.properties.xKey,this.minKey=a.properties.minKey,this.q1Key=a.properties.q1Key,this.medianKey=a.properties.medianKey,this.q3Key=a.properties.q3Key,this.maxKey=a.properties.maxKey}},c4=class extends a.n1.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[c$.NEAREST_NODE,c$.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},directionNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},categoryKey:"xValue",pathsPerSeries:[],hasHighlightedLabels:!0}),this.properties=new c_,this.NodeEvent=c2}async processData(t){if(!this.visible)return;let{xKey:e,minKey:i,q1Key:a,medianKey:s,q3Key:o,maxKey:r}=this.properties,n=!this.ctx.animationManager.isSkipped(),l=this.getCategoryAxis()?.scale,h=this.getValueAxis()?.scale,{isContinuousX:d,xScaleType:c,yScaleType:p}=this.getScaleInformation({xScale:l,yScale:h}),u=[];n&&this.processedData&&u.push(cK(this.id,this.processedData)),n&&u.push(cU());let{processedData:g}=await this.requestDataModel(t,this.data,{props:[cj(e,c,{id:"xValue"}),cY(i,p,{id:"minValue"}),cY(a,p,{id:"q1Value"}),cY(s,p,{id:"medianValue"}),cY(o,p,{id:"q3Value"}),cY(r,p,{id:"maxValue"}),...d?[cH]:[],...u]});this.smallestDataInterval=g.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){let{processedData:e,dataModel:i}=this;if(!(e&&i))return[];if(t!==this.getBarDirection()){let{index:t,def:a}=i.resolveProcessedDataDefById(this,"xValue"),s=e.domain.keys[t];return"key"===a.type&&"category"===a.valueType?s:this.padBandExtent(s)}return cG(this.domainForClippedRange(t,["minValue","maxValue"],"xValue",!0))}getSeriesRange(t,e){return this.domainForVisibleRange(cq.Y,["maxValue","minValue"],"xValue",e,!0)}createNodeData(){let{visible:t,dataModel:e,processedData:i}=this,a=this.getCategoryAxis(),s=this.getValueAxis();if(!(e&&i&&a&&s))return;let{xKey:o,fill:r,fillOpacity:n,stroke:l,strokeWidth:h,strokeOpacity:d,lineDash:c,lineDashOffset:p,cap:u,whisker:g}=this.properties,y=[],f=e.resolveKeysById(this,"xValue",i),m=e.resolveColumnById(this,"minValue",i),x=e.resolveColumnById(this,"q1Value",i),b=e.resolveColumnById(this,"medianValue",i),v=e.resolveColumnById(this,"q3Value",i),S=e.resolveColumnById(this,"maxValue",i),{barWidth:k,groupIndex:D}=this.updateGroupScale(a),M=cQ.is(a.scale)?-.5*k:0,{groupScale:w}=this,I=this.isVertical(),C={itemId:o,nodeData:y,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible};return t&&(i.dataSources.get(this.id)??[]).forEach((t,e)=>{let i,C=f[e];if(null==C)return;let A=m[e],L=x[e],T=b[e],N=v[e],O=S[e];if([A,L,T,N,O].some(t=>"number"!=typeof t)||A>L||L>T||T>N||N>O)return;let P={xValue:Math.round(a.scale.convert(C)),minValue:Math.round(s.scale.convert(A)),q1Value:Math.round(s.scale.convert(L)),medianValue:Math.round(s.scale.convert(T)),q3Value:Math.round(s.scale.convert(N)),maxValue:Math.round(s.scale.convert(O))};P.xValue+=Math.round(w.convert(String(D)))+M;let E=Math.round(k),R=Math.abs(P.q3Value-P.q1Value),B=P.xValue+E/2,z=Math.min(P.q3Value,P.q1Value)+R/2,F={x:I?B:z,y:I?z:B};i=I?{x:F.x-E/2,y:P.minValue,width:E,height:P.maxValue-P.minValue}:{x:P.minValue,y:F.y-E/2,width:P.maxValue-P.minValue,height:E},y.push({series:this,itemId:C,datum:t,datumIndex:e,xKey:o,bandwidth:E,scaledValues:P,cap:u,whisker:g,fill:r,fillOpacity:n,stroke:l,strokeWidth:h,strokeOpacity:d,lineDash:c,lineDashOffset:p,midPoint:F,focusRect:i})}),C}legendItemSymbol(){let{fill:t,fillOpacity:e,stroke:i,strokeWidth:a,strokeOpacity:s,lineDash:o,lineDashOffset:r,fillGradientDefaults:n,fillPatternDefaults:l,fillImageDefaults:h}=this.properties;return{marker:c1({fill:t,fillOpacity:e,stroke:i,strokeOpacity:s,strokeWidth:a,lineDash:o,lineDashOffset:r},n,l,h)}}getLegendData(t){let{id:e,ctx:{legendManager:i},visible:a}=this,{xKey:s,yName:o,showInLegend:r,legendItemName:n}=this.properties;return s&&"category"===t?[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:a&&i.getItemEnabled({seriesId:e,itemId:e}),label:{text:n??o??e},symbol:this.legendItemSymbol(),legendItemName:n,hideInLegend:!r}]:[]}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,properties:s}=this,{xKey:o,xName:r,yName:n,medianKey:l,medianName:h,q1Key:d,q1Name:c,q3Key:p,q3Name:u,minKey:g,minName:y,maxKey:f,maxName:m,legendItemName:x,tooltip:b}=s,v=this.getCategoryAxis(),S=this.getValueAxis();if(!i||!a||!v||!S)return;let k=a.dataSources.get(this.id)?.[t],D=i.resolveKeysById(this,"xValue",a)[t],M=i.resolveColumnById(this,"minValue",a)[t],w=i.resolveColumnById(this,"q1Value",a)[t],I=i.resolveColumnById(this,"medianValue",a)[t],C=i.resolveColumnById(this,"q3Value",a)[t],A=i.resolveColumnById(this,"maxValue",a)[t];if(null==D)return;let L=this.getItemBaseStyle(!1);return Object.assign(L,this.getItemStyleOverrides(String(t),k,L,!1)),this.formatTooltipWithContext(b,{heading:v.formatDatum(D),title:x??n,symbol:this.legendItemSymbol(),data:[{label:y,fallbackLabel:g,value:S.formatDatum(M)},{label:c,fallbackLabel:d,value:S.formatDatum(w)},{label:h,fallbackLabel:l,value:S.formatDatum(I)},{label:u,fallbackLabel:p,value:S.formatDatum(C)},{label:m,fallbackLabel:f,value:S.formatDatum(A)}]},{seriesId:e,datum:k,title:n,xKey:o,xName:r,yName:n,medianKey:l,medianName:h,q1Key:d,q1Name:c,q3Key:p,q3Name:u,minKey:g,minName:y,maxKey:f,maxName:m,...L})}animateEmptyUpdateReady({datumSelection:t}){let e=this.isVertical(),{from:i,to:a}={from:e?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}};cJ.resetMotion([t],(t,i)=>e?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}),cJ.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[t],i,a,{phase:"initial"})}isLabelEnabled(){return!1}updateDatumSelection(t){let e=t.nodeData??[];return t.datumSelection.update(e)}getItemBaseStyle(t){let{properties:e}=this,{cornerRadius:i,cap:a,whisker:s,fillGradientDefaults:o,fillPatternDefaults:r,fillImageDefaults:n}=e,l=t?e.highlightStyle.item:void 0,h=this.getStrokeWidth(e.strokeWidth);return c1({fill:l?.fill??e.fill,fillOpacity:l?.fillOpacity??e.fillOpacity,stroke:l?.stroke??e.stroke,strokeWidth:l?.strokeWidth??h,strokeOpacity:l?.strokeOpacity??e.strokeOpacity,lineDash:l?.lineDash??e.lineDash??[],lineDashOffset:l?.lineDashOffset??e.lineDashOffset,cornerRadius:i,cap:a,whisker:s},o,r,n)}getItemStyleOverrides(t,e,i,a){let{id:s,properties:o}=this,{xKey:r,minKey:n,q1Key:l,medianKey:h,q3Key:d,maxKey:c,fillGradientDefaults:p,fillPatternDefaults:u,fillImageDefaults:g,itemStyler:y}=o;if(null==y)return;let f=this.cachedDatumCallback(cZ(t,a?"highlight":"node"),()=>this.callWithContext(y,{seriesId:s,datum:e,xKey:r,minKey:n,q1Key:l,medianKey:h,q3Key:d,maxKey:c,highlighted:a,...i}));return c1(f,p,u,g)}updateDatumNodes({datumSelection:t,isHighlight:e}){let i=this.isVertical(),a=this.getValueAxis()?.isReversed(),{highlightStyle:s}=this.properties;t.each((t,o)=>{let r=this.getFormattedStyles(o,e?"highlight":"node");e&&(r=cV(s.item,r));let{stroke:n,strokeWidth:l,strokeOpacity:h,lineDash:d,lineDashOffset:c}=r;r.whisker=cV(r.whisker,{stroke:n,strokeWidth:l,strokeOpacity:h,lineDash:d,lineDashOffset:c});let p=this.getShapeFillBBox();t.updateDatumStyles(o,r,i,a,p)})}updateLabelNodes(){}updateLabelSelection(t){let{labelData:e,labelSelection:i}=t;return i.update(e)}nodeFactory(){return new cA}getFormattedStyles(t,e){let i,{id:a,properties:s}=this,{xKey:o,minKey:r,q1Key:n,medianKey:l,q3Key:h,maxKey:d,itemStyler:c,cornerRadius:p,fillGradientDefaults:u,fillPatternDefaults:g,fillImageDefaults:y}=s,{datum:f,stroke:m,strokeWidth:x,strokeOpacity:b,lineDash:v,lineDashOffset:S,cap:k,whisker:D}=t,M=1;c0(t.fill)?i=t.fill:(i=t.fill,M=s.fillOpacity);let w=c1({fill:i,fillOpacity:M,stroke:m,strokeWidth:x,strokeOpacity:b,lineDash:v,lineDashOffset:S,cornerRadius:p,cap:cW(k),whisker:cW(D)},u,g,y);if(c){let t=this.cachedDatumCallback(cZ(f.index,e),()=>this.callWithContext(c,{datum:f,seriesId:a,highlighted:"highlight"===e,...w,xKey:o,minKey:r,q1Key:n,medianKey:l,q3Key:h,maxKey:d}));t&&(w=c1(cV(t,w),u,g,y))}return w}computeFocusBounds({datumIndex:t}){return cX(this,this.contextNodeData?.nodeData[t].focusRect)}};c4.className="BoxPlotSeries",c4.type="box-plot";var{boxPlotSeriesThemeableOptionsDef:c5,commonSeriesOptionsDefs:c3}=a.n1,c6={...c5,...c3,type:(0,s.mw)((0,s.dY)("box-plot")),xKey:(0,s.mw)(s.Yj),minKey:(0,s.mw)(s.Yj),q1Key:(0,s.mw)(s.Yj),medianKey:(0,s.mw)(s.Yj),q3Key:(0,s.mw)(s.Yj),maxKey:(0,s.mw)(s.Yj),xName:s.Yj,yName:s.Yj,minName:s.Yj,q1Name:s.Yj,medianName:s.Yj,q3Name:s.Yj,maxName:s.Yj,grouped:s.zM,legendItemName:s.Yj},{CARTESIAN_AXIS_TYPE:c8}=a.n1.ThemeConstants,c9={series:{direction:"vertical",fill:{$if:[{$or:[{$isGradient:[{$palette:"fill"}]},{$isPattern:[{$palette:"fill"}]},{$isImage:[{$palette:"fill"}]}]},{$palette:"fill"},{$mix:[a.n1.SAFE_FILL_OPERATION,{$ref:"backgroundColor"},.7]}]},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,strokeWidth:2},axes:{[c8.NUMBER]:{crosshair:{snap:!1}},[c8.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},c7={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"box-plot",moduleFactory:t=>new c4(t),tooltipDefaults:{range:"exact"},defaultAxes:a.n1.DIRECTION_SWAP_AXES,themeTemplate:c9,groupable:!0},pt={type:"series",name:"box-plot",chartType:"cartesian",enterprise:!0,options:c6,create:t=>new c4(t)},{findMinMax:pe}=a.n1;function pi(t,e=1){let i=Math.ceil(Math.log2(t.length/e))-1;return i=Math.min(Math.max(i,0),16),2**i|0}function pa(t){return pe(t.map(t=>Number(t)))}function ps(t,e,i){return(t.valueOf()-e)/(i-e)}function po(t,e){return 4*Math.min(Math.floor(t*e),e-1)|0}function pr(t,e,i,a,s,o){let r=new Int32Array(4*o).fill(-1),n=new Float64Array(4*o).fill(NaN);for(let l=0;l<t.length;l+=1){let h=t[l],d=e[l],c=i[l];if(null==h||null==d||null==c)continue;let p=ps(h,a,s),u=d.valueOf(),g=c.valueOf(),y=po(p,o),f=-1===r[y+0];(f||p<n[y+0])&&(r[y+0]=l,n[y+0]=p),(f||p>n[y+1])&&(r[y+1]=l,n[y+1]=p),(f||g<n[y+2])&&(r[y+2]=l,n[y+2]=g),(f||u>n[y+3])&&(r[y+3]=l,n[y+3]=u)}return{indexData:r,valueData:n}}function pn(t,e,i,{inPlace:a=!1}={}){let s=i/2|0,o=a?t:new Int32Array(4*s),r=a?e:new Float64Array(4*s);for(let i=0;i<s;i+=1){let a=4*i|0,s=2*a|0,n=s+4|0,l=-1===t[n+0],h=l||e[s+0]<e[n+0]?s:n;o[a+0]=t[h+0],r[a+0]=e[h+0];let d=l||e[s+1]>e[n+1]?s:n;o[a+1]=t[d+1],r[a+1]=e[d+1];let c=l||e[s+2]<e[n+2]?s:n;o[a+2]=t[c+2],r[a+2]=e[c+2];let p=l||e[s+3]>e[n+3]?s:n;o[a+3]=t[p+3],r[a+3]=e[p+3]}return{maxRange:s,indexData:o,valueData:r}}var{fixNumericExtent:pl,keyProperty:ph,createDatumId:pd,SeriesNodePickMode:pc,ChartAxisDirection:pp,SMALLEST_KEY_INTERVAL:pu,valueProperty:pg,diff:py,animationValidation:pf,computeBarFocusBounds:pm,visibleRangeIndices:px,ContinuousScale:pb,DiscreteTimeScale:pv,BandScale:pS,getShapeStyle:pk}=a.n1,pD=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.xKey=a.properties.xKey,this.openKey=a.properties.openKey,this.closeKey=a.properties.closeKey,this.highKey=a.properties.highKey,this.lowKey=a.properties.lowKey}},pM=class extends a.n1.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[pc.AXIS_ALIGNED,pc.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},directionNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},categoryKey:"xValue",pathsPerSeries:[]}),this.NodeEvent=pD,this.dataAggregationFilters=void 0}async processData(t){if(!this.visible)return;let{xKey:e,openKey:i,closeKey:a,highKey:s,lowKey:o}=this.properties,r=!this.ctx.animationManager.isSkipped(),n=this.getCategoryAxis()?.scale,l=this.getValueAxis()?.scale,{isContinuousX:h,xScaleType:d,yScaleType:c}=this.getScaleInformation({xScale:n,yScale:l}),p=[];r&&(this.processedData&&p.push(py(this.id,this.processedData)),p.push(pf())),i&&p.push(pg(i,c,{id:"openValue",invalidValue:void 0,missingValue:void 0}));let{dataModel:u,processedData:g}=await this.requestDataModel(t,this.data,{props:[ph(e,d,{id:"xValue"}),pg(a,c,{id:"closeValue"}),pg(s,c,{id:"highValue"}),pg(o,c,{id:"lowValue"}),...h?[pu]:[],...p]});this.smallestDataInterval=g.reduced?.smallestKeyInterval,this.dataAggregationFilters=this.aggregateData(u,g),this.animationState.transition("updateData")}aggregateData(t,e){let i=this.axes[pp.X];if(null==i||!(pb.is(i.scale)||pv.is(i.scale)))return;let a=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"highValue",e),o=t.resolveColumnById(this,"lowValue",e),{index:r}=t.resolveProcessedDataDefById(this,"xValue");return function(t,e,i,a){if(t.length<1e3)return;let[s,o]=pa(a),r=pi(t),{indexData:n,valueData:l}=pr(t,e,i,s,o,r),h=[{maxRange:r,indexData:n}];for(;r>64;)({indexData:n,valueData:l,maxRange:r}=pn(n,l,r)),h.push({maxRange:r,indexData:n});return h.reverse(),h}(a,s,o,e.domain.keys[r])}getSeriesDomain(t){let{processedData:e,dataModel:i}=this;if(!(e&&i))return[];if(t!==this.getBarDirection()){let{index:t,def:a}=i.resolveProcessedDataDefById(this,"xValue"),s=e.domain.keys[t];return"key"===a.type&&"category"===a.valueType?s:this.padBandExtent(s)}return pl(this.domainForClippedRange(t,["highValue","lowValue"],"xValue",!0))}getSeriesRange(t,e){return this.domainForVisibleRange(pp.Y,["highValue","lowValue"],"xValue",e,!0)}getVisibleItems(t,e,i){return this.countVisibleItems("xValue",["highValue","lowValue"],t,e,i)}createNodeData(){let{visible:t,dataModel:e,processedData:i}=this,a=this.getCategoryAxis(),o=this.getValueAxis();if(!(e&&i&&a&&o))return;let r=[],{xKey:n,highKey:l,lowKey:h}=this.properties,d=i.dataSources.get(this.id)??[],c=e.resolveKeysById(this,"xValue",i),p=e.resolveColumnById(this,"openValue",i),u=e.resolveColumnById(this,"closeValue",i),g=e.resolveColumnById(this,"highValue",i),y=e.resolveColumnById(this,"lowValue",i),{groupScale:f}=this,{barWidth:m,groupIndex:x}=this.updateGroupScale(a),b=f.convert(String(x)),v=m>=1?m:f.rawBandwidth,S=pS.is(a.scale),k={itemId:n,nodeData:r,labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible};if(!t)return k;let D=(t,e,i,s,l,h,c,p)=>{let u=d[t],g=S?c/2:0,y=a.scale.convert(e)+b+g,f=o.scale.convert(i),m=o.scale.convert(s),x=o.scale.convert(l),v=o.scale.convert(h),k=s>i,D=Math.min(x,v),M=Math.max(x,v)-D;r.push({series:this,itemId:k?"up":"down",datum:u,datumIndex:t,xKey:n,xValue:e,openValue:i,closeValue:s,highValue:l,lowValue:h,midPoint:{x:y,y:D+M/2},aggregatedValue:s,isRising:k,centerX:y,width:c,y:D,height:M,yOpen:f,yClose:m,crisp:p})},{dataAggregationFilters:M}=this,w=a.scale,[I,C]=w.range,A=C-I,L=t=>w.convert(c[t])+b,T=M?.find(t=>t.maxRange>A);if(null==T){let[t,e]=px(d.length,a.range,t=>{let e=L(t);return[e,e+v]});i.input.count<1e3&&(t=0,e=i.input.count);for(let i=t;i<e;i+=1){let t=c[i];if(null==t)continue;let e=p[i],a=u[i],o=g[i],r=y[i],n=null!=r&&r<=e&&r<=a,d=null!=o&&o>=e&&o>=a;if(!n){s.Vy.warnOnce(`invalid low value for key [${h}] in data element, low value cannot be higher than datum open or close values`);continue}if(!d){s.Vy.warnOnce(`invalid high value for key [${l}] in data element, high value cannot be lower than datum open or close values.`);continue}D(i,t,e,a,o,r,v,!0)}}else{let{maxRange:t,indexData:e}=T,[i,s]=px(t,a.range,t=>{let i=4*t,a=e[i+0],s=e[i+1];if(-1!==a)return[L(a),L(s)+v]});for(let t=i;t<s;t+=1){let i=4*t,a=e[i+0],s=e[i+1],o=e[i+3],r=e[i+2];if(-1===a)continue;let n=(a+s)/2|0,l=c[n];if(null==l)continue;let h=p[a],d=u[s],f=g[o];D(n,l,h,d,f,y[r],Math.abs(L(s)-L(a))+v,!1)}}return k}isVertical(){return!0}isLabelEnabled(){return!1}updateDatumSelection(t){let e=t.nodeData??[];return t.datumSelection.update(e)}updateLabelNodes(t){}updateLabelSelection(t){let{labelData:e,labelSelection:i}=t;return i.update(e)}getItemBaseStyle(t,e){let{properties:i}=this,a=i.item[t],s=e?i.highlightStyle.item:void 0,o={fill:s?.fill??a.fill,fillOpacity:s?.fillOpacity??a.fillOpacity,stroke:s?.stroke??a.stroke,strokeWidth:s?.strokeWidth??a.strokeWidth,strokeOpacity:s?.strokeOpacity??a.strokeOpacity,lineDash:s?.lineDash??a.lineDash,lineDashOffset:s?.lineDashOffset??a.lineDashOffset};return a.fillGradientDefaults&&a.fillPatternDefaults&&a.fillImageDefaults?pk(o,a.fillGradientDefaults,a.fillPatternDefaults,a.fillImageDefaults):o}getItemStyleOverrides(t,e,i,a,s){let{id:o,properties:r}=this,n=r.item[i],{itemStyler:l}=r;if(null==l)return;let{xKey:h,openKey:d,closeKey:c,highKey:p,lowKey:u}=r,g=this.cachedDatumCallback(pd(t,s?"highlight":"node"),()=>this.callWithContext(l,{seriesId:o,datum:e,itemId:i,xKey:h,openKey:d,closeKey:c,highKey:p,lowKey:u,highlighted:s,...a}));return n.fillGradientDefaults&&n.fillPatternDefaults&&n.fillImageDefaults?pk(g,n.fillGradientDefaults,n.fillPatternDefaults,n.fillImageDefaults):g}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,properties:s}=this,{xKey:o,xName:r,yName:n,openKey:l,openName:h,highKey:d,highName:c,lowKey:p,lowName:u,closeKey:g,closeName:y,legendItemName:f,tooltip:m}=s,x=this.getCategoryAxis(),b=this.getValueAxis();if(!i||!a||!x||!b)return;let v=a.dataSources.get(this.id)?.[t],S=i.resolveKeysById(this,"xValue",a)[t],k=i.resolveColumnById(this,"openValue",a)[t],D=i.resolveColumnById(this,"highValue",a)[t],M=i.resolveColumnById(this,"lowValue",a)[t],w=i.resolveColumnById(this,"closeValue",a)[t];if(null==S)return;let I=w>=k?"up":"down",C=this.properties.item[I],A=this.getItemBaseStyle(I,!1);Object.assign(A,this.getItemStyleOverrides(String(t),v,I,A,!1));let L={fill:C.fill??C.stroke,fillOpacity:C.fillOpacity??C.strokeOpacity??1,stroke:C.stroke,strokeWidth:C.strokeWidth??1,strokeOpacity:C.strokeOpacity??1,lineDash:C.lineDash??[0],lineDashOffset:C.lineDashOffset??0};return C.fillGradientDefaults&&C.fillPatternDefaults&&C.fillImageDefaults&&(L=pk(L,C.fillGradientDefaults,C.fillPatternDefaults,C.fillImageDefaults)),this.formatTooltipWithContext(m,{heading:x.formatDatum(S),title:f,symbol:{marker:L},data:[{label:h,fallbackLabel:l,value:b.formatDatum(k)},{label:c,fallbackLabel:d,value:b.formatDatum(D)},{label:u,fallbackLabel:p,value:b.formatDatum(M)},{label:y,fallbackLabel:g,value:b.formatDatum(w)}]},{seriesId:e,datum:v,title:n,itemId:I,xKey:o,xName:r,yName:n,openKey:l,openName:h,highKey:d,highName:c,lowKey:p,lowName:u,closeKey:g,closeName:y,...A})}getDatumId(t){return pd(t.xValue)}computeFocusBounds(t){let e=this.getNodeData()?.at(t.datumIndex);if(null==e)return;let{centerX:i,y:a,width:s,height:o}=e;return pm(this,{x:i-s/2,y:a,width:s,height:o})}},{Path:pw,SceneChangeDetection:pI,BBox:pC}=a.n1,pA=class extends pw{constructor(){super(...arguments),this.centerX=0,this.y=0,this.width=0,this.height=0,this.yOpen=0,this.yClose=0,this.crisp=!1,this.strokeAlignment=0}computeBBox(){let{centerX:t,y:e,width:i,height:a}=this;return new pC(t-i/2,e,i,a)}isPointInPath(t,e){return this.getBBox().containsPoint(t,e)}distanceSquared(t,e){return this.getBBox().distanceSquared(t,e)}get midPoint(){return{x:this.centerX,y:this.y+this.height/2}}alignedCoordinates(){let{y:t,width:e,height:i,crisp:a,strokeAlignment:s}=this,{centerX:o,yOpen:r,yClose:n}=this,l=o-e/2,h=o+e/2,d=t,c=t+i;if(a&&e>1){o=this.align(o),r=this.align(r),n=this.align(n);let a=this.align(e/2);l=o-a,h=o+a,c=(d=this.align(t))+this.align(d,i)}let p=(d+c)/2;return o+=s,l+=s,h+=s,d-=s,c+=s,r+=r<p?s:-s,n+=n<p?s:-s,{centerX:o,x0:l,x1:h,y0:d,y1:c,yOpen:r,yClose:n}}executeStroke(t,e){let{width:i,strokeWidth:a}=this;i<a&&(t.lineWidth=i),super.executeStroke(t,e)}};n([pI()],pA.prototype,"centerX",2),n([pI()],pA.prototype,"y",2),n([pI()],pA.prototype,"width",2),n([pI()],pA.prototype,"height",2),n([pI()],pA.prototype,"yOpen",2),n([pI()],pA.prototype,"yClose",2),n([pI()],pA.prototype,"crisp",2),n([pI()],pA.prototype,"strokeAlignment",2);var pL=class extends pA{updatePath(){let{path:t}=this,{centerX:e,x0:i,x1:a,y0:s,y1:o,yOpen:r,yClose:n}=this.alignedCoordinates();t.clear(),t.moveTo(e,s),t.lineTo(e,o),Math.abs(a-i)>1&&(t.moveTo(i,r),t.lineTo(e,r),t.moveTo(e,n),t.lineTo(a,n))}},{SceneArrayChangeDetection:pT,SceneChangeDetection:pN,ExtendedPath2D:pO,BBox:pP}=a.n1,pE=class extends pA{constructor(){super(...arguments),this.wickPath=new pO,this.wickStroke=void 0,this.wickStrokeWidth=void 0,this.wickStrokeOpacity=void 0}computeDefaultGradientFillBBox(){let{width:t,centerX:e,yOpen:i,yClose:a}=this,s=Math.min(i,a),o=e-t/2;return new pP(o,s,e+t/2-o,Math.max(i,a)-s)}updatePath(){let{path:t,stroke:e,strokeWidth:i,strokeOpacity:a,lineDash:s,lineDashOffset:o,wickStroke:r,wickStrokeWidth:n,wickStrokeOpacity:l,wickLineDash:h,wickLineDashOffset:d,strokeAlignment:c}=this,{centerX:p,x0:u,x1:g,y0:y,y1:f,yOpen:m,yClose:x}=this.alignedCoordinates();this.path.clear(),this.wickPath.clear();let b=null!=r&&r!==e||null!=n&&n!==i||null!=l&&l!==a||null!=h&&h!==s||null!=d&&d!==o?this.wickPath:t;if(3>=Math.abs(g-u)){b.moveTo(p,y),b.lineTo(p,f);return}let v=Math.min(m,x),S=Math.max(m,x);b.moveTo(p,y),b.lineTo(p,v+i/2),b.moveTo(p,f),b.lineTo(p,S-i/2);let k=c+i/2,D=S-v-2*k;if(D>0)t.rect(u+k,v+k,g-u-2*k,D);else{let e=(v+S)/2;t.moveTo(u,e),t.lineTo(g,e)}}drawPath(t){super.drawPath(t);let{wickPath:e}=this;if(e.isEmpty())return;let{stroke:i,strokeWidth:a,strokeOpacity:s,lineDash:o,lineDashOffset:r,wickStroke:n=i,wickStrokeWidth:l=a,wickStrokeOpacity:h=s,wickLineDash:d=o,wickLineDashOffset:c=r}=this;0!==l&&(t.globalAlpha*=h,"string"==typeof n&&(t.strokeStyle=n),t.lineWidth=l,null!=d&&t.setLineDash([...d]),t.lineDashOffset=c,t.stroke(e.getPath2D()))}};n([pN()],pE.prototype,"wickStroke",2),n([pN()],pE.prototype,"wickStrokeWidth",2),n([pN()],pE.prototype,"wickStrokeOpacity",2),n([pT()],pE.prototype,"wickLineDash",2),n([pN()],pE.prototype,"wickLineDashOffset",2);var{BaseProperties:pR,Property:pB,AbstractBarSeriesProperties:pz,SeriesTooltip:pF}=a.n1,p_=class extends pR{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};n([pB],p_.prototype,"stroke",2),n([pB],p_.prototype,"strokeWidth",2),n([pB],p_.prototype,"strokeOpacity",2),n([pB],p_.prototype,"lineDash",2),n([pB],p_.prototype,"lineDashOffset",2);var pW=class extends pR{constructor(){super(...arguments),this.up=new p_,this.down=new p_}};n([pB],pW.prototype,"up",2),n([pB],pW.prototype,"down",2);var pG=class extends pz{};n([pB],pG.prototype,"xKey",2),n([pB],pG.prototype,"openKey",2),n([pB],pG.prototype,"closeKey",2),n([pB],pG.prototype,"highKey",2),n([pB],pG.prototype,"lowKey",2),n([pB],pG.prototype,"xName",2),n([pB],pG.prototype,"yName",2),n([pB],pG.prototype,"openName",2),n([pB],pG.prototype,"closeName",2),n([pB],pG.prototype,"highName",2),n([pB],pG.prototype,"lowName",2);var pj=class extends pG{constructor(){super(...arguments),this.tooltip=new pF,this.item=new pW}};n([pB],pj.prototype,"tooltip",2),n([pB],pj.prototype,"item",2),n([pB],pj.prototype,"itemStyler",2);var{FillGradientDefaults:pV,FillPatternDefaults:p$,FillImageDefaults:pH,BaseProperties:pY,SeriesTooltip:pK,Property:pU}=a.n1,pX=class extends pY{};n([pU],pX.prototype,"stroke",2),n([pU],pX.prototype,"strokeWidth",2),n([pU],pX.prototype,"strokeOpacity",2),n([pU],pX.prototype,"lineDash",2),n([pU],pX.prototype,"lineDashOffset",2);var pZ=class extends pY{constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new pV,this.fillPatternDefaults=new p$,this.fillImageDefaults=new pH,this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new pX}};n([pU],pZ.prototype,"fill",2),n([pU],pZ.prototype,"fillGradientDefaults",2),n([pU],pZ.prototype,"fillPatternDefaults",2),n([pU],pZ.prototype,"fillImageDefaults",2),n([pU],pZ.prototype,"fillOpacity",2),n([pU],pZ.prototype,"stroke",2),n([pU],pZ.prototype,"strokeWidth",2),n([pU],pZ.prototype,"strokeOpacity",2),n([pU],pZ.prototype,"lineDash",2),n([pU],pZ.prototype,"lineDashOffset",2),n([pU],pZ.prototype,"cornerRadius",2),n([pU],pZ.prototype,"wick",2);var pQ=class extends pY{constructor(){super(...arguments),this.up=new pZ,this.down=new pZ}};n([pU],pQ.prototype,"up",2),n([pU],pQ.prototype,"down",2);var pq=class extends pG{constructor(){super(...arguments),this.item=new pQ,this.tooltip=new pK}};n([pU],pq.prototype,"item",2),n([pU],pq.prototype,"tooltip",2),n([pU],pq.prototype,"itemStyler",2);var{createDatumId:pJ,isGradientFill:p0,isPatternFill:p1,isImageFill:p2,getShapeFill:p4,applyShapeStyle:p5,getShapeStyle:p3}=a.n1,p6=class extends pM{constructor(){super(...arguments),this.properties=new pq}nodeFactory(){return new pE}updateDatumNodes({datumSelection:t,isHighlight:e}){let{id:i,properties:a}=this,{xKey:s,highKey:o,lowKey:r,openKey:n,closeKey:l,item:h,itemStyler:d}=a,{up:c,down:p}=h,u=p3({fill:c.fill,fillOpacity:c.fillOpacity,stroke:c.stroke,strokeWidth:c.strokeWidth,strokeOpacity:c.strokeOpacity,lineDash:c.lineDash,lineDashOffset:c.lineDashOffset},c.fillGradientDefaults,c.fillPatternDefaults,c.fillImageDefaults),g=p3({fill:p.fill,fillOpacity:p.fillOpacity,stroke:p.stroke,strokeWidth:p.strokeWidth,strokeOpacity:p.strokeOpacity,lineDash:p.lineDash,lineDashOffset:p.lineDashOffset},p.fillGradientDefaults,p.fillPatternDefaults,p.fillImageDefaults),y=e?a.highlightStyle.item:void 0;t.each((t,a)=>{let h,{isRising:f,centerX:m,width:x,y:b,height:v,yOpen:S,yClose:k,crisp:D}=a;if(null!=d){let{fill:t,fillOpacity:y,stroke:m,strokeWidth:x,strokeOpacity:b,lineDash:v,lineDashOffset:S}=f?u:g;h=p3(this.cachedDatumCallback(pJ(this.getDatumId(a),e?"highlight":"node"),()=>this.callWithContext(d,{seriesId:i,itemId:a.itemId,xKey:s,highKey:o,lowKey:r,openKey:n,closeKey:l,datum:a.datum,fill:t,fillOpacity:y,strokeOpacity:b,stroke:m,strokeWidth:x,lineDash:v,lineDashOffset:S,highlighted:e})),f?c.fillGradientDefaults:p.fillGradientDefaults,f?c.fillPatternDefaults:p.fillPatternDefaults,f?c.fillImageDefaults:p.fillImageDefaults)}t.centerX=m,t.width=x,t.y=b,t.height=v,t.yOpen=S,t.yClose=k,t.crisp=D;let M=f?u:g,w=f?c.wick:p.wick;p5(t,{fill:y?.fill??h?.fill??M.fill,fillOpacity:y?.fillOpacity??h?.fillOpacity??M.fillOpacity,stroke:y?.stroke??h?.stroke??M.stroke,strokeWidth:y?.strokeWidth??h?.strokeWidth??M.strokeWidth,strokeOpacity:y?.strokeOpacity??h?.strokeOpacity??M.strokeOpacity,lineDash:y?.lineDash??h?.lineDash??M.lineDash,lineDashOffset:y?.lineDashOffset??h?.lineDashOffset??M.lineDashOffset},void 0,this.getShapeFillBBox());let I=h?.wick;t.wickStroke=y?.stroke??I?.stroke??w.stroke,t.wickStrokeWidth=y?.strokeWidth??I?.strokeWidth??w.strokeWidth,t.wickStrokeOpacity=y?.strokeOpacity??I?.strokeOpacity??w.strokeOpacity,t.wickLineDash=y?.lineDash??I?.lineDash??w.lineDash,t.wickLineDashOffset=y?.lineDashOffset??I?.lineDashOffset??w.lineDashOffset,t.strokeAlignment=(h?.strokeWidth??M.strokeWidth)/2})}legendItemSymbol(){let{up:t,down:e}=this.properties.item,i=p4(t.fill,t.fillGradientDefaults,t.fillPatternDefaults,t.fillImageDefaults),a=p0(i)?i.colorStops.map(t=>"string"==typeof t?t:{color:t.color,stop:null!=t.stop?.5*t.stop:void 0}):[{color:p1(i)||p2(i)?t.stroke:i,stop:0},{color:p1(i)||p2(i)?t.stroke:i,stop:.5}],s=p4(e.fill,e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults),o={type:"gradient",gradient:"linear",rotation:90,colorStops:[...a,...p0(s)?s.colorStops.map(t=>"string"==typeof t?t:{color:t.color,stop:null!=t.stop?.5*t.stop:void 0}):[{color:p1(s)||p2(s)?e.stroke:s,stop:.5}]],reverse:!1},r={type:"gradient",gradient:"linear",rotation:90,colorStops:[{color:t.stroke,stop:0},{color:t.stroke,stop:.5},{color:e.stroke,stop:.5}],reverse:!1};return{marker:{fill:o,fillOpacity:t.fillOpacity,stroke:r,strokeWidth:t.strokeWidth??1,strokeOpacity:t.strokeOpacity??1,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset}}}getLegendData(t){let{id:e,data:i,visible:a,ctx:{legendManager:s}}=this,{xKey:o,yName:r,showInLegend:n,legendItemName:l}=this.properties;return i?.length&&o&&"category"===t?[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:a&&s.getItemEnabled({seriesId:e,itemId:e}),label:{text:l??r??e},symbol:this.legendItemSymbol(),legendItemName:l,hideInLegend:!n}]:[]}};p6.className="CandleStickSeries",p6.type="candlestick";var{commonSeriesOptionsDefs:p8,candlestickSeriesThemeableOptionsDef:p9}=a.n1,p7={...p9,...p8,type:(0,s.mw)((0,s.dY)("candlestick")),xKey:(0,s.mw)(s.Yj),openKey:(0,s.mw)(s.Yj),highKey:(0,s.mw)(s.Yj),lowKey:(0,s.mw)(s.Yj),closeKey:(0,s.mw)(s.Yj),xName:s.Yj,yName:s.Yj,openName:s.Yj,highName:s.Yj,lowName:s.Yj,closeName:s.Yj};p7.pickOutsideVisibleMinorAxis=(0,s._L)(s.zM),p7.focusPriority=(0,s._L)(s.ai);var{CARTESIAN_AXIS_TYPE:ut}=a.n1.ThemeConstants;function ue(t){return{fill:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},"up"===t?"transparent":{$palette:"fill"},{$palette:`${t}.fill`}]},stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:`${t}.stroke`}]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$if:[{$or:[{$isGradient:[{$palette:`${t}.fill`}]},{$isPattern:[{$palette:`${t}.fill`}]},{$isImage:[{$palette:`${t}.fill`}]}]},{$map:[{$path:["./color",void 0,{$value:"$1"}]},{$path:["./colorStops",void 0,{$palette:`${t}.fill`}]}]},[{$mix:[{$palette:`${t}.fill`},"black",.15]},{$mix:[{$palette:`${t}.fill`},"white",.15]}]]},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS}}var ui={series:{item:{up:ue("up"),down:ue("down")},highlightStyle:{item:{strokeWidth:3}}},animation:{enabled:!1},axes:{[ut.NUMBER]:{crosshair:{snap:!1}},[ut.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},{CARTESIAN_AXIS_TYPE:ua,CARTESIAN_POSITION:us}=a.n1.ThemeConstants,uo={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"candlestick",moduleFactory:t=>new p6(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:ua.NUMBER,position:us.LEFT},{type:ua.ORDINAL_TIME,position:us.BOTTOM}],themeTemplate:ui,groupable:!1},ur={type:"series",name:"candlestick",chartType:"cartesian",enterprise:!0,options:p7,create:t=>new p6(t)},{CachedTextMeasurerPool:un,TextUtils:ul,TextWrapper:uh}=a.n1;function ud(t,e){return null!=t.lineHeight&&null!=t.fontSize?t.lineHeight*e/t.fontSize:ul.getLineHeight(e)}function uc(t,e,i,a,{padding:o},r){let n,l,{spacing:h=0}=e,d=2*o,c=2*o+h,p=(e.minimumFontSize??e.fontSize)+(a.minimumFontSize??a.fontSize);if(p>r(p+c,!1).height-c)return;let u=function(t,e){let{fontSize:i,minimumFontSize:a=i}=t,{fontSize:s,minimumFontSize:o=s}=e,r=i-a,n=s-o,l=t.fontSize,h=e.fontSize,d=[{labelFontSize:i,secondaryLabelFontSize:s}];for(;l>a||h>o;)(r>0?(l-a)/r:-1)>(n>0?(h-o)/n:-1)?l--:h--,d.push({labelFontSize:l,secondaryLabelFontSize:h});return d.reverse(),d}(e,a),g={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight},y={fontFamily:a.fontFamily,fontSize:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight};return(0,s.F4)(0,u.length-1,s=>{let{labelFontSize:o,secondaryLabelFontSize:p}=u[s],f=0===s,m=ud(e,o),x=ud(a,p),b=r(m+x+c,f),v=b.width-d,S=b.height-c;if(m+x>S||((null==n||n.fontSize!==o)&&(g.fontSize=o,n=uy(e,t,v,S,g,e.wrapping,f?e.overflowStrategy:"hide")),null==n||n.width>v||n.height>S)||((null==l||l.fontSize!==p)&&(y.fontSize=p,l=uy(a,i,v,S,y,a.wrapping,f?a.overflowStrategy:"hide")),null==l))return;let k=n.height+l.height;if(!(l.width>v)&&!(k>S))return{width:Math.max(n.width,l.width),height:k+h,meta:b.meta,label:n,secondaryLabel:l}})}function up(t,e,{padding:i},a){let o=2*i,r=Math.min(e.minimumFontSize??e.fontSize,e.fontSize),n={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight};return(0,s.F4)(r,e.fontSize,i=>{let s=ud(e,i),l=i===r,h=a(s+o,l),d=h.width-o,c=h.height-o;if(s>c)return;n.fontSize=i;let p=uh.wrapLines(t,{maxWidth:d,maxHeight:c,font:n,textWrap:e.wrapping,overflow:(l?e.overflowStrategy:void 0)??"hide"});if(!p.length)return;let u=function(t,{font:e,lineHeight:i=ul.defaultLineHeight,maxWidth:a,maxHeight:s=1/0}){let o,r,n=i*t.length;for(;n>s;){if(1===t.length)return;t.pop(),t[t.length-1]=uh.appendEllipsis(t.at(-1)),n=i*t.length}let l=un.measureLines(t,{font:e});if(l.width>a){let t=[];for(let e of(r=0,l.lineMetrics)){if(e.width>a){if(!t.length)return;break}t.push(e.text),r=Math.max(r,e.width)}o=uh.appendEllipsis(t.join("\n"))}else o=t.join("\n"),r=l.width;return{text:o,width:r,height:n}}(p,{lineHeight:s,font:n,maxWidth:d,maxHeight:c});if(u)return[{fontSize:i,lineHeight:s,...u},h.meta]})}function uu(t){return t?.minimumFontSize!=null&&t?.fontSize!=null&&t?.minimumFontSize>t?.fontSize}function ug(t,e,i,a,o,r){let n,l,h,d=e.enabled?t:void 0,c=a.enabled?i:void 0;if((uu(e)||uu(a))&&s.Vy.warnOnce("minimumFontSize should be set to a value less than or equal to the font size"),null!=d&&null!=c&&(n=uc(d,e,c,a,o,r)),null==n&&null!=d&&(l=up(d,e,o,r)),null!=l){let[t,e]=l;n={width:t.width,height:t.height,meta:e,label:t,secondaryLabel:void 0}}if(null==n&&null==d&&null!=c&&(h=up(c,a,o,r)),null!=h){let[t,e]=h;n={width:t.width,height:t.height,meta:e,label:void 0,secondaryLabel:t}}return n}function uy(t,e,i,a,s,o,r){let n=uh.wrapLines(e,{maxWidth:i,maxHeight:a,font:s,textWrap:o,overflow:r});if(!n.length)return;let l=ud(t,s.fontSize),{width:h}=un.measureLines(n,{font:s});return{width:h,lineHeight:l,text:n.join("\n"),height:n.length*l,fontSize:s.fontSize}}var{Property:uf}=a.n1,um=class extends a.n1.Label{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}};n([uf],um.prototype,"wrapping",2),n([uf],um.prototype,"overflowStrategy",2),n([uf],um.prototype,"lineHeight",2),n([uf],um.prototype,"minimumFontSize",2);var ux=class extends um{constructor(){super(...arguments),this.spacing=0}};n([uf],ux.prototype,"spacing",2);var ub=class extends um{},{CartesianSeriesProperties:uv,SeriesTooltip:uS,Property:uk}=a.n1,uD=class extends uv{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new ux,this.tooltip=new uS}};n([uk],uD.prototype,"title",2),n([uk],uD.prototype,"xKey",2),n([uk],uD.prototype,"yKey",2),n([uk],uD.prototype,"colorKey",2),n([uk],uD.prototype,"xName",2),n([uk],uD.prototype,"yName",2),n([uk],uD.prototype,"colorName",2),n([uk],uD.prototype,"colorRange",2),n([uk],uD.prototype,"stroke",2),n([uk],uD.prototype,"strokeOpacity",2),n([uk],uD.prototype,"strokeWidth",2),n([uk],uD.prototype,"textAlign",2),n([uk],uD.prototype,"verticalAlign",2),n([uk],uD.prototype,"itemPadding",2),n([uk],uD.prototype,"itemStyler",2),n([uk],uD.prototype,"label",2),n([uk],uD.prototype,"tooltip",2);var{SeriesNodePickMode:uM,computeBarFocusBounds:uw,getMissCount:uI,valueProperty:uC,ChartAxisDirection:uA,DEFAULT_CARTESIAN_DIRECTION_KEYS:uL,DEFAULT_CARTESIAN_DIRECTION_NAMES:uT,createDatumId:uN,ColorScale:uO,Rect:uP,PointerEvents:uE,applyShapeStyle:uR}=a.n1,uB=class extends a.n1.CartesianSeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.colorKey=a.properties.colorKey}},uz={left:-.5,center:0,right:-.5},uF={top:-.5,middle:0,bottom:-.5},u_=class extends a.n1.CartesianSeries{constructor(t){super({moduleCtx:t,directionKeys:uL,directionNames:uT,categoryKey:void 0,pickModes:[uM.NEAREST_NODE,uM.EXACT_SHAPE_MATCH],pathsPerSeries:[],hasMarkers:!1,hasHighlightedLabels:!0}),this.properties=new uD,this.NodeEvent=uB,this.colorScale=new uO}async processData(t){let e=this.axes[uA.X],i=this.axes[uA.Y];if(!e||!i||!this.data?.length)return;let{xKey:a,yKey:s,colorRange:o,colorKey:r}=this.properties,n=this.axes[uA.X]?.scale,l=this.axes[uA.Y]?.scale,{xScaleType:h,yScaleType:d}=this.getScaleInformation({xScale:n,yScale:l}),c=this.colorScale.type,{dataModel:p,processedData:u}=await this.requestDataModel(t,this.data,{props:[uC(a,h,{id:"xValue"}),uC(s,d,{id:"yValue"}),...r?[uC(r,c,{id:"colorValue",invalidValue:null})]:[]]});if(this.isColorScaleValid()){let t=p.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=u.domain.values[t],this.colorScale.range=o,this.colorScale.update()}}isColorScaleValid(){let{colorKey:t}=this.properties;if(!t)return!1;let{dataModel:e,processedData:i}=this;if(!e||!i)return!1;let a=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,o=uI(this,i.defs.values[a].missing);return 0!==s&&s!==o}xCoordinateRange(t,e){let i=this.axes[uA.X].scale,a=e*(i.bandwidth??0)/2,s=i.convert(t)+a;return[s,s+e*(i.bandwidth??10)]}yCoordinateRange(t,e){let i=this.axes[uA.Y].scale,a=e*(i.bandwidth??0)/2,s=i.convert(t[0])+a;return[s,s+e*(i.bandwidth??10)]}getSeriesDomain(t){let{dataModel:e,processedData:i}=this;return e&&i?t===uA.X?e.getDomain(this,"xValue","value",i):e.getDomain(this,"yValue","value",i):[]}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){let{data:t,visible:e,axes:i,dataModel:a,processedData:o}=this,r=i[uA.X],n=i[uA.Y];if(!(t&&a&&o&&e&&r&&n))return;if("category"!==r.type||"category"!==n.type)return void s.Vy.warnOnce(`Heatmap series expected axes to have "category" type, but received "${r.type}" and "${n.type}" instead.`);let{xKey:l,xName:h,yKey:d,yName:c,colorKey:p,colorName:u,textAlign:g,verticalAlign:y,itemPadding:f,label:m}=this.properties,x=a.resolveColumnById(this,"xValue",o),b=a.resolveColumnById(this,"yValue",o),v=p?a.resolveColumnById(this,"colorValue",o):void 0,S=r.scale,k=n.scale,D=(S.bandwidth??0)/2,M=(k.bandwidth??0)/2,w=[],I=[],C=S.bandwidth??10,A=k.bandwidth??10,L=(C-2*f)*uz[g],T=(A-2*f)*uF[y],N=()=>({width:C,height:A,meta:null});return(o.dataSources.get(this.id)??[]).forEach((t,e)=>{let i=x[e],a=b[e],s=S.convert(i)+D,o=k.convert(a)+M,r=v?.[e],n=null==r?void 0:this.getLabelText(m,{value:r,datum:t,colorKey:p,colorName:u,xKey:l,yKey:d,xName:h,yName:c}),O=ug(n,this.properties.label,void 0,this.properties.label,{padding:f},N),P={x:s,y:o,size:0};if(w.push({series:this,itemId:d,datumIndex:e,yKey:d,xKey:l,xValue:i,yValue:a,colorValue:r,datum:t,point:P,width:C,height:A,midPoint:{x:s,y:o},missing:null!=v&&null==r}),O?.label!=null){let{text:i,fontSize:a,lineHeight:s,height:o}=O.label,{fontStyle:r,fontFamily:n,fontWeight:l,color:h}=this.properties.label,c=P.x+L*(C-2*f),p=P.y+T*(A-2*f)-(O.height-o)*.5;I.push({series:this,itemId:d,datum:t,datumIndex:e,text:i,fontSize:a,lineHeight:s,fontStyle:r,fontFamily:n,fontWeight:l,color:h,textAlign:g,verticalAlign:y,x:c,y:p})}}),{itemId:this.properties.yKey??this.id,nodeData:w,labelData:I,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new uP}update(t){return this.ctx.animationManager.skipCurrentBatch(),super.update(t)}updateDatumSelection(t){let{nodeData:e,datumSelection:i}=t;return i.update(e??[])}getItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle.item:void 0;return{fill:i?.fill,fillOpacity:i?.fillOpacity??1,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity}}getItemStyleOverrides(t,e,i,a,s){let{id:o,properties:r}=this,{xKey:n,yKey:l,itemStyler:h}=r,d=this.isColorScaleValid()&&null!=i?this.colorScale.convert(i):"transparent",c=null==a.fill?{fill:d}:void 0;if(null!=h){c??(c={});let i=this.cachedDatumCallback(uN(t,s?"highlight":"node"),()=>this.callWithContext(h,{seriesId:o,datum:e,xKey:n,yKey:l,highlighted:s,...a,fill:d}));Object.assign(c,i)}return c}updateDatumNodes(t){let{isHighlight:e}=t,i=this.axes[uA.X],[a,s]=i?.visibleRange??[],o=0===a&&1===s,r=this.getItemBaseStyle(e);t.datumSelection.each((t,i)=>{let{datumIndex:a,colorValue:s,datum:n,point:l,width:h,height:d}=i,c=this.getItemStyleOverrides(String(a),n,s,r,e);t.crisp=o,t.x=Math.floor(l.x-h/2),t.y=Math.floor(l.y-d/2),t.width=Math.ceil(h),t.height=Math.ceil(d),uR(t,r,c)})}updateLabelSelection(t){let{labelData:e,labelSelection:i}=t,{enabled:a}=this.properties.label;return i.update(a?e:[])}updateLabelNodes(t){t.labelSelection.each((t,e)=>{t.text=e.text,t.fontSize=e.fontSize,t.lineHeight=e.lineHeight,t.fontStyle=e.fontStyle,t.fontFamily=e.fontFamily,t.fontWeight=e.fontWeight,t.fill=e.color,t.textAlign=e.textAlign,t.textBaseline=e.verticalAlign,t.x=e.x,t.y=e.y,t.pointerEvents=uE.None})}getTooltipContent(t){let e,{id:i,dataModel:a,processedData:s,axes:o,properties:r,colorScale:n}=this,{xKey:l,xName:h,yKey:d,yName:c,colorKey:p,colorName:u,colorRange:g,title:y,legendItemName:f,tooltip:m}=r,x=o[uA.X],b=o[uA.Y];if(!a||!s||!x||!b)return;let v=s.dataSources.get(this.id)?.[t],S=a.resolveColumnById(this,"xValue",s)[t],k=a.resolveColumnById(this,"yValue",s)[t],D=null!=p&&this.isColorScaleValid()?a.resolveColumnById(this,"colorValue",s)[t]:void 0;if(null==S)return;let M=[];null==D?e=g[0]:(e=n.convert(D),M.push({label:u,fallbackLabel:p,value:String(D)})),M.push({label:h,fallbackLabel:l,value:x.formatDatum(S)},{label:c,fallbackLabel:d,value:b.formatDatum(k)});let w=this.getItemBaseStyle(!1);Object.assign(w,this.getItemStyleOverrides(String(t),v,D,w,!1)),null!=w.fill&&(e=w.fill);let I=null!=e?{marker:{shape:"square",fill:e,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}}:void 0;return this.formatTooltipWithContext(m,{title:y??f,symbol:I,data:M},{seriesId:i,datum:v,title:y,xKey:l,xName:h,yKey:d,yName:c,colorKey:p,colorName:u,...w})}getLegendData(t){return"gradient"===t&&this.isColorScaleValid()&&this.dataModel?[{legendType:"gradient",enabled:this.visible,seriesId:this.id,colorName:this.properties.colorName,colorDomain:this.processedData.domain.values[this.dataModel.resolveProcessedDataIndexById(this,"colorValue")],colorRange:this.properties.colorRange}]:[]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:t}){let e=this.contextNodeData?.nodeData[t];if(void 0===e)return;let{width:i,height:a,midPoint:s}=e;return uw(this,{x:s.x-i/2,y:s.y-a/2,width:i,height:a})}};u_.className="HeatmapSeries",u_.type="heatmap";var{commonSeriesOptionsDefs:uW,heatmapSeriesThemeableOptionsDef:uG}=a.n1,uj={...uG,...uW,type:(0,s.mw)((0,s.dY)("heatmap")),xKey:(0,s.mw)(s.Yj),yKey:(0,s.mw)(s.Yj),colorKey:s.Yj,xName:s.Yj,yName:s.Yj,colorName:s.Yj,colorRange:(0,s.jk)(s.yW)},uV={series:{stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"backgroundColor"},{$path:["./0",{$palette:"stroke"},{$palette:"strokes"}]}]},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},a.n1.SAFE_RANGE2_OPERATION]},label:{enabled:!1,color:{$ref:"textColor"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3},gradientLegend:{enabled:!0}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:u$,CARTESIAN_POSITION:uH}}=a.n1,uY={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"heatmap",moduleFactory:t=>new u_(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:u$.CATEGORY,position:uH.LEFT},{type:u$.CATEGORY,position:uH.BOTTOM}],themeTemplate:uV},uK={type:"series",name:"heatmap",chartType:"cartesian",enterprise:!0,options:uj,create:t=>new u_(t)},{createDatumId:uU}=a.n1,uX=class extends pM{constructor(){super(...arguments),this.properties=new pj}nodeFactory(){return new pL}updateDatumNodes({datumSelection:t,isHighlight:e}){let{id:i,properties:a}=this,{xKey:s,highKey:o,lowKey:r,openKey:n,closeKey:l,item:h,itemStyler:d}=a,{up:c,down:p}=h,{stroke:u,strokeWidth:g,strokeOpacity:y,lineDash:f,lineDashOffset:m}=c,{stroke:x,strokeWidth:b,strokeOpacity:v,lineDash:S,lineDashOffset:k}=p,D=e?a.highlightStyle.item:void 0;t.each((t,a)=>{let h,{isRising:M,centerX:w,width:I,y:C,height:A,yOpen:L,yClose:T,crisp:N}=a;if(null!=d){let{stroke:t,strokeWidth:u,strokeOpacity:g,lineDash:y,lineDashOffset:f}=M?c:p;h=this.cachedDatumCallback(uU(this.getDatumId(a),e?"highlight":"node"),()=>this.callWithContext(d,{seriesId:i,itemId:a.itemId,xKey:s,highKey:o,lowKey:r,openKey:n,closeKey:l,datum:a.datum,strokeOpacity:g,stroke:t,strokeWidth:u,lineDash:y,lineDashOffset:f,highlighted:e}))}t.centerX=w,t.width=I,t.y=C,t.height=A,t.yOpen=L,t.yClose=T,t.crisp=N,t.stroke=D?.stroke??h?.stroke??(M?u:x),t.strokeWidth=D?.strokeWidth??h?.strokeWidth??(M?g:b),t.strokeOpacity=D?.strokeOpacity??h?.strokeOpacity??(M?y:v),t.lineDash=D?.lineDash??h?.lineDash??(M?f:S),t.lineDashOffset=D?.lineDashOffset??h?.lineDashOffset??(M?m:k),t.strokeAlignment=(h?.strokeWidth??(M?g:b))/2})}getLegendData(t){let{id:e,data:i,ctx:{legendManager:a},visible:s}=this,{xKey:o,yName:r,item:{up:n,down:l},showInLegend:h,legendItemName:d}=this.properties;if(!i?.length||!o||"category"!==t)return[];let c={type:"gradient",gradient:"linear",colorSpace:"rgb",colorStops:[{color:n.stroke,stop:0},{color:n.stroke,stop:.5},{color:l.stroke,stop:.5}],rotation:90};return[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:s&&a.getItemEnabled({seriesId:e,itemId:e}),label:{text:d??r??e},symbol:{marker:{fill:c,fillOpacity:n.strokeOpacity,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0}},legendItemName:d,hideInLegend:!h}]}};uX.className="ohlc",uX.type="ohlc";var{commonSeriesOptionsDefs:uZ,ohlcSeriesThemeableOptionsDef:uQ}=a.n1,uq={...uQ,...uZ,type:(0,s.mw)((0,s.dY)("ohlc")),xKey:(0,s.mw)(s.Yj),openKey:(0,s.mw)(s.Yj),highKey:(0,s.mw)(s.Yj),lowKey:(0,s.mw)(s.Yj),closeKey:(0,s.mw)(s.Yj),xName:s.Yj,yName:s.Yj,openName:s.Yj,highName:s.Yj,lowName:s.Yj,closeName:s.Yj};uq.pickOutsideVisibleMinorAxis=(0,s._L)(s.zM),uq.focusPriority=(0,s._L)(s.ai);var{CARTESIAN_AXIS_TYPE:uJ,CARTESIAN_POSITION:u0}=a.n1.ThemeConstants,u1={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ohlc",moduleFactory:t=>new uX(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:uJ.NUMBER,position:u0.LEFT},{type:uJ.ORDINAL_TIME,position:u0.BOTTOM}],themeTemplate:{animation:{enabled:!1},series:{item:{up:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"up.stroke"}]}},down:{stroke:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$palette:"stroke"},{$palette:"down.stroke"}]}}}},axes:{[uJ.NUMBER]:{crosshair:{snap:!1}},[uJ.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},groupable:!1},u2={type:"series",name:"ohlc",chartType:"cartesian",enterprise:!0,options:uq,create:t=>new uX(t)};function u4(t,e,i,a,s,o){let r=t[o];return null!=r&&o===a[po(ps(r,e,i),s)+3]}function u5(t,e,i,a,s,o){let r=t[o];return null!=r&&o===a[po(ps(r,e,i),s)+2]}var{CartesianSeriesProperties:u3,FillGradientDefaults:u6,FillPatternDefaults:u8,FillImageDefaults:u9,InterpolationProperties:u7,SeriesMarker:gt,SeriesTooltip:ge,Property:gi,DropShadow:ga,Label:gs}=a.n1,go=class extends gs{constructor(){super(...arguments),this.placement="outside",this.padding=6}};n([gi],go.prototype,"placement",2),n([gi],go.prototype,"padding",2);var gr=class extends u3{constructor(){super(...arguments),this.fill="#99CCFF",this.fillGradientDefaults=new u6,this.fillPatternDefaults=new u8,this.fillImageDefaults=new u9,this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new u7,this.shadow=new ga().set({enabled:!1}),this.marker=new gt,this.label=new go,this.tooltip=new ge,this.connectMissingData=!1}};n([gi],gr.prototype,"xKey",2),n([gi],gr.prototype,"yLowKey",2),n([gi],gr.prototype,"yHighKey",2),n([gi],gr.prototype,"xName",2),n([gi],gr.prototype,"yName",2),n([gi],gr.prototype,"yLowName",2),n([gi],gr.prototype,"yHighName",2),n([gi],gr.prototype,"fill",2),n([gi],gr.prototype,"fillGradientDefaults",2),n([gi],gr.prototype,"fillPatternDefaults",2),n([gi],gr.prototype,"fillImageDefaults",2),n([gi],gr.prototype,"fillOpacity",2),n([gi],gr.prototype,"stroke",2),n([gi],gr.prototype,"strokeWidth",2),n([gi],gr.prototype,"strokeOpacity",2),n([gi],gr.prototype,"lineDash",2),n([gi],gr.prototype,"lineDashOffset",2),n([gi],gr.prototype,"interpolation",2),n([gi],gr.prototype,"shadow",2),n([gi],gr.prototype,"marker",2),n([gi],gr.prototype,"label",2),n([gi],gr.prototype,"tooltip",2),n([gi],gr.prototype,"connectMissingData",2);var{CollapseMode:gn,isScaleValid:gl,pairUpSpans:gh,prepareAreaFillAnimationFns:gd,plotInterpolatedLinePathStroke:gc,prepareLinePathPropertyAnimation:gp,areScalingEqual:gu}=a.n1,{valueProperty:gg,keyProperty:gy,ChartAxisDirection:gf,mergeDefaults:gm,updateLabelNode:gx,fixNumericExtent:gb,buildResetPathFn:gv,resetLabelFn:gS,resetMarkerFn:gk,resetMarkerPositionFn:gD,pathSwipeInAnimation:gM,resetMotion:gw,markerSwipeScaleInAnimation:gI,seriesLabelFadeInAnimation:gC,animationValidation:gA,diff:gL,updateClipPath:gT,computeMarkerFocusBounds:gN,plotAreaPathFill:gO,plotLinePathStroke:gP,interpolatePoints:gE,pathFadeInAnimation:gR,markerFadeInAnimation:gB,fromToMotion:gz,pathMotion:gF,extent:g_,createDatumId:gW,applyShapeFillBBox:gG,PointerEvents:gj,Group:gV,BBox:g$,ContinuousScale:gH,DiscreteTimeScale:gY,findMinMax:gK,getShapeStyle:gU,getShapeFill:gX,applyShapeStyle:gZ}=a.n1,gQ=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.xKey=a.properties.xKey,this.yLowKey=a.properties.yLowKey,this.yHighKey=a.properties.yHighKey}},gq=class extends a.n1.CartesianSeries{constructor(t){super({moduleCtx:t,hasMarkers:!0,pathsPerSeries:["fill","stroke"],pickModes:[a.n1.SeriesNodePickMode.AXIS_ALIGNED],directionKeys:{[gf.X]:["xKey"],[gf.Y]:["yLowKey","yHighKey"]},directionNames:{[gf.X]:["xName"],[gf.Y]:["yLowName","yHighName","yName"]},categoryKey:"xValue",animationResetFns:{path:gv({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:gS,marker:(t,e)=>({...gk(t),...gD(t,e)})},clipFocusBox:!1}),this.properties=new gr,this.NodeEvent=gQ,this.dataAggregationFilters=void 0}async processData(t){let{xKey:e,yLowKey:i,yHighKey:a}=this.properties,s=this.axes[gf.X]?.scale,o=this.axes[gf.Y]?.scale,{xScaleType:r,yScaleType:n}=this.getScaleInformation({xScale:s,yScale:o}),l=[],h=!this.ctx.animationManager.isSkipped();!this.ctx.animationManager.isSkipped()&&this.processedData&&l.push(gL(this.id,this.processedData)),h&&l.push(gA());let{dataModel:d,processedData:c}=await this.requestDataModel(t,this.data,{props:[gy(e,r,{id:"xValue"}),gg(i,n,{id:"yLowValue"}),gg(a,n,{id:"yHighValue"}),...l]});this.dataAggregationFilters=this.aggregateData(d,c),this.animationState.transition("updateData")}aggregateData(t,e){let i=this.axes[gf.X];if(null==i||!(gH.is(i.scale)||gY.is(i.scale)))return;let a=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"yHighValue",e),o=t.resolveColumnById(this,"yLowValue",e),{index:r}=t.resolveProcessedDataDefById(this,"xValue");return function(t,e,i,a){if(t.length<1e3)return;let[s,o]=pa(a),r=pi(t),{indexData:n,valueData:l}=pr(t,e,i,s,o,r),h=[],d=[];for(let e=0;e<t.length;e+=1)u4(t,s,o,n,r,e)&&h.push(e),u5(t,s,o,n,r,e)&&d.push(e);let c=[{maxRange:r,topIndices:h,bottomIndices:d}];for(;r>64;)({maxRange:r}=pn(n,l,r,{inPlace:!0})),h=h.filter(u4.bind(null,t,s,o,n,r)),d=d.filter(u5.bind(null,t,s,o,n,r)),c.push({maxRange:r,topIndices:h,bottomIndices:d});return c.reverse(),c}(a,s,o,e.domain.keys[r])}xCoordinateRange(t){let e=this.axes[gf.X].scale.convert(t);return[e,e]}yCoordinateRange(t){let e=this.axes[gf.Y].scale.convert(t[0]);return[e,e]}getSeriesDomain(t){let{processedData:e,dataModel:i}=this;if(!(e&&i))return[];let{domain:{keys:[a]}}=e;if(t!==gf.X)return gb(gK(this.domainForClippedRange(gf.Y,["yHighValue","yLowValue"],"xValue",!0)));{let t=i.resolveProcessedDataDefById(this,"xValue");return t?.def.type==="key"&&"category"===t.def.valueType?a:gb(g_(a))}}getSeriesRange(t,e){return this.domainForVisibleRange(gf.Y,["yHighValue","yLowValue"],"xValue",e,!0)}createNodeData(){let{data:t,dataModel:e,processedData:i,axes:a}=this,s=a[gf.X],o=a[gf.Y];if(!(t&&s&&o&&e&&i))return;let r=s.scale,n=o.scale,{xKey:l,yLowKey:h,yHighKey:d,connectMissingData:c,marker:p,interpolation:u}=this.properties,g=i.dataSources.get(this.id)??[],y=(r.bandwidth??0)/2,f=e.resolveKeysById(this,"xValue",i),m=e.resolveColumnById(this,"yHighValue",i),x=e.resolveColumnById(this,"yLowValue",i),b=t=>r.convert(f[t])+y,v=[],S=[],k=[],D=(t,e,i)=>{let a=g[t],s=f[t];if(null==s)return;let o=k[k.length-1];if(Number.isFinite(e)&&Number.isFinite(i)){let r=(o,r,n)=>{S.push({index:t,series:this,itemId:o,datum:a,datumIndex:t,midPoint:{x:u,y:n},yHighValue:e,yLowValue:i,xValue:s,xKey:l,yLowKey:h,yHighKey:d,point:{x:u,y:n,size:f},enabled:!0});let p=this.createLabelData({datumIndex:t,point:{x:u,y:n},value:r,yLowValue:i,yHighValue:e,itemId:o,inverted:c,datum:a,series:this});v.push(p)},c=i>e,u=b(t),g=n.convert(e),y=n.convert(i),{size:f}=p;r("high",e,g),r("low",i,y);let m={high:{point:{x:u,y:g},xDatum:s,yDatum:e},low:{point:{x:u,y:y},xDatum:s,yDatum:i}};Array.isArray(o)?o.push(m):(null!=o&&(o.skip+=1),k.push([m]))}else c||(Array.isArray(o)||null==o?k.push({skip:0}):o.skip+=1)},{dataAggregationFilters:M}=this,[w,I]=r.range,C=I-w,A=M?.find(t=>t.maxRange>C),L=A?.topIndices,T=A?.bottomIndices,[N,O]=this.visibleRange("xValue",s.range,L);N=Math.max(N-1,0),O=Math.min(O+1,L?.length??f.length),i.input.count<1e3&&(N=0,O=i.input.count);for(let t=N;t<O;t+=1){let e=L?.[t]??t,i=T?.[t]??t;D(e,m[e],x[i])}let P=k.flatMap(t=>Array.isArray(t)?gE(t.map(t=>t.high),u):[]),E=k.flatMap(t=>Array.isArray(t)?gE(t.map(t=>t.low),u):[]);return{itemId:`${h}-${d}`,labelData:v,nodeData:S,fillData:{itemId:"high",spans:P,phantomSpans:E},highStrokeData:{itemId:"high",spans:P},lowStrokeData:{itemId:"low",spans:E},scales:this.calculateScaling(),visible:this.visible}}createLabelData({datumIndex:t,point:e,value:i,itemId:a,inverted:s,datum:o,series:r}){let{xKey:n,yLowKey:l,yHighKey:h,xName:d,yName:c,yLowName:p,yHighName:u,label:g}=this.properties,{placement:y,padding:f=10}=g,m=a;s&&(m="low"===a?"high":"low");let x="outside"===y&&"high"===m||"inside"===y&&"low"===m?-1:1;return{x:e.x,y:e.y+f*x,series:r,itemId:a,datum:o,datumIndex:t,text:this.getLabelText(g,{value:i,datum:o,itemId:a,xKey:n,yLowKey:l,yHighKey:h,xName:d,yLowName:p,yHighName:u,yName:c}),textAlign:"center",textBaseline:-1===x?"bottom":"top"}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}updatePathNodes(t){let{opacity:e,visible:i}=t,[a,s]=t.paths,o=this.getStrokeWidth(this.properties.strokeWidth);s.setProperties({fill:void 0,lineCap:"round",lineJoin:"round",pointerEvents:gj.None,stroke:this.properties.stroke,strokeWidth:o,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity:e,visible:i});let r=gX(this.properties.fill,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults),n=this.getShapeFillBBox();gG(a,r,n),gZ(a,{stroke:void 0,fill:r,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,strokeOpacity:this.properties.strokeOpacity,strokeWidth:o},void 0,n),a.setProperties({pointerEvents:gj.None,lineJoin:"round",fillShadow:this.properties.shadow,opacity:e,visible:i}),gT(this,s),gT(this,a)}updatePaths(t){this.updateAreaPaths(t.paths,t.contextData)}updateAreaPaths(t,e){for(let i of t)i.visible=e.visible;if(e.visible)this.updateFillPath(t,e),this.updateStrokePath(t,e);else for(let e of t)e.path.clear(),e.markDirty("RangeArea")}updateFillPath(t,e){let[i]=t;i.path.clear(),gO(i,e.fillData),i.markDirty("RangeArea")}updateStrokePath(t,e){let[,i]=t;i.path.clear(),gP(i,e.highStrokeData.spans),gP(i,e.lowStrokeData.spans),i.markDirty("RangeArea")}updateMarkerSelection(t){let{nodeData:e,markerSelection:i}=t;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(this.properties.marker.enabled?e:[])}getMarkerItemBaseStyle(t){let{properties:e}=this,{marker:i}=e,a=t?e.highlightStyle.item:void 0;return{shape:i.shape,size:i.size,fill:a?.fill??i.fill,fillOpacity:a?.fillOpacity??i.fillOpacity,stroke:a?.stroke??i.stroke,strokeWidth:a?.strokeWidth??this.getStrokeWidth(i.strokeWidth),strokeOpacity:a?.strokeOpacity??i.strokeOpacity,lineDash:a?.lineDash??i.lineDash,lineDashOffset:a?.lineDashOffset??i.lineDashOffset}}getMarkerItemStyleOverrides(t,e,i,a){let{id:s,properties:o}=this,{xKey:r,yHighKey:n,yLowKey:l,marker:h}=o,{itemStyler:d}=h;if(null!=d)return this.cachedDatumCallback(gW(t,a?"highlight":"node"),()=>this.callWithContext(d,{seriesId:s,datum:e,xKey:r,yHighKey:n,yLowKey:l,highlighted:a,...i}))}updateMarkerNodes(t){let{markerSelection:e,isHighlight:i}=t,{xKey:a,yLowKey:s,yHighKey:o,marker:r,fill:n,stroke:l,strokeWidth:h,fillOpacity:d,strokeOpacity:c}=this.properties,p=gm(i&&this.properties.highlightStyle.item,r.getStyle(),{fill:n,fillOpacity:d,stroke:l,strokeWidth:h,strokeOpacity:c}),u=this.getShapeFillBBox();e.each((t,e)=>{this.updateMarkerStyle(r,t,e.datum,e.point,{xKey:a,yHighKey:o,yLowKey:s},i,p,u)}),i||this.properties.marker.markClean()}updateLabelSelection(t){let{labelData:e,labelSelection:i}=t;return i.update(e,t=>{t.pointerEvents=gj.None})}updateLabelNodes(t){t.labelSelection.each((t,e)=>{gx(t,this.properties.label,e)})}getHighlightLabelData(t,e){let i=t.filter(t=>t.datum===e.datum);return i.length>0?i:void 0}getHighlightData(t,e){let i=t.filter(t=>t.datum===e.datum);return i.length>0?i:void 0}getTooltipContent(t,e){let{id:i,dataModel:a,processedData:s,axes:o,properties:r}=this,{xName:n,yName:l,yLowKey:h,yLowName:d,xKey:c,yHighKey:p,yHighName:u,tooltip:g}=r,y=o[gf.X],f=o[gf.Y];if(!a||!s||!y||!f)return;let m=s.dataSources.get(this.id)?.[t],x=a.resolveKeysById(this,"xValue",s)[t],b=a.resolveColumnById(this,"yHighValue",s)[t],v=a.resolveColumnById(this,"yLowValue",s)[t];if(null==x)return;let S=this.getMarkerItemBaseStyle(!1);Object.assign(S,this.getMarkerItemStyleOverrides(String(t),t,S,!1));let k=`${f.formatDatum(v)} - ${f.formatDatum(b)}`;return this.formatTooltipWithContext(g,{heading:y.formatDatum(x),symbol:this.legendItemSymbol(),data:[{label:l,fallbackLabel:`${d??h} - ${u??p}`,value:k}]},{seriesId:i,datum:m,title:l,itemId:e?.itemId??"unknown",xName:n,yName:l,yLowKey:h,yLowName:d,xKey:c,yHighKey:p,yHighName:u,...S})}legendItemSymbol(){let{fill:t,stroke:e,strokeWidth:i,strokeOpacity:a,lineDash:s,marker:o}=this.properties;return{marker:gU({shape:o.shape,fill:o.fill??t,stroke:o.stroke??e,fillOpacity:o.fillOpacity,strokeOpacity:o.strokeOpacity,strokeWidth:o.strokeWidth,lineDash:o.lineDash,lineDashOffset:o.lineDashOffset},o.fillGradientDefaults,o.fillPatternDefaults,o.fillImageDefaults),line:{stroke:e,strokeOpacity:a,strokeWidth:i,lineDash:s}}}getLegendData(t){if("category"!==t)return[];let{id:e,visible:i}=this,{yLowKey:a,yHighKey:s,yName:o,yLowName:r,yHighName:n,showInLegend:l}=this.properties,h=o??`${r??a} - ${n??s}`;return[{legendType:"category",id:e,itemId:`${a}-${s}`,seriesId:e,enabled:i,label:{text:`${h}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}nodeFactory(){return new gV}animateEmptyUpdateReady(t){let{markerSelection:e,labelSelection:i,contextData:a,paths:s}=t,{animationManager:o}=this.ctx;this.updateAreaPaths(s,a),gM(this,o,...s),gw([e],gD),gI(this,o,e),gC(this,"labels",o,i)}animateReadyResize(t){let{contextData:e,paths:i}=t;this.updateAreaPaths(i,e),super.animateReadyResize(t)}animateWaitingUpdateReady(t){let{animationManager:e}=this.ctx,{markerSelection:i,labelSelection:a,contextData:s,paths:o,previousContextData:r}=t,[n,l]=o;if(null==n&&null==l)return;this.resetMarkerAnimation(t),this.resetLabelAnimation(t);let h=()=>{this.resetPathAnimation(t),this.updateAreaPaths(o,s)};if(null==s||null==r){h(),gB(this,e,"added",i),gR(this,"fill_path_properties",e,"add",n),gR(this,"stroke_path_properties",e,"add",l),gC(this,"labels",e,a);return}let d=function(t,e,i){if(t.scales.x?.type==="category"!=(e.scales.x?.type==="category")||!gl(t.scales.x)||!gl(e.scales.x))return;let a="updated";e.visible&&!t.visible?a="removed":!e.visible&&t.visible&&(a="added");let s=gh({scales:t.scales,data:t.fillData.spans},{scales:e.scales,data:e.fillData.spans},gn.Split);if(null==s)return;let o=gh({scales:t.scales,data:t.fillData.phantomSpans},{scales:e.scales,data:e.fillData.phantomSpans},gn.Split);if(null==o)return;let r=gh({scales:t.scales,data:t.highStrokeData.spans},{scales:e.scales,data:e.highStrokeData.spans},gn.Split);if(null==r)return;let n=gh({scales:t.scales,data:t.lowStrokeData.spans},{scales:e.scales,data:e.lowStrokeData.spans},gn.Split);if(null==n)return;let l="fade",h=gd(a,s,o,l),d=function(t,e,i,a){let s=gp(t,a);return{status:t,path:{addPhaseFn:(t,a)=>{gc(t,a,e.added),gc(t,a,i.added)},updatePhaseFn:(t,a)=>{gc(t,a,e.moved),gc(t,a,i.moved)},removePhaseFn:(t,a)=>{gc(t,a,e.removed),gc(t,a,i.removed)}},pathProperties:s}}(a,r,n,l),c=(i?.changed??!0)||!gu(t.scales.x,e.scales.x)||!gu(t.scales.y,e.scales.y)||"updated"!==a;return{status:a,fill:h,stroke:d,hasMotion:c}}(s,r,this.processedData?.reduced?.diff?.[this.id]);if(void 0===d)return void(e.skipCurrentBatch(),h());"no-op"!==d.status&&(gz(this.id,"fill_path_properties",e,[n],d.fill.pathProperties),gz(this.id,"stroke_path_properties",e,[l],d.stroke.pathProperties),"added"===d.status?this.updateAreaPaths(o,s):"removed"===d.status?this.updateAreaPaths(o,r):(gF(this.id,"fill_path_update",e,[n],d.fill.path),gF(this.id,"stroke_path_update",e,[l],d.stroke.path)),d.hasMotion&&(gB(this,e,void 0,i),gC(this,"labels",e,a)),this.ctx.animationManager.animate({id:this.id,groupId:"reset_after_animation",phase:"trailing",from:{},to:{},onComplete:()=>this.updateAreaPaths(o,s)}))}getFormattedMarkerStyle(t){let{xKey:e,yLowKey:i,yHighKey:a}=this.properties;return this.getMarkerStyle(this.properties.marker,t.datum,{xKey:e,yLowKey:i,yHighKey:a},!0)}computeFocusBounds(t){let e=gN(this,t),i=gN(this,{...t,datumIndex:t.datumIndex+1});if(e&&i)return g$.merge([e,i])}isDatumEnabled(t,e){return e%2==0&&super.isDatumEnabled(t,e)}};gq.className="RangeAreaSeries",gq.type="range-area";var{commonSeriesOptionsDefs:gJ,rangeAreaSeriesThemeableOptionsDef:g0}=a.n1,g1={...g0,...gJ,type:(0,s.mw)((0,s.dY)("range-area")),xKey:(0,s.mw)(s.Yj),yLowKey:(0,s.mw)(s.Yj),yHighKey:(0,s.mw)(s.Yj),xName:s.Yj,yName:s.Yj,yLowName:s.Yj,yHighName:s.Yj};g1.pickOutsideVisibleMinorAxis=(0,s._L)(s.zM),g1.focusPriority=(0,s._L)(s.ai);var g2={series:{fill:{$palette:"fill"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,stroke:{$palette:"stroke"},fillOpacity:.7,nodeClickRange:"nearest",marker:{enabled:!1,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,size:6,strokeWidth:2},label:{enabled:!1,placement:"outside",padding:10,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},interpolation:{type:"linear"}},axes:{[a.n1.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:g4,CARTESIAN_POSITION:g5}}=a.n1,g3={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-area",moduleFactory:t=>new gq(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:g4.NUMBER,position:g5.LEFT},{type:g4.CATEGORY,position:g5.BOTTOM}],themeTemplate:g2},g6={type:"series",name:"range-area",chartType:"cartesian",enterprise:!0,options:g1,create:t=>new gq(t)},{AbstractBarSeriesProperties:g8,FillGradientDefaults:g9,FillPatternDefaults:g7,FillImageDefaults:yt,SeriesTooltip:ye,Property:yi,DropShadow:ya,Label:ys}=a.n1,yo=class extends ys{constructor(){super(...arguments),this.placement="inside",this.padding=6}};n([yi],yo.prototype,"placement",2),n([yi],yo.prototype,"padding",2);var yr=class extends g8{constructor(){super(...arguments),this.fill="#99CCFF",this.fillGradientDefaults=new g9,this.fillPatternDefaults=new g7,this.fillImageDefaults=new yt,this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new ya().set({enabled:!1}),this.label=new yo,this.tooltip=new ye,this.fastDataProcessing=!1}};n([yi],yr.prototype,"xKey",2),n([yi],yr.prototype,"yLowKey",2),n([yi],yr.prototype,"yHighKey",2),n([yi],yr.prototype,"xName",2),n([yi],yr.prototype,"yName",2),n([yi],yr.prototype,"yLowName",2),n([yi],yr.prototype,"yHighName",2),n([yi],yr.prototype,"fill",2),n([yi],yr.prototype,"fillGradientDefaults",2),n([yi],yr.prototype,"fillPatternDefaults",2),n([yi],yr.prototype,"fillImageDefaults",2),n([yi],yr.prototype,"fillOpacity",2),n([yi],yr.prototype,"stroke",2),n([yi],yr.prototype,"strokeWidth",2),n([yi],yr.prototype,"strokeOpacity",2),n([yi],yr.prototype,"lineDash",2),n([yi],yr.prototype,"lineDashOffset",2),n([yi],yr.prototype,"cornerRadius",2),n([yi],yr.prototype,"itemStyler",2),n([yi],yr.prototype,"shadow",2),n([yi],yr.prototype,"label",2),n([yi],yr.prototype,"tooltip",2),n([yi],yr.prototype,"fastDataProcessing",2);var{SeriesNodePickMode:yn,valueProperty:yl,keyProperty:yh,ChartAxisDirection:yd,checkCrisp:yc,updateLabelNode:yp,SMALLEST_KEY_INTERVAL:yu,LARGEST_KEY_INTERVAL:yg,diff:yy,prepareBarAnimationFunctions:yf,midpointStartingBarPosition:ym,resetBarSelectionsFn:yx,fixNumericExtent:yb,seriesLabelFadeInAnimation:yv,resetLabelFn:yS,animationValidation:yk,computeBarFocusBounds:yD,visibleRangeIndices:yM,createDatumId:yw,ContinuousScale:yI,DiscreteTimeScale:yC,Rect:yA,PointerEvents:yL,motion:yT,applyShapeStyle:yN,findMinMax:yO,getShapeStyle:yP,areScalingEqual:yE}=a.n1,yR=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.xKey=a.properties.xKey,this.yLowKey=a.properties.yLowKey,this.yHighKey=a.properties.yHighKey}},yB=class extends a.n1.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[yn.AXIS_ALIGNED,yn.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},directionNames:{x:["xName"],y:["yLowName","yHighName","yName"]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:yx,label:yS}}),this.properties=new yr,this.dataAggregationFilters=void 0,this.NodeEvent=yR}async processData(t){let{xKey:e,yLowKey:i,yHighKey:a,fastDataProcessing:s}=this.properties,o=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:n,xScaleType:l,yScaleType:h}=this.getScaleInformation({xScale:o,yScale:r}),d=[];this.ctx.animationManager.isSkipped()||(this.processedData&&d.push(yy(this.id,this.processedData)),d.push(yk()));let c=this.visible?{}:{forceValue:0},{dataModel:p,processedData:u}=await this.requestDataModel(t,this.data,{props:[yh(e,l,{id:"xValue"}),yl(i,h,{id:"yLowValue",invalidValue:null,...c}),yl(a,h,{id:"yHighValue",invalidValue:null,...c}),...n?[yu,yg]:[],...d],groupByKeys:!s});this.smallestDataInterval=u.reduced?.smallestKeyInterval,this.largestDataInterval=u.reduced?.largestKeyInterval,this.dataAggregationFilters=this.aggregateData(p,u),this.animationState.transition("updateData")}aggregateData(t,e){if("grouped"!==e.type)return;let i=this.axes[yd.X];if(null==i||!(yI.is(i.scale)||yC.is(i.scale)))return;let a=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"yHighValue",e),o=t.resolveColumnById(this,"yLowValue",e),{index:r}=t.resolveProcessedDataDefById(this,"xValue");return function(t,e,i,a){if(t.length<1e3)return;let[s,o]=pa(a),r=pi(t,5),{indexData:n,valueData:l}=pr(t,e,i,s,o,r),h=[{maxRange:r,indexData:n}];for(;r>64;)({indexData:n,valueData:l,maxRange:r}=pn(n,l,r)),h.push({maxRange:r,indexData:n});return h.reverse(),h}(a,s,o,e.domain.keys[r])}getSeriesDomain(t){let{processedData:e,dataModel:i}=this;if(!e||!i)return[];let{keys:[a]}=e.domain;if(t!==this.getCategoryDirection())return yb(yO(this.domainForClippedRange(t,["yHighValue","yLowValue"],"xValue",!0)));{let t=i.resolveProcessedDataDefById(this,"xValue");return t?.def.type==="key"&&t?.def.valueType==="category"?a:this.padBandExtent(a)}}getSeriesRange(t,e){return this.domainForVisibleRange(yd.Y,["yHighValue","yLowValue"],"xValue",e,!0)}createNodeData(){let{data:t,dataModel:e,groupScale:i,processedData:a,visible:s}=this,o=this.getCategoryAxis(),r=this.getValueAxis();if(!(t&&o&&r&&e&&a?.dataSources))return;let n=o.scale,l=r.scale,h=this.getBarDirection()===yd.X,{xKey:d,yLowKey:c,yHighKey:p,strokeWidth:u}=this.properties,g=`${c}-${p}`,y={itemId:g,nodeData:[],labelData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible};if(!s)return y;let f=a.dataSources.get(this.id)??[],m=e.resolveKeysById(this,"xValue",a),x=e.resolveColumnById(this,"yLowValue",a),b=e.resolveColumnById(this,"yHighValue",a),{barWidth:v,groupIndex:S}=this.updateGroupScale(o),k=yI.is(n)?-.5*v:0,D=i.convert(String(S)),M=yc(o?.scale,o?.visibleRange,this.smallestDataInterval,this.largestDataInterval),w=t=>Math.round(n.convert(m[t]))+D+k,I=(t,e,i,a,s,o,r)=>{let n=f[t],v=m[t];if(null==v)return;let S=x[t],k=b[t];if(!Number.isFinite(S?.valueOf())||!Number.isFinite(k?.valueOf()))return;let[D,M]=S<k?[S,k]:[k,S],w=Math.round(l.convert(o)),I=Math.round(l.convert(s)),C=Math.max(u,Math.abs(I-w)),A={x:h?Math.min(w,I):i,y:h?i:Math.min(w,I),width:h?C:a,height:h?a:C},L={x:A.x+A.width/2,y:A.y+A.height/2},T=this.createLabelData({datumIndex:t,rect:A,barAlongX:h,yLowValue:D,yHighValue:M,datum:n,series:this}),N={index:e,valueIndex:t,series:this,itemId:g,datum:n,datumIndex:t,xValue:v,yLowValue:S,yHighValue:k,yLowKey:c,yHighKey:p,xKey:d,x:A.x,y:A.y,width:A.width,height:A.height,midPoint:L,crisp:r,labels:T};y.nodeData.push(N),y.labelData.push(...T)},{dataAggregationFilters:C}=this,[A,L]=n.range,T=L-A,N=C?.find(t=>t.maxRange>T);if(null!=N){let{maxRange:t,indexData:e}=N,[i,a]=yM(t,o.range,t=>{let i=4*t,a=e[i+0],s=e[i+1];if(-1!==a)return[w((a+s)/2|0),w(s)+v]});for(let t=i;t<a;t+=1){let i=4*t,a=e[i+0],s=e[i+1],o=e[i+2],r=e[i+3];if(-1===a)continue;let n=(a+s)/2|0;if(null==m[n])continue;let l=w(n),h=Math.abs(w(a)-w(s))+v;I(n,0,l,h,x[o],b[r],!1)}}else if("ungrouped"===a.type){let[t,e]=yM(f.length,o.range,t=>[w(t),v]);a.input.count<1e3&&(t=0,e=a.input.count);for(let i=t;i<e;i+=1){let t=w(i),e=x[i],a=b[i];I(i,0,t,v,e,a,M)}}else for(let{datumIndex:t,groupIndex:i}of e.forEachGroupDatum(this,a)){let e=w(t),a=x[t],s=b[t];I(t,i,e,v,a,s,M)}return y}createLabelData({datumIndex:t,rect:e,barAlongX:i,yLowValue:a,yHighValue:s,datum:o,series:r}){let{xKey:n,yLowKey:l,yHighKey:h,xName:d,yLowName:c,yHighName:p,yName:u,label:g}=this.properties,y={datum:o,xKey:n,yLowKey:l,yHighKey:h,xName:d,yLowName:c,yHighName:p,yName:u},{placement:f,padding:m}=g,x=m*("outside"===f?1:-1),b={datumIndex:t,x:e.x+(i?-x:e.width/2),y:e.y+(i?e.height/2:e.height+x),textAlign:i?"left":"center",textBaseline:i?"middle":"bottom",text:this.getLabelText(g,{itemId:"low",value:a,...y}),itemId:"low",datum:o,series:r},v={datumIndex:t,x:e.x+(i?e.width+x:e.width/2),y:e.y+(i?e.height/2:-x),textAlign:i?"right":"center",textBaseline:i?"middle":"top",text:this.getLabelText(g,{itemId:"high",value:s,...y}),itemId:"high",datum:o,series:r};return"outside"===f&&(b.textAlign=i?"right":"center",b.textBaseline=i?"middle":"top",v.textAlign=i?"left":"center",v.textBaseline=i?"middle":"bottom"),[b,v]}nodeFactory(){return new yA}updateDatumSelection(t){let{nodeData:e,datumSelection:i}=t;return i.update(e??[],void 0,t=>this.getDatumId(t))}getItemBaseStyle(t){let{properties:e}=this,{cornerRadius:i,fillGradientDefaults:a,fillPatternDefaults:s,fillImageDefaults:o}=e,r=t?e.highlightStyle.item:void 0;return yP({fill:r?.fill??e.fill,fillOpacity:r?.fillOpacity??e.fillOpacity,stroke:r?.stroke??e.stroke,strokeWidth:r?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:r?.strokeOpacity??e.strokeOpacity,lineDash:r?.lineDash??e.lineDash??[],lineDashOffset:r?.lineDashOffset??e.lineDashOffset,cornerRadius:i},a,s,o)}getItemStyleOverrides(t,e,i,a){let{id:s,properties:o}=this,{xKey:r,yHighKey:n,yLowKey:l,itemStyler:h,fillGradientDefaults:d,fillPatternDefaults:c,fillImageDefaults:p}=o;if(null==h)return;let u=this.cachedDatumCallback(yw(t,a?"highlight":"node"),()=>this.callWithContext(h,{seriesId:s,datum:e,xKey:r,yHighKey:n,yLowKey:l,highlighted:a,...i}));return yP(u,d,c,p)}updateDatumNodes(t){let{datumSelection:e,isHighlight:i}=t,a=this.getCategoryDirection()===yd.X,s=this.getItemBaseStyle(i),o=this.getShapeFillBBox();e.each((t,e)=>{let r=this.getItemStyleOverrides(String(e.datumIndex),e.datum,s,i);yN(t,s,r,o),t.cornerRadius=r?.cornerRadius??s.cornerRadius,t.visible=a?e.width>0:e.height>0,t.crisp=e.crisp})}getHighlightLabelData(t,e){let i=t.filter(t=>t.datum===e.datum);return i.length>0?i:void 0}updateLabelSelection(t){let e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,t=>{t.pointerEvents=yL.None})}updateLabelNodes(t){t.labelSelection.each((t,e)=>{yp(t,this.properties.label,e)})}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,properties:s}=this,{xKey:o,xName:r,yName:n,yLowKey:l,yHighKey:h,yLowName:d,yHighName:c,tooltip:p}=s,u=this.getCategoryAxis(),g=this.getValueAxis();if(!i||!a||!u||!g)return;let y=a.dataSources.get(this.id)?.[t],f=i.resolveKeysById(this,"xValue",a)[t],m=i.resolveColumnById(this,"yHighValue",a)[t],x=i.resolveColumnById(this,"yLowValue",a)[t];if(null==f)return;let b=this.getItemBaseStyle(!1);Object.assign(b,this.getItemStyleOverrides(String(t),y,b,!1));let v=`${g.formatDatum(x)} - ${g.formatDatum(m)}`;return this.formatTooltipWithContext(p,{heading:u.formatDatum(f),symbol:this.legendItemSymbol(),data:[{label:n,fallbackLabel:`${d??l} - ${c??h}`,value:v}]},{seriesId:e,datum:y,title:n,xKey:o,xName:r,yName:n,yLowKey:l,yHighKey:h,yLowName:d,yHighName:c,...b})}legendItemSymbol(){let{fill:t,stroke:e,strokeWidth:i,fillOpacity:a,strokeOpacity:s,lineDash:o,lineDashOffset:r,fillGradientDefaults:n,fillPatternDefaults:l,fillImageDefaults:h}=this.properties;return{marker:yP({fill:t,stroke:e,fillOpacity:a,strokeOpacity:s,strokeWidth:i,lineDash:o,lineDashOffset:r},n,l,h)}}getLegendData(t){if("category"!==t)return[];let{id:e,visible:i}=this,{yName:a,yLowName:s,yHighName:o,yLowKey:r,yHighKey:n,showInLegend:l}=this.properties,h=a??`${s??r} - ${o??n}`;return[{legendType:"category",id:e,itemId:`${r}-${n}`,seriesId:e,enabled:i,label:{text:`${h}`},symbol:this.legendItemSymbol(),hideInLegend:!l}]}animateEmptyUpdateReady({datumSelection:t,labelSelection:e}){let i=yf(ym(this.isVertical(),"normal"));yT.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],i),yv(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(t){let{datumSelection:e,labelSelection:i,contextData:s,previousContextData:o}=t,r=a.n1.calculateDataDiff(this.id,e,this.getDatumId.bind(this),s,o,this.processedData);this.ctx.animationManager.stopByAnimationGroupId(this.id);let n=null==o?"fade":"normal",l=yf(ym(this.isVertical(),n));yT.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],l,(t,e)=>this.getDatumId(e),r),(r?.changed||!yE(s.groupScale,o?.groupScale))&&yv(this,"labels",this.ctx.animationManager,i)}getDatumId(t){return`${t.xValue}-${t.valueIndex}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t}){return yD(this,this.contextNodeData?.nodeData[t])}};yB.className="RangeBarSeries",yB.type="range-bar";var{commonSeriesOptionsDefs:yz,rangeBarSeriesThemeableOptionsDef:yF}=a.n1,y_={...yF,...yz,type:(0,s.mw)((0,s.dY)("range-bar")),xKey:(0,s.mw)(s.Yj),yLowKey:(0,s.mw)(s.Yj),yHighKey:(0,s.mw)(s.Yj),xName:s.Yj,yName:s.Yj,yLowName:s.Yj,yHighName:s.Yj};y_.pickOutsideVisibleMinorAxis=(0,s._L)(s.zM),y_.fastDataProcessing=(0,s._L)(s.zM),y_.focusPriority=(0,s._L)(s.ai);var yW={series:{direction:"vertical",fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},placement:"inside"}},axes:{[a.n1.ThemeConstants.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},yG={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-bar",moduleFactory:t=>new yB(t),tooltipDefaults:{range:"exact"},defaultAxes:a.n1.DIRECTION_SWAP_AXES,themeTemplate:yW,groupable:!0},yj={type:"series",name:"range-bar",chartType:"cartesian",enterprise:!0,options:y_,create:t=>new yB(t)},{AbstractBarSeriesProperties:yV,BaseProperties:y$,FillGradientDefaults:yH,FillPatternDefaults:yY,FillImageDefaults:yK,PropertiesArray:yU,SeriesTooltip:yX,Property:yZ,DropShadow:yQ,Label:yq}=a.n1,yJ=class extends y${};n([yZ],yJ.prototype,"totalType",2),n([yZ],yJ.prototype,"index",2),n([yZ],yJ.prototype,"axisLabel",2);var y0=class extends y${};n([yZ],y0.prototype,"renderer",2);var y1=class extends yq{constructor(){super(...arguments),this.placement="outside-end",this.padding=6}};n([yZ],y1.prototype,"placement",2),n([yZ],y1.prototype,"padding",2);var y2=class extends y${constructor(){super(...arguments),this.fill="#c16068",this.fillGradientDefaults=new yH,this.fillPatternDefaults=new yY,this.fillImageDefaults=new yK,this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new yQ().set({enabled:!1}),this.label=new y1,this.tooltip=new y0}};n([yZ],y2.prototype,"name",2),n([yZ],y2.prototype,"fill",2),n([yZ],y2.prototype,"fillGradientDefaults",2),n([yZ],y2.prototype,"fillPatternDefaults",2),n([yZ],y2.prototype,"fillImageDefaults",2),n([yZ],y2.prototype,"stroke",2),n([yZ],y2.prototype,"fillOpacity",2),n([yZ],y2.prototype,"strokeOpacity",2),n([yZ],y2.prototype,"lineDash",2),n([yZ],y2.prototype,"lineDashOffset",2),n([yZ],y2.prototype,"strokeWidth",2),n([yZ],y2.prototype,"cornerRadius",2),n([yZ],y2.prototype,"itemStyler",2),n([yZ],y2.prototype,"shadow",2),n([yZ],y2.prototype,"label",2),n([yZ],y2.prototype,"tooltip",2);var y4=class extends y${constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};n([yZ],y4.prototype,"enabled",2),n([yZ],y4.prototype,"stroke",2),n([yZ],y4.prototype,"strokeOpacity",2),n([yZ],y4.prototype,"lineDash",2),n([yZ],y4.prototype,"lineDashOffset",2),n([yZ],y4.prototype,"strokeWidth",2);var y5=class extends y${constructor(){super(...arguments),this.positive=new y2,this.negative=new y2,this.total=new y2}};n([yZ],y5.prototype,"positive",2),n([yZ],y5.prototype,"negative",2),n([yZ],y5.prototype,"total",2);var y3=class extends yV{constructor(){super(...arguments),this.item=new y5,this.totals=new yU(yJ),this.line=new y4,this.tooltip=new yX}};n([yZ],y3.prototype,"xKey",2),n([yZ],y3.prototype,"yKey",2),n([yZ],y3.prototype,"xName",2),n([yZ],y3.prototype,"yName",2),n([yZ],y3.prototype,"item",2),n([yZ],y3.prototype,"totals",2),n([yZ],y3.prototype,"line",2),n([yZ],y3.prototype,"tooltip",2);var{adjustLabelPlacement:y6,SeriesNodePickMode:y8,fixNumericExtent:y9,valueProperty:y7,keyProperty:ft,accumulativeValueProperty:fe,trailingAccumulatedValueProperty:fi,ChartAxisDirection:fa,createDatumId:fs,checkCrisp:fo,updateLabelNode:fr,prepareBarAnimationFunctions:fn,collapsedStartingBarPosition:fl,resetBarSelectionsFn:fh,seriesLabelFadeInAnimation:fd,resetLabelFn:fc,animationValidation:fp,DEFAULT_CARTESIAN_DIRECTION_KEYS:fu,DEFAULT_CARTESIAN_DIRECTION_NAMES:fg,computeBarFocusBounds:fy,isContinuous:ff,Rect:fm,motion:fx,applyShapeStyle:fb,getShapeStyle:fv}=a.n1,fS=class extends a.n1.AbstractBarSeries{constructor(t){super({moduleCtx:t,directionKeys:fu,directionNames:fg,categoryKey:void 0,pickModes:[y8.NEAREST_NODE,y8.EXACT_SHAPE_MATCH],pathsPerSeries:["connector"],hasHighlightedLabels:!0,pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:fh,label:fc}}),this.properties=new y3,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(t){let{xKey:e,yKey:i,totals:s}=this.properties,{data:o=[]}=this;if(!this.visible)return;let r={missingValue:void 0,invalidValue:void 0},n=[],l=s.reduce((t,e)=>{let i=t.get(e.index);return i?i.push(e):t.set(e.index,[e]),t},new Map);o.forEach((t,i)=>{n.push(t),l.get(i)?.forEach(t=>n.push({...t.toJson(),[e]:t.axisLabel}))});let h=[];this.ctx.animationManager.isSkipped()||h.push(fp());let d=this.getCategoryAxis()?.scale,c=this.getValueAxis()?.scale,{isContinuousX:p,xScaleType:u,yScaleType:g}=this.getScaleInformation({xScale:d,yScale:c}),{processedData:y}=await this.requestDataModel(t,n,{props:[ft(e,u,{id:"xValue"}),fe(i,g,{...r,id:"yCurrent"}),fe(i,g,{...r,missingValue:0,id:"yCurrentTotal"}),fe(i,g,{...r,id:"yCurrentPositive",validation:t=>ff(t)&&Number(t)>=0}),fe(i,g,{...r,id:"yCurrentNegative",validation:t=>ff(t)&&Number(t)>=0}),fi(i,g,{...r,id:"yPrevious"}),y7(i,g,{id:"yRaw"}),y7("totalType","band",{id:"totalTypeValue",missingValue:void 0,validation:t=>"total"===t||"subtotal"===t}),...p?[a.n1.SMALLEST_KEY_INTERVAL,a.n1.LARGEST_KEY_INTERVAL]:[],...h]});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.largestDataInterval=y.reduced?.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(t){let{processedData:e,dataModel:i}=this;if(!e||!i)return[];let{keys:[a],values:s}=e.domain;if(t===this.getCategoryDirection()){let e=i.resolveProcessedDataDefById(this,"xValue");if(e?.def.type==="key"&&e?.def.valueType==="category")return a;let s=t===fa.Y,o=this.getCategoryAxis().isReversed();return this.padBandExtent(a,o!==s)}{let t=s[i.resolveProcessedDataIndexById(this,"yCurrent")];return y9([Math.min(0,t[0]),Math.max(0,t[1])])}}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){let{data:t,dataModel:e,processedData:i}=this,a=this.getCategoryAxis(),s=this.getValueAxis();if(!t||!a||!s||!e||!i)return;let{line:o}=this.properties,r=a.scale,n=s.scale,l=this.getBarDirection()===fa.X,h=this.getBandwidth(a)??10,d=a.isReversed(),c=s.isReversed();if("ungrouped"!==i.type)return;let p={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible};if(!this.visible)return p;let u=[],g=e.resolveKeysById(this,"xValue",i),y=e.resolveColumnById(this,"yRaw",i),f=e.resolveColumnById(this,"totalTypeValue",i),m=e.resolveColumnById(this,"yCurrent",i),x=e.resolveColumnById(this,"yPrevious",i),b=e.resolveColumnById(this,"yCurrentTotal",i),v=fo(a?.scale,a?.visibleRange,this.smallestDataInterval,this.largestDataInterval),S=0,{xKey:k,yKey:D,xName:M,yName:w}=this.properties;(i.dataSources.get(this.id)??[]).forEach((t,e)=>{let i,a,s=f[e],I=this.isSubtotal(s),C=this.isTotal(s),A=C||I,L=g[e];if(null==L)return;let T=Math.round(r.convert(L)),N=y[e],{cumulativeValue:O,trailingValue:P}=C||I?{cumulativeValue:b[e],trailingValue:I?S:0}:{cumulativeValue:m[e],trailingValue:x[e]};A&&(S=O??0);let E=Math.round(n.convert(O)),R=Math.round(n.convert(P)),B=C?O:I?(O??0)-(P??0):N,z=(B??0)>=0,F=this.getSeriesItemType(z,s),{strokeWidth:_,label:W}=this.getItemConfig(F),G=z?E:R,j=z?R:E,V=Math.max(_,Math.abs(j-G)),$={x:l?Math.min(G,j):T,y:l?T:Math.min(G,j),width:l?V:h,height:l?h:V},H={x:$.x+$.width/2,y:$.y+$.height/2},Y=A?E:R,K=Math.floor(o.strokeWidth)%2/2,U=d?E:Y,X=d?Y:E;l?(i={x:U+K,y:$.y},a={x:X+K,y:$.y+$.height}):(i={x:$.x,y:U+K},a={x:$.x+$.width,y:X+K});let Z={x:d?a.x:i.x,y:d?a.y:i.y,x2:d?i.x:a.x,y2:d?i.y:a.y,size:0};u.push(Z);let Q="subtotal"===F?"total":F,q=this.getLabelText(W,{itemId:Q,value:B,datum:t,xKey:k,yKey:D,xName:M,yName:w}),J={index:e,series:this,itemId:F,datum:t,datumIndex:e,cumulativeValue:O??0,xValue:L,yValue:B,yKey:D,xKey:k,x:$.x,y:$.y,width:$.width,height:$.height,midPoint:H,crisp:v,label:{text:q,...y6({isUpward:(B??-1)>=0!==c,isVertical:!l,placement:W.placement,padding:W.padding,rect:$})}};p.nodeData.push(J),p.labelData.push(J)});let I=this.properties.line.enabled;return null!=m&&I&&(p.pointData=u),p}updateSeriesItemTypes(){let{dataModel:t,seriesItemTypes:e,processedData:i}=this;if(!t||!i)return;e.clear();let a=t.resolveProcessedDataIndexById(this,"yCurrentPositive"),s=t.resolveProcessedDataIndexById(this,"yCurrentNegative"),o=t.resolveProcessedDataIndexById(this,"totalTypeValue"),r=i.domain.values[a]??[],n=i.domain.values[s]??[];r.length>0&&e.add("positive"),n.length>0&&e.add("negative");let l=i?.domain.values[o];l&&l.forEach(t=>{("total"===t||"subtotal"===t)&&e.add("total")})}isSubtotal(t){return"subtotal"===t}isTotal(t){return"total"===t}nodeFactory(){return new fm}getSeriesItemType(t,e){return e??(t?"positive":"negative")}getItemConfig(t){switch(t){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}updateDatumSelection(t){let{nodeData:e,datumSelection:i}=t;return i.update(e??[])}getItemStyle(t,e,i,a){let{id:s,properties:o}=this,r=o.item["subtotal"===i?"total":i],n=a?o.highlightStyle.item:void 0,{itemStyler:l,fillGradientDefaults:h,fillPatternDefaults:d,fillImageDefaults:c}=r,{xKey:p,yKey:u}=o,g=fv({fill:n?.fill??r.fill,fillOpacity:n?.fillOpacity??r.fillOpacity,stroke:n?.stroke??r.stroke,strokeWidth:n?.strokeWidth??r.strokeWidth,strokeOpacity:n?.strokeOpacity??r.strokeOpacity,lineDash:n?.lineDash??r.lineDash??[],lineDashOffset:n?.lineDashOffset??r.lineDashOffset,cornerRadius:r.cornerRadius},h,d,c);if(null!=l){let o=this.cachedDatumCallback(fs(t,a?"highlight":"node"),()=>this.callWithContext(l,{seriesId:s,itemId:i,datum:e,xKey:p,yKey:u,highlighted:a,...g}));Object.assign(g,o=fv(o,h,d,c))}return g}updateDatumNodes(t){let{datumSelection:e,isHighlight:i}=t,a=this.getCategoryDirection()===fa.X,s=this.getShapeFillBBox();e.each((t,e)=>{let o=e.itemId;fb(t,this.getItemStyle(String(e.datumIndex),e.datum,o,i),void 0,s),t.visible=a?e.width>0:e.height>0,t.crisp=e.crisp})}updateLabelSelection(t){let{labelData:e,labelSelection:i}=t;if(0===e.length)return i.update([]);let a=e.filter(t=>{let{label:e}=this.getItemConfig(t.itemId);return e.enabled});return i.update(a)}updateLabelNodes(t){t.labelSelection.each((t,e)=>{fr(t,this.getItemConfig(e.itemId).label,e.label)})}getTooltipContent(t){let e,{id:i,dataModel:a,processedData:s,properties:o}=this,{xKey:r,xName:n,yKey:l,yName:h,tooltip:d}=o,c=this.getCategoryAxis(),p=this.getValueAxis();if(!a||!s||!c||!p)return;let u=s.dataSources.get(this.id)?.[t],g=a.resolveKeysById(this,"xValue",s)[t],y=a.resolveColumnById(this,"yRaw",s)[t],f=a.resolveColumnById(this,"yCurrentTotal",s),m=a.resolveColumnById(this,"totalTypeValue",s);if(null==g)return;let x=m[t],b=this.getSeriesItemType((y??0)>=0,x);if(this.isTotal(x))e=f[t];else if(this.isSubtotal(x)){e=f[t];for(let i=t-1;i>=0;i-=1)if(this.isSubtotal(m[i])){e-=f[i];break}}else e=y;let v=this.getItemStyle(String(t),u,b,!1);return this.formatTooltipWithContext(d,{heading:c.formatDatum(g),symbol:this.legendItemSymbol(b),data:[{label:h,fallbackLabel:l,value:p.formatDatum(e)}]},{seriesId:i,datum:u,title:h,itemId:b,xKey:r,xName:n,yKey:l,yName:h,...v})}legendItemSymbol(t){let{fill:e,stroke:i,fillOpacity:a,strokeOpacity:s,strokeWidth:o,lineDash:r,lineDashOffset:n,fillGradientDefaults:l,fillPatternDefaults:h,fillImageDefaults:d}=this.getItemConfig(t);return{marker:fv({fill:e,stroke:i,fillOpacity:a,strokeOpacity:s,strokeWidth:o,lineDash:r,lineDashOffset:n},l,h,d)}}getLegendData(t){if("category"!==t)return[];let{id:e,seriesItemTypes:i}=this,a=[],s=t=>t.charAt(0).toUpperCase()+t.substring(1),{showInLegend:o}=this.properties;return i.forEach(t=>{let{name:i}=this.getItemConfig(t);a.push({legendType:"category",id:e,itemId:t,seriesId:e,enabled:!0,label:{text:i??s(t)},symbol:this.legendItemSymbol(t),hideInLegend:!o,isFixed:!0})}),a}toggleSeriesItem(){}animateEmptyUpdateReady(t){let{datumSelection:e,labelSelection:i,contextData:a}=t,s=fn(fl(this.isVertical(),this.axes,"normal"));fx.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s),fd(this,"labels",this.ctx.animationManager,i);let{pointData:o}=a;o&&(this.isVertical()?this.animateConnectorLinesVertical(t):this.animateConnectorLinesHorizontal(t))}animateConnectorLinesHorizontal(t){let{pointData:e=[]}=t.contextData,[i]=t.paths,{path:s}=i;this.updateLineNode(i);let o=this.getValueAxis(),r=o?.isReversed(),n=r?(t,e)=>t<e:(t,e)=>t>e,l=o?.scale.convert(0),h=e.reduce((t,e)=>(n(e.x,t)&&(t=e.x),t),r?1/0:0),d=(t,e,i,a,s)=>(t-e)/(i-e)*(s-a)+a;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:l,to:h,ease:a.n1.Motion.easeOut,collapsable:!1,onUpdate(t){s.clear(!0),e.forEach((e,i)=>{let a=d(t,l,h,l,e.x),o=d(t,l,h,l,e.x2);0!==i&&s.lineTo(a,e.y),s.moveTo(o,e.y2)}),i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(t)})}animateConnectorLinesVertical(t){let{pointData:e=[]}=t.contextData,[i]=t.paths,{path:s}=i;this.updateLineNode(i);let o=this.getValueAxis(),r=o?.isReversed(),n=r?(t,e)=>t>e:(t,e)=>t<e,l=o?.scale.convert(0),h=e.reduce((t,e)=>(n(e.y,t)&&(t=e.y),t),r?0:1/0),d=(t,e,i,a,s)=>(t-e)/(i-e)*(s-a)+a;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:l,to:h,ease:a.n1.Motion.easeOut,collapsable:!1,onUpdate(t){s.clear(!0),e.forEach((e,i)=>{let a=d(t,l,h,l,e.y),o=d(t,l,h,l,e.y2);0!==i&&s.lineTo(e.x,a),s.moveTo(e.x2,o)}),i.checkPathDirty()},onStop:()=>this.resetConnectorLinesPath(t)})}animateReadyResize(t){super.animateReadyResize(t),this.resetConnectorLinesPath(t)}updatePaths(t){this.resetConnectorLinesPath({contextData:t.contextData,paths:t.paths})}resetConnectorLinesPath({contextData:t,paths:e}){if(0===e.length)return;let[i]=e;this.updateLineNode(i);let{path:a}=i;a.clear(!0);let{pointData:s}=t;s&&(s.forEach((t,e)=>{0!==e&&a.lineTo(t.x,t.y),a.moveTo(t.x2,t.y2)}),i.checkPathDirty())}updateLineNode(t){let{stroke:e,strokeWidth:i,strokeOpacity:s,lineDash:o,lineDashOffset:r}=this.properties.line;t.setProperties({fill:void 0,stroke:e,strokeWidth:this.getStrokeWidth(i),strokeOpacity:s,lineDash:o,lineDashOffset:r,lineJoin:"round",pointerEvents:a.n1.PointerEvents.None})}isLabelEnabled(){let{positive:t,negative:e,total:i}=this.properties.item;return t.label.enabled||e.label.enabled||i.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t}){return fy(this,this.contextNodeData?.nodeData[t])}};fS.className="WaterfallSeries",fS.type="waterfall";var{commonSeriesOptionsDefs:fk,waterfallSeriesThemeableOptionsDef:fD}=a.n1,fM={...fD,...fk,type:(0,s.mw)((0,s.dY)("waterfall")),xKey:(0,s.mw)(s.Yj),yKey:(0,s.mw)(s.Yj),xName:s.Yj,yName:s.Yj,totals:(0,s.J$)({totalType:(0,s.mw)((0,s.KC)("total","subtotal")),index:(0,s.mw)(s.Ly),axisLabel:(0,s.mw)(s.Yj)},"a total definition options array")};function fw(t,e){return{fill:{$if:[{$eq:[{$palette:"type"},"user-indexed"]},{$path:[`./${e}`,{$palette:"fill"},{$palette:"fills"}]},{$palette:`${t}.fill`}]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$if:[{$or:[{$isGradient:[{$palette:`${t}.fill`}]},{$isPattern:[{$palette:`${t}.fill`}]},{$isImage:[{$palette:`${t}.fill`}]}]},{$map:[{$path:["./color",void 0,{$value:"$1"}]},{$path:["./colorStops",void 0,{$palette:`${t}.fill`}]}]},[{$mix:[{$palette:`${t}.fill`},"black",.15]},{$mix:[{$palette:`${t}.fill`},"white",.15]}]]},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,stroke:{$palette:`${t}.stroke`},strokeWidth:0,label:{enabled:!1,fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},formatter:void 0,placement:"outside-end"}}}var fI={series:{item:{positive:fw("altUp",0),negative:fw("altDown",1),total:fw("neutral",2)},line:{stroke:{$palette:"neutral.stroke"},strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2}},legend:{enabled:!0,toggleSeries:!1}},fC={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"waterfall",solo:!0,moduleFactory:t=>new fS(t),tooltipDefaults:{range:"exact"},defaultAxes:a.n1.DIRECTION_SWAP_AXES,themeTemplate:fI},fA={type:"series",name:"waterfall",chartType:"cartesian",enterprise:!0,options:fM,create:t=>new fS(t)},{NewAreaSeriesModule:fL,NewBarSeriesModule:fT,NewBubbleSeriesModule:fN,NewHistogramSeriesModule:fO,NewLineSeriesModule:fP,NewScatterSeriesModule:fE,numberFormatValidator:fR,without:fB}=a.n1,fz={width:s.Ly,height:s.Ly,grip:s.zM,fill:s.yW,stroke:s.yW,strokeWidth:s.Ly,cornerRadius:s.Ly},fF=["cursor","highlightStyle","listeners","nodeClickRange","showInLegend","showInMiniChart","tooltip","visible","xName","yName"],f_={enabled:s.zM,height:s.Ly,spacing:s.Ly,cornerRadius:s.ai,mask:{fill:s.yW,fillOpacity:s.CG,stroke:s.yW,strokeWidth:s.Ly},minHandle:fz,maxHandle:fz,miniChart:{enabled:s.zM,padding:{top:s.Ly,bottom:s.Ly},label:{enabled:s.zM,avoidCollisions:s.zM,spacing:s.Ly,format:fR,formatter:s.E2,interval:{minSpacing:s.Ly,maxSpacing:s.Ly,values:s.YO,step:s.ai},...s.LV},series:(0,s.J$)((0,s.is)({area:fB(fL.options,fF),bar:fB(fT.options,[...fF,"errorBar","label","legendItemName","direction"]),"box-plot":fB(pt.options,[...fF,"direction","legendItemName","minName","q1Name","medianName","q3Name","maxName"]),bubble:fB(fN.options,[...fF,"title","label","labelKey","labelName","sizeName"]),candlestick:fB(ur.options,fF),heatmap:fB(uK.options,[...fF,"title","label","colorName","textAlign","verticalAlign","itemPadding","colorRange"]),histogram:fB(fO.options,[...fF,"label"]),line:fB(fP.options,[...fF,"errorBar","title","label"]),ohlc:fB(u2.options,fF),"range-area":fB(g6.options,[...fF,"label","yLowName","yHighName"]),"range-bar":fB(yj.options,[...fF,"direction","label","yLowName","yHighName"]),scatter:fB(fE.options,[...fF,"errorBar","title","label","labelKey","labelName"]),waterfall:fB(fA.options,[...fF,"direction"])},"miniChart series options"))}},{annotationOptionsDef:fW}=a.n1;function fG(t,e,i){i||(e=function(t){let e=new Set;for(let i of t)!function t(e,i,a,s){let o=s.indexOf(i);if(-1!==o){for(let t=o;t<s.length;t+=1)a.add(s[t]);return}s.push(i);let{toNode:r}=i;for(let i of e)i.fromNode===r&&t(e,i,a,s);s.pop()}(t,i,e,[]);return 0!==e.size&&s.Vy.warnOnce("Some links formed circular references. These will be removed from the output."),0===e.size?t:t.filter(t=>!e.has(t))}(e));let a=new Map;for(let e of t)a.set(e.id,{datum:e,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let o=0;return a.forEach((t,i)=>{o=Math.max(o,fj(a,e,t,i,-1,[])+fj(a,e,t,i,1,[])+1)}),{links:e,nodeGraph:a,maxPathLength:o}}function fj(t,e,i,a,s,o){if(o.includes(a))return 1/0;let r=-1===s?i.maxPathLengthBefore:i.maxPathLengthAfter;if(-1===r){r=0;let n=-1===s?i.linksBefore:i.linksAfter;for(let i of e){let{fromNode:l,toNode:h}=i,d=-1===s?h.id:l.id,c=-1===s?l.id:h.id,p=a===d?t.get(c):void 0;null!=p&&(n.push({node:p,link:i}),o?.push(a),r=Math.max(r,fj(t,e,p,c,s,o)+1),o?.pop())}-1===s?i.maxPathLengthBefore=r:i.maxPathLengthAfter=r}return r}var{Series:fV,DataController:f$,keyProperty:fH,valueProperty:fY,Selection:fK,Group:fU,TransformableText:fX}=a.n1,fZ=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a);let{datumIndex:s}=i,o=a.contextNodeData?.nodeData.find(t=>t.datumIndex.type===s.type&&t.datumIndex.index===s.index);this.size=o?.size,this.label=o?.type===1?o?.label:void 0}},fQ=class extends fV{constructor(){super(...arguments),this.NodeEvent=fZ,this._chartNodes=void 0,this.nodeCount=0,this.linkCount=0,this.linksDataModel=void 0,this.linksProcessedData=void 0,this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new fU({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new fU({name:"nodeGroup"})),this.focusLinkGroup=this.highlightNode.appendChild(new fU({name:"linkGroup"})),this.focusNodeGroup=this.highlightNode.appendChild(new fU({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightNode.appendChild(new fU({name:"linkGroup"})),this.highlightNodeGroup=this.highlightNode.appendChild(new fU({name:"nodeGroup"})),this.labelSelection=fK.select(this.labelGroup,fX),this.linkSelection=fK.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=fK.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=fK.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=fK.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=fK.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=fK.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){return this.properties.nodes??this._chartNodes}setChartNodes(t){this._chartNodes=t,this.nodes===t&&(this.nodeDataRefresh=!0)}async processData(t){let{data:e,nodes:i}=this;if(null==e)return;let{fromKey:a,toKey:s,sizeKey:o,idKey:r,labelKey:n}=this.properties,l=new f$("standalone",t.suppressFieldDotNotation),h=null!=i?l.request(this.id,i,{props:[fH(r,void 0,{id:"idValue",includeProperty:!1}),...null!=n?[fY(n,void 0,{id:"labelValue",includeProperty:!1})]:[]],groupByKeys:!0}):null,d=t.request(this.id,e,{props:[fY(a,void 0,{id:"fromValue",includeProperty:!1}),fY(s,void 0,{id:"toValue",includeProperty:!1}),...null!=o?[fY(o,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]:[]],groupByKeys:!1});null!=i&&l.execute();let[c,p]=await Promise.all([h,d]);this.nodesDataModel=c?.dataModel,this.nodesProcessedData=c?.processedData,this.linksDataModel=p?.dataModel,this.linksProcessedData=p?.processedData;let u=new Map;if(null==c){let t=p.dataModel.resolveColumnById(this,"fromValue",p.processedData),e=p.dataModel.resolveColumnById(this,"toValue",p.processedData),i=t=>{let e=u.size;return{series:this,itemId:void 0,datum:{},datumIndex:{type:1,index:e},type:1,index:e,linksBefore:[],linksAfter:[],id:t,size:0,label:t}};p.processedData.dataSources.get(this.id)?.forEach((a,s)=>{let o=t[s],r=e[s];null!=o&&null!=r&&(u.has(o)||u.set(o,i(o)),u.has(r)||u.set(r,i(r)))})}else{let t=c.dataModel.resolveColumnById(this,"idValue",c.processedData),e=null!=n?c.dataModel.resolveColumnById(this,"labelValue",c.processedData):void 0;c.processedData.dataSources.get(this.id)?.forEach((i,a)=>{let s=t[a],o=e?.[a];u.set(s,{series:this,itemId:void 0,datum:i,datumIndex:{type:1,index:a},type:1,index:a,linksBefore:[],linksAfter:[],id:s,size:0,label:o})})}this.processedNodes=u}getNodeGraph(t,e,{includeCircularReferences:i}){let{linksDataModel:a,linksProcessedData:s}=this;if(null==a||null==s){let{links:t,nodeGraph:e,maxPathLength:a}=fG(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:e,links:t,maxPathLength:a}}let{sizeKey:o}=this.properties,r=a.resolveColumnById(this,"fromValue",s),n=a.resolveColumnById(this,"toValue",s),l=null!=o?a.resolveColumnById(this,"sizeValue",s):void 0,h=new Map;this.processedNodes.forEach(e=>{let i=t(e);h.set(e.id,i)});let d=[];s.dataSources.get(this.id)?.forEach((t,i)=>{let a=r[i],s=n[i],o=null!=l?l[i]:1,c=h.get(a),p=h.get(s);if(o<=0||null==c||null==p)return;let u=e({series:this,itemId:void 0,datum:t,datumIndex:{type:0,index:i},type:0,index:i,fromNode:c,toNode:p,size:o});d.push(u)});let{links:c,nodeGraph:p,maxPathLength:u}=fG(h.values(),d,i);return p.forEach(t=>{t.datum.linksBefore=t.linksBefore.map(t=>t.link),t.datum.linksAfter=t.linksAfter.map(t=>t.link)}),this.nodeCount=p.size,this.linkCount=c.length,{nodeGraph:p,links:c,maxPathLength:u}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(t){let e,i,a,s,{seriesRect:o}=t,r={seriesRectWidth:o?.width??0,seriesRectHeight:o?.height??0};(null==this._nodeDataDependencies||this._nodeDataDependencies.seriesRectWidth!==r.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==r.seriesRectHeight)&&(this._nodeDataDependencies=r),this.updateSelections();let n=this.contextNodeData?.nodeData??[],l=this.contextNodeData?.labelData??[],h=this.ctx.highlightManager?.getActiveHighlight();if(h?.series===this&&null==h.type){let{itemId:t}=h;h=null!=t?n.find(e=>1===e.type&&e.id===t):void 0}else h?.series!==this&&(h=void 0);this.contentGroup.visible=this.visible,this.contentGroup.opacity=null!=h?this.properties.highlightStyle.series.dimOpacity??1:1,this.labelSelection=this.updateLabelSelection({labelData:l,labelSelection:this.labelSelection}),this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=this.updateLinkSelection({nodeData:n.filter(t=>0===t.type),datumSelection:this.linkSelection}),this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=this.updateNodeSelection({nodeData:n.filter(t=>1===t.type),datumSelection:this.nodeSelection}),this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1}),h?.type===1?((i=(e=n.filter(t=>0===t.type&&(t.toNode===h||t.fromNode===h))).map(t=>t.fromNode===h?t.toNode:t.fromNode)).push(h),a=[],s=[h]):(h?.type===0?(e=[h],i=[h.fromNode,h.toNode],a=[h]):(e=[],i=[],a=[]),s=[]),this.focusLinkSelection=this.updateLinkSelection({nodeData:e,datumSelection:this.focusLinkSelection}),this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=this.updateNodeSelection({nodeData:i,datumSelection:this.focusNodeSelection}),this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=this.updateLinkSelection({nodeData:a,datumSelection:this.highlightLinkSelection}),this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=this.updateNodeSelection({nodeData:s,datumSelection:this.highlightNodeSelection}),this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}resetAnimation(t){}getSeriesDomain(t){return[]}getSeriesRange(t,e){return[NaN,NaN]}legendItemSymbol(t,e,i={}){let{fills:a,strokes:s}=this.properties,{fill:o=a[e%a.length],fillOpacity:r=1,stroke:n=s[e%s.length],strokeWidth:l=0,strokeOpacity:h=1,lineDash:d=[0],lineDashOffset:c=0}=i;return{marker:{fill:o,fillOpacity:r,stroke:n,strokeWidth:l,strokeOpacity:h,lineDash:d,lineDashOffset:c}}}getLegendData(t){if("category"!==t)return[];let{showInLegend:e}=this.properties;return Array.from(this.processedNodes.values(),({id:t,label:i},a)=>({legendType:"category",id:this.id,itemId:t,seriesId:this.id,enabled:!0,label:{text:i??t},symbol:this.legendItemSymbol(1,a),hideInLegend:!e,isFixed:!0}))}pickNodeClosestDatum({x:t,y:e}){let i,a=1/0;return this.linkSelection.each((s,o)=>{let r=s.containsPoint(t,e)?0:1/0;r<a&&(a=r,i=o)}),this.nodeSelection.each((s,o)=>{let r=s.distanceSquared(t,e);r<a&&(a=r,i=o)}),null!=i?{datum:i,distance:Math.sqrt(a)}:void 0}getDatumAriaText(t,e){return 0===t.type?this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:t.index+1,count:this.linkCount,from:t.fromNode.id,to:t.toNode.id,size:t.size,sizeName:this.properties.sizeName??this.properties.sizeKey}):1===t.type?this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:t.index+1,count:this.nodeCount,description:e}):void 0}pickFocus(t){let{datumIndexDelta:e,otherIndexDelta:i}=t,a=this.contextNodeData?.nodeData[t.datumIndex-t.datumIndexDelta],s=a;if(0!==i||0===e)return;if(a?.type===0){let t=Array.from(this.linkSelection,t=>t.datum),i=t.indexOf(a)+e;if(i>=0&&i<t.length)s=t[i];else if(i>0)s=t[t.length-1];else{let t=Array.from(this.nodeSelection,t=>t.datum);s=t[t.length-1]}}else if(a?.type===1){let t=Array.from(this.nodeSelection,t=>t.datum),i=t.indexOf(a)+e;s=i>=0&&i<t.length?t[i]:i<0?t[0]:Array.from(this.linkSelection,t=>t.datum)[0]}if(null==s)return;let o=1===s.type?Array.from(this.nodeSelection).find(t=>t.datum===s):Array.from(this.linkSelection).find(t=>t.datum===s);if(null==o)return;let r=this.computeFocusBounds(o.node);if(null!=r)return{datum:o.datum,datumIndex:this.contextNodeData?.nodeData.indexOf(o.datum)??0,otherIndex:0,bounds:r,clipFocusBox:!0}}getCategoryValue(t){}datumIndexForCategoryValue(t){}},{Path:fq,SceneChangeDetection:fJ}=a.n1;function f0({radius:t,startAngle:e,endAngle:i,tension:a}){let s=t*Math.cos(e),o=t*Math.sin(e),r=t*Math.cos(i),n=t*Math.sin(i);return{x:[s,s*a,r*a,r],y:[o,o*a,n*a,n]}}var f1=class extends fq{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}tensionedCurveTo(t,e,i,a,s,o,r,n){let{path:l,tension:h}=this,d=1-h;l.cubicCurveTo((i-t)*d+t,(a-e)*d+e,(s-r)*d+r,(o-n)*d+n,r,n)}updatePath(){let{path:t,centerX:e,centerY:i,radius:a}=this,{startAngle1:s,endAngle1:o,startAngle2:r,endAngle2:n}=this;s>r&&([s,r]=[r,s],[o,n]=[n,o]),t.clear();let l=e+a*Math.cos(s),h=i+a*Math.sin(s);t.moveTo(l,h),this.tensionedCurveTo(l,h,e,i,e,i,e+a*Math.cos(n),i+a*Math.sin(n)),t.arc(e,i,a,n,r,!0),this.tensionedCurveTo(e+a*Math.cos(r),i+a*Math.sin(r),e,i,e,i,e+a*Math.cos(o),i+a*Math.sin(o)),t.arc(e,i,a,o,s,!0),t.closePath()}};n([fJ()],f1.prototype,"centerX",2),n([fJ()],f1.prototype,"centerY",2),n([fJ()],f1.prototype,"radius",2),n([fJ()],f1.prototype,"startAngle1",2),n([fJ()],f1.prototype,"endAngle1",2),n([fJ()],f1.prototype,"startAngle2",2),n([fJ()],f1.prototype,"endAngle2",2),n([fJ()],f1.prototype,"tension",2);var{FillGradientDefaults:f2,FillPatternDefaults:f4,FillImageDefaults:f5,BaseProperties:f3,SeriesTooltip:f6,SeriesProperties:f8,Property:f9,Label:f7}=a.n1,mt=class extends f7{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};n([f9],mt.prototype,"spacing",2),n([f9],mt.prototype,"maxWidth",2);var me=class extends f3{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}};n([f9],me.prototype,"fill",2),n([f9],me.prototype,"fillOpacity",2),n([f9],me.prototype,"stroke",2),n([f9],me.prototype,"strokeOpacity",2),n([f9],me.prototype,"strokeWidth",2),n([f9],me.prototype,"lineDash",2),n([f9],me.prototype,"lineDashOffset",2),n([f9],me.prototype,"tension",2),n([f9],me.prototype,"itemStyler",2);var mi=class extends f3{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};n([f9],mi.prototype,"spacing",2),n([f9],mi.prototype,"width",2),n([f9],mi.prototype,"fill",2),n([f9],mi.prototype,"fillOpacity",2),n([f9],mi.prototype,"stroke",2),n([f9],mi.prototype,"strokeOpacity",2),n([f9],mi.prototype,"strokeWidth",2),n([f9],mi.prototype,"lineDash",2),n([f9],mi.prototype,"lineDashOffset",2),n([f9],mi.prototype,"itemStyler",2);var ma=class extends f8{constructor(){super(...arguments),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fillGradientDefaults=new f2,this.fillPatternDefaults=new f4,this.fillImageDefaults=new f5,this.fills=[],this.strokes=[],this.label=new mt,this.link=new me,this.node=new mi,this.tooltip=new f6}};n([f9],ma.prototype,"fromKey",2),n([f9],ma.prototype,"toKey",2),n([f9],ma.prototype,"idKey",2),n([f9],ma.prototype,"idName",2),n([f9],ma.prototype,"labelKey",2),n([f9],ma.prototype,"labelName",2),n([f9],ma.prototype,"sizeKey",2),n([f9],ma.prototype,"sizeName",2),n([f9],ma.prototype,"nodes",2),n([f9],ma.prototype,"fillGradientDefaults",2),n([f9],ma.prototype,"fillPatternDefaults",2),n([f9],ma.prototype,"fillImageDefaults",2),n([f9],ma.prototype,"fills",2),n([f9],ma.prototype,"strokes",2),n([f9],ma.prototype,"label",2),n([f9],ma.prototype,"link",2),n([f9],ma.prototype,"node",2),n([f9],ma.prototype,"tooltip",2);var{SeriesNodePickMode:ms,CachedTextMeasurerPool:mo,TextWrapper:mr,TextUtils:mn,createDatumId:ml,angleBetween:mh,normalizeAngle360:md,isBetweenAngles:mc,Sector:mp,evaluateBezier:mu,applyShapeStyle:mg,getShapeStyle:my,BBox:mf}=a.n1,mm=t=>t.startAngle+mh(t.startAngle,t.endAngle)/2,mx=class extends fQ{constructor(t){super({moduleCtx:t,pickModes:[ms.NEAREST_NODE,ms.EXACT_SHAPE_MATCH]}),this.properties=new ma}isLabelEnabled(){return(null!=this.properties.labelKey||null==this.nodes)&&this.properties.label.enabled}linkFactory(){return new f1}nodeFactory(){return new mp}createNodeData(){let{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:a,toKey:o,sizeKey:r,label:{spacing:n,maxWidth:l,fontSize:h},node:{width:d,spacing:c}}=this.properties,p=e/2,u=i/2,g=[],{nodeGraph:y,links:f}=this.getNodeGraph(t=>({...t,centerX:p,centerY:u,innerRadius:NaN,outerRadius:NaN,startAngle:NaN,endAngle:NaN}),t=>({...t,centerX:p,centerY:u,radius:NaN,startAngle1:NaN,endAngle1:NaN,startAngle2:NaN,endAngle2:NaN}),{includeCircularReferences:!0}),m=0;y.forEach(({datum:t,linksBefore:e,linksAfter:i},s)=>{let n=e.reduce((t,{link:e})=>t+e.size,0)+i.reduce((t,{link:e})=>t+e.size,0);if(0===n)y.delete(s);else{t.size=n,m+=t.size;let e=this.getLabelText(this.properties.label,{datum:t.datum,value:t.label,fromKey:a,toKey:o,sizeKey:r,size:t.size});t.label=String(e)}});let x=0;if(this.isLabelEnabled()){let t=this.properties.label.getFont(),e=0;y.forEach(({datum:i})=>{let{id:a,label:s}=i;if(null==s)return;let o=mr.wrapText(s,{maxWidth:l,font:this.properties.label,textWrap:"never"}),{width:r}=mo.measureText(o,{font:t,textAlign:"left",textBaseline:"middle"});e=Math.max(r,e),g.push({id:a,text:o,centerX:p,centerY:u,angle:NaN,radius:NaN})}),x=e+n}let b=y.size,v=Math.min(e,i)/2-d-x,S=c/v;if(0!==x&&(b*S>=1.5*Math.PI||v<=0)&&(g=[],S=c/(v=Math.min(e,i)/2-d)),b*S>=2*Math.PI||v<=0)return void s.Vy.warnOnce("There was insufficient space to display the Chord Series.");let k=v,D=v+d,M=Math.max((2*Math.PI-b*S)/m,0),w=0;y.forEach(({datum:t})=>{t.innerRadius=k,t.outerRadius=D,t.startAngle=w,t.endAngle=w+t.size*M,w=t.endAngle+S;let e=(t.innerRadius+t.outerRadius)/2,i=mm(t);t.midPoint={x:t.centerX+e*Math.cos(i),y:t.centerY+e*Math.sin(i)}});let I=[];y.forEach(({datum:t,linksBefore:e,linksAfter:i})=>{let a=mm(t),s=[...e.map(t=>({link:t.link,distance:mh(mm(t.node.datum),a),after:!1})),...i.map(t=>({link:t.link,distance:mh(mm(t.node.datum),a),after:!0}))],o=t.startAngle;s.toSorted((t,e)=>t.distance-e.distance).forEach(({link:t,after:e})=>{let i=t.size*M;e?(t.startAngle1=o,t.endAngle1=o+i):(t.startAngle2=o,t.endAngle2=o+i),o+=t.size*M}),I.push(t)});let{tension:C}=this.properties.link;f.forEach(t=>{t.radius=v;let e=f0({radius:v,startAngle:t.startAngle1,endAngle:t.endAngle2,tension:C}),i=f0({radius:v,startAngle:t.startAngle2,endAngle:t.endAngle1,tension:C}),a=mu(...e.x,.5),s=mu(...e.y,.5),o=mu(...i.x,.5),r=mu(...i.y,.5);t.midPoint={x:t.centerX+(a+o)/2,y:t.centerY+(s+r)/2},I.push(t)}),g.forEach(t=>{let e=y.get(t.id)?.datum;null!=e&&(t.radius=D+n,t.angle=md(e.startAngle+mh(e.startAngle,e.endAngle)/2))}),g.sort((t,e)=>t.angle-e.angle);let A=1/0,L=-1/0;return{itemId:t,nodeData:I,labelData:g=g.filter(t=>{let e=Math.atan2(mn.getLineHeight(h)/2,t.radius),i=t.angle-e,a=t.angle+e;return!(mc(A,i,a)||mc(L,i,a))&&(A=Math.min(i,A),L=Math.max(a,L),!0)})}}updateLabelSelection(t){let e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){let{labelSelection:e}=t,{color:i,fontStyle:a,fontWeight:s,fontSize:o,fontFamily:r}=this.properties.label;e.each((t,{text:e,centerX:n,centerY:l,radius:h,angle:d})=>{t.visible=!0,t.translationX=n+h*Math.cos(d),t.translationY=l+h*Math.sin(d),t.text=e,t.fill=i,t.fontStyle=a,t.fontWeight=s,t.fontSize=o,t.fontFamily=r,t.textBaseline="middle",Math.cos(d)>=0?(t.textAlign="left",t.rotation=d):(t.textAlign="right",t.rotation=d-Math.PI)})}updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>ml([t.type,t.id]))}getBaseNodeStyle(t){let{properties:e}=this,{fill:i,fillOpacity:a,stroke:s,strokeOpacity:o,lineDash:r,lineDashOffset:n}=e.node,l=t?e.highlightStyle.item:void 0;return my({fill:l?.fill??i,fillOpacity:l?.fillOpacity??a,stroke:l?.stroke??s,strokeOpacity:l?.strokeOpacity??o,strokeWidth:l?.strokeWidth??this.getStrokeWidth(e.node.strokeWidth),lineDash:l?.lineDash??r,lineDashOffset:l?.lineDashOffset??n},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getNodeStyleOverrides(t,e,i,a,s,o,r){let n,{id:l,properties:h}=this,{fills:d,strokes:c}=h,{itemStyler:p}=h.node,u=o.fill??d[i%d.length],g=o.stroke??c[i%c.length];if(r||(n??(n={}),n.fill=u,n.stroke=g),null!=p){let i=this.cachedDatumCallback(ml(t,"node",r?"highlight":"node"),()=>{let{fillOpacity:t=1,strokeOpacity:i=1,strokeWidth:n=0,lineDash:h=[],lineDashOffset:d=0}=o;return this.callWithContext(p,{seriesId:l,datum:e,highlighted:r,label:s,size:a,fill:u,fillOpacity:t,stroke:g,strokeOpacity:i,strokeWidth:n,lineDash:h,lineDashOffset:d})});n??(n={}),Object.assign(n,i)}return my(n,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateNodeNodes(t){let{datumSelection:e,isHighlight:i}=t,a=this.getBaseNodeStyle(i),s=this.getShapeFillBBox();e.each((t,e)=>{let{datumIndex:o,size:r,label:n}=e,l=this.getNodeStyleOverrides(String(o.index),e.datum,o.index,r,n,a,i);mg(t,a,l,s),t.centerX=e.centerX,t.centerY=e.centerY,t.innerRadius=e.innerRadius,t.outerRadius=e.outerRadius,t.startAngle=e.startAngle,t.endAngle=e.endAngle,t.inset=t.strokeWidth/2})}updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>ml([t.type,t.index,t.fromNode.id,t.toNode.id]))}getBaseLinkStyle(t){let{properties:e}=this,{fill:i,fillOpacity:a,stroke:s,strokeOpacity:o,lineDash:r,lineDashOffset:n,tension:l}=e.link,h=t?e.highlightStyle.item:void 0;return my({fill:h?.fill??i,fillOpacity:h?.fillOpacity??a,stroke:h?.stroke??s,strokeOpacity:h?.strokeOpacity??o,strokeWidth:h?.strokeWidth??this.getStrokeWidth(e.link.strokeWidth),lineDash:h?.lineDash??r,lineDashOffset:h?.lineDashOffset??n,tension:l},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getLinkStyleOverrides(t,e,i,a,s){let o,{id:r,properties:n}=this,{fills:l,strokes:h}=n,{itemStyler:d}=n.link,c=a.fill??l[i%l.length],p=a.stroke??h[i%h.length];return s||(o??(o={}),o.fill=c,o.stroke=p),null!=d&&(o??(o={}),Object.assign(o,this.cachedDatumCallback(ml(t,"link",s?"highlight":"node"),()=>{let{fillOpacity:t=1,strokeOpacity:i=1,strokeWidth:o=0,lineDash:n=[],lineDashOffset:l=0,tension:h}=a;return this.callWithContext(d,{seriesId:r,datum:e,highlighted:s,tension:h,fill:c,fillOpacity:t,stroke:p,strokeOpacity:i,strokeWidth:o,lineDash:n,lineDashOffset:l})}))),my(o,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateLinkNodes(t){let{datumSelection:e,isHighlight:i}=t,a=this.getBaseLinkStyle(i),s=this.getShapeFillBBox();e.each((t,e)=>{let{datumIndex:o}=e,r=e.fromNode.datumIndex,n=this.getLinkStyleOverrides(String(o.index),e.datum,r.index,a,i);t.centerX=e.centerX,t.centerY=e.centerY,t.radius=e.radius,t.startAngle1=e.startAngle1,t.endAngle1=e.endAngle1,t.startAngle2=e.startAngle2,t.endAngle2=e.endAngle2,mg(t,a,n,s),t.tension=n?.tension??a.tension})}getShapeFillBBox(){let t=this._nodeDataDependencies?.seriesRectWidth??0,e=this._nodeDataDependencies?.seriesRectHeight??0,i=Math.min(t,e),a=new mf((t-i)/2,(e-i)/2,t,e);return{series:a,axis:a}}getTooltipContent(t){let e,{id:i,linksProcessedData:a,nodesProcessedData:s,properties:o}=this,{fromKey:r,toKey:n,sizeKey:l,sizeName:h,tooltip:d}=o,c=this.contextNodeData?.nodeData.find(e=>e.datumIndex.type===t.type&&e.datumIndex.index===t.index);if(null==c)return;let p=0===c.type?c.fromNode.index:c.index,u=0===c.type?`${c.fromNode.label} - ${c.toNode.label}`:c.label,g=0===t.type?a?.dataSources.get(this.id)?.[t.index]:s?.dataSources.get(this.id)?.[t.index],y=c.size;if(0===c.type){let i=c.fromNode.datumIndex,a=this.getBaseLinkStyle(!1);Object.assign(a,this.getLinkStyleOverrides(String(t.index),g,i.index,a,!1)),e=a}else{let i=c.label,a=this.getBaseNodeStyle(!1);Object.assign(a,this.getNodeStyleOverrides(String(t.index),g,t.index,y,i,a,!1)),e=a}return this.formatTooltipWithContext(d,{title:u,symbol:this.legendItemSymbol(c.type,p,e),data:null!=l?[{label:h,fallbackLabel:l,value:String(y)}]:[]},{seriesId:i,datum:g,title:u,fromKey:r,toKey:n,sizeKey:l,sizeName:h,size:y,...e})}computeFocusBounds(t){return t}};mx.className="ChordSeries",mx.type="chord";var{commonSeriesOptionsDefs:mb,chordSeriesThemeableOptionsDef:mv}=a.n1,mS={...mv,...mb,type:(0,s.mw)((0,s.dY)("chord")),fromKey:(0,s.mw)(s.Yj),toKey:(0,s.mw)(s.Yj),sizeKey:s.Yj,sizeName:s.Yj};mS.fillGradientDefaults=(0,s._L)(s.wi),mS.fillPatternDefaults=(0,s._L)(s.GY),mS.fillImageDefaults=(0,s._L)(s.Zd);var mk={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"chord",tooltipDefaults:{range:"exact"},moduleFactory:t=>new mx(t),themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0,tension:.4}},legend:{enabled:!1,toggleSeries:!1}}},{ThemeConstants:{CARTESIAN_AXIS_TYPE:mD,CARTESIAN_POSITION:mM},ThemeSymbols:{DEFAULT_SHADOW_COLOUR:mw}}=a.n1,mI={$if:[{$eq:[{$path:["/direction",void 0]},"horizontal"]},[{type:mD.NUMBER,position:mM.LEFT},{type:mD.CATEGORY,position:{$if:[{$eq:[{$path:["/stageLabel/placement",void 0]},"before"]},mM.TOP,mM.BOTTOM]},label:{$omit:[["placement"],{$path:["/stageLabel",void 0]}]}}],[{type:mD.CATEGORY,position:{$if:[{$eq:[{$path:["/stageLabel/placement",void 0]},"after"]},mM.RIGHT,mM.LEFT]},label:{$omit:[["placement"],{$path:["/stageLabel",void 0]}]}},{type:mD.NUMBER,position:mM.BOTTOM}]]},mC={series:{direction:"vertical",strokeWidth:0,spacingRatio:.25,fills:[{$palette:"fill"}],strokes:[{$palette:"stroke"}],fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}},dropOff:{enabled:!0,fillOpacity:.2,strokeWidth:0},shadow:{enabled:!1,color:mw,xOffset:3,yOffset:3,blur:5}},axes:{[mD.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter:t=>Math.abs(t.value).toFixed(t.fractionDigits??0)}},[mD.CATEGORY]:{line:{enabled:!1}}}},{lineDistanceSquared:mA,BBox:mL,Path:mT,SceneChangeDetection:mN}=a.n1;function mO([t,e],[i,a]){return 1e-6>=Math.abs(t-i)&&1e-6>=Math.abs(e-a)}var mP=class extends mT{constructor(){super(...arguments),this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}get midPoint(){let{x0:t,y0:e,x1:i,y1:a,x2:s,y2:o,x3:r,y3:n}=this;return{x:(t+i+s+r)/4,y:(e+a+o+n)/4}}distanceSquared(t,e){if(this.containsPoint(t,e))return 0;let{x0:i,y0:a,x1:s,y1:o,x2:r,y2:n,x3:l,y3:h}=this;return Math.min(mA(t,e,i,a,s,o,1/0),mA(t,e,s,o,r,n,1/0),mA(t,e,r,n,l,h,1/0),mA(t,e,l,h,i,a,1/0))}computeBBox(){let{x0:t,y0:e,x1:i,y1:a,x2:s,y2:o,x3:r,y3:n}=this,l=Math.min(t,i,s,r),h=Math.max(t,i,s,r)-l,d=Math.min(e,a,o,n),c=Math.max(e,a,o,n)-d;return new mL(l,d,h,c)}updatePath(){let t,e,{path:i,x0:a,y0:s,x1:o,y1:r,x2:n,y2:l,x3:h,y3:d}=this;i.clear(),[[a,s],[o,r],[n,l],[h,d]].forEach(a=>{if(null!=t&&mO(t,a)||null!=e&&mO(e,a))return;let[s,o]=a;null==t?i.moveTo(s,o):i.lineTo(s,o),t??(t=a),e=a}),i.closePath()}};n([mN()],mP.prototype,"x0",2),n([mN()],mP.prototype,"y0",2),n([mN()],mP.prototype,"x1",2),n([mN()],mP.prototype,"y1",2),n([mN()],mP.prototype,"x2",2),n([mN()],mP.prototype,"y2",2),n([mN()],mP.prototype,"x3",2),n([mN()],mP.prototype,"y3",2);var{NODE_UPDATE_STATE_TO_PHASE_MAPPING:mE}=a.n1;function mR(t,e,i,a){let{x0:s,y0:o,x1:r,y1:n,x2:l,y2:h,x3:d,y3:c,opacity:p}=t;return i?{x0:(s+d)/2,y0:(o+c)/2,x1:(r+l)/2,y1:(n+h)/2,x2:(r+l)/2,y2:(n+h)/2,x3:(s+d)/2,y3:(o+c)/2,opacity:p}:{x0:(s+r)/2,y0:(o+n)/2,x1:(s+r)/2,y1:(o+n)/2,x2:(l+d)/2,y2:(h+c)/2,x3:(l+d)/2,y3:(h+c)/2,opacity:p}}function mB(t,e){let{x0:i,y0:a,x1:s,y1:o,x2:r,y2:n,x3:l,y3:h,opacity:d}=e;return{x0:i,y0:a,x1:s,y1:o,x2:r,y2:n,x3:l,y3:h,opacity:d}}var{SeriesNodePickMode:mz,SeriesZIndexMap:mF,valueProperty:m_,keyProperty:mW,ChartAxisDirection:mG,updateLabelNode:mj,SMALLEST_KEY_INTERVAL:mV,LARGEST_KEY_INTERVAL:m$,diff:mH,fixNumericExtent:mY,seriesLabelFadeInAnimation:mK,resetMotion:mU,resetLabelFn:mX,animationValidation:mZ,computeBarFocusBounds:mQ,ContinuousScale:mq,Group:mJ,Selection:m0,PointerEvents:m1,motion:m2,checkCrisp:m4,createDatumId:m5,applyShapeStyle:m3,getShapeStyle:m6,getShapeFill:m8}=a.n1,m9=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.xKey=a.properties.stageKey,this.yKey=a.properties.valueKey}},m7=class extends a.n1.AbstractBarSeries{constructor({moduleCtx:t,animationResetFns:e}){super({moduleCtx:t,pickModes:[mz.AXIS_ALIGNED,mz.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["stageKey"],y:["valueKey"]},directionNames:{x:[],y:[]},categoryKey:"xValue",datumSelectionGarbageCollection:!1,animationResetFns:{datum:e.datum,label:mX}}),this.NodeEvent=m9,this.connectorNodeGroup=this.contentGroup.appendChild(new mJ({name:`${this.id}-series-connectorNodes`,zIndex:mF.BACKGROUND})),this.connectorSelection=m0.select(this.connectorNodeGroup,()=>this.connectionFactory()),this.connectorNodeGroup.pointerEvents=m1.None}get pickModeAxis(){return"main-category"}setSeriesIndex(t){return!!super.setSeriesIndex(t)&&(this.connectorNodeGroup.zIndex=[mF.BACKGROUND,t],!0)}isVertical(){return!super.isVertical()}connectionFactory(){return new mP}async processData(t){let{stageKey:e,valueKey:i}=this.properties,{visible:a,id:s}=this,o=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale,{isContinuousX:n,xScaleType:l,yScaleType:h}=this.getScaleInformation({xScale:o,yScale:r}),d=[];this.ctx.animationManager.isSkipped()||(this.processedData&&d.push(mH(this.id,this.processedData)),d.push(mZ()));let c=this.visible?{}:{forceValue:0},{processedData:p}=await this.requestDataModel(t,this.data,{props:[mW(e,l,{id:"xValue"}),m_(i,h,{id:"yValue",...c,validation:(t,e,i)=>a&&this.ctx.legendManager.getItemEnabled({seriesId:s,itemId:i}),invalidValue:0}),...n?[mV,m$]:[],...d],groupByKeys:!1});this.smallestDataInterval=p.reduced?.smallestKeyInterval,this.largestDataInterval=p.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){let{processedData:e,dataModel:i,id:a,ctx:{legendManager:s}}=this;if(!e||!i)return[];let{keys:[o]}=e.domain;if(t===this.getCategoryDirection()){let t=i.resolveProcessedDataDefById(this,"xValue");return t?.def.type==="key"&&t?.def.valueType==="category"?this.hasData?o.filter((t,e)=>s.getItemEnabled({seriesId:a,itemId:e})):[]:this.padBandExtent(o)}{let e=Math.max(...this.domainForClippedRange(t,["yValue"],"xValue",!0));return mY([-e,e])}}getSeriesRange(t,e){return[NaN,NaN]}createNodeData(){let t,{hasData:e,data:i,dataModel:a,groupScale:s,processedData:o,id:r,ctx:{legendManager:n}}=this,l=this.getCategoryAxis(),h=this.getValueAxis();if(!(e&&i&&l&&h&&a&&o?.type==="ungrouped"))return;let d=l.scale,c=h.scale,p=this.getBarDirection()===mG.X,{stageKey:u,valueKey:g}=this.properties,{strokeWidth:y}=this.barStyle(),f=`${g}`,m={itemId:f,nodeData:[],labelData:[],connectorData:[],scales:this.calculateScaling(),groupScale:this.getScaling(this.groupScale),visible:this.visible},x=this.visible;if(!x)return m;let b=a.resolveKeysById(this,"xValue",o),v=a.resolveColumnById(this,"yValue",o),{barWidth:S,groupIndex:k}=this.updateGroupScale(l),D=mq.is(d)?-.5*S:0,M=m4(l?.scale,l?.visibleRange,this.smallestDataInterval,this.largestDataInterval);return(o.dataSources.get(this.id)??[]).forEach((e,i)=>{let a=x&&n.getItemEnabled({seriesId:r,itemId:i}),o=b[i];if(null==o)return;let l=Math.round(d.convert(o))+s.convert(String(k))+D,h=v[i],w=Math.round(c.convert(-h)),I=Math.round(c.convert(h)),C=Math.max(y,Math.abs(I-w)),A={x:p?Math.min(I,w):l,y:p?l:Math.min(I,w),width:p?C:S,height:p?S:C},L={x:A.x+A.width/2,y:A.y+A.height/2},T=this.createLabelData({datumIndex:i,rect:A,barAlongX:p,yDatum:h,datum:e,visible:a}),N={index:i,series:this,itemId:f,datum:e,datumIndex:i,xValue:o,yValue:h,xKey:u,yKey:g,x:A.x,y:A.y,width:A.width,height:A.height,midPoint:L,strokeWidth:y,crisp:M,label:T,visible:a};if(m.nodeData.push(N),null!=T&&m.labelData.push(T),null!=t){let e=t.rect,i=t.nodeDatum,a=t.datumIndex;p?m.connectorData.push({datum:i,datumIndex:a,x0:e.x,y0:e.y+e.height,x1:e.x+e.width,y1:e.y+e.height,x2:A.x+A.width,y2:A.y,x3:A.x,y3:A.y,opacity:1}):m.connectorData.push({datum:i,datumIndex:a,x0:e.x+e.width,y0:e.y,x1:A.x,y1:A.y,x2:A.x,y2:A.y+A.height,x3:e.x+e.width,y3:e.y+e.height,opacity:1})}a&&(t={itemId:f,rect:A,nodeDatum:N,datumIndex:i})}),m}updateNodes(t,e,i){super.updateNodes(t,e,i);let{connectorSelection:a}=this,s=this.contextNodeData?.connectorData??[];this.connectorSelection=this.updateConnectorSelection({connectorSelection:a,connectorData:s}),this.updateConnectorNodes({connectorSelection:a})}updateDatumSelection(t){let{nodeData:e,datumSelection:i}=t;return i.update(e??[],void 0,t=>this.getDatumId(t))}updateConnectorSelection(t){let{connectorData:e,connectorSelection:i}=t;return i.update(this.connectorEnabled()?e:[],void 0,t=>this.getDatumId(t.datum))}updateConnectorNodes(t){let{fills:e,strokes:i,fillGradientDefaults:a,fillPatternDefaults:s,fillImageDefaults:o}=this.properties,{fill:r,fillOpacity:n,stroke:l,strokeOpacity:h,strokeWidth:d,lineDash:c,lineDashOffset:p}=this.connectorStyle(),u=this.getShapeFillBBox();t.connectorSelection.each((t,g)=>{let{datumIndex:y}=g;t.setProperties(mB(t,g)),m3(t,{fill:m8(r??e[y%e.length],a,s,o),stroke:l??i[y%i.length],fillOpacity:n,strokeOpacity:h,strokeWidth:d,lineDash:c,lineDashOffset:p},void 0,u)})}getHighlightLabelData(t,e){let i=t.filter(t=>t.datum===e.datum);return i.length>0?i:void 0}updateLabelSelection(t){let e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,t=>{t.pointerEvents=m1.None})}updateLabelNodes(t){t.labelSelection.each((t,e)=>{mj(t,this.properties.label,e)})}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,properties:s}=this,{stageKey:o,valueKey:r,tooltip:n}=s,l=this.getCategoryAxis(),h=this.getValueAxis();if(!i||!a||!l||!h)return;let d=a.dataSources.get(this.id)?.[t],c=i.resolveKeysById(this,"xValue",a)[t],p=i.resolveColumnById(this,"yValue",a)[t];if(null!=c)return this.formatTooltipWithContext(n,{symbol:this.legendItemSymbol(t),data:[{label:l.formatDatum(c),value:h.formatDatum(p)}]},{seriesId:e,datum:d,title:o,stageKey:o,valueKey:r,...this.tooltipStyle(d,t)})}resetAllAnimation(t){super.resetAllAnimation(t),mU([this.connectorSelection],mB)}animateEmptyUpdateReady({labelSelection:t}){let{connectorSelection:e}=this,i=function(t,e){let i=t=>null==t;return{fromFn:(a,s,o)=>{let r;"updated"===o&&i(s)?o="removed":"updated"===o&&i(a.previousDatum)&&(o="added"),r="added"===o&&null==a.previousDatum&&"fade"===e?{...mB(a,s),opacity:0}:"unknown"===o||"added"===o?mR(s,a.previousDatum,t,e):{x0:a.x0,y0:a.y0,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,x3:a.x3,y3:a.y3,opacity:a.opacity};let n=mE[o];return{...r,phase:n}},toFn:(a,s,o)=>{let r;return"removed"===o&&null==a.datum&&"fade"===e?{...mB(a,s),opacity:0}:"removed"===o||i(s)?mR(s,a.previousDatum,t,e):mB(a,s)}}}(this.isVertical(),"normal");m2.fromToMotion(this.id,"connectors",this.ctx.animationManager,[e],i),mK(this,"labels",this.ctx.animationManager,t)}animateWaitingUpdateReady(t){let{labelSelection:e}=t;this.ctx.animationManager.stopByAnimationGroupId(this.id),mK(this,"labels",this.ctx.animationManager,e)}getDatumId(t){return m5(t.xValue)}isLabelEnabled(){return this.properties.label.enabled}computeFocusBounds({datumIndex:t}){return mQ(this,this.contextNodeData?.nodeData[t])}legendItemSymbol(t){let{strokeWidth:e,fillOpacity:i,strokeOpacity:a,lineDash:s,lineDashOffset:o,fillGradientDefaults:r,fillPatternDefaults:n,fillImageDefaults:l}=this.barStyle(),{fills:h,strokes:d}=this.properties;return{marker:m6({fill:h[t%h.length]??"black",fillOpacity:i,stroke:d[t%d.length]??"black",strokeWidth:e,strokeOpacity:a,lineDash:s,lineDashOffset:o},r,n,l)}}getLegendData(t){let{id:e,processedData:i,dataModel:a,ctx:{legendManager:s},visible:o}=this;if(!a||!i||"category"!==t)return[];let{showInLegend:r}=this.properties,n=a.resolveKeysById(this,"xValue",i);return(i.dataSources.get(this.id)??[]).map((t,i)=>{let a=n[i];if(null!=a)return{legendType:"category",id:e,datum:t,itemId:i,seriesId:e,enabled:o&&s.getItemEnabled({seriesId:e,itemId:i}),label:{text:String(a)},symbol:this.legendItemSymbol(i),skipAnimations:!0,hideInLegend:!r}}).filter(t=>null!=t)}},{FillGradientDefaults:xt,FillPatternDefaults:xe,FillImageDefaults:xi,Label:xa,AbstractBarSeriesProperties:xs,SeriesTooltip:xo,AxisLabel:xr,Property:xn}=a.n1,xl=class extends xa{constructor(){super(...arguments),this.spacing=0}};n([xn],xl.prototype,"placement",2),n([xn],xl.prototype,"spacing",2);var xh=class extends xr{};n([xn],xh.prototype,"placement",2);var xd=class extends xs{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new xt,this.fillPatternDefaults=new xe,this.fillImageDefaults=new xi,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new xl,this.stageLabel=new xh,this.tooltip=new xo}};function xc(t,{x:e,y:i,width:a,height:s,opacity:o}){return{x1:e,y1:i,x2:e+a,y2:i+s,opacity:o}}n([xn],xd.prototype,"stageKey",2),n([xn],xd.prototype,"valueKey",2),n([xn],xd.prototype,"fills",2),n([xn],xd.prototype,"fillGradientDefaults",2),n([xn],xd.prototype,"fillPatternDefaults",2),n([xn],xd.prototype,"fillImageDefaults",2),n([xn],xd.prototype,"fillOpacity",2),n([xn],xd.prototype,"strokes",2),n([xn],xd.prototype,"strokeWidth",2),n([xn],xd.prototype,"strokeOpacity",2),n([xn],xd.prototype,"lineDash",2),n([xn],xd.prototype,"lineDashOffset",2),n([xn],xd.prototype,"label",2),n([xn],xd.prototype,"stageLabel",2),n([xn],xd.prototype,"tooltip",2);var{formatValue:xp,Line:xu}=a.n1,xg=class extends m7{constructor(t){super({moduleCtx:t,animationResetFns:{datum:xc}}),this.properties=new xd}get hasData(){let{id:t,ctx:{legendManager:e}}=this,i=this.data?.reduce((i,a,s)=>i+ +!!e.getItemEnabled({seriesId:t,itemId:s}),0);return null!=i&&i>1}getBandScalePadding(){return{inner:1,outer:0}}connectorEnabled(){return!0}barStyle(){return{fillOpacity:1,strokeOpacity:1,strokeWidth:0,lineDash:[],lineDashOffset:0,fillGradientDefaults:this.properties.fillGradientDefaults,fillPatternDefaults:this.properties.fillPatternDefaults,fillImageDefaults:this.properties.fillImageDefaults}}connectorStyle(){let{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:a,lineDashOffset:s,fillGradientDefaults:o,fillPatternDefaults:r,fillImageDefaults:n}=this.properties;return{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:a,lineDashOffset:s,fillGradientDefaults:o,fillPatternDefaults:r,fillImageDefaults:n}}nodeFactory(){return new xu}createLabelData({datumIndex:t,rect:e,barAlongX:i,yDatum:a,datum:s,visible:o}){let r,n,l,h,{stageKey:d,valueKey:c,label:p}=this.properties,{spacing:u,placement:g}=p;if(i)switch(r=e.x+e.width/2,l="center",g){case"before":n=e.y-u,h="bottom";break;case"after":n=e.y+e.height+u,h="top";break;default:n=e.y+e.height/2,h="middle"}else switch(n=e.y+e.height/2,h="middle",g){case"before":r=e.x-u,l="right";break;case"after":r=e.x+e.width+u,l="left";break;default:r=e.x+e.width/2,l="center"}return{x:r,y:n,textAlign:l,textBaseline:h,text:this.getLabelText(p,{itemId:c,value:a,datum:s,stageKey:d,valueKey:c},t=>xp(t,0)),itemId:c,datum:s,datumIndex:t,series:this,visible:o}}updateDatumNodes(t){let e=t.isHighlight?this.properties.highlightStyle.item:void 0;t.datumSelection.each((t,i)=>{t.setProperties(xc(t,i)),t.stroke=e?.stroke,t.strokeWidth=e?.strokeWidth??0,t.strokeOpacity=e?.strokeOpacity??1,t.lineDash=e?.lineDash,t.lineDashOffset=e?.lineDashOffset??0})}tooltipStyle(t,e){let{fills:i,strokes:a}=this.properties,s=i[e%i.length]??"black",o=a[e%a.length]??"black",{fillOpacity:r,strokeOpacity:n,strokeWidth:l,lineDash:h,lineDashOffset:d}=this.barStyle();return{fill:s,fillOpacity:r,stroke:o,strokeOpacity:n,strokeWidth:l,lineDash:h,lineDashOffset:d}}};xg.className="ConeFunnelSeries",xg.type="cone-funnel";var{commonSeriesOptionsDefs:xy,coneFunnelSeriesThemeableOptionsDef:xf}=a.n1,xm={...xf,...xy,type:(0,s.mw)((0,s.dY)("cone-funnel")),stageKey:(0,s.mw)(s.Yj),valueKey:(0,s.mw)(s.Yj)},{ThemeConstants:{CARTESIAN_AXIS_TYPE:xx}}=a.n1,xb={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"cone-funnel",moduleFactory:t=>new xg(t),solo:!0,tooltipDefaults:{range:"nearest"},defaultAxes:mI,themeTemplate:{series:{direction:"vertical",fills:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},a.n1.SAFE_RANGE2_OPERATION]},strokes:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"secondSequentialColors"},a.n1.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,strokeWidth:0,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},placement:"before",spacing:4}},seriesArea:{padding:{top:20,bottom:20}},axes:{[xx.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter:t=>Math.abs(t.value).toFixed(t.fractionDigits??0)}},[xx.CATEGORY]:{line:{enabled:!1}}}}},{FillGradientDefaults:xv,FillPatternDefaults:xS,FillImageDefaults:xk,Label:xD,DropShadow:xM,AbstractBarSeriesProperties:xw,BaseProperties:xI,SeriesTooltip:xC,AxisLabel:xA,Property:xL}=a.n1,xT=class extends xD{},xN=class extends xA{};n([xL],xN.prototype,"placement",2);var xO=class extends xI{constructor(){super(...arguments),this.enabled=!0,this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};n([xL],xO.prototype,"enabled",2),n([xL],xO.prototype,"fill",2),n([xL],xO.prototype,"fillOpacity",2),n([xL],xO.prototype,"stroke",2),n([xL],xO.prototype,"strokeWidth",2),n([xL],xO.prototype,"strokeOpacity",2),n([xL],xO.prototype,"lineDash",2),n([xL],xO.prototype,"lineDashOffset",2);var xP=class extends xw{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new xv,this.fillPatternDefaults=new xS,this.fillImageDefaults=new xk,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.spacingRatio=0,this.dropOff=new xO,this.shadow=new xM().set({enabled:!1}),this.label=new xT,this.stageLabel=new xN,this.tooltip=new xC}};n([xL],xP.prototype,"stageKey",2),n([xL],xP.prototype,"valueKey",2),n([xL],xP.prototype,"fills",2),n([xL],xP.prototype,"fillGradientDefaults",2),n([xL],xP.prototype,"fillPatternDefaults",2),n([xL],xP.prototype,"fillImageDefaults",2),n([xL],xP.prototype,"fillOpacity",2),n([xL],xP.prototype,"strokes",2),n([xL],xP.prototype,"strokeWidth",2),n([xL],xP.prototype,"strokeOpacity",2),n([xL],xP.prototype,"lineDash",2),n([xL],xP.prototype,"lineDashOffset",2),n([xL],xP.prototype,"spacingRatio",2),n([xL],xP.prototype,"itemStyler",2),n([xL],xP.prototype,"dropOff",2),n([xL],xP.prototype,"shadow",2),n([xL],xP.prototype,"label",2),n([xL],xP.prototype,"stageLabel",2),n([xL],xP.prototype,"tooltip",2);var{ChartAxisDirection:xE,resetBarSelectionsFn:xR,prepareBarAnimationFunctions:xB,midpointStartingBarPosition:xz,createDatumId:xF,formatValue:x_,Rect:xW,motion:xG,applyShapeStyle:xj,getShapeStyle:xV}=a.n1,x$=class extends m7{constructor(t){super({moduleCtx:t,animationResetFns:{datum:xR}}),this.properties=new xP}getBandScalePadding(){return{inner:this.properties.spacingRatio,outer:0}}connectorEnabled(){return this.properties.dropOff.enabled}barStyle(){let{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:a,lineDashOffset:s,fillGradientDefaults:o,fillPatternDefaults:r,fillImageDefaults:n}=this.properties;return{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:a,lineDashOffset:s,fillGradientDefaults:o,fillPatternDefaults:r,fillImageDefaults:n}}connectorStyle(){let{fill:t,fillOpacity:e,stroke:i,strokeOpacity:a,strokeWidth:s,lineDash:o,lineDashOffset:r}=this.properties.dropOff;return{fill:t,fillOpacity:e,stroke:i,strokeOpacity:a,strokeWidth:s,lineDash:o,lineDashOffset:r,fillGradientDefaults:this.properties.fillGradientDefaults,fillPatternDefaults:this.properties.fillPatternDefaults,fillImageDefaults:this.properties.fillImageDefaults}}nodeFactory(){return new xW}createLabelData({datumIndex:t,rect:e,yDatum:i,datum:a,visible:s}){let{valueKey:o,stageKey:r,label:n}=this.properties;return{x:e.x+e.width/2,y:e.y+e.height/2,textAlign:"center",textBaseline:"middle",text:this.getLabelText(n,{itemId:r,value:i,datum:a,valueKey:o,stageKey:r},t=>x_(t,0)),itemId:r,datum:a,datumIndex:t,series:this,visible:s}}getItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle.item:void 0;return xV({fill:i?.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset},e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults)}getItemStyleOverrides(t,e,i,a,s){let{id:o,properties:r}=this,{stageKey:n,valueKey:l,fills:h,strokes:d,itemStyler:c}=r,p=a.fill??h[i%h.length]??"black",u=a.stroke??d[i%d.length]??"black",g={};if(s||(g.fill=p,g.stroke=u),null!=c){let i=this.cachedDatumCallback(xF(t,s?"highlight":"node"),()=>{let{fillOpacity:t,strokeOpacity:i,strokeWidth:r,lineDash:h,lineDashOffset:d}=a;return this.callWithContext(c,{seriesId:o,datum:e,highlighted:s,stageKey:n,valueKey:l,fill:p,fillOpacity:t,stroke:u,strokeOpacity:i,strokeWidth:r,lineDash:h,lineDashOffset:d})});Object.assign(g,i)}return xV(g,r.fillGradientDefaults,r.fillPatternDefaults,r.fillImageDefaults)}updateDatumNodes(t){let{shadow:e}=this.properties,{datumSelection:i,isHighlight:a}=t,s=this.getCategoryDirection()===xE.X,o=this.getItemBaseStyle(a),r=this.getShapeFillBBox();i.each((t,i)=>{let{datumIndex:n}=i,l=this.getItemStyleOverrides(String(i.datumIndex),i.datum,n,o,a);xj(t,o,l,r),t.visible=s?i.width>0:i.height>0,t.crisp=i.crisp,t.fillShadow=e})}tooltipStyle(t,e){let i=this.getItemBaseStyle(!1);return Object.assign(i,this.getItemStyleOverrides(String(e),t,e,i,!1)),i}animateEmptyUpdateReady(t){super.animateEmptyUpdateReady(t);let{datumSelection:e}=t,i=xB(xz(this.isVertical(),"normal"));xG.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],i)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t);let{datumSelection:e}=t,{processedData:i}=this,a=i?.reduced?.diff?.[this.id],s=xB(xz(this.isVertical(),"fade"));xG.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s,(t,e)=>e.xValue,a)}};x$.className="FunnelSeries",x$.type="funnel";var{commonSeriesOptionsDefs:xH,funnelSeriesThemeableOptionsDef:xY}=a.n1,xK={...xY,...xH,type:(0,s.mw)((0,s.dY)("funnel")),stageKey:(0,s.mw)(s.Yj),valueKey:(0,s.mw)(s.Yj)},xU={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"funnel",moduleFactory:t=>new x$(t),solo:!0,tooltipDefaults:{range:"exact"},defaultAxes:mI,themeTemplate:mC},xX=class{*[Symbol.iterator](){let{node:t,datum:e}=this;t&&e&&(yield{node:t,datum:e})}nodes(){return this.node?[this.node]:[]}update(t,e,i,a){let s=t.nodes();if(0===s.length)this.node?.remove(),this.node=void 0;else{void 0===this.node&&(this.node=new i,this.node.fillOpacity=0,this.node.strokeOpacity=0,e.appendChild(this.node));let t=s[0],o=s.toReversed().find(t=>t.datum.datum.value>t.datum.datum.segmentStart)??s[s.length-1];this.node.datum=this.datum=t.datum,a(this.node,t,o)}}},xZ={fromFn:()=>({opacity:0,phase:"initial"}),toFn:()=>({opacity:1})};function xQ(t,e){if(null==t)return"";let{min:i,max:a}=e,s=Math.max(2-Math.max(0!==i?Math.ceil(Math.log10(Math.abs(i))):0,0!==a?Math.ceil(Math.log10(Math.abs(a))):0),0);return t.toFixed(s)}function xq(t,e,i,a){let s;if(null!=i.text)return i.text;let o=a??i.value;if(i?.formatter!=null&&(s=xJ(e,i.formatter,{seriesId:t,datum:void 0,value:o})),null!=s)return String(s)}function xJ(t,e,i){return a.n1.callWithContext(t.chartService,void 0,e,[i])}function x0({path:t,x:e,y:i,size:a}){t.moveTo(e,i-a/2),t.lineTo(e,i+a/2)}function x1(t,e){let i=(0,s.nl)(t.datumUnion.nodes(),t.targetSelection.nodes());return t.pickNodeNearestDistantObject(e,i)}function x2(t,e){let i=[{data:t.contextNodeData?.nodeData,selection:t.datumUnion},{data:t.contextNodeData?.targetData,selection:t.targetSelection}].filter(t=>t.data&&t.data.length>0),a=(0,s.qE)(0,e.otherIndex+e.otherIndexDelta,i.length-1);if(0===i.length)return;let{data:o,selection:r}=i[a];if(null==o||0===o.length)return;let n=(0,s.qE)(0,e.datumIndex,o.length-1),l=o[n];for(let t of r)if(t.datum===l)return{bounds:t.node,clipFocusBox:!0,datum:l,datumIndex:n,otherIndex:a}}var{BaseProperties:x4,Property:x5}=a.n1,x3=class extends x4{getSegments(t,e){let i,{values:a,step:o,count:r}=this,n=Math.min(...t.domain),l=Math.max(...t.domain);if(null!=a){let t=a.filter(t=>t>n&&t<l).sort((t,e)=>t-e);i=[n,...t,l]}else if(null!=o){let t=[];for(let e=n;e<l;e+=o)t.push(e);t.push(l),i=t}else if(null!=r){let t=r+1;i=Array.from({length:t+1},(e,i)=>i/t*(l-n)+n)}else{let e=t.ticks({nice:!0,interval:void 0,tickCount:void 0,minTickCount:0,maxTickCount:1/0})?.ticks?.filter(t=>t>n&&t<l);i=null!=e?[n,...e,l]:void 0}return null!=i&&i.length>e&&(s.Vy.warnOnce("the configured segmentation results in more than 1 item per pixel, ignoring. Supply a segmentation configuration that results in larger segments or omit this configuration"),i=void 0),i??(i=[n,l]),i}};n([x5],x3.prototype,"values",2),n([x5],x3.prototype,"step",2),n([x5],x3.prototype,"count",2);var x6=class extends x4{constructor(){super(...arguments),this.enabled=!1,this.interval=new x3,this.spacing=0}};n([x5],x6.prototype,"enabled",2),n([x5],x6.prototype,"interval",2),n([x5],x6.prototype,"spacing",2);var{BaseProperties:x8,SeriesTooltip:x9,SeriesProperties:x7,PropertiesArray:bt,Property:be,Label:bi,AxisLabel:ba}=a.n1,bs=class extends bi{};n([be],bs.prototype,"spacing",2);var bo=class extends x8{constructor(){super(...arguments),this.value=0,this.label=new bs}};n([be],bo.prototype,"text",2),n([be],bo.prototype,"value",2),n([be],bo.prototype,"shape",2),n([be],bo.prototype,"placement",2),n([be],bo.prototype,"spacing",2),n([be],bo.prototype,"size",2),n([be],bo.prototype,"rotation",2),n([be],bo.prototype,"fill",2),n([be],bo.prototype,"fillOpacity",2),n([be],bo.prototype,"stroke",2),n([be],bo.prototype,"strokeWidth",2),n([be],bo.prototype,"strokeOpacity",2),n([be],bo.prototype,"lineDash",2),n([be],bo.prototype,"lineDashOffset",2),n([be],bo.prototype,"label",2);var br=class extends x8{constructor(){super(...arguments),this.enabled=!0,this.thicknessRatio=1,this.fills=new bt(a.n1.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};n([be],br.prototype,"enabled",2),n([be],br.prototype,"thickness",2),n([be],br.prototype,"thicknessRatio",2),n([be],br.prototype,"fills",2),n([be],br.prototype,"fillMode",2),n([be],br.prototype,"fill",2),n([be],br.prototype,"fillOpacity",2),n([be],br.prototype,"stroke",2),n([be],br.prototype,"strokeWidth",2),n([be],br.prototype,"strokeOpacity",2),n([be],br.prototype,"lineDash",2),n([be],br.prototype,"lineDashOffset",2);var bn=class extends x8{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};n([be],bn.prototype,"values",2),n([be],bn.prototype,"step",2),n([be],bn.prototype,"minSpacing",2),n([be],bn.prototype,"maxSpacing",2);var bl=class extends ba{constructor(){super(...arguments),this.placement=void 0}};n([be],bl.prototype,"placement",2);var bh=class extends x8{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new bt(a.n1.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new bn,this.label=new bl}};n([be],bh.prototype,"min",2),n([be],bh.prototype,"max",2),n([be],bh.prototype,"fills",2),n([be],bh.prototype,"fillMode",2),n([be],bh.prototype,"fill",2),n([be],bh.prototype,"fillOpacity",2),n([be],bh.prototype,"stroke",2),n([be],bh.prototype,"strokeWidth",2),n([be],bh.prototype,"strokeOpacity",2),n([be],bh.prototype,"lineDash",2),n([be],bh.prototype,"lineDashOffset",2),n([be],bh.prototype,"defaultFill",2),n([be],bh.prototype,"interval",2),n([be],bh.prototype,"label",2);var bd=class extends ux{constructor(){super(...arguments),this.placement="inside-center",this.avoidCollisions=!0}};n([be],bd.prototype,"text",2),n([be],bd.prototype,"placement",2),n([be],bd.prototype,"avoidCollisions",2);var bc=class extends x7{constructor(){super(...arguments),this.value=0,this.segmentation=new x6,this.defaultColorRange=[],this.targets=new bt(bo),this.defaultTarget=new bo,this.defaultScale=new bh,this.direction="vertical",this.thickness=1,this.cornerRadius=0,this.cornerMode="container",this.margin=0,this.scale=new bh,this.bar=new br,this.label=new bd,this.tooltip=new x9}};n([be],bc.prototype,"value",2),n([be],bc.prototype,"segmentation",2),n([be],bc.prototype,"defaultColorRange",2),n([be],bc.prototype,"targets",2),n([be],bc.prototype,"defaultTarget",2),n([be],bc.prototype,"defaultScale",2),n([be],bc.prototype,"direction",2),n([be],bc.prototype,"thickness",2),n([be],bc.prototype,"cornerRadius",2),n([be],bc.prototype,"cornerMode",2),n([be],bc.prototype,"margin",2),n([be],bc.prototype,"scale",2),n([be],bc.prototype,"bar",2),n([be],bc.prototype,"label",2),n([be],bc.prototype,"tooltip",2);var{CachedTextMeasurerPool:bp,BBox:bu}=a.n1;function bg(t){let{x0:e,y0:i,x1:a,y1:s,horizontalInset:o,verticalInset:r}=t;return{x:Math.min(e,a)+o,y:Math.min(i,s)+r,width:Math.max(Math.abs(a-e)-2*o,0),height:Math.max(Math.abs(s-i)-2*r,0)}}function by(t){let{clipX0:e,clipX1:i,clipY0:a,clipY1:s}=t;return null!=e&&null!=i||null!=a&&null!=s}function bf(t,e){let i=t?"initial":"update";return{node:{fromFn(a,s){let o=a.previousDatum,{x0:r,y0:n,x1:l,y1:h,clipX0:d,clipY0:c,clipX1:p,clipY1:u}=o??s,{horizontalInset:g,verticalInset:y}=s,f=null!=o&&by(o),m=by(s);return f&&m||(!f&&m?({x0:r,y0:n,x1:l,y1:h,clipX0:d,clipY0:c,clipX1:p,clipY1:u}=s,t&&(e?p=s.clipX0:u=s.clipY0)):f&&!m?({x0:r,y0:n,x1:l,y1:h}=s,d=void 0,c=void 0,p=void 0,u=void 0):t&&(e?l=r:h=n)),{x0:r,y0:n,x1:l,y1:h,clipX0:d,clipY0:c,clipX1:p,clipY1:u,horizontalInset:g,verticalInset:y,phase:i}},toFn(t,e){let{x0:i,y0:a,x1:s,y1:o,clipX0:r,clipY0:n,clipX1:l,clipY1:h,horizontalInset:d,verticalInset:c}=e;return{x0:i,y0:a,x1:s,y1:o,clipX0:r,clipY0:n,clipX1:l,clipY1:h,horizontalInset:d,verticalInset:c}},applyFn(t,e){t.setProperties(bm(t,e))}}}}function bm(t,e){let{x:i,y:a,width:s,height:o}=bg(e),r=function(t){if(!by(t))return;let{x0:e,y0:i,x1:a,y1:s}=t,{x:o,y:r,width:n,height:l}=bg(t),{clipX0:h,clipX1:d,clipY0:c,clipY1:p}=t;(null==h||null==d)&&(h=e,d=a),(null==c||null==p)&&(c=i,p=s);let u=Math.min(h,d),g=Math.min(c,p),y=Math.abs(d-h),f=Math.abs(p-c);return h=Math.max(o,u),c=Math.max(r,g),new bu(Math.min(h,d=Math.min(o+n,u+y)),Math.min(c,p=Math.min(r+l,g+f)),Math.abs(d-h),Math.abs(p-c))}(e),n=function(t,e){if(null==e)return!0;let i=bg(t),a=i.x+1e-6,s=i.y+1e-6,o=i.x+i.width-1e-6,r=i.y+i.height-1e-6,n=e.x,l=e.x+e.width,h=e.y,d=e.y+e.height;return Math.max(a,n)<=Math.min(o,l)&&Math.max(s,h)<=Math.min(r,d)}(e,r);return{x:i,y:a,width:s,height:o,clipBBox:r,visible:n}}var bx={Before:"right",Center:"center",After:"left"},bb={Before:"top",Center:"middle",After:"bottom"},bv={Before:-1,Center:-.5,After:0},bS={Before:0,Center:-.5,After:-1},{fromToMotion:bk,resetMotion:bD,SeriesNodePickMode:bM,StateMachine:bw,createDatumId:bI,CachedTextMeasurerPool:bC,toRadians:bA,BBox:bL,Group:bT,PointerEvents:bN,Selection:bO,Rect:bP,Text:bE,TransformableText:bR,Marker:bB,LinearScale:bz,AxisTickGenerator:bF,NiceMode:b_,easing:bW,getColorStops:bG,findRangeExtent:bj}=a.n1,bV={before:180,middle:0,after:0},b$={before:90,middle:0,after:-90},bH=class{constructor(t,e){this.gauge=t,this.ctx=e}get defaultTickMinSpacing(){return 0}get range(){return this.gauge.range}get reverse(){return!1}get scale(){return this.gauge.scale}get label(){return this.gauge.properties.scale.label}get interval(){return this.gauge.properties.scale.interval}formatTick(t,e,i,a,s,o){let{label:r}=this;return this.formatWithContext(t,e,i)??(null!=r.format?o?.(t):void 0)??this.gauge.formatLabel(t)}formatWithContext(t,e,i){let a;return this.label.formatter&&(a=xJ(this.ctx,this.label.formatter,{value:t,index:e,domain:i,boundSeries:void 0})),a}inRange(){return!0}},bY=class extends a.n1.Series{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[bM.EXACT_SHAPE_MATCH,bM.NEAREST_NODE]}),this.properties=new bc,this.seriesRect=bL.NaN,this.gaugeRect=bL.NaN,this.scale=new bz,this.originX=0,this.originY=0,this.scaleGroup=this.contentGroup.appendChild(new bT({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new bT({name:"itemGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new bT({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new bT({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new bT({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new bT({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new bT({name:"tickGroup"})),this.scaleSelection=bO.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=bO.select(this.itemGroup,()=>this.nodeFactory()),this.targetSelection=bO.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=bO.select(this.itemTargetLabelGroup,bE),this.labelSelection=bO.select(this.itemLabelGroup,bE),this.highlightTargetSelection=bO.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=bO.select(this.tickGroup,bR),this.datumUnion=new xX,this.axis=new bH(this,t),this.tickGenerator=new bF(this.axis),this.animationState=new bw("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=bN.None,this.tickGroup.pointerEvents=bN.None}get range(){return this.horizontal?[0,this.gaugeRect.width]:[0,this.gaugeRect.height]}get horizontal(){return"horizontal"===this.properties.direction}get hasData(){return!0}nodeFactory(){let t=new bP;return t.crisp=!0,t}markerFactory(){return new bB}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(t){return xQ(t,this.properties.scale)}createLinearGradient(t,e,i){let{properties:a,horizontal:s}=this,{defaultColorRange:o}=a;return{type:"gradient",gradient:"linear",colorSpace:"oklch",colorStops:bG(e,o,t.domain,i),rotation:90*!!s}}getShapeFillBBox(){let{properties:t,originX:e,originY:i,horizontal:a,scale:s}=this,{thickness:o}=t,r=bj(s.range);return new bL(e,i,a?r:o,a?o:r)}getTargets(){let{properties:t}=this,e=t.defaultTarget;return Array.from(t.targets).map(t=>{let{text:i=e.text,value:a=e.value??0,shape:s=e.shape??"triangle",rotation:o=e.rotation??0,strokeWidth:r=e.strokeWidth??0,placement:n=e.placement??"middle",spacing:l=e.spacing??0,size:h=e.size??0,fill:d=e.fill??"black",fillOpacity:c=e.fillOpacity??1,stroke:p=e.stroke??"black",strokeOpacity:u=e.strokeOpacity??1,lineDash:g=e.lineDash??[0],lineDashOffset:y=e.lineDashOffset??0}=t,{enabled:f=e.label.enabled,color:m=e.label.color??"black",fontStyle:x=e.label.fontStyle??"normal",fontWeight:b=e.label.fontWeight??"normal",fontSize:v=e.label.fontSize,fontFamily:S=e.label.fontFamily,spacing:k=e.label.spacing??0}=t.label;return{text:i,value:a,shape:s,placement:n,spacing:l,size:h,rotation:o,fill:d,fillOpacity:c,stroke:p,strokeWidth:r,strokeOpacity:u,lineDash:g,lineDashOffset:y,label:{enabled:f,color:m,fontStyle:x,fontWeight:b,fontSize:v,fontFamily:S,spacing:k}}})}getTargetPoint(t){let e,{properties:i,originX:a,originY:s,horizontal:o,scale:r,gaugeRect:n}=this,{thickness:l}=i,{value:h,placement:d,spacing:c,size:p}=t,u=r.convert(h);switch(d){case"before":e=-(c+p/2);break;case"after":e=l+c+p/2;break;default:e=l/2}return{x:a+n.x+(o?u:e),y:s+n.y+(o?e:u)}}getTargetLabel(t){let e,i,{size:a,placement:s,label:o}=t,{spacing:r,color:n,fontStyle:l,fontWeight:h,fontSize:d,fontFamily:c}=o,p=a/2+r,u=0,g=0;return this.horizontal?(e="center","after"===s?(i="top",g=p):(i="bottom",g=-p)):(i="middle","before"===s?(e="right",u=-p):(e="left",u=p)),{offsetX:u,offsetY:g,fill:n,textAlign:e,textBaseline:i,fontStyle:l,fontWeight:h,fontSize:d,fontFamily:c,lineHeight:void 0}}labelDatum(t,e){let{placement:i,avoidCollisions:a,spacing:s,text:o,color:r,fontSize:n,minimumFontSize:l,fontStyle:h,fontWeight:d,fontFamily:c,lineHeight:p,wrapping:u,overflowStrategy:g,formatter:y=t=>this.formatLabel(t.value)}=t;return{placement:i,avoidCollisions:a,spacing:s,text:o,value:e,fill:r,fontSize:n,minimumFontSize:l,fontStyle:h,fontWeight:d,fontFamily:c,lineHeight:p,wrapping:u,overflowStrategy:g,formatter:y}}verticalLabelInset(){let{properties:t}=this,{label:e}=t,i=e.text?.split("\n"),a=ud(e,e.fontSize)*(i?.length??1);return e.spacing+a}horizontalLabelInset(){let{scale:t,properties:e}=this,{scale:i,label:a}=e,s=a.text?.split("\n"),o=a.getFont(),r=i.interval.values??t.ticks({nice:!1,interval:i.interval.step,minTickCount:0,maxTickCount:6,tickCount:5})?.ticks??[],n=(s??r?.map(t=>xq(this.id,this.ctx,this.labelDatum(a,t))??"")).reduce((t,e)=>{let{width:i}=bC.measureText(e,{font:o});return Math.max(t,i)},0);return a.spacing+n}createNodeData(){let t,e,i,a,s,o,{id:r,properties:n,horizontal:l,scale:h,seriesRect:d}=this,{value:c,segmentation:p,thickness:u,cornerRadius:g,cornerMode:y,bar:f,scale:m,label:x}=n;h.domain=[m.min,m.max],h.range=l?[0,d.width]:[d.height,0],l?(e=1,t=Math.PI/2):(e="before"===m.label.placement?1:-1,t=0);let b=t-Math.PI/2;l?(i=0,a=d.width,o=(s=(d.height-u)/2)+u,"outside-start"===x.placement?i+=this.horizontalLabelInset():"outside-end"===x.placement&&(a-=this.horizontalLabelInset())):(a=(i=(d.width-u)/2)+u,o=0,s=d.height,"outside-start"===x.placement?s-=this.verticalLabelInset():"outside-end"===x.placement&&(o+=this.verticalLabelInset())),this.gaugeRect=new bL(Math.min(i,a),Math.min(s,o),Math.abs(a-i),Math.abs(o-s)),h.domain=[m.min,m.max],h.range=l?[i,a]:[s,o];let{ticks:v}=this.tickGenerator.generateTicks({domain:h.domain,primaryTickCount:void 0,visibleRange:[0,1],niceMode:b_.Off,labelX:0,parallelFlipRotation:t,regularFlipRotation:b,sideFlag:e,removeOverflowLabels:!1}).tickData,S=this.getTargets(),k=[],D=[],M=[],w=[],[I,C]=h.range,A=Math.abs(C-I),L=l?h.convert(c):a,T=l?o:h.convert(c),N=p.enabled?p.spacing/2:0,O=l?N:0,P=l?0:N,E=Math.min(f.thickness??Math.round(f.thicknessRatio*u),u),R=-(u-E)/2,B=l?0:R,z=l?R:0,F="item"===y,_=Math.ceil(A),W=p.enabled?p.interval.getSegments(h,_):void 0,G=f.fill??this.createLinearGradient(h,f.fills,f.fillMode),j=m.fill??(f.enabled&&0===m.fills.length?m.defaultFill:void 0)??this.createLinearGradient(h,m.fills,m.fillMode);if(null==W&&F){let t={value:c,segmentStart:Math.min(...h.domain),segmentEnd:Math.max(...h.domain)};if(f.enabled){let e=+Math.min(g,E/2,A/2),a=l?e:0,o=l?0:e;k.push({series:this,itemId:"value",datum:t,datumIndex:{type:0},type:0,x0:0+i-a-B,y0:0+s-o-z,x1:0+L+a+B,y1:0+T+o+z,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:g,topRightCornerRadius:g,bottomRightCornerRadius:g,bottomLeftCornerRadius:g,fill:G,horizontalInset:O,verticalInset:P})}let e=+Math.min(g,u/2,A/2),r=l?e:0,n=l?0:e;w.push({series:this,itemId:"scale",datum:t,datumIndex:{type:0},type:0,x0:0+i-r,y0:0+s-n,x1:0+a+r,y1:0+o+n,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:g,topRightCornerRadius:g,bottomRightCornerRadius:g,bottomLeftCornerRadius:g,fill:j,horizontalInset:O,verticalInset:P})}else{W??(W=h.domain);let t=0+i-B,e=0+s-z,r=0+L+B,n=0+T+z;for(let d=0;d<W.length-1;d+=1){let p=W[d+0],u=W[d+1],y={value:c,segmentStart:p,segmentEnd:u},m=0===d,x=d===W.length-2,b=h.convert(p),v=h.convert(u),S=F||m?g:0,D=F||x?g:0,M=l?S:D,I=l?D:S;f.enabled&&k.push({series:this,itemId:`value-${d}`,datum:y,datumIndex:{type:0},type:0,x0:0+(l?b:i),y0:0+(l?s:b),x1:0+(l?v:a),y1:0+(l?o:v),clipX0:t,clipY0:e,clipX1:r,clipY1:n,topLeftCornerRadius:M,topRightCornerRadius:D,bottomRightCornerRadius:I,bottomLeftCornerRadius:S,fill:G,horizontalInset:O,verticalInset:P}),w.push({series:this,itemId:`scale-${d}`,datum:y,datumIndex:{type:0},type:0,x0:0+(l?b:i),y0:0+(l?s:b),x1:0+(l?v:a),y1:0+(l?o:v),clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:M,topRightCornerRadius:D,bottomRightCornerRadius:I,bottomLeftCornerRadius:S,fill:j,horizontalInset:O,verticalInset:P})}}x.enabled&&M.push(this.labelDatum(x,c));let V=l?bV:b$;for(let t=0;t<S.length;t+=1){let e=S[t],{value:i,text:a,shape:s,size:o,fill:r,fillOpacity:n,stroke:l,strokeWidth:h,strokeOpacity:d,lineDash:c,lineDashOffset:p}=e,u=this.getTargetPoint(e),g=bA(e.rotation+V[e.placement]);D.push({series:this,itemId:`target-${t}`,midPoint:u,datum:{value:i},datumIndex:{type:1,index:t},type:1,value:i,text:a,x:u.x,y:u.y,shape:s,size:o,rotation:g,fill:r,fillOpacity:n,stroke:l,strokeOpacity:d,strokeWidth:h,lineDash:c,lineDashOffset:p,label:this.getTargetLabel(e)})}return{itemId:r,nodeData:k,tickData:v,targetData:D,labelData:M,scaleData:w}}updateSelections(t){(this.nodeDataRefresh||t)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(t){if(null!=t&&t.series===this&&1===t.type)return t}update({seriesRect:t}){let{datumSelection:e,labelSelection:i,targetSelection:a,targetLabelSelection:s,scaleSelection:o,highlightTargetSelection:r,tickSelection:n}=this;this.seriesRect=t??bL.NaN;let l=this.checkResize(t);this.updateSelections(l),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let h=this.contextNodeData?.nodeData??[],d=this.contextNodeData?.labelData??[],c=this.contextNodeData?.targetData??[],p=this.contextNodeData?.scaleData??[],u=this.contextNodeData?.tickData??[],g=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:p,scaleSelection:o}),this.updateScaleNodes({scaleSelection:o}),this.targetSelection=this.updateTargetSelection({targetData:c,targetSelection:a}),this.updateTargetNodes({targetSelection:a,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:c,targetLabelSelection:s}),this.updateTargetLabelNodes({targetLabelSelection:s}),this.datumSelection=this.updateDatumSelection({nodeData:h,datumSelection:e}),this.updateDatumNodes({datumSelection:e}),this.labelSelection=this.updateLabelSelection({labelData:d,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:null!=g?[g]:[],targetSelection:r}),this.updateTargetNodes({targetSelection:r,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:u,tickSelection:n}),this.updateTickNodes({tickSelection:n}),l&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>bI(t.nodeData.length,e.itemId))}updateDatumNodes(t){let{datumSelection:e}=t,{ctx:i,properties:s}=this,{bar:o}=s,{fillOpacity:r,stroke:n,strokeOpacity:l,lineDash:h,lineDashOffset:d}=o,c=this.getStrokeWidth(o.strokeWidth),p=i.animationManager.isSkipped(),u=this.getShapeFillBBox();e.each((t,e)=>{let{topLeftCornerRadius:i,topRightCornerRadius:s,bottomRightCornerRadius:o,bottomLeftCornerRadius:g,fill:y}=e;t.fill=y,t.fillBBox=u,t.fillOpacity=r,t.stroke=n,t.strokeOpacity=l,t.strokeWidth=c,t.lineDash=h,t.lineDashOffset=d,t.topLeftCornerRadius=i,t.topRightCornerRadius=s,t.bottomRightCornerRadius=o,t.bottomLeftCornerRadius=g,t.pointerEvents=this.properties.bar.enabled?a.n1.PointerEvents.All:a.n1.PointerEvents.None,(p||null==t.previousDatum)&&t.setProperties(bm(t,e))}),this.datumUnion.update(e,this.itemGroup,a.n1.Rect,(t,e,i)=>{t.pointerEvents=a.n1.PointerEvents.None,t.clipBBox??(t.clipBBox=new bL(NaN,NaN,NaN,NaN)),t.x=e.x,t.y=e.y,t.clipBBox.x=e.clipBBox?.x??e.x,t.clipBBox.y=e.clipBBox?.y??e.y,this.horizontal?(t.height=t.clipBBox.height=i.height,t.width=i===e?i.width:i.x+i.width,t.clipBBox.width=t.width-(i.width-(i.clipBBox?.width??i.width)),t.topLeftCornerRadius=e.topLeftCornerRadius,t.bottomLeftCornerRadius=e.bottomLeftCornerRadius,t.topRightCornerRadius=i.topRightCornerRadius):(t.width=t.clipBBox.width=i.width,t.height=i===e?i.height:i.x+i.height,t.clipBBox.height=t.height-(i.height-(i.clipBBox?.height??i.height)),t.topLeftCornerRadius=e.topLeftCornerRadius,t.topRightCornerRadius=e.topRightCornerRadius,t.bottomLeftCornerRadius=i.bottomLeftCornerRadius),t.bottomRightCornerRadius=i.bottomRightCornerRadius})}updateScaleSelection(t){return t.scaleSelection.update(t.scaleData,void 0,e=>bI(t.scaleData.length,e.itemId))}updateScaleNodes(t){let{scaleSelection:e}=t,{scale:i}=this.properties,{fillOpacity:a,stroke:s,strokeOpacity:o,strokeWidth:r,lineDash:n,lineDashOffset:l}=i,h=this.getShapeFillBBox();e.each((t,e)=>{let{topLeftCornerRadius:i,topRightCornerRadius:d,bottomRightCornerRadius:c,bottomLeftCornerRadius:p,fill:u}=e;t.fill=u,t.fillBBox=h,t.fillOpacity=a,t.stroke=s,t.strokeOpacity=o,t.strokeWidth=r,t.lineDash=n,t.lineDashOffset=l,t.topLeftCornerRadius=i,t.topRightCornerRadius=d,t.bottomRightCornerRadius=c,t.bottomLeftCornerRadius=p,t.setProperties(bm(t,e))})}updateTargetSelection(t){return t.targetSelection.update(t.targetData,void 0,t=>t.itemId)}updateTargetNodes(t){let{targetSelection:e,isHighlight:i}=t,a=i?this.properties.highlightStyle.item:void 0;e.each((t,e)=>{let{x:i,y:s,shape:o,size:r,rotation:n,fill:l,fillOpacity:h,stroke:d,strokeOpacity:c,strokeWidth:p,lineDash:u,lineDashOffset:g}=e;t.size=r,t.shape="line"===o?x0:o,t.fill=a?.fill??l,t.fillOpacity=a?.fillOpacity??h,t.stroke=a?.stroke??d,t.strokeOpacity=a?.strokeOpacity??c,t.strokeWidth=a?.strokeWidth??p,t.lineDash=a?.lineDash??u,t.lineDashOffset=a?.lineDashOffset??g,t.translationX=i,t.translationY=s,t.rotation=n})}updateTargetLabelSelection(t){return t.targetLabelSelection.update(t.targetData)}updateTargetLabelNodes(t){let{targetLabelSelection:e}=t;e.each((t,e)=>{let{x:i,y:a,text:s}=e,{offsetX:o,offsetY:r,fill:n,fontStyle:l,fontWeight:h,fontSize:d,fontFamily:c,textAlign:p,textBaseline:u}=e.label;t.visible=!0,t.x=i+o,t.y=a+r,t.text=s,t.fill=n,t.fontStyle=l,t.fontWeight=h,t.fontSize=d,t.fontFamily=c,t.textAlign=p,t.textBaseline=u})}updateTickSelection(t){return t.tickSelection.update(t.tickData,void 0,t=>t.tickId)}updateTickNodes(t){let e,i,a,s,{gaugeRect:o,properties:r}=this,n=r.defaultScale,{enabled:l,color:h,fontFamily:d=n.label.fontFamily,fontSize:c=n.label.fontSize,fontStyle:p,fontWeight:u=n.label.fontWeight,spacing:g}=r.scale.label,{placement:y}=r.scale.label,f=bA(r.scale.label.rotation??0);this.horizontal?(y??(y="after"),e="center",i="before"===y?"bottom":"top",s=this.originY+o.y+("before"===y?-g:o.height+g)):(y??(y="before"),e="before"===y?"end":"start",i="middle",a=this.originX+o.x+("before"===y?-g:o.width+g)),t.tickSelection.each((t,o)=>{if(!l){t.visible=!1;return}let r=a??o.translationY,n=s??o.translationY;t.visible=!0,t.text=o.tickLabel,t.fill=h,t.fontFamily=d,t.fontSize=c,t.fontStyle=p,t.fontWeight=u,t.textBaseline=i,t.textAlign=e,t.x=r,t.y=n,t.rotationCenterX=r,t.rotationCenterY=n,t.rotation=f})}updateLabelSelection(t){return t.labelSelection.update(t.labelData,void 0,t=>"primary")}updateLabelNodes(t){let{labelSelection:e}=t,i=this.ctx.animationManager.isSkipped();e.each((t,e)=>{t.fill=e.fill,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.fontFamily=e.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(let{datum:t}of this.labelSelection)if(null==t.text)return!1;return!0}formatLabelText(t){let e,{labelSelection:i,horizontal:a,scale:s,seriesRect:o,gaugeRect:r}=this,{x:n,y:l,width:h,height:d}=r,c=t?.label??this.properties.value;if(a)e=new bL(n,l,s.convert(c)-n,d);else{let t=s.convert(c);e=new bL(n,t,h,d-t)}let p={seriesRect:o,gaugeRect:r,barRect:e},{margin:u}=this.properties;!function(t,e,i,a,s,o){let{seriesRect:r,gaugeRect:n,barRect:l}=s,{padding:h,horizontal:d}=a;i.each((i,a)=>{let s,c,p,u,g,y,f,m,x,b=xq(t.id,e,a,o?.label);if("outside-start"===a.placement?d?(s=n.x,c=r.height):(s=r.width,c=r.height-(n.y+n.height)):"outside-end"===a.placement?d?(s=r.width-(n.x+n.width),c=r.height):(s=r.width,c=n.y):a.avoidCollisions&&(s=n.width,c=n.height),null==b)return;if(null!=s&&null!=c){let t=up(b,a,{padding:h},()=>({width:s,height:c,meta:null}));p=t?.[0]}else{let t={fontSize:a.fontSize,fontStyle:a.fontStyle,fontWeight:a.fontWeight,fontFamily:a.fontFamily,lineHeight:a.lineHeight},{width:e,height:i}=bp.measureText(b,{font:t});p={text:b,fontSize:a.fontSize,lineHeight:ud(a,a.fontSize),width:e,height:i}}if(null==p){i.visible=!1;return}let v=d?n.x:n.y+n.height,S=d?n.x+n.width:n.y,k=d?l.x:l.y+l.height,D=d?l.x+l.width:l.y,M=a.spacing*(d?1:-1);switch(a.placement){case"outside-start":u=-1/0,g=1/0,y=v-M,f="Before";break;case"outside-end":u=-1/0,g=1/0,y=S+M,f="After";break;case"inside-start":u=v,g=D,y=v+M,f="After";break;case"inside-end":u=D,g=S,y=S-M,f="Before";break;case"inside-center":u=v,g=S,y=(v+S)/2,f="Center";break;case"bar-inside":u=k,g=D,y=(k+D)/2,f="Center";break;case"bar-inside-end":u=k,g=D,y=D-M,f="Before";break;case"bar-outside-end":u=D,g=S,y=D+M,f="After";break;case"bar-end":u=-1/0,g=1/0,y=D,f="Center"}let w=d?y:n.x+n.width/2,I=d?n.y+n.height/2:y;x=d?(m=w+bv[f]*p.width)+p.width:(m=I+bS[f]*p.height)+p.height;let C=Math.min(m,x)>=Math.min(u,g)&&Math.max(m,x)<=Math.max(u,g);if(a.avoidCollisions&&!C){i.visible=!1;return}i.visible=!0,i.text=p.text,i.fontSize=p.fontSize,i.lineHeight=p.lineHeight,i.textAlign=d?bx[f]:"center",i.textBaseline=d?"middle":bb[f],i.x=w,i.y=I})}(this,this.ctx,i,{padding:u,horizontal:a},p,t)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),bD([this.datumSelection],bm),this.formatLabelText()}resetAnimation(t){"initial"===t?this.animationState.transition("reset"):"ready"===t&&this.animationState.transition("skip")}animateLabelText(t={}){let{animationManager:e}=this.ctx,i=0,a=0;if(this.labelSelection.each((e,s)=>{e.opacity=1,i=e.previousDatum?.value??t.from??s.value,a=s.value}),this.labelsHaveExplicitText());else if(i===a)this.formatLabelText({label:a});else{let s=`${this.id}_labels`;e.animate({id:s,groupId:"label",from:{label:i},to:{label:a},phase:t.phase??"update",ease:bW.easeOut,onUpdate:t=>this.formatLabelText(t)})}}animateEmptyUpdateReady(){let{animationManager:t}=this.ctx,{node:e}=bf(!0,this.horizontal);bk(this.id,"node",t,[this.datumSelection],e,(t,e)=>e.itemId),bk(this.id,"label",t,[this.labelSelection],xZ,()=>"primary"),this.animateLabelText({from:0,phase:"initial"})}animateWaitingUpdateReady(){let{animationManager:t}=this.ctx,{node:e}=bf(!1,this.horizontal);bk(this.id,"node",t,[this.datumSelection],e,(t,e)=>e.itemId),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[0,1]}getSeriesRange(t,e){return[NaN,NaN]}getLegendData(){return[]}getTooltipContent(t){let e,i,{id:a,properties:s}=this,{tooltip:o}=s;if(0===t.type?(e=s.value,i=s.label.text):{value:e,text:i}=s.targets[t.index],null!=e)return this.formatTooltipWithContext(o,{data:[{label:i,fallbackLabel:"Value",value:this.formatLabel(e)}]},{seriesId:a,title:void 0,datum:void 0,value:e})}pickNodeClosestDatum(t){return x1(this,t)}pickFocus(t){return x2(this,t)}getCaptionText(){return this.formatLabel(this.properties.value)}getCategoryValue(t){}datumIndexForCategoryValue(t){}};bY.className="LinearGaugeSeries",bY.type="linear-gauge";var bK={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"linear-gauge",moduleFactory:t=>new bY(t),tooltipDefaults:{range:10},themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{thickness:50,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},a.n1.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./2",a.n1.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},label:{spacing:11}},bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:1},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"after",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},defaultScale:{label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}}},label:{enabled:!1,placement:"inside-start",fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[2]},minimumFontSize:12,spacing:18,color:{$ref:"backgroundColor"}},margin:4}}},bU={type:"series",name:"linear-gauge",chartType:"gauge",enterprise:!0,options:a.n1.linearGaugeSeriesOptionsDef,create:t=>new bY(t)},bX={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer",buttons:{anchorPointX:"middle",anchorPointY:"middle"}},legend:{enabled:!1},gradientLegend:{enabled:!1}};function bZ(t,e,i,a){let s,o,[r,n]=t,[l,h]=e,d=l-r,c=h-n,p=d*d+c*c;if(1e-9>Math.abs(p))s=r,o=n;else{let t=((i-r)*d+(a-n)*c)/p;s=r+(t=Math.max(0,Math.min(1,t)))*(l-r),o=n+t*(h-n)}let u=i-s,g=a-o;return u*u+g*g}function bQ(t,e,i){let a=1/0,s=t[t.length-1];for(let o of t)a=Math.min(a,bZ(s,o,e,i)),s=o;return Math.sqrt(a)}function bq(t){let[e,i]=t[0],a=0;for(let s=1;s<t.length;s+=1){let[o,r]=t[s];a+=Math.hypot(o-e,r-i),e=o,i=r}return a}function bJ(t){if(0===t.length)return;let e=bq(t)/2,[i,a]=t[0],s=0;for(let o=1;o<t.length;o+=1){let[r,n]=t[o],l=Math.hypot(r-i,n-a),h=s+l;if(h>e){let t=(e-s)/l;return{point:[i+(r-i)*t,a+(n-a)*t],angle:Math.atan2(n-a,r-i)}}s=h,i=r,a=n}}var{LonLatBBox:b0}=a.n1;function b1(t,e,i,a,s){return null==t?t=new b0(e,i,a,s):(t.lon0=Math.min(t.lon0,e),t.lat0=Math.min(t.lat0,i),t.lon1=Math.max(t.lon1,a),t.lat1=Math.max(t.lat1,s)),t}function b2(t,e){return t.forEach(t=>{let[i,a]=t;e=b1(e,i,a,i,a)}),e}function b4(t,e,i){let a=!1,s=1/0;for(let o of t){let t=o[o.length-1],[r,n]=t;for(let l of o){let[o,h]=l;h>i!=n>i&&e<(r-o)*(i-h)/(n-h)+o&&(a=!a),s=Math.min(s,bZ(t,l,e,i)),t=l,r=o,n=h}}return(a?-1:1)*Math.sqrt(s)}var{Path:b5,ExtendedPath2D:b3,BBox:b6,SceneChangeDetection:b8,SceneObjectChangeDetection:b9,objectsEqual:b7}=a.n1,vt=class extends b5{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new b3}computeBBox(){return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),this.bbox?.clone()}updatePath(){let{projectedGeometry:t}=this;this.strokePath.clear(),this.path.clear(),this.bbox=null!=t?this.drawGeometry(t,void 0):void 0}drawPath(t){super.drawPath(t),this.renderStroke(t,this.strokePath.getPath2D())}containsPoint(t,e){let{projectedGeometry:i}=this;return null!=i&&!!this.getBBox().containsPoint(t,e)&&0>=this.geometryDistance(i,t,e)}distanceSquared(t,e){let{projectedGeometry:i}=this;if(null==i)return 1/0;let a=this.geometryDistance(i,t,e);return a>0?a*a:0}geometryDistance(t,e,i){let{renderMode:a,strokeWidth:s}=this,o=(1&a)!=0,r=(2&a)!=0,n=Math.max(s/2,1)+1;switch(t.type){case"GeometryCollection":return t.geometries.reduce((t,a)=>Math.min(t,this.geometryDistance(a,e,i)),1/0);case"MultiPolygon":return o?t.coordinates.reduce((t,a)=>Math.min(t,Math.max(b4(a,e,i),0)),1/0):1/0;case"Polygon":return o?Math.max(b4(t.coordinates,e,i),0):1/0;case"MultiLineString":return r?t.coordinates.reduce((t,a)=>Math.min(t,Math.max(bQ(a,e,i)-n,0)),1/0):1/0;case"LineString":return r?Math.max(bQ(t.coordinates,e,i)-n,0):1/0;default:return 1/0}}drawGeometry(t,e){let{renderMode:i,path:a,strokePath:s}=this,o=(1&i)!=0,r=(2&i)!=0;switch(t.type){case"GeometryCollection":t.geometries.forEach(t=>{e=this.drawGeometry(t,e)});break;case"MultiPolygon":o&&t.coordinates.forEach(t=>{e=this.drawPolygon(a,t,e)});break;case"Polygon":o&&(e=this.drawPolygon(a,t.coordinates,e));break;case"LineString":r&&(e=this.drawLineString(s,t.coordinates,e,!1));break;case"MultiLineString":r&&t.coordinates.forEach(t=>{e=this.drawLineString(s,t,e,!1)})}return e}drawPolygon(t,e,i){if(e.length<1)return i;i=this.drawLineString(t,e[0],i,!0);for(let i=1;i<e.length;i+=1){let a=e[i];this.drawLineString(t,a,void 0,!0)}return i}drawLineString(t,e,i,a){if(e.length<2)return i;let s=a?e.length-1:e.length;for(let a=0;a<s;a+=1){let[s,o]=e[a];if(0===a?t.moveTo(s,o):t.lineTo(s,o),null==i)i=new b6(s,o,0,0);else{let{x:t,y:e}=i,a=t+i.width,r=e+i.height;i.x=Math.min(t,s),i.y=Math.min(e,o),i.width=Math.max(a,s)-i.x,i.height=Math.max(r,o)-i.y}}return a&&t.closePath(),i}};function ve(t,e){if(null!=t.bbox){let[i,a,s,o]=t.bbox;return e=b1(e,i,a,s,o)}switch(t.type){case"GeometryCollection":t.geometries.forEach(t=>{e=ve(t,e)});break;case"MultiPolygon":t.coordinates.forEach(t=>{t.length>0&&(e=b2(t[0],e))});break;case"Polygon":t.coordinates.length>0&&(e=b2(t.coordinates[0],e));break;case"MultiLineString":t.coordinates.forEach(t=>{e=b2(t,e)});break;case"LineString":e=b2(t.coordinates,e);break;case"MultiPoint":t.coordinates.forEach(t=>{let[i,a]=t;e=b1(e,i,a,i,a)});break;case"Point":{let[i,a]=t.coordinates;e=b1(e,i,a,i,a)}}return e}function vi(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.forEach(t=>{let a=vi(t);if(null==a)return;let s=b2(a[0],void 0);if(null==s)return;let o=Math.abs(s.lat1-s.lat0)*Math.abs(s.lon1-s.lon0);(null==e||o>e)&&(e=o,i=a)}),i}case"MultiPolygon":{let e,i;return t.coordinates.forEach(t=>{let a=b2(t[0],void 0);if(null==a)return;let s=Math.abs(a.lat1-a.lat0)*Math.abs(a.lon1-a.lon0);(null==e||s>e)&&(e=s,i=t)}),i}case"Polygon":return t.coordinates;case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function va(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.forEach(t=>{let a=va(t);if(null==a)return;let s=bq(a);null!=s&&(null==e||s>e)&&(e=s,i=a)}),i}case"MultiLineString":{let e,i=0;return t.coordinates.forEach(t=>{let a=bq(t);a>i&&(i=a,e=t)}),e}case"LineString":return t.coordinates;case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function vs(t,e){if(null==t)return!1;switch(t.type){case"GeometryCollection":return t.geometries.some(t=>vs(t,e));case"MultiPolygon":case"Polygon":return(1&e)!=0;case"MultiLineString":case"LineString":return(2&e)!=0;case"MultiPoint":case"Point":return(4&e)!=0}}function vo(t,e){switch(t.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:t.geometries.map(t=>vo(t,e))};case"Polygon":return{type:"Polygon",coordinates:vr(t.coordinates,e)};case"MultiPolygon":var i,a;return{type:"MultiPolygon",coordinates:(i=t.coordinates,a=e,i.map(t=>vr(t,a)))};case"MultiLineString":return{type:"MultiLineString",coordinates:vr(t.coordinates,e)};case"LineString":return{type:"LineString",coordinates:vn(t.coordinates,e)};case"MultiPoint":return{type:"MultiPoint",coordinates:vn(t.coordinates,e)};case"Point":return{type:"Point",coordinates:e.convert(t.coordinates)}}}function vr(t,e){return t.map(t=>vn(t,e))}function vn(t,e){return t.map(t=>e.convert(t))}function vl(t,e){let i=t.contextNodeData?.nodeData[e.datumIndex];if(void 0!==i){for(let e of t.datumSelection.nodes())if(e.datum===i)return e}}n([b9({equals:b7})],vt.prototype,"projectedGeometry",2),n([b8()],vt.prototype,"renderMode",2),a.n1.SeriesProperties;var vh=class extends a.n1.DataModelSeries{addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",t=>{this.onLegendItemClick(t)}),this.ctx.chartEventManager.addListener("legend-item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}},{Property:vd,SeriesProperties:vc,SeriesTooltip:vp,Label:vu}=a.n1,vg=class extends vc{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new vu,this.tooltip=new vp}};n([vd],vg.prototype,"topology",2),n([vd],vg.prototype,"title",2),n([vd],vg.prototype,"legendItemName",2),n([vd],vg.prototype,"idKey",2),n([vd],vg.prototype,"topologyIdKey",2),n([vd],vg.prototype,"idName",2),n([vd],vg.prototype,"labelKey",2),n([vd],vg.prototype,"labelName",2),n([vd],vg.prototype,"sizeKey",2),n([vd],vg.prototype,"sizeName",2),n([vd],vg.prototype,"colorKey",2),n([vd],vg.prototype,"colorName",2),n([vd],vg.prototype,"sizeDomain",2),n([vd],vg.prototype,"colorRange",2),n([vd],vg.prototype,"maxStrokeWidth",2),n([vd],vg.prototype,"stroke",2),n([vd],vg.prototype,"strokeOpacity",2),n([vd],vg.prototype,"strokeWidth",2),n([vd],vg.prototype,"lineDash",2),n([vd],vg.prototype,"lineDashOffset",2),n([vd],vg.prototype,"itemStyler",2),n([vd],vg.prototype,"label",2),n([vd],vg.prototype,"tooltip",2);var{getMissCount:vy,createDatumId:vf,SeriesNodePickMode:vm,valueProperty:vx,CachedTextMeasurerPool:vb,ColorScale:vv,LinearScale:vS,Selection:vk,Text:vD,Transformable:vM}=a.n1,vw=class extends vh{constructor(t){super({moduleCtx:t,categoryKey:void 0,useLabelLayer:!0,pickModes:[vm.EXACT_SHAPE_MATCH,vm.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new vg,this._chartTopology=void 0,this.colorScale=new vv,this.sizeScale=new vS,this.datumSelection=vk.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=vk.select(this.labelGroup,vD),this.highlightDatumSelection=vk.select(this.highlightNode,()=>this.nodeFactory()),this._previousDatumMidPoint=void 0}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&null!=this.topology}renderToOffscreenCanvas(){return!0}setSeriesIndex(t){return!!super.setSeriesIndex(t)&&(this.contentGroup.zIndex=[1,t],this.highlightGroup.zIndex=[2,t],!0)}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}isLabelEnabled(){return null!=this.properties.labelKey&&this.properties.label.enabled}nodeFactory(){let t=new vt;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t}async processData(t){if(null==this.data)return;let{data:e,topology:i,sizeScale:a,colorScale:o}=this,{topologyIdKey:r,idKey:n,sizeKey:l,colorKey:h,labelKey:d,sizeDomain:c,colorRange:p}=this.properties,u=new Map;i?.features.forEach(t=>{let e=t.properties?.[r];null!=e&&vs(t.geometry,2)&&u.set(e,t)});let g=this.sizeScale.type,y=this.colorScale.type,f=this.scale?.type,{dataModel:m,processedData:x}=await this.requestDataModel(t,e,{props:[vx(n,f,{id:"idValue",includeProperty:!1}),vx(n,f,{id:"featureValue",includeProperty:!1,processor:()=>t=>u.get(t)}),...null!=d?[vx(d,"band",{id:"labelValue"})]:[],...null!=l?[vx(l,g,{id:"sizeValue"})]:[],...null!=h?[vx(h,y,{id:"colorValue"})]:[]]}),b=m.resolveColumnById(this,"featureValue",x);if(this.topologyBounds=b.reduce((t,e)=>{let i=e?.geometry;return null==i?t:ve(i,t)},void 0),null!=l){let t=m.resolveProcessedDataIndexById(this,"sizeValue"),e=x.domain.values[t]??[];a.domain=c??e}if(null!=p&&this.isColorScaleValid()){let t=m.resolveProcessedDataIndexById(this,"colorValue");o.domain=x.domain.values[t],o.range=p,o.update()}null==i&&s.Vy.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){let{colorKey:t}=this.properties;if(!t)return!1;let{dataModel:e,processedData:i}=this;if(!e||!i)return!1;let a=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,o=vy(this,i.defs.values[a].missing);return 0!==s&&s!==o}getLabelDatum(t,e,i,a){if(null==e||null==i)return;let s=va(i);if(null==s)return;let{idKey:o,idName:r,sizeKey:n,sizeName:l,colorKey:h,colorName:d,labelKey:c,labelName:p,label:u}=this.properties,g=this.getLabelText(u,{value:e,datum:t,idKey:o,idName:r,sizeKey:n,sizeName:l,colorKey:h,colorName:d,labelKey:c,labelName:p});if(null==g)return;let y=vb.measureText(String(g),{font:a}),f=bJ(s);if(null==f)return;let[m,x]=f.point,{width:b,height:v}=y;return{point:{x:m,y:x,size:0},label:{width:b,height:v,text:g},anchor:void 0,placement:void 0}}createNodeData(){let{id:t,dataModel:e,processedData:i,sizeScale:a,properties:o,scale:r}=this,{idKey:n,sizeKey:l,colorKey:h,labelKey:d,label:c}=o;if(null==e||null==i)return;let p=e.resolveColumnById(this,"idValue",i),u=e.resolveColumnById(this,"featureValue",i),g=null!=d?e.resolveColumnById(this,"labelValue",i):void 0,y=null!=l?e.resolveColumnById(this,"sizeValue",i):void 0,f=null!=h?e.resolveColumnById(this,"colorValue",i):void 0,m=o.maxStrokeWidth??o.strokeWidth;a.range=[Math.min(o.strokeWidth,m),m];let x=c.getFont(),b=new Map;i.dataSources.get(this.id)?.forEach((t,e)=>{let i=p[e],a=u[e]?.geometry??void 0,s=null!=a&&null!=r?vo(a,r):void 0;null!=i&&null!=s&&b.set(i,s)});let v=[],S=[],k=[];if((i.dataSources.get(this.id)??[]).forEach((t,e)=>{let i=p[e],a=f?.[e],s=y?.[e],o=g?.[e],r=b.get(i);null==r&&k.push(i);let l=this.getLabelDatum(t,o,r,x);null!=l&&S.push(l),v.push({series:this,itemId:n,datum:t,datumIndex:e,idValue:i,labelValue:o,colorValue:a,sizeValue:s,projectedGeometry:r})}),k.length>10){let t=k.length-10;k.length=10,k.push(`(+${t} more)`)}return k.length>0&&s.Vy.warnOnce("some data items do not have matches in the provided topology",k),{itemId:t,nodeData:v,labelData:S}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){let{datumSelection:t,highlightDatumSelection:e}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let i=this.ctx.highlightManager?.getActiveHighlight();null!=i&&(i.series!==this||null==i.datum)&&(i=void 0);let a=this.contextNodeData?.nodeData??[];this.datumSelection=this.updateDatumSelection({nodeData:a,datumSelection:t}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:null!=i?[i]:[],datumSelection:e}),this.updateDatumNodes({datumSelection:e,isHighlight:!0})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>vf(t.idValue))}getItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle.item:void 0;return{stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset}}getItemStyleOverrides(t,e,i,a,s,o){let r,{id:n,properties:l,colorScale:h,sizeScale:d}=this,{colorRange:c,itemStyler:p}=l;if(o||null==i||(r??(r={}),r.stroke=this.isColorScaleValid()?h.convert(i):c?.[0]??l.stroke),null!=a&&(r??(r={}),r.strokeWidth=d.convert(a,{clamp:!0})),null!=p){let i=this.cachedDatumCallback(vf(t,o?"highlight":"node"),()=>this.callWithContext(p,{seriesId:n,datum:e,highlighted:o,...s,...r}));r??(r={}),Object.assign(r,i)}return r}updateDatumNodes(t){let{datumSelection:e,isHighlight:i}=t,a=this.getItemBaseStyle(i);e.each((t,e)=>{let{datum:s,datumIndex:o,colorValue:r,sizeValue:n,projectedGeometry:l}=e;if(null==l){t.visible=!1,t.projectedGeometry=void 0;return}let h=this.getItemStyleOverrides(String(o),s,r,n,a,i);t.visible=!0,t.projectedGeometry=l,t.stroke=h?.stroke??a.stroke,t.strokeWidth=h?.strokeWidth??a.strokeWidth,t.strokeOpacity=h?.strokeOpacity??a.strokeOpacity,t.lineDash=h?.lineDash??a.lineDash,t.lineDashOffset=h?.lineDashOffset??a.lineDashOffset})}updatePlacedLabelData(t){this.labelSelection=this.labelSelection.update(t,t=>{t.pointerEvents=a.n1.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(t){let{labelSelection:e}=t,{color:i,fontStyle:a,fontWeight:s,fontSize:o,fontFamily:r}=this.properties.label;e.each((t,{x:e,y:n,width:l,height:h,text:d})=>{t.visible=!0,t.x=e+l/2,t.y=n+h/2,t.text=d,t.fill=i,t.fontStyle=a,t.fontWeight=s,t.fontSize=o,t.fontFamily=r,t.textAlign="center",t.textBaseline="middle"})}resetAnimation(){}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum({x:t,y:e}){let i,a=1/0;return this.datumSelection.each((s,o)=>{let r=s.distanceSquared(t,e);r<a&&(a=r,i=o)}),null!=i?{datum:i,distance:Math.sqrt(a)}:void 0}datumMidPoint(t){let{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;let i=t.projectedGeometry,a=null!=i?va(i):void 0,s=null!=a?bJ(a)?.point:void 0,o=null!=s?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:o},o}legendItemSymbol(t){let{dataModel:e,processedData:i,properties:a}=this,{strokeWidth:s,strokeOpacity:o,lineDash:r}=a,{stroke:n}=a;if(null!=t&&this.isColorScaleValid()){let a=e.resolveColumnById(this,"colorValue",i)[t];n=this.colorScale.convert(a)}return{marker:{fill:void 0,fillOpacity:0,stroke:void 0,strokeWidth:0,strokeOpacity:0,lineDash:[0],lineDashOffset:0,enabled:!1},line:{stroke:n,strokeWidth:s,strokeOpacity:o,lineDash:r}}}getLegendData(t){let{processedData:e,dataModel:i}=this;if(null==e||null==i)return[];let{id:a,visible:s}=this,{title:o,legendItemName:r,idKey:n,idName:l,colorKey:h,colorName:d,colorRange:c,showInLegend:p}=this.properties;return"gradient"===t&&null!=h&&null!=c?[{legendType:"gradient",enabled:s,seriesId:a,colorName:d,colorRange:c,colorDomain:e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")]}]:"category"===t?[{legendType:"category",id:a,itemId:a,seriesId:a,enabled:s,label:{text:r??o??l??n},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!p}]:[]}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,properties:s}=this,{idKey:o,idName:r,colorKey:n,colorName:l,sizeKey:h,sizeName:d,labelKey:c,labelName:p,title:u,legendItemName:g,tooltip:y}=s;if(!i||!a)return;let f=a.dataSources.get(this.id)?.[t],m=i.resolveColumnById(this,"idValue",a),x=[],b=null!=h?i.resolveColumnById(this,"sizeValue",a)[t]:void 0,v=null!=n?i.resolveColumnById(this,"colorValue",a)[t]:void 0;if(null!=h&&x.push({label:d,fallbackLabel:h,value:String(b)}),null!=n&&x.push({label:l,fallbackLabel:n,value:String(v)}),null!=c&&c!==o){let e=i.resolveColumnById(this,"labelValue",a)[t];x.push({label:p,fallbackLabel:c,value:e})}let S=this.getItemBaseStyle(!1);return Object.assign(S,this.getItemStyleOverrides(String(t),t,v,b,S,!1)),this.formatTooltipWithContext(y,{heading:m[t],title:u??g,symbol:this.legendItemSymbol(t),data:x},{seriesId:e,datum:f,title:u,idKey:o,idName:r,colorKey:n,colorName:l,sizeKey:h,sizeName:d,labelKey:c,labelName:p,...S})}computeFocusBounds(t){let e=vl(this,t);return e?vM.toCanvas(this.contentGroup,e.getBBox()):void 0}};vw.className="MapLineSeries",vw.type="map-line";var{commonSeriesOptionsDefs:vI,mapLineSeriesThemeableOptionsDef:vC,without:vA}=a.n1,vL={...vC,...vA(vI,["highlightStyle"]),type:(0,s.mw)((0,s.dY)("map-line")),idKey:(0,s.mw)(s.Yj),sizeKey:s.Yj,colorKey:s.Yj,labelKey:s.Yj,idName:s.Yj,sizeName:s.Yj,colorName:s.Yj,labelName:s.Yj,topology:s.eW,topologyIdKey:s.Yj,legendItemName:s.Yj,title:s.Yj};vL.colorRange=(0,s._L)((0,s.Uo)((0,s.jk)(s.yW),(0,s.O9)(1)));var vT={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line",moduleFactory:t=>new vw(t),tooltipDefaults:{range:"exact"},themeTemplate:{...bX,series:{stroke:a.n1.SAFE_STROKE_FILL_OPERATION,colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},a.n1.SAFE_RANGE2_OPERATION]},strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},tooltip:{range:"exact"}}},{Property:vN,SeriesProperties:vO,SeriesTooltip:vP}=a.n1,vE=class extends vO{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new vP}};n([vN],vE.prototype,"topology",2),n([vN],vE.prototype,"stroke",2),n([vN],vE.prototype,"strokeOpacity",2),n([vN],vE.prototype,"strokeWidth",2),n([vN],vE.prototype,"lineDash",2),n([vN],vE.prototype,"lineDashOffset",2),n([vN],vE.prototype,"tooltip",2);var{createDatumId:vR,SeriesNodePickMode:vB,Group:vz,Selection:vF,PointerEvents:v_}=a.n1,vW=class extends vh{constructor(t){super({moduleCtx:t,categoryKey:void 0,useLabelLayer:!0,pickModes:[vB.EXACT_SHAPE_MATCH]}),this.properties=new vE,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new vz({name:"itemGroup"})),this.datumSelection=vF.select(this.itemGroup,()=>this.nodeFactory())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setSeriesIndex(t){return!!super.setSeriesIndex(t)&&(this.contentGroup.zIndex=[0,t,0],this.highlightGroup.zIndex=[0,t,1],!0)}nodeFactory(){let t=new vt;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t.pointerEvents=v_.None,t}processData(){let{topology:t}=this;this.topologyBounds=t?.features.reduce((t,e)=>{let i=e.geometry;return null==i?t:ve(i,t)},void 0),null==t&&s.Vy.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){let{id:t,topology:e,scale:i}=this;if(null==e)return;let a=[];return e.features.forEach((t,e)=>{let{geometry:s}=t,o=null!=s&&null!=i?vo(s,i):void 0;null!=o&&a.push({series:this,itemId:e,datum:t,datumIndex:0,index:e,projectedGeometry:o})}),{itemId:t,nodeData:a,labelData:[]}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){let{datumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible;let{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:e,datumSelection:t}),this.updateDatumNodes({datumSelection:t})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>vR(t.index))}updateDatumNodes(t){let{properties:e}=this,{datumSelection:i}=t,{stroke:a,strokeOpacity:s,lineDash:o,lineDashOffset:r}=e,n=this.getStrokeWidth(e.strokeWidth);i.each((t,e)=>{let{projectedGeometry:i}=e;if(null==i){t.visible=!1,t.projectedGeometry=void 0;return}t.visible=!0,t.projectedGeometry=i,t.stroke=a,t.strokeWidth=n,t.strokeOpacity=s,t.lineDash=o,t.lineDashOffset=r})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(t){}computeFocusBounds(t){}};vW.className="MapLineBackgroundSeries",vW.type="map-line-background";var{mapLineBackgroundSeriesThemeableOptionsDef:vG}=a.n1,vj={...vG,type:(0,s.mw)((0,s.dY)("map-line-background")),topology:s.eW},vV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line-background",moduleFactory:t=>new vW(t),tooltipDefaults:{range:"exact"},themeTemplate:{...bX,series:{stroke:{$path:["./1",{$palette:"stroke"},{$palette:"secondHierarchyColors"}]},strokeWidth:1,lineDash:[0],lineDashOffset:0}}},v$=(t,e,i)=>{let a=t,s=a;for(let t of e)if(null==a||i(a.value,t)>0)s=a={value:t,next:a};else{for(;null!=s.next&&0>=i(s.next.value,t);)s=s.next;s.next={value:t,next:s.next}}return a};function vH(t,e,i){let a,s=b2(t[0],void 0);if(null==s)return;let o=(s.lon0+s.lon1)/2,r=(s.lat0+s.lat1)/2,n=Math.abs(s.lon1-s.lon0),l=Math.abs(s.lat1-s.lat0),[h,d]=function(t){if(0===t.length)return;let e=0,i=0,a=0,[s,o]=t[t.length-1];for(let[r,n]of t){let t=s*n-r*o;a+=t,e+=(s+r)*t,i+=(o+n)*t,s=r,o=n}return[e/(a*=3),i/a]}(t[0]),c=-b4(t,h,d),p=(t,e)=>t-.5*Math.max(e-c,0),u=(e,a,s)=>{let{distance:o,maxDistance:r}=i(t,e,a,s),n=Math.hypot(h-e,d-a),l=Math.min(Math.max(h,e-s/2),e+s/2),c=Math.min(Math.max(d,a-s/2),a+s/2),u=Math.hypot(h-l,d-c),g=p(o,n),y=p(r,u);return{distance:o,maxDistance:r,value:g,maxValue:y,x:e,y:a,stride:s}},g=(t,e,i,a)=>{let s=u(e,i,a);s.maxDistance>=0&&t.push(s)},y={value:u(o,r,Math.min(n,l)/2),next:null};for(;null!=y;){let t=y.value,{distance:i,value:s,maxValue:o,x:r,y:n,stride:l}=t;if(y=y.next,i>0&&(null==a||s>a.value)&&(a=t),null!=a&&o-a.value<=e)continue;let h=l/2,d=[];g(d,r-h,n-h,h),g(d,r+h,n-h,h),g(d,r-h,n+h,h),g(d,r+h,n+h,h),d.sort(vY),y=v$(y,d,vY)}if(null==a)return;let{distance:f,x:m,y:x}=a;return{x:m,y:x,distance:f}}var vY=(t,e)=>e.maxValue-t.maxValue;function vK(t,e){let i=vH(t,e,(t,e,i,a)=>{let s=-b4(t,e,i),o=s+a*Math.SQRT2;return{distance:s,maxDistance:o}});if(null==i)return;let{x:a,y:s}=i;return[a,s]}var{BBox:vU}=a.n1;function vX(t){if(!t)return;let{range:e}=t,i=e[0][0],a=e[0][1],s=e[1][0]-i,o=e[1][1]-a,r=new vU(i,a,s,o);return{series:r,axis:r}}var{FillGradientDefaults:vZ,FillPatternDefaults:vQ,FillImageDefaults:vq,Property:vJ,SeriesProperties:v0,SeriesTooltip:v1,Label:v2}=a.n1,v4=class extends v2{constructor(){super(...arguments),this.placement="bottom"}};n([vJ],v4.prototype,"placement",2);var v5=class extends v0{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape="circle",this.size=6,this.fill="black",this.fillGradientDefaults=new vZ,this.fillPatternDefaults=new vQ,this.fillImageDefaults=new vq,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new v4,this.tooltip=new v1}};n([vJ],v5.prototype,"topology",2),n([vJ],v5.prototype,"title",2),n([vJ],v5.prototype,"legendItemName",2),n([vJ],v5.prototype,"idKey",2),n([vJ],v5.prototype,"topologyIdKey",2),n([vJ],v5.prototype,"idName",2),n([vJ],v5.prototype,"latitudeKey",2),n([vJ],v5.prototype,"latitudeName",2),n([vJ],v5.prototype,"longitudeKey",2),n([vJ],v5.prototype,"longitudeName",2),n([vJ],v5.prototype,"labelKey",2),n([vJ],v5.prototype,"labelName",2),n([vJ],v5.prototype,"sizeKey",2),n([vJ],v5.prototype,"sizeName",2),n([vJ],v5.prototype,"colorKey",2),n([vJ],v5.prototype,"colorName",2),n([vJ],v5.prototype,"colorRange",2),n([vJ],v5.prototype,"shape",2),n([vJ],v5.prototype,"size",2),n([vJ],v5.prototype,"maxSize",2),n([vJ],v5.prototype,"sizeDomain",2),n([vJ],v5.prototype,"fill",2),n([vJ],v5.prototype,"fillGradientDefaults",2),n([vJ],v5.prototype,"fillPatternDefaults",2),n([vJ],v5.prototype,"fillImageDefaults",2),n([vJ],v5.prototype,"fillOpacity",2),n([vJ],v5.prototype,"stroke",2),n([vJ],v5.prototype,"strokeWidth",2),n([vJ],v5.prototype,"strokeOpacity",2),n([vJ],v5.prototype,"lineDash",2),n([vJ],v5.prototype,"lineDashOffset",2),n([vJ],v5.prototype,"itemStyler",2),n([vJ],v5.prototype,"label",2),n([vJ],v5.prototype,"tooltip",2);var{CachedTextMeasurerPool:v3,fromToMotion:v6,StateMachine:v8,getMissCount:v9,createDatumId:v7,SeriesNodePickMode:St,valueProperty:Se,computeMarkerFocusBounds:Si,ColorScale:Sa,LinearScale:Ss,Group:So,Selection:Sr,Text:Sn,Marker:Sl,applyShapeStyle:Sh,getShapeStyle:Sd}=a.n1,Sc=class extends vh{constructor(t){super({moduleCtx:t,categoryKey:void 0,useLabelLayer:!0,pickModes:[St.EXACT_SHAPE_MATCH,St.NEAREST_NODE],usesPlacedLabels:!0}),this.properties=new v5,this._chartTopology=void 0,this.colorScale=new Sa,this.sizeScale=new Ss,this.markerGroup=this.contentGroup.appendChild(new So({name:"markerGroup"})),this.labelSelection=Sr.select(this.labelGroup,Sn,!1),this.markerSelection=Sr.select(this.markerGroup,Sl,!1),this.highlightMarkerSelection=Sr.select(this.highlightNode,Sl),this.animationState=new v8("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){let t=null!=this.properties.latitudeKey&&null!=this.properties.longitudeKey;return super.hasData&&(null!=this.topology||t)}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setSeriesIndex(t){return!!super.setSeriesIndex(t)&&(this.contentGroup.zIndex=[3,t],this.highlightGroup.zIndex=[4,t],!0)}isLabelEnabled(){return null!=this.properties.labelKey&&this.properties.label.enabled}async processData(t){if(null==this.data)return;let{data:e,topology:i,sizeScale:a,colorScale:s}=this,{topologyIdKey:o,idKey:r,latitudeKey:n,longitudeKey:l,sizeKey:h,colorKey:d,labelKey:c,sizeDomain:p,colorRange:u}=this.properties,g=new Map;i?.features.forEach(t=>{let e=t.properties?.[o];null!=e&&g.set(e,t)});let y=this.sizeScale.type,f=this.colorScale.type,m=this.scale?.type,x=null!=n&&null!=l,{dataModel:b,processedData:v}=await this.requestDataModel(t,e,{props:[...null!=r?[Se(r,m,{id:"idValue",includeProperty:!1}),Se(r,m,{id:"featureValue",includeProperty:!1,processor:()=>t=>g.get(t)})]:[],...x?[Se(n,m,{id:"latValue"}),Se(l,m,{id:"lonValue"})]:[],...c?[Se(c,"band",{id:"labelValue"})]:[],...h?[Se(h,y,{id:"sizeValue"})]:[],...d?[Se(d,f,{id:"colorValue"})]:[]]}),S=null!=r?b.resolveColumnById(this,"featureValue",v):void 0,k=x?b.resolveColumnById(this,"latValue",v):void 0,D=x?b.resolveColumnById(this,"lonValue",v):void 0;if(this.topologyBounds=v.dataSources.get(this.id)?.reduce((t,e,i)=>{let a=S?.[i],s=a?.geometry;if(null!=s&&(t=ve(s,t)),null!=k&&null!=D){let e=D[i],a=k[i];t=b1(t,e,a,e,a)}return t},void 0),null!=h){let t=b.resolveProcessedDataIndexById(this,"sizeValue"),e=v.domain.values[t]??[];a.domain=p??e}if(null!=u&&this.isColorScaleValid()){let t=b.resolveProcessedDataIndexById(this,"colorValue");s.domain=v.domain.values[t],s.range=u,s.update()}this.animationState.transition("updateData")}isColorScaleValid(){let{colorKey:t}=this.properties;if(!t)return!1;let{dataModel:e,processedData:i}=this;if(!e||!i)return!1;let a=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,o=v9(this,i.defs.values[a].missing);return 0!==s&&s!==o}getLabelDatum(t,e,i,a,s,o){if(null==e)return;let{idKey:r,idName:n,latitudeKey:l,latitudeName:h,longitudeKey:d,longitudeName:c,sizeKey:p,sizeName:u,colorKey:g,colorName:y,labelKey:f,labelName:m,label:x,shape:b}=this.properties,{placement:v}=x,S=this.getLabelText(x,{value:e,datum:t,idKey:r,idName:n,latitudeKey:l,latitudeName:h,longitudeKey:d,longitudeName:c,sizeKey:p,sizeName:u,colorKey:g,colorName:y,labelKey:f,labelName:m});if(null==S)return;let{width:k,height:D}=v3.measureText(String(S),{font:o});return{point:{x:i,y:a,size:s},label:{width:k,height:D,text:S},anchor:Sl.anchor(b),placement:v}}createNodeData(){let t,{id:e,dataModel:i,processedData:a,sizeScale:o,properties:r,scale:n}=this,{idKey:l,latitudeKey:h,longitudeKey:d,sizeKey:c,colorKey:p,labelKey:u,label:g}=r;if(null==i||null==a||null==n)return;let y=null!=h&&null!=d,f=null!=l?i.resolveColumnById(this,"idValue",a):void 0,m=null!=l?i.resolveColumnById(this,"featureValue",a):void 0,x=y?i.resolveColumnById(this,"latValue",a):void 0,b=y?i.resolveColumnById(this,"lonValue",a):void 0,v=null!=u?i.resolveColumnById(this,"labelValue",a):void 0,S=null!=c?i.resolveColumnById(this,"sizeValue",a):void 0,k=null!=p?i.resolveColumnById(this,"colorValue",a):void 0,D=r.maxSize??r.size;o.range=[Math.min(r.size,D),D];let M=g.getFont();null!=f&&null!=m&&(t=new Map,a.dataSources.get(this.id)?.forEach((e,i)=>{let a=f[i],s=m[i]?.geometry??void 0,o=null!=s&&null!=n?vo(s,n):void 0;null!=a&&null!=o&&t.set(a,o)}));let w=[],I=[],C=[];if((a.dataSources.get(this.id)??[]).forEach((e,i)=>{let a=f?.[i],s=b?.[i],l=x?.[i],d=k?.[i],c=S?.[i],p=v?.[i],u=null!=c?o.convert(c,{clamp:!0}):r.size,g=null!=a?t?.get(a):void 0;if(null!=a&&null==vo&&C.push(a),null!=s&&null!=l){let[t,o]=n.convert([s,l]),r=this.getLabelDatum(e,p,t,o,u,M);r&&I.push(r),w.push({series:this,itemId:h,datum:e,datumIndex:i,index:-1,idValue:a,lonValue:s,latValue:l,labelValue:p,sizeValue:c,colorValue:d,point:{x:t,y:o,size:u},midPoint:{x:t,y:o}})}else null!=g&&(function t(e,i){let a;switch(e.type){case"GeometryCollection":return e.geometries.flatMap(e=>t(e,i));case"MultiPoint":return e.coordinates;case"Point":return[e.coordinates];case"MultiPolygon":{let t=vi(e);a=null!=t?vK(t,i):void 0;break}case"Polygon":{let t=e.coordinates;a=null!=t?vK(t,i):void 0;break}case"MultiLineString":{let t=va(e);a=null!=t?bJ(t)?.point:void 0;break}case"LineString":{let t=e.coordinates;a=bJ(t)?.point}}return null!=a?[a]:[]})(g,1).forEach(([t,o],r)=>{let n=this.getLabelDatum(e,p,t,o,u,M);n&&I.push(n),w.push({series:this,itemId:h,datum:e,datumIndex:i,index:r,idValue:a,lonValue:s,latValue:l,labelValue:p,sizeValue:c,colorValue:d,point:{x:t,y:o,size:u},midPoint:{x:t,y:o}})})}),C.length>10){let t=C.length-10;C.length=10,C.push(`(+${t} more)`)}return C.length>0&&s.Vy.warnOnce("some data items do not have matches in the provided topology",C),{itemId:e,nodeData:w,labelData:I}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale!==this.scale&&(this.previousScale=this.scale,!0)}update({seriesRect:t}){let e=this.checkResize(t),i=this.checkScaleChange(),{markerSelection:a,highlightMarkerSelection:s}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let o=this.ctx.highlightManager?.getActiveHighlight();null!=o&&(o.series!==this||null==o.datum)&&(o=void 0);let r=this.contextNodeData?.nodeData??[];this.markerSelection=this.updateMarkerSelection({markerData:r,markerSelection:a}),this.updateMarkerNodes({markerSelection:a,isHighlight:!1,highlightedDatum:o}),this.highlightMarkerSelection=this.updateMarkerSelection({markerData:null!=o?[o]:[],markerSelection:s}),this.updateMarkerNodes({markerSelection:s,isHighlight:!0,highlightedDatum:o}),(i||e)&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePlacedLabelData(t){this.labelSelection=this.labelSelection.update(t,t=>{t.pointerEvents=a.n1.PointerEvents.None}),this.updateLabelNodes({labelSelection:this.labelSelection})}updateLabelNodes(t){let{labelSelection:e}=t,{color:i,fontStyle:a,fontWeight:s,fontSize:o,fontFamily:r}=this.properties.label;e.each((t,{x:e,y:n,width:l,height:h,text:d})=>{t.visible=!0,t.x=e+l/2,t.y=n+h/2,t.text=d,t.fill=i,t.fontStyle=a,t.fontWeight=s,t.fontSize=o,t.fontFamily=r,t.textAlign="center",t.textBaseline="middle"})}updateMarkerSelection(t){let{markerData:e,markerSelection:i}=t;return i.update(e,void 0,t=>v7([t.index,t.idValue,t.lonValue,t.latValue]))}getMarkerItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle.item:void 0;return Sd({shape:e.shape,size:e.size,fill:i?.fill??e.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getMarkerItemStyleOverrides(t,e,i,a,s,o){let r,{id:n,properties:l,colorScale:h,sizeScale:d}=this,{colorRange:c,itemStyler:p}=l;if(r??(r={}),o||null==i||(r.fill=this.isColorScaleValid()?h.convert(i):c?.[0]??l.fill),null!=a&&(r.size=d.convert(a,{clamp:!0})),null!=p){let i=this.cachedDatumCallback(v7(t,o?"highlight":"node"),()=>this.callWithContext(p,{seriesId:n,datum:e,highlighted:o,...s,...r}));r??(r={}),Object.assign(r,i)}return r}updateMarkerNodes(t){let{markerSelection:e,isHighlight:i,highlightedDatum:a}=t,s=this.getMarkerItemBaseStyle(i),o=vX(this.scale);e.each((t,e)=>{let{datumIndex:r,datum:n,point:l,colorValue:h,sizeValue:d}=e,c=this.getMarkerItemStyleOverrides(String(r),n,h,d,s,i);t.shape=c?.shape??s.shape,t.size=c?.size??s.size,Sh(t,s,c,o),t.x=l.x,t.y=l.y,t.scalingCenterX=l.x,t.scalingCenterY=l.y,t.zIndex=+(!i&&null!=a&&n===a.datum)})}isProcessedDataAnimatable(){return!0}resetAnimation(t){"initial"===t?this.animationState.transition("reset"):"ready"===t&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup()}animateMarkers(){let{animationManager:t}=this.ctx;v6(this.id,"markers",t,[this.markerSelection,this.highlightMarkerSelection],{fromFn:(t,e,i)=>"removed"===i?{scalingX:1,scalingY:1}:null==t.previousDatum?{scalingX:0,scalingY:0}:{scalingX:t.scalingX,scalingY:t.scalingY},toFn:(t,e,i)=>"removed"===i?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}})}getLabelData(){return this.isLabelEnabled()?this.contextNodeData?.labelData??[]:[]}pickNodeClosestDatum(t){let e,{x:i,y:a}=t,s=1/0;return this.contextNodeData?.nodeData.forEach(t=>{let{x:o,y:r,size:n}=t.point,l=Math.max(Math.abs(o-i)-n,0),h=Math.max(Math.abs(r-a)-n,0),d=l*l+h*h;d<s&&(s=d,e=t)}),null!=e?{datum:e,distance:Math.sqrt(s)}:void 0}legendItemSymbol(t){let{dataModel:e,processedData:i,properties:a}=this,{shape:s,fillOpacity:o,stroke:r,strokeWidth:n,strokeOpacity:l,lineDash:h,lineDashOffset:d}=a,{fill:c}=a;if(null!=t&&this.isColorScaleValid()){let a=e.resolveColumnById(this,"colorValue",i)[t];c=this.colorScale.convert(a)}return{marker:Sd({shape:s,fill:c,fillOpacity:o,stroke:r,strokeWidth:n,strokeOpacity:l,lineDash:h,lineDashOffset:d},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}}getLegendData(t){let{processedData:e,dataModel:i}=this;if(null==e||null==i)return[];let{id:a,visible:s}=this,{title:o,legendItemName:r,idName:n,idKey:l,colorKey:h,colorName:d,colorRange:c,showInLegend:p}=this.properties;return"gradient"===t&&null!=h&&null!=c?[{legendType:"gradient",enabled:s,seriesId:a,colorName:d,colorRange:c,colorDomain:e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")]}]:"category"===t?[{legendType:"category",id:a,itemId:a,seriesId:a,enabled:s,label:{text:r??o??n??l??a},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!p}]:[]}getTooltipContent(t){let e,{id:i,dataModel:a,processedData:s,properties:o}=this,{idKey:r,idName:n,latitudeKey:l,latitudeName:h,longitudeKey:d,longitudeName:c,colorKey:p,colorName:u,sizeKey:g,sizeName:y,labelKey:f,labelName:m,title:x,legendItemName:b,tooltip:v}=o;if(!a||!s)return;let S=s.dataSources.get(this.id)?.[t],k=null!=g?a.resolveColumnById(this,"sizeValue",s)[t]:void 0,D=null!=p?a.resolveColumnById(this,"colorValue",s)[t]:void 0,M=[];if(null!=k&&M.push({label:y,fallbackLabel:g,value:String(k)}),null!=D&&M.push({label:u,fallbackLabel:p,value:String(D)}),null!=f&&f!==r){let e=a.resolveColumnById(this,"labelValue",s)[t];M.push({label:m,fallbackLabel:f,value:e})}if(null!=r)e=a.resolveColumnById(this,"idValue",s)[t];else if(null!=l&&null!=d){let i=a.resolveColumnById(this,"latValue",s)[t],o=a.resolveColumnById(this,"lonValue",s)[t];e=`${Math.abs(i).toFixed(4)}\xb0 ${i>=0?"N":"S"}, ${Math.abs(o).toFixed(4)}\xb0 ${o>=0?"W":"E"}`}let w=this.getMarkerItemBaseStyle(!1);return Object.assign(w,this.getMarkerItemStyleOverrides(String(t),t,D,k,w,!1)),this.formatTooltipWithContext(v,{heading:e,title:x??b,symbol:this.legendItemSymbol(t),data:M},{seriesId:i,datum:S,title:x,idKey:r,idName:n,latitudeKey:l,latitudeName:h,longitudeKey:d,longitudeName:c,colorKey:p,colorName:u,sizeKey:g,sizeName:y,labelKey:f,labelName:m,...w})}getFormattedMarkerStyle(t){let{datumIndex:e,colorValue:i,sizeValue:a}=t,s=this.getMarkerItemBaseStyle(!1);return Object.assign(s,this.getMarkerItemStyleOverrides(String(e),e,i,a,s,!1)),{size:s.size}}computeFocusBounds(t){return Si(this,t)}};Sc.className="MapMarkerSeries",Sc.type="map-marker";var{commonSeriesOptionsDefs:Sp,mapMarkerSeriesThemeableOptionsDef:Su,without:Sg}=a.n1,Sy={...Su,...Sg(Sp,["highlightStyle"]),type:(0,s.mw)((0,s.dY)("map-marker")),idKey:s.Yj,latitudeKey:s.Yj,longitudeKey:s.Yj,sizeKey:s.Yj,colorKey:s.Yj,labelKey:s.Yj,idName:s.Yj,latitudeName:s.Yj,longitudeName:s.Yj,sizeName:s.Yj,colorName:s.Yj,labelName:s.Yj,topology:s.eW,topologyIdKey:s.Yj,legendItemName:s.Yj,title:s.Yj},Sf={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-marker",moduleFactory:t=>new Sc(t),tooltipDefaults:{range:"exact"},themeTemplate:{...bX,series:{shape:"circle",maxSize:30,fill:{$palette:"fill"},stroke:{$palette:"stroke"},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},a.n1.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,fillOpacity:.5,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},tooltip:{range:"exact"}}};function Sm(t,e,i){i>=e&&(t.maxX=Math.min(t.maxX,i-e)),i<=e&&(t.minX=Math.max(t.minX,i-e))}var{Property:Sx,SeriesProperties:Sb,SeriesTooltip:Sv,FillGradientDefaults:SS,FillPatternDefaults:Sk,FillImageDefaults:SD}=a.n1,SM=class extends Sb{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillGradientDefaults=new SS,this.fillPatternDefaults=new Sk,this.fillImageDefaults=new SD,this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new ub,this.tooltip=new Sv}};n([Sx],SM.prototype,"topology",2),n([Sx],SM.prototype,"title",2),n([Sx],SM.prototype,"legendItemName",2),n([Sx],SM.prototype,"idKey",2),n([Sx],SM.prototype,"idName",2),n([Sx],SM.prototype,"topologyIdKey",2),n([Sx],SM.prototype,"labelKey",2),n([Sx],SM.prototype,"labelName",2),n([Sx],SM.prototype,"colorKey",2),n([Sx],SM.prototype,"colorName",2),n([Sx],SM.prototype,"colorRange",2),n([Sx],SM.prototype,"fill",2),n([Sx],SM.prototype,"fillGradientDefaults",2),n([Sx],SM.prototype,"fillPatternDefaults",2),n([Sx],SM.prototype,"fillImageDefaults",2),n([Sx],SM.prototype,"fillOpacity",2),n([Sx],SM.prototype,"stroke",2),n([Sx],SM.prototype,"strokeOpacity",2),n([Sx],SM.prototype,"strokeWidth",2),n([Sx],SM.prototype,"lineDash",2),n([Sx],SM.prototype,"lineDashOffset",2),n([Sx],SM.prototype,"padding",2),n([Sx],SM.prototype,"itemStyler",2),n([Sx],SM.prototype,"label",2),n([Sx],SM.prototype,"tooltip",2);var{getMissCount:Sw,createDatumId:SI,SeriesNodePickMode:SC,valueProperty:SA,CachedTextMeasurerPool:SL,TextUtils:ST,ColorScale:SN,Group:SO,Selection:SP,Text:SE,PointerEvents:SR,applyShapeStyle:SB,getShapeStyle:Sz}=a.n1,SF=a.n1.MercatorScale.fixedScale(),S_=class extends vh{constructor(t){super({moduleCtx:t,categoryKey:void 0,useLabelLayer:!0,pickModes:[SC.EXACT_SHAPE_MATCH,SC.NEAREST_NODE]}),this.properties=new SM,this._chartTopology=void 0,this.colorScale=new SN,this.itemGroup=this.contentGroup.appendChild(new SO({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new SO({name:"itemLabelGroup"})),this.datumSelection=SP.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=SP.select(this.itemLabelGroup,SE),this.highlightDatumSelection=SP.select(this.highlightNode,()=>this.nodeFactory()),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=SR.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&null!=this.topology}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setSeriesIndex(t){return!!super.setSeriesIndex(t)&&(this.contentGroup.zIndex=[1,t],this.highlightGroup.zIndex=[2,t],!0)}isLabelEnabled(){return null!=this.properties.labelKey&&this.properties.label.enabled}nodeFactory(){let t=new vt;return t.renderMode=1,t.lineJoin="round",t}async processData(t){if(null==this.data)return;let{data:e,topology:i,colorScale:a}=this,{topologyIdKey:o,idKey:r,colorKey:n,labelKey:l,colorRange:h}=this.properties,d=new Map;i?.features.forEach(t=>{let e=t.properties?.[o];null!=e&&vs(t.geometry,1)&&d.set(e,t)});let c=this.colorScale.type,p=this.scale?.type,{dataModel:u,processedData:g}=await this.requestDataModel(t,e,{props:[SA(r,p,{id:"idValue",includeProperty:!1}),SA(r,p,{id:"featureValue",includeProperty:!1,processor:()=>t=>d.get(t)}),...l?[SA(l,"band",{id:"labelValue"})]:[],...n?[SA(n,c,{id:"colorValue"})]:[]]}),y=u.resolveColumnById(this,"featureValue",g);if(this.topologyBounds=y.reduce((t,e)=>{let i=e?.geometry;return null==i?t:ve(i,t)},void 0),null!=h&&this.isColorScaleValid()){let t=u.resolveProcessedDataIndexById(this,"colorValue");a.domain=g.domain.values[t],a.range=h,a.update()}null==i&&s.Vy.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){let{colorKey:t}=this.properties;if(!t)return!1;let{dataModel:e,processedData:i}=this;if(!e||!i)return!1;let a=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.input.count,o=Sw(this,i.defs.values[a].missing);return 0!==s&&s!==o}getLabelLayout(t,e,i,a,s){if(null==e||null==a)return;let{idKey:o,idName:r,colorKey:n,colorName:l,labelKey:h,labelName:d,padding:c,label:p}=this.properties,u=this.getLabelText(p,{value:e,datum:t,idKey:o,idName:r,colorKey:n,colorName:l,labelKey:h,labelName:d});if(null==u)return;let g=SL.measureText(String(u),{font:i}),y=u.split("\n").length,f=(g.width+2*c)/(y*ST.getLineHeight(p.fontSize)+2*c);if(s?.geometry===a&&s?.labelText===u&&s?.aspectRatio===f)return s;let m=vi(vo(a,SF));if(null==m)return;let x=function(t,{aspectRatio:e,precision:i}){let a=vH(t,i,(t,i,a,s)=>{let o=function(t,e,i,a){let s=!1,o=1/0;for(let r of t){let t=r[r.length-1],[n,l]=t;for(let h of r){let[r,d]=h;d>i!=l>i&&e<(n-r)*(i-d)/(l-d)+r&&(s=!s),o=Math.min(o,function(t,e,i,a,s){let[o,r]=t,[n,l]=e,h=1/s,d=n-o,[c,p]=r<=l?t:e,[u,g]=o<=n?t:e,[y,f]=r<=l?e:t,[m,x]=o<=n?e:t,b=1/0;if(0!==d){let t=(l-r)/d;for(let e=0;e<=1;e+=1){let s=0===e?h:-h,n=(t*o-r-s*i+a)/(t-s);n>=u&&n<=m&&(b=Math.min(b,2*Math.abs(i-n)))}}else for(let t=0;t<=1;t+=1){let e=(0===t?h:-h)*(o-i)+a;e>=p&&e<=f&&(b=Math.min(b,2*Math.abs(a-e)*s))}let v=Math.abs((c-i)/(p-a)),S=Math.abs((y-i)/(f-a));f<a&&S<s?b=Math.min(b,2*Math.abs(a-f)*s):p>a&&v<s&&(b=Math.min(b,2*Math.abs(a-p)*s));let k=Math.abs((g-a)/(u-i)),D=Math.abs((x-a)/(m-i));return m<i&&D<h?b=Math.min(b,2*Math.abs(i-m)):u>i&&k<h&&(b=Math.min(b,2*Math.abs(i-u))),b}(t,h,e,i,a)),t=h,n=r,l=d}}return(s?1:-1)*o}(t,i,a,e),r=o+2*s*e;return{distance:o*Math.SQRT2,maxDistance:r*Math.SQRT2}});if(null==a)return;let{x:s,y:o,distance:r}=a;return{x:s,y:o,maxWidth:r/Math.SQRT2}}(m,{aspectRatio:f,precision:.001});if(null==x)return;let{x:b,y:v,maxWidth:S}=x;return{geometry:a,labelText:u,aspectRatio:f,x:b,y:v,maxWidth:S,fixedPolygon:m}}getLabelDatum(t,e){let{scale:i}=this;if(null==i)return;let{padding:a,label:s}=this.properties,{labelText:o,aspectRatio:r,x:n,y:l,maxWidth:h,fixedPolygon:d}=t,c={width:Math.ceil(h*e),height:Math.ceil(h*e/r),meta:n},p=up(o,s,{padding:a},(t,i)=>{if(!i)return c;let a=function(t,e,i,a){let s={minX:-1/0,maxX:1/0};for(let o of t){let t=o[o.length-1];for(let r of o)!function(t,e,i,a,s,o){let r=s-o/2,n=s+o/2,[l,h]=e,[d,c]=i,p=d-l,[u,g]=l<=d?e:i,[y,f]=l<=d?i:e;if(0!==p){let e=(c-h)/p;for(let i=0;i<=1;i+=1){let s=((0===i?r:n)-h)/e+l;s>=u&&s<=y&&Sm(t,a,s)}}else Math.max(r,Math.min(h,c))<=Math.min(n,Math.max(h,c))&&Sm(t,a,l);y<a&&f>=r&&f<=n?Sm(t,a,y):u>a&&g>=r&&g<=n&&Sm(t,a,u)}(s,t,r,e,i,a),t=r}let{minX:o,maxX:r}=s;return Number.isFinite(o)&&Number.isFinite(r)?{x:e+(o+r)/2,width:r-o}:{x:e,width:0}}(d,n,l,t/e);return{width:a.width*e,height:t,meta:a.x}});if(null==p)return;let[{text:u,fontSize:g,lineHeight:y,width:f},m]=p;if(u===ST.EllipsisChar)return;let x=f<c.width?n:m,b=this.scale.convert(SF.invert([x,l]));return{x:b[0],y:b[1],text:u,fontSize:g,lineHeight:y}}createNodeData(){let{id:t,dataModel:e,processedData:i,properties:a,scale:o,previousLabelLayouts:r}=this,{idKey:n,colorKey:l,labelKey:h,label:d}=a;if(null==e||null==i)return;let c=null!=o?(o.range[1][0]-o.range[0][0])/o.bounds.width:NaN,p=e.resolveColumnById(this,"idValue",i),u=e.resolveColumnById(this,"featureValue",i),g=null!=h?e.resolveColumnById(this,"labelValue",i):void 0,y=null!=l?e.resolveColumnById(this,"colorValue",i):void 0,f=d.getFont(),m=new Map;this.previousLabelLayouts=m;let x=[],b=[],v=[];if((i.dataSources.get(this.id)??[]).forEach((t,e)=>{let i=p[e],a=y?.[e],s=g?.[e],l=u[e]?.geometry??void 0;null==l&&v.push(i);let h=this.getLabelLayout(t,s,f,l,r?.get(i));null!=h&&m.set(i,h);let d=null!=h&&null!=o?this.getLabelDatum(h,c):void 0;null!=d&&b.push(d);let S=null!=l&&null!=o?vo(l,o):void 0;x.push({series:this,itemId:n,datum:t,datumIndex:e,idValue:i,colorValue:a,labelValue:s,projectedGeometry:S})}),v.length>10){let t=v.length-10;v.length=10,v.push(`(+${t} more)`)}return v.length>0&&s.Vy.warnOnce("some data items do not have matches in the provided topology",v),{itemId:t,nodeData:x,labelData:b}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){let{datumSelection:t,labelSelection:e,highlightDatumSelection:i}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=this.ctx.highlightManager?.getActiveHighlight();null!=a&&(a.series!==this||null==a.datum)&&(a=void 0);let s=this.contextNodeData?.nodeData??[],o=this.contextNodeData?.labelData??[];this.datumSelection=this.updateDatumSelection({nodeData:s,datumSelection:t}),this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:o,labelSelection:e}),this.updateLabelNodes({labelSelection:e}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:null!=a?[a]:[],datumSelection:i}),this.updateDatumNodes({datumSelection:i,isHighlight:!0})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>SI(t.idValue))}getItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle.item:void 0;return Sz({fill:i?.fill??e.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getItemStyleOverrides(t,e,i,a,s){let o,{id:r,properties:n,colorScale:l}=this,{colorRange:h,itemStyler:d}=n;if(s||null==i||(o??(o={}),o.fill=this.isColorScaleValid()?l.convert(i):h?.[0]??n.fill),null!=d){let i=this.cachedDatumCallback(SI(t,s?"highlight":"node"),()=>this.callWithContext(d,{seriesId:r,datum:e,highlighted:s,...a,...o}));o??(o={}),Object.assign(o,i)}return Sz(o,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateDatumNodes(t){let{datumSelection:e,isHighlight:i}=t,a=this.getItemBaseStyle(i),s=vX(this.scale);e.each((t,e)=>{let{datum:o,datumIndex:r,colorValue:n,projectedGeometry:l}=e;if(null==l){t.visible=!1,t.projectedGeometry=void 0;return}let h=this.getItemStyleOverrides(String(r),o,n,a,i);t.visible=!0,t.projectedGeometry=l,SB(t,a,h,s)})}updateLabelSelection(t){let e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){let{labelSelection:e}=t,{color:i,fontStyle:a,fontWeight:s,fontFamily:o}=this.properties.label;e.each((t,{x:e,y:r,text:n,fontSize:l,lineHeight:h})=>{t.visible=!0,t.x=e,t.y=r,t.text=n,t.fill=i,t.fontStyle=a,t.fontWeight=s,t.fontSize=l,t.lineHeight=h,t.fontFamily=o,t.textAlign="center",t.textBaseline="middle"})}resetAnimation(){}pickNodeClosestDatum({x:t,y:e}){let i,a=1/0;return this.datumSelection.each((s,o)=>{let r=s.distanceSquared(t,e);r<a&&(a=r,i=o)}),null!=i?{datum:i,distance:Math.sqrt(a)}:void 0}datumMidPoint(t){let{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;let i=t.projectedGeometry,a=null!=i?vi(i):void 0,s=null!=a?vK(a,2):void 0,o=null!=s?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:o},o}legendItemSymbol(t){let{dataModel:e,processedData:i,properties:a}=this,{fillOpacity:s,stroke:o,strokeWidth:r,strokeOpacity:n,lineDash:l,lineDashOffset:h}=a,{fill:d}=a;if(null!=t&&this.isColorScaleValid()){let a=e.resolveColumnById(this,"colorValue",i)[t];d=this.colorScale.convert(a)}return{marker:Sz({fill:d,fillOpacity:s,stroke:o,strokeWidth:r,strokeOpacity:n,lineDash:l,lineDashOffset:h},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}}getLegendData(t){let{processedData:e,dataModel:i}=this;if(null==e||null==i)return[];let{id:a,visible:s}=this,{title:o,legendItemName:r,idKey:n,idName:l,colorKey:h,colorName:d,colorRange:c,showInLegend:p}=this.properties;return"gradient"===t&&null!=h&&null!=c?[{legendType:"gradient",enabled:s,seriesId:a,colorName:d,colorRange:c,colorDomain:e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")]}]:"category"===t?[{legendType:"category",id:a,itemId:a,seriesId:a,enabled:s,label:{text:r??o??l??n},symbol:this.legendItemSymbol(),legendItemName:r,hideInLegend:!p}]:[]}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,properties:s}=this,{idKey:o,idName:r,colorKey:n,colorName:l,labelKey:h,labelName:d,legendItemName:c,title:p,tooltip:u}=s;if(!i||!a)return;let g=a.dataSources.get(this.id)?.[t],y=i.resolveColumnById(this,"idValue",a)[t],f=null!=n?i.resolveColumnById(this,"colorValue",a)[t]:void 0,m=[];if(null!=f&&m.push({label:l,fallbackLabel:n,value:String(f)}),null!=h&&h!==o){let e=i.resolveColumnById(this,"labelValue",a)[t];m.push({label:d,fallbackLabel:h,value:e})}let x=this.getItemBaseStyle(!1);return Object.assign(x,this.getItemStyleOverrides(String(t),t,f,x,!1)),this.formatTooltipWithContext(u,{heading:y,title:p??c,symbol:this.legendItemSymbol(t),data:m},{seriesId:e,datum:g,title:p,idKey:o,idName:r,colorKey:n,colorName:l,labelKey:h,labelName:d,...x})}computeFocusBounds(t){return vl(this,t)}};S_.className="MapShapeSeries",S_.type="map-shape";var{commonSeriesOptionsDefs:SW,mapShapeSeriesThemeableOptionsDef:SG,without:Sj}=a.n1,SV={...SG,...Sj(SW,["highlightStyle"]),type:(0,s.mw)((0,s.dY)("map-shape")),idKey:(0,s.mw)(s.Yj),colorKey:s.Yj,labelKey:s.Yj,idName:s.Yj,colorName:s.Yj,labelName:s.Yj,topology:s.eW,topologyIdKey:s.Yj,legendItemName:s.Yj,title:s.Yj},S$={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape",moduleFactory:t=>new S_(t),tooltipDefaults:{range:"exact"},themeTemplate:{...bX,series:{fill:{$palette:"fill"},stroke:{$ref:"backgroundColor"},colorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$palette:"divergingColors"},a.n1.SAFE_RANGE2_OPERATION]},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{color:{$ref:"backgroundColor"},fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:"bold",overflowStrategy:"hide"}},tooltip:{range:"exact"}}},{FillGradientDefaults:SH,FillPatternDefaults:SY,FillImageDefaults:SK,Property:SU,SeriesProperties:SX,SeriesTooltip:SZ}=a.n1,SQ=class extends SX{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillGradientDefaults=new SH,this.fillPatternDefaults=new SY,this.fillImageDefaults=new SK,this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new SZ}};n([SU],SQ.prototype,"topology",2),n([SU],SQ.prototype,"fill",2),n([SU],SQ.prototype,"fillGradientDefaults",2),n([SU],SQ.prototype,"fillPatternDefaults",2),n([SU],SQ.prototype,"fillImageDefaults",2),n([SU],SQ.prototype,"fillOpacity",2),n([SU],SQ.prototype,"stroke",2),n([SU],SQ.prototype,"strokeOpacity",2),n([SU],SQ.prototype,"strokeWidth",2),n([SU],SQ.prototype,"lineDash",2),n([SU],SQ.prototype,"lineDashOffset",2),n([SU],SQ.prototype,"tooltip",2);var{createDatumId:Sq,SeriesNodePickMode:SJ,Selection:S0,Group:S1,PointerEvents:S2,getShapeStyle:S4}=a.n1,S5=class extends vh{constructor(t){super({moduleCtx:t,categoryKey:void 0,useLabelLayer:!0,pickModes:[SJ.EXACT_SHAPE_MATCH]}),this.properties=new SQ,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new S1({name:"itemGroup"})),this.datumSelection=S0.select(this.itemGroup,()=>this.nodeFactory())}get topology(){return this.properties.topology??this._chartTopology}get focusable(){return!1}setOptionsData(){}setChartData(){}getNodeData(){}get hasData(){return!1}renderToOffscreenCanvas(){return!0}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}setSeriesIndex(t){return!!super.setSeriesIndex(t)&&(this.contentGroup.zIndex=[0,t,0],this.highlightGroup.zIndex=[0,t,1],!0)}nodeFactory(){let t=new vt;return t.renderMode=1,t.lineJoin="round",t.pointerEvents=S2.None,t}processData(){let{topology:t}=this;this.topologyBounds=t?.features.reduce((t,e)=>{let i=e.geometry;return null==i?t:ve(i,t)},void 0),null==t&&s.Vy.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}createNodeData(){let{id:t,topology:e,scale:i}=this;if(null==e)return;let a=[];return e.features.forEach((t,e)=>{let{geometry:s}=t,o=null!=s&&null!=i?vo(s,i):void 0;null!=o&&a.push({series:this,itemId:e,datum:t,datumIndex:0,index:e,projectedGeometry:o})}),{itemId:t,nodeData:a,labelData:[]}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update(){let{datumSelection:t}=this;this.updateSelections(),this.contentGroup.visible=this.visible;let{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=this.updateDatumSelection({nodeData:e,datumSelection:t}),this.updateDatumNodes({datumSelection:t})}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>Sq(t.index))}updateDatumNodes(t){let{properties:e}=this,{datumSelection:i}=t,{fill:a,fillOpacity:s,stroke:o,strokeOpacity:r,lineDash:n,lineDashOffset:l}=e,h=this.getStrokeWidth(e.strokeWidth);i.each((t,e)=>{let{projectedGeometry:i}=e;if(null==i){t.visible=!1,t.projectedGeometry=void 0;return}t.visible=!0,t.projectedGeometry=i;let d=S4({fill:a,fillOpacity:s,stroke:o,strokeWidth:h,strokeOpacity:r,lineDash:n,lineDashOffset:l},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults);t.setProperties(d)})}resetAnimation(){}getLegendData(){return[]}getTooltipContent(t){}pickFocus(){}computeFocusBounds(t){}};S5.className="MapShapeBackgroundSeries",S5.type="map-shape-background";var{commonSeriesOptionsDefs:S3,mapShapeBackgroundSeriesThemeableOptionsDef:S6}=a.n1,S8={...S6,...S3,type:(0,s.mw)((0,s.dY)("map-shape-background")),topology:s.eW},S9={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape-background",moduleFactory:t=>new S5(t),tooltipDefaults:{range:"exact"},themeTemplate:{...bX,series:{fill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$ref:"backgroundColor"},strokeWidth:1,fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:[{$mix:[{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"black",.15]},{$mix:[{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},"white",.15]}],rotation:0,reverse:!1},fillPatternDefaults:{...a.n1.FILL_PATTERN_DEFAULTS,fill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]}},fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS}}},{ChartAxisDirection:S7,PolarAxis:kt,diff:ke,fixNumericExtent:ki,groupAccumulativeValueProperty:ka,keyProperty:ks,normaliseGroupTo:ko,resetLabelFn:kr,seriesLabelFadeInAnimation:kn,seriesLabelFadeOutAnimation:kl,valueProperty:kh,animationValidation:kd,createDatumId:kc,SeriesNodePickMode:kp,normalizeAngle360:ku,CategoryScale:kg,motion:ky,applyShapeStyle:kf,isGradientFill:km,getShapeStyle:kx}=a.n1,kb=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.angleKey=a.properties.angleKey,this.radiusKey=a.properties.radiusKey}},kv=class extends a.n1.PolarSeries{constructor(t,{animationResetFns:e}){super({moduleCtx:t,categoryKey:"angleValue",useLabelLayer:!0,canHaveAxes:!0,pickModes:[kp.NEAREST_NODE,kp.EXACT_SHAPE_MATCH],animationResetFns:{...e,label:kr}}),this.NodeEvent=kb,this.groupScale=new kg,this.circleCache={r:0,cx:0,cy:0}}getSeriesDomain(t){let{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===S7.Angle)return e.getDomain(this,"angleValue","key",i);{let t=e.getDomain(this,"radiusValue-end","value",i);return ki(Number.isFinite(t[1]-t[0])?[t[0]>0?0:t[0],t[1]<0?0:t[1]]:[])}}async processData(t){let{angleKey:e,radiusKey:i,normalizedTo:a}=this.properties,o=!this.ctx.animationManager.isSkipped(),r=this.getStackId(),n=`${r}-trailing`,l=[];(0,s.vM)(a)&&l.push(ko([r,n],Math.abs(a))),o&&this.processedData&&l.push(ke(this.id,this.processedData)),o&&l.push(kd());let h=this.visible?{}:{forceValue:0},d=this.axes[S7.Radius]?.scale.type,c=this.axes[S7.Angle]?.scale.type;await this.requestDataModel(t,this.data,{props:[ks(e,c,{id:"angleValue"}),kh(i,d,{id:"radiusValue-raw",invalidValue:null,...h}),...ka(i,"normal","current",{id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:r,separateNegative:!0,...h},d),...ka(i,"trailing","current",{id:"radiusValue-start",invalidValue:null,groupId:n,separateNegative:!0,...h},d),...l],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){let t=this.radius,e=this.centerX,i=this.centerY,a=this.circleCache;return(t!==a.r||e!==a.cx||i!==a.cy)&&(this.circleCache={r:t,cx:e,cy:i},!0)}isRadiusAxisReversed(){return this.axes[S7.Radius]?.isReversed()}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;let{nodeData:t=[]}=this.createNodeData()??{};this.nodeData=t,this.nodeDataRefresh=!1}getAxisInnerRadius(){let t=this.axes[S7.Radius];return t instanceof kt?this.radius*t.innerRadiusRatio:0}createNodeData(){let{processedData:t,dataModel:e,groupScale:i}=this;if(!e||!t||"grouped"!==t.type)return;let a=this.axes[S7.Angle],s=this.axes[S7.Radius],o=a?.scale,r=s?.scale;if(!o||!r)return;let n=e.resolveKeysById(this,"angleValue",t),l=e.resolveColumnById(this,"radiusValue-start",t),h=e.resolveColumnById(this,"radiusValue-end",t),d=e.resolveColumnById(this,"radiusValue-raw",t),c=e.resolveProcessedDataIndexById(this,"radiusValue-range"),p=0,u=0;a instanceof X&&(p=a.groupPaddingInner,u=a.paddingInner);let g=(o.bandwidth??0)*(1-u),{index:y,visibleGroupCount:f}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:f}).map((t,e)=>String(e)),i.range=[-g/2,g/2],i.paddingInner=f>1?p:0;let m=this.isRadiusAxisReversed(),x=m?this.radius:this.getAxisInnerRadius(),b=m?this.getAxisInnerRadius():this.radius,v=b+x,{angleKey:S,radiusKey:k,angleName:D,radiusName:M,label:w}=this.properties,I=(t,e,i,a)=>{let s=this.getLabelText(w,{value:e,datum:t,angleKey:S,radiusKey:k,angleName:D,radiusName:M});if(s)return{x:i,y:a,text:s,textAlign:"center",textBaseline:"middle"}},C=[];if(!this.visible)return{itemId:k,nodeData:C,labelData:C};let{dataSources:A}=t,L=A.get(this.id)??[];for(let{datumIndex:a,group:s}of e.forEachGroupDatum(this,t)){let t,e,p=L[a],u=n[a];if(null==u)return;let g=d[a],f=g>=0&&!Object.is(g,-0),S=l[a],k=h[a],D=s.aggregation[c][+!!f]??0,M=f===m;if(void 0===S||void 0===k)return;1===L.length?(t=-.5*Math.PI,e=1.5*Math.PI):(t=ku(o.convert(u)+i.convert(String(y))),e=ku(t+i.bandwidth));let w=t+i.bandwidth/2,A=v-r.convert(S),T=v-r.convert(k),N=(A+T)/2,O=v-r.convert(0),P=v-r.convert(D),E=Math.cos(w)*N,R=Math.sin(w)*N,B=this.properties.label.enabled?I(p,g,E,R):void 0,z=this.getColumnWidth(t,e);C.push({series:this,datum:p,datumIndex:a,point:{x:E,y:R,size:0},midPoint:{x:E,y:R},label:B,angleValue:u,radiusValue:g,negative:M,innerRadius:A,outerRadius:T,stackInnerRadius:O,stackOuterRadius:P,startAngle:t,endAngle:e,midAngle:w,axisInnerRadius:x,axisOuterRadius:b,columnWidth:z,index:a})}return{itemId:k,nodeData:C,labelData:C}}getColumnWidth(t,e){return NaN}update({seriesRect:t}){let e=this.checkResize(t);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle.item:void 0;return kx({fill:i?.fill??e.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset,cornerRadius:e.cornerRadius},e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults)}getItemStyleOverrides(t,e,i,a){let{id:s,properties:o}=this,{angleKey:r,radiusKey:n,itemStyler:l,fillGradientDefaults:h,fillPatternDefaults:d,fillImageDefaults:c}=o;if(null!=l)return kx(this.cachedDatumCallback(kc(t,a?"highlight":"node"),()=>this.callWithContext(l,{seriesId:s,datum:e,highlighted:a,angleKey:r,radiusKey:n,...i})),h,d,c)}updateSectorSelection(t,e){let i=[];if(e){let t=this.ctx.highlightManager?.getActiveHighlight();t?.datum&&t.series===this&&i.push(t)}else i=this.nodeData;let a=this.isRadiusAxisReversed(),s=a?this.radius:this.getAxisInnerRadius(),o=a?this.getAxisInnerRadius():this.radius,r=this.getShapeFillBBox(),n=this.getItemBaseStyle(e);t.update(i,void 0,t=>this.getDatumId(t)).each((t,i)=>{let{datum:a,datumIndex:l,midPoint:h}=i,d=this.getItemStyleOverrides(String(l),a,n,e),c=d?.fill??n.fill,p=km(c)&&"item"===c.bounds?{centerX:h?.x??0,centerY:h?.y??0}:{centerX:0,centerY:0,innerRadius:s,outerRadius:o};this.updateItemPath(t,i,e),kf(t,n,d,r,p),t.cornerRadius=d?.cornerRadius??n.cornerRadius,t.lineJoin="round"})}updateLabels(){let{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}animateEmptyUpdateReady(){let{labelSelection:t}=this,e=this.getColumnTransitionFunctions();ky.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),kn(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){let{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getColumnTransitionFunctions();ky.fromToMotion(this.id,"datums",e,[t],i),kl(this,"labels",e,this.labelSelection)}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,axes:s,properties:o}=this,{angleKey:r,angleName:n,radiusKey:l,radiusName:h,tooltip:d}=o,c=s[S7.Angle],p=s[S7.Radius];if(!i||!a||!c||!p)return;let u=a.dataSources.get(this.id)?.[t],g=i.resolveKeysById(this,"angleValue",a)[t],y=i.resolveColumnById(this,"radiusValue-raw",a)[t];if(null==g)return;let f=this.getItemBaseStyle(!1);return Object.assign(f,this.getItemStyleOverrides(String(t),t,f,!1)),this.formatTooltipWithContext(d,{heading:c.formatDatum(g),symbol:this.legendItemSymbol(),data:[{label:h,fallbackLabel:l,value:p.formatDatum(y)}]},{seriesId:e,datum:u,title:n,angleKey:r,angleName:n,radiusKey:l,radiusName:h,...f})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}legendItemSymbol(){let{fill:t,stroke:e,fillOpacity:i,strokeOpacity:s,strokeWidth:o,lineDash:r,lineDashOffset:n,fillGradientDefaults:l,fillPatternDefaults:h,fillImageDefaults:d}=this.properties,c=kx({fill:t??"rgba(0, 0, 0, 0)",stroke:e??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:s,strokeWidth:o,lineDash:r,lineDashOffset:n},l,h,d);return a.n1.isGradientFill(c.fill)&&(c.fill={...c.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:c}}getLegendData(t){if("category"!==t)return[];let{id:e,visible:i}=this,{radiusKey:a,radiusName:s,showInLegend:o}=this.properties;return[{legendType:"category",id:e,itemId:a,seriesId:e,enabled:i,label:{text:s??a},symbol:this.legendItemSymbol(),hideInLegend:!o}]}getDatumId(t){return kc(t.angleValue)}computeLabelsBBox(){return null}},{SeriesProperties:kS,FillGradientDefaults:kk,FillPatternDefaults:kD,FillImageDefaults:kM,SeriesTooltip:kw,Property:kI,Label:kC}=a.n1,kA=class extends kS{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new kk,this.fillPatternDefaults=new kD,this.fillImageDefaults=new kM,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new kC,this.tooltip=new kw}};n([kI],kA.prototype,"angleKey",2),n([kI],kA.prototype,"angleName",2),n([kI],kA.prototype,"radiusKey",2),n([kI],kA.prototype,"radiusName",2),n([kI],kA.prototype,"fill",2),n([kI],kA.prototype,"fillGradientDefaults",2),n([kI],kA.prototype,"fillPatternDefaults",2),n([kI],kA.prototype,"fillImageDefaults",2),n([kI],kA.prototype,"fillOpacity",2),n([kI],kA.prototype,"stroke",2),n([kI],kA.prototype,"strokeWidth",2),n([kI],kA.prototype,"strokeOpacity",2),n([kI],kA.prototype,"lineDash",2),n([kI],kA.prototype,"lineDashOffset",2),n([kI],kA.prototype,"cornerRadius",2),n([kI],kA.prototype,"itemStyler",2),n([kI],kA.prototype,"rotation",2),n([kI],kA.prototype,"stackGroup",2),n([kI],kA.prototype,"normalizedTo",2),n([kI],kA.prototype,"label",2),n([kI],kA.prototype,"tooltip",2);var{motion:kL}=a.n1;function kT(){let t={startAngle:new Map,endAngle:new Map},e=["startAngle","endAngle"],i=(e,i)=>({startAngle:t.startAngle.get(e)[i],endAngle:t.endAngle.get(e)[i]});return{calculate:(i,a,s)=>{e.forEach(e=>{let o=t[e],r=("removed"===s||"updated"===s?i:a)[e],n=("removed"===s?i:a)[e];isNaN(n)&&(n=i.previousDatum?.[e]??NaN);let l=r-n;Math.abs(l)>Math.PI&&(r-=2*Math.sign(l)*Math.PI),o.set(a,{from:r,to:n})})},from:t=>i(t,"from"),to:t=>i(t,"to")}}function kN(t,e,i){if("updated"===i){if(null==t.previousDatum||isNaN(t.previousDatum.startAngle)||isNaN(t.previousDatum.endAngle))return"added";if(isNaN(e.startAngle)||isNaN(e.endAngle))return"removed"}return"added"===i&&null!=t.previousDatum?"updated":i}function kO(t,{innerRadius:e,outerRadius:i,columnWidth:a,axisInnerRadius:s,axisOuterRadius:o,startAngle:r,endAngle:n}){return{innerRadius:e,outerRadius:i,columnWidth:a,axisInnerRadius:s,axisOuterRadius:o,startAngle:r,endAngle:n}}var{SectorBox:kP,motion:kE}=a.n1;function kR(t){let{negative:e,innerRadius:i,outerRadius:a,stackInnerRadius:s,stackOuterRadius:o}=t;return{innerRadius:e?o:s,outerRadius:e?s:o,clipInnerRadius:e?a:i,clipOuterRadius:e?i:a}}function kB(t,e){let{startAngle:i,endAngle:a}=e,{innerRadius:s,outerRadius:o,clipInnerRadius:r,clipOuterRadius:n}=kR(e),l=new kP(i,a,r,n);return{innerRadius:s,outerRadius:o,startAngle:i,endAngle:a,clipSector:l}}var{Sector:kz,SectorBox:kF,PolarZIndexMap:k_}=a.n1,kW=class extends kv{constructor(t){super(t,{animationResetFns:{item:kB}}),this.properties=new kA}setSeriesIndex(t){return!!super.setSeriesIndex(t)&&(this.contentGroup.zIndex=[0,k_.FOREGROUND,t],this.highlightGroup.zIndex=[0,k_.HIGHLIGHT,t],this.labelGroup.zIndex=[0,k_.LABEL,t],!0)}getStackId(){let t=this.seriesGrouping?.groupIndex??this.id;return`nightingale-stack-${t}-yValues`}nodeFactory(){return new kz}updateItemPath(t,e,i){let{negative:a}=e;if(t.centerX=0,t.centerY=0,t.startOuterCornerRadius=a?0:this.properties.cornerRadius,t.endOuterCornerRadius=a?0:this.properties.cornerRadius,t.startInnerCornerRadius=a?this.properties.cornerRadius:0,t.endInnerCornerRadius=a?this.properties.cornerRadius:0,i){let{startAngle:i,endAngle:a}=e,{innerRadius:s,outerRadius:o,clipInnerRadius:r,clipOuterRadius:n}=kR(e);t.innerRadius=s,t.outerRadius=o,t.startAngle=i,t.endAngle=a,t.clipSector=new kF(i,a,r,n)}}getColumnTransitionFunctions(){var t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();let e=kT();return{toFn:(i,a,s)=>{let o,r,n,{startAngle:l,endAngle:h}=e.to(a);if("removed"===s)n=new kP(l,h,o=t,r=t);else{let e,i;({innerRadius:o,outerRadius:r,clipInnerRadius:e,clipOuterRadius:i}=kR(a)),isNaN(o)&&(o=t),isNaN(r)&&(r=t),isNaN(e)&&(e=t),isNaN(i)&&(i=t),n=new kP(l,h,e,i)}return{innerRadius:o,outerRadius:r,startAngle:l,endAngle:h,clipSector:n}},fromFn:(i,a,s)=>{let o,r,n;s=kN(i,a,s),e.calculate(i,a,s);let{startAngle:l,endAngle:h}=e.from(a);return"removed"===s||"updated"===s?(o=i.innerRadius,r=i.outerRadius,n=i.clipSector):(o=t,r=t),n??(n=new kP(l,h,o,r)),{innerRadius:o,outerRadius:r,startAngle:l,endAngle:h,clipSector:n,phase:kE.NODE_UPDATE_STATE_TO_PHASE_MAPPING[s]}}}}};kW.className="NightingaleSeries",kW.type="nightingale";var{commonSeriesOptionsDefs:kG,nightingaleSeriesThemeableOptionsDef:kj}=a.n1,kV={...kj,...kG,type:(0,s.mw)((0,s.dY)("nightingale")),angleKey:(0,s.mw)(s.Yj),radiusKey:(0,s.mw)(s.Yj),angleName:s.Yj,radiusName:s.Yj,grouped:s.zM,stacked:s.zM,stackGroup:s.Yj,normalizedTo:s.ai},{ThemeConstants:{POLAR_AXIS_TYPE:k$,POLAR_AXIS_SHAPE:kH}}=a.n1,kY={$path:["./shape",kH.CIRCLE,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]},kK={series:{fill:{$palette:"fill"},stroke:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$ref:"backgroundColor"},{$palette:"stroke"}]},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,strokeWidth:1,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},axes:{[k$.ANGLE_CATEGORY]:{shape:kY,groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[k$.RADIUS_NUMBER]:{shape:kY}}},{ThemeConstants:{POLAR_AXIS_TYPE:kU}}=a.n1,kX={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"nightingale",moduleFactory:t=>new kW(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:kU.ANGLE_CATEGORY},{type:kU.RADIUS_NUMBER}],themeTemplate:kK,stackable:!0,groupable:!0,stackedByDefault:!0},{SeriesProperties:kZ,FillGradientDefaults:kQ,FillPatternDefaults:kq,FillImageDefaults:kJ,SeriesTooltip:k0,Property:k1,Label:k2,DropShadow:k4}=a.n1,k5=class extends k2{},k3=class extends k2{constructor(){super(...arguments),this.spacing=0}};n([k1],k3.prototype,"spacing",2),n([k1],k3.prototype,"placement",2);var k6=class extends kZ{constructor(){super(...arguments),this.fills=[],this.fillGradientDefaults=new kQ,this.fillPatternDefaults=new kq,this.fillImageDefaults=new kJ,this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.direction="vertical",this.reverse=void 0,this.spacing=0,this.aspectRatio=void 0,this.shadow=new k4().set({enabled:!1}),this.label=new k5,this.stageLabel=new k3,this.tooltip=new k0}};function k8(t,{x:e,y:i,top:a,right:s,bottom:o,left:r}){t.x0=e-a/2,t.x1=e+a/2,t.x2=e+o/2,t.x3=e-o/2,t.y0=i-r/2,t.y1=i-s/2,t.y2=i+s/2,t.y3=i+r/2}n([k1],k6.prototype,"stageKey",2),n([k1],k6.prototype,"valueKey",2),n([k1],k6.prototype,"fills",2),n([k1],k6.prototype,"fillGradientDefaults",2),n([k1],k6.prototype,"fillPatternDefaults",2),n([k1],k6.prototype,"fillImageDefaults",2),n([k1],k6.prototype,"fillOpacity",2),n([k1],k6.prototype,"strokes",2),n([k1],k6.prototype,"strokeWidth",2),n([k1],k6.prototype,"strokeOpacity",2),n([k1],k6.prototype,"lineDash",2),n([k1],k6.prototype,"lineDashOffset",2),n([k1],k6.prototype,"direction",2),n([k1],k6.prototype,"reverse",2),n([k1],k6.prototype,"spacing",2),n([k1],k6.prototype,"aspectRatio",2),n([k1],k6.prototype,"itemStyler",2),n([k1],k6.prototype,"shadow",2),n([k1],k6.prototype,"label",2),n([k1],k6.prototype,"stageLabel",2),n([k1],k6.prototype,"tooltip",2);var{StateMachine:k9,valueProperty:k7,SeriesNodePickMode:Dt,CachedTextMeasurerPool:De,TextUtils:Di,createDatumId:Da,BBox:Ds,Group:Do,Selection:Dr,Text:Dn,PointerEvents:Dl,applyShapeStyle:Dh,fromToMotion:Dd,seriesLabelFadeInAnimation:Dc,getShapeStyle:Dp}=a.n1,Du=class extends a.n1.DataModelSeries{constructor(t){super({moduleCtx:t,categoryKey:void 0,pickModes:[Dt.EXACT_SHAPE_MATCH,Dt.NEAREST_NODE]}),this.properties=new k6,this.itemGroup=this.contentGroup.appendChild(new Do({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Do({name:"itemLabelGroup"})),this.stageLabelGroup=this.contentGroup.appendChild(new Do({name:"stageLabelGroup"})),this.datumSelection=Dr.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=Dr.select(this.itemLabelGroup,Dn),this.stageLabelSelection=Dr.select(this.stageLabelGroup,Dn),this.highlightDatumSelection=Dr.select(this.highlightNode,()=>this.nodeFactory()),this.animationState=new k9("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{clear:"empty",reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable()),this.itemLabelGroup.pointerEvents=Dl.None,this.stageLabelGroup.pointerEvents=Dl.None}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",t=>this.onLegendItemClick(t)))}nodeFactory(){return new mP}getNodeData(){return this.contextNodeData?.nodeData}resetAnimation(t){"initial"===t?this.animationState.transition("reset"):"ready"===t&&this.animationState.transition("skip")}async processData(t){if(null==this.data)return;let{id:e,visible:i,ctx:{legendManager:a}}=this,{stageKey:s,valueKey:o}=this.properties,r=this.visible?{}:{forceValue:0};await this.requestDataModel(t,this.data,{props:[k7(s,"band",{id:"xValue"}),k7(o,"number",{id:"yValue",...r,validation:(t,s,o)=>i&&a.getItemEnabled({seriesId:e,itemId:o}),invalidValue:0})]})}createNodeData(){let t,e,i,a,s,{id:o,dataModel:r,processedData:n,properties:l,visible:h,ctx:{legendManager:d}}=this,{stageKey:c,valueKey:p,direction:u,reverse:g="horizontal"===u,spacing:y,aspectRatio:f,label:m,stageLabel:x}=l;if(null==r||null==n)return;let b="horizontal"===u,v=r.resolveColumnById(this,"xValue",n),S=r.resolveColumnById(this,"yValue",n),k=De.getMeasurer({font:x.getFont()});b?(t="center",e="before"===x.placement?"bottom":"top"):(t="after"===x.placement?"left":"right",e="middle");let D=x.enabled?[]:void 0,M=0,w=0,I=0,C=n.dataSources.get(this.id)??[];C.forEach((i,a)=>{let s=v[a],r=S[a],n=h&&d.getItemEnabled({seriesId:o,itemId:a});if(I+=r,null==D)return;let l=this.getLabelText(this.properties.stageLabel,{datum:i,value:s,stageKey:c,valueKey:p}),{width:u}=k.measureText(l),g=l.split("\n").length*Di.getLineHeight(m.fontSize);M=Math.max(M,u),w=Math.max(w,g),D.push({x:NaN,y:NaN,text:l,textAlign:t,textBaseline:e,visible:n})});let A=this._nodeDataDependencies?.seriesRectWidth??0,L=this._nodeDataDependencies?.seriesRectHeight??0,T=y*(n.input.count-1);if(b){let t=w+x.spacing;i=new Ds(0,"before"===x.placement?t:0,A,L-t)}else{let t=M+x.spacing;i=new Ds("after"===x.placement?0:t,0,A-t,L)}if(null!=f&&0!==f){let t="horizontal"===u?1/f:f,e=Math.min(i.width,i.height*t),a=e/t;i=new Ds(i.x+(i.width-e)/2,i.y+(i.height-a)/2,e,a)}b?s="before"===x.placement?i.y-x.spacing:i.y+i.height+x.spacing:a="after"===x.placement?i.x+i.width+x.spacing:i.x-x.spacing;let N=i.width-(b?T:0),O=i.height-(b?0:T);if(N<0||O<0)return;let P=[],E=[],R=0;return C.forEach((t,e)=>{let r,n,l,u,f=v[e],x=S[e],k=h&&d.getItemEnabled({seriesId:o,itemId:e}),M=R+x,w=(R+M)/(2*I),C=(M-R)/I,A=b?N*w+y*e:.5*N,L=b?.5*O:O*w+y*e,T=i.x+A,B=i.y+L;if(null!=D){let t=D[e];t.x=a??T,t.y=s??B}if(b){let t=N*C;r=t,l=t;let e=(A+t/2)*(O/i.width),a=(A-t/2)*(O/i.width);n=g?i.height-e:e,u=g?i.height-a:a}else{let t=O*C;n=t,u=t;let e=(L-t/2)*(N/i.height),a=(L+t/2)*(N/i.height);r=g?i.width-e:e,l=g?i.width-a:a}let z={x:T,y:B,text:this.getLabelText(m,{datum:t,value:x,stageKey:c,valueKey:p}),textAlign:"center",textBaseline:"middle",visible:k};E.push(z),P.push({series:this,itemId:p,datum:t,datumIndex:e,index:e,xValue:f,yValue:x,x:T,y:B,top:r,right:n,bottom:l,left:u,label:z,enabled:k,midPoint:{x:T,y:B}}),R=M}),{itemId:o,nodeData:P,labelData:E,stageLabelData:D,bounds:i}}updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}update({seriesRect:t}){this.checkResize(t);let{datumSelection:e,labelSelection:i,stageLabelSelection:a,highlightDatumSelection:s}=this;this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let o=this.ctx.highlightManager?.getActiveHighlight();null!=o&&(o.series!==this||null==o.datum)&&(o=void 0);let r=this.contextNodeData?.nodeData??[],n=this.contextNodeData?.labelData??[],l=this.contextNodeData?.stageLabelData??[];this.datumSelection=this.updateDatumSelection({nodeData:r,datumSelection:e}),this.updateDatumNodes({datumSelection:e,isHighlight:!1}),this.labelSelection=this.updateLabelSelection({labelData:n,labelSelection:i}),this.updateLabelNodes({labelSelection:i,labelProperties:this.properties.label}),this.stageLabelSelection=this.updateStageLabelSelection({stageLabelData:l,stageLabelSelection:a}),this.updateLabelNodes({labelSelection:a,labelProperties:this.properties.stageLabel}),this.highlightDatumSelection=this.updateDatumSelection({nodeData:null!=o?[o]:[],datumSelection:s}),this.updateDatumNodes({datumSelection:s,isHighlight:!0}),this.animationState.transition("update")}updateDatumSelection(t){return t.datumSelection.update(t.nodeData)}getItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle.item:void 0;return Dp({fill:i?.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getItemStyleOverrides(t,e,i,a,s){let{id:o,properties:r}=this,{fills:n,strokes:l,stageKey:h,valueKey:d,itemStyler:c}=r,p=a.fill??n[i%n.length],u=a.stroke??l[i%l.length],g={};if(s||(g.fill=p,g.stroke=u),null!=c){let i=this.cachedDatumCallback(Da(t,s?"highlight":"node"),()=>this.callWithContext(c,{seriesId:o,datum:e,stageKey:h,valueKey:d,highlighted:s,fill:p,stroke:u,...a}));Object.assign(g,i)}return Dp(g,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateDatumNodes(t){let{datumSelection:e,isHighlight:i}=t,{properties:a}=this,{shadow:s}=a,o=this.getItemBaseStyle(i),r=this.contextNodeData?.bounds,n=r?{series:r,axis:r}:void 0;e.each((t,e)=>{let{datumIndex:a,datum:r}=e,l=this.getItemStyleOverrides(String(a),r,a,o,i);Dh(t,o,l,n),k8(t,e),t.fillShadow=s})}updateLabelSelection(t){return t.labelSelection.update(this.properties.label.enabled?t.labelData:[])}updateStageLabelSelection(t){return t.stageLabelSelection.update(t.stageLabelData)}updateLabelNodes(t){let{labelSelection:e,labelProperties:i}=t,{color:a,fontSize:s,fontStyle:o,fontWeight:r,fontFamily:n}=i;e.each((t,{visible:e,x:i,y:l,text:h,textAlign:d,textBaseline:c})=>{t.visible=e,t.x=i,t.y=l,t.text=h,t.fill=a,t.fontStyle=o,t.fontWeight=r,t.fontSize=s,t.fontFamily=n,t.textAlign=d,t.textBaseline=c})}computeFocusBounds(t){let e=this.getNodeData()?.[t.datumIndex];if(void 0!==e){for(let t of this.datumSelection)if(t.datum===e)return t.node}}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,properties:s}=this,{stageKey:o,valueKey:r,tooltip:n}=s;if(!i||!a)return;let l=a.dataSources.get(this.id)?.[t],h=i.resolveColumnById(this,"xValue",a)[t],d=i.resolveColumnById(this,"yValue",a)[t];if(null==h)return;let c=this.getLabelText(this.properties.stageLabel,{datum:a.dataSources.get(this.id)?.[t],value:d,stageKey:o,valueKey:r}),p=this.getItemBaseStyle(!1);return Object.assign(p,this.getItemStyleOverrides(String(t),t,t,p,!1)),this.formatTooltipWithContext(n,{symbol:this.legendItemSymbol(t),data:[{label:String(h),value:c}]},{seriesId:e,datum:l,title:void 0,stageKey:o,valueKey:r,...p})}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}pickNodeClosestDatum({x:t,y:e}){let i,a=1/0;return this.datumSelection.each((s,o)=>{let r=s.distanceSquared(t,e);r<a&&(a=r,i=o)}),null!=i?{datum:i,distance:Math.sqrt(a)}:void 0}legendItemSymbol(t){let{fills:e,strokes:i,strokeWidth:a,fillOpacity:s,strokeOpacity:o,lineDash:r,lineDashOffset:n}=this.properties;return{marker:Dp({fill:e[t%e.length]??"black",fillOpacity:s,stroke:i[t%i.length]??"black",strokeWidth:a,strokeOpacity:o,lineDash:r,lineDashOffset:n},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}}getLegendData(t){let{processedData:e,dataModel:i,id:a,ctx:{legendManager:s},visible:o}=this;if(!i||!e||"category"!==t)return[];let{showInLegend:r}=this.properties,n=[],l=i.resolveColumnById(this,"xValue",e);return(e.dataSources.get(this.id)??[]).forEach((t,e)=>{let i=l[e];n.push({legendType:"category",id:a,itemId:e,seriesId:a,enabled:o&&s.getItemEnabled({seriesId:a,itemId:e}),label:{text:i},symbol:this.legendItemSymbol(e),hideInLegend:!r})}),n}animateReset(){this.ctx.animationManager.skipCurrentBatch(),this.ctx.animationManager.stopByAnimationGroupId(this.id)}animateEmptyUpdateReady(){var t;let{datumSelection:e,labelSelection:i,properties:a}=this,s=(t=a.direction,{fromFn:(e,i)=>{let{x:a,y:s}=i,{top:o,right:r,bottom:n,left:l}=i;return"vertical"===t?(o=0,n=0):(l=0,r=0),{x:a,y:s,top:o,right:r,bottom:n,left:l}},toFn:(t,e)=>{let{x:i,y:a,top:s,right:o,bottom:r,left:n}=e;return{x:i,y:a,top:s,right:o,bottom:r,left:n}},applyFn:k8});Dd(this.id,"nodes",this.ctx.animationManager,[e],s),Dc(this,"labels",this.ctx.animationManager,i)}};Du.className="PyramidSeries",Du.type="pyramid";var{commonSeriesOptionsDefs:Dg,pyramidSeriesThemeableOptionsDef:Dy}=a.n1,Df={...Dy,...Dg,type:(0,s.mw)((0,s.dY)("pyramid")),stageKey:(0,s.mw)(s.Yj),valueKey:(0,s.mw)(s.Yj)},{ThemeSymbols:{DEFAULT_SHADOW_COLOUR:Dm}}=a.n1,Dx={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"pyramid",moduleFactory:t=>new Du(t),solo:!0,tooltipDefaults:{range:"exact"},themeTemplate:{series:{direction:"vertical",strokeWidth:0,spacing:2,fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,label:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}},stageLabel:{enabled:!0,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:12},shadow:{enabled:!1,color:Dm,xOffset:3,yOffset:3,blur:5}}}},{ThemeConstants:{POLAR_AXIS_TYPE:Db}}=a.n1,Dv={series:{stroke:{$palette:"stroke"},label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}},marker:{enabled:!0,fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:0}},axes:{[Db.ANGLE_CATEGORY]:{label:{spacing:10}}}},DS=a.n1.mergeDefaults({series:{stroke:a.n1.SAFE_STROKE_FILL_OPERATION,strokeWidth:2}},Dv),Dk=a.n1.mergeDefaults({series:{fill:{$palette:"fill"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,fillOpacity:.8,strokeWidth:2,marker:{enabled:!1,fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS}}},Dv),{Label:DD,SeriesMarker:DM,SeriesProperties:Dw,SeriesTooltip:DI,Property:DC}=a.n1,DA=class extends Dw{constructor(){super(...arguments),this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new DM,this.label=new DD,this.tooltip=new DI,this.connectMissingData=!1}};n([DC],DA.prototype,"angleKey",2),n([DC],DA.prototype,"radiusKey",2),n([DC],DA.prototype,"angleName",2),n([DC],DA.prototype,"radiusName",2),n([DC],DA.prototype,"stroke",2),n([DC],DA.prototype,"strokeWidth",2),n([DC],DA.prototype,"strokeOpacity",2),n([DC],DA.prototype,"lineDash",2),n([DC],DA.prototype,"lineDashOffset",2),n([DC],DA.prototype,"rotation",2),n([DC],DA.prototype,"marker",2),n([DC],DA.prototype,"label",2),n([DC],DA.prototype,"tooltip",2),n([DC],DA.prototype,"connectMissingData",2);var{ChartAxisDirection:DL,PolarAxis:DT,SeriesNodePickMode:DN,valueProperty:DO,fixNumericExtent:DP,seriesLabelFadeInAnimation:DE,markerFadeInAnimation:DR,resetMarkerFn:DB,animationValidation:Dz,computeMarkerFocusBounds:DF,extent:D_,BBox:DW,Group:DG,Path:Dj,PointerEvents:DV,Selection:D$,Text:DH,Marker:DY,mergeDefaults:DK,getShapeStyle:DU}=a.n1,DX=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.angleKey=a.properties.angleKey,this.radiusKey=a.properties.radiusKey}},DZ=class extends a.n1.PolarSeries{constructor(t){super({moduleCtx:t,categoryKey:"angleValue",useLabelLayer:!0,pickModes:[DN.NEAREST_NODE,DN.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:DB},clipFocusBox:!1}),this.properties=new DA,this.NodeEvent=DX,this.lineGroup=this.contentGroup.appendChild(new DG({name:"radar-line"})),this.lineSelection=D$.select(this.lineGroup,Dj),this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0},this.lineGroup.zIndex=0,this.itemGroup.zIndex=1}nodeFactory(){return new DY}getSeriesDomain(t){let{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===DL.Angle)return e.getDomain(this,"angleValue","value",i);{let t=e.getDomain(this,"radiusValue","value",i);return DP(D_(0===t.length?t:[0].concat(t)))}}async processData(t){let{angleKey:e,radiusKey:i}=this.properties,a=[];this.ctx.animationManager.isSkipped()||a.push(Dz());let s=this.axes[DL.Radius]?.scale.type,o=this.axes[DL.Angle]?.scale.type;await this.requestDataModel(t,this.data,{props:[DO(e,o,{id:"angleValue"}),DO(i,s,{id:"radiusValue",invalidValue:void 0}),...a]}),this.animationState.transition("updateData")}didCircleChange(){let t=this.radius,e=this.centerX,i=this.centerY,a=this.circleCache;return(t!==a.r||e!==a.cx||i!==a.cy)&&(this.circleCache={r:t,cx:e,cy:i},!0)}getAxisInnerRadius(){let t=this.axes[DL.Radius];return t instanceof DT?this.radius*t.innerRadiusRatio:0}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;let{nodeData:t=[]}=this.createNodeData()??{};this.nodeData=t,this.nodeDataRefresh=!1}createNodeData(){let{processedData:t,dataModel:e}=this;if(!t||!e)return;let{angleKey:i,radiusKey:a,angleName:o,radiusName:r,marker:n,label:l}=this.properties,h=this.axes[DL.Angle]?.scale,d=this.axes[DL.Radius]?.scale;if(!h||!d)return;let c=e.resolveColumnById(this,"angleValue",t),p=e.resolveColumnById(this,"radiusValue",t),u=this.getAxisInnerRadius(),g=(t.dataSources.get(this.id)??[]).map((t,e)=>{let g,y=c[e],f=p[e],m=h.convert(y),x=this.radius+u-d.convert(f),b=Math.cos(m),v=Math.sin(m),S=b*x,k=v*x;if(l.enabled){let e=this.getLabelText(l,{value:f,datum:t,angleKey:i,radiusKey:a,angleName:o,radiusName:r});if(e){let t="right";(0,s.YX)(b,0)?t="center":b>0&&(t="left");let i="bottom";(0,s.YX)(v,0)?i="middle":v>0&&(i="top"),g={x:S+b*n.size,y:k+v*n.size,text:e,textAlign:t,textBaseline:i}}}return{series:this,datum:t,datumIndex:e,index:e,point:{x:S,y:k,size:n.size},midPoint:{x:S,y:k},label:g,angleValue:y,radiusValue:f,missing:!(0,s.Bf)(m)||!(0,s.Bf)(x)}});return{itemId:a,nodeData:g,labelData:g}}update({seriesRect:t}){let e=this.checkResize(t),i=!this.ctx.animationManager.isSkipped(),{series:a}=this.ctx.highlightManager?.getActiveHighlight()??{};this.highlightGroup.visible=(i||this.visible)&&a===this,this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){let t=this.visible?[!0]:[];this.lineSelection.update(t)}updateMarkerSelection(){this.properties.marker.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=D$.select(this.itemGroup,()=>this.nodeFactory(),!1)),this.itemSelection.update(this.properties.marker.enabled?this.nodeData:[])}getMarkerFill(t){return t?.fill??this.properties.marker.fill}getDatumStylerProperties(t){let{id:e,properties:i}=this,{angleKey:a,radiusKey:s}=i;return{seriesId:e,datum:t,angleKey:a,radiusKey:s}}updateMarkers(t,e){let{visible:i}=this,{marker:a,stroke:s,strokeWidth:o,strokeOpacity:r,highlightStyle:n}=this.properties,l=[];if(i&&a.shape&&a.enabled)if(e){let t=this.ctx.highlightManager?.getActiveHighlight();t?.datum&&(l=[t])}else l=this.nodeData;let h=DK(e&&n.item,a.getStyle(),{stroke:s,strokeWidth:o,strokeOpacity:r}),d=this.getShapeFillBBox();t.update(l).each((t,i)=>{this.updateMarkerStyle(a,t,i.datum,i.point,this.getDatumStylerProperties(i),e,h,d)})}updateLabels(){let{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,axes:s,properties:o}=this,{angleKey:r,angleName:n,radiusKey:l,radiusName:h,tooltip:d,marker:c}=o,p=s[DL.Angle],u=s[DL.Radius];if(!i||!a||!p||!u)return;let g=a.dataSources.get(this.id)?.[t],y=i.resolveColumnById(this,"angleValue",a)[t],f=i.resolveColumnById(this,"radiusValue",a)[t];if(null==y)return;let m=this.getMarkerStyle(c,g,this.getDatumStylerProperties(g),!1);return this.formatTooltipWithContext(d,{heading:p.formatDatum(y),symbol:this.legendItemSymbol(),data:[{label:h,fallbackLabel:l,value:u.formatDatum(f)}]},{seriesId:e,datum:g,title:n,angleKey:r,radiusKey:l,angleName:n,radiusName:h,...m})}legendItemSymbol(){let{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:a,marker:s}=this.properties;return{marker:DU({shape:s.shape,enabled:s.enabled||e<=0,fill:this.getMarkerFill()??s.stroke??t??"rgba(0, 0, 0, 0)",stroke:s.stroke??t??"rgba(0, 0, 0, 0)",fillOpacity:s.fillOpacity,strokeOpacity:s.strokeOpacity,strokeWidth:s.strokeWidth,lineDash:s.lineDash,lineDashOffset:s.lineDashOffset},s.fillGradientDefaults,s.fillPatternDefaults,s.fillImageDefaults),line:{stroke:t,strokeOpacity:i,strokeWidth:e,lineDash:a}}}getLegendData(t){if("category"!==t)return[];let{id:e,ctx:{legendManager:i},visible:a}=this,{radiusKey:s,radiusName:o,showInLegend:r}=this.properties;return[{legendType:"category",id:e,itemId:s,seriesId:e,enabled:a&&i.getItemEnabled({seriesId:e,itemId:s}),label:{text:o??s},symbol:this.legendItemSymbol(),hideInLegend:!r}]}pickNodeClosestDatum(t){let e,{nodeData:i,centerX:a,centerY:s}=this,{x:o,y:r}=t;if(Math.sqrt((o-a)**2+(r-s)**2)>this.radius+this.properties.marker.size)return;let n=1/0;for(let o of i){let{point:{x:i=NaN,y:r=NaN}={}}=o;if(isNaN(i)||isNaN(r))continue;let l=Math.sqrt((t.x-i-a)**2+(t.y-r-s)**2);l<n&&(n=l,e=o)}if(e){let t=Math.max(n-(e.point?.size??0),0);return{datum:e,distance:t}}}computeLabelsBBox(){let{label:t}=this.properties;this.maybeRefreshNodeData();let e=[],i=new DH;return(this.nodeData.forEach(a=>{if(!t.enabled||!a.label)return;i.text=a.label.text,i.x=a.label.x,i.y=a.label.y,i.setFont(t),i.setAlign(a.label);let s=i.getBBox();e.push(s)}),0===e.length)?null:DW.merge(e)}getLineNode(){return this.lineSelection?.at(0)}beforePathAnimation(){let t=this.getLineNode();t&&(t.fill=void 0,t.lineJoin="round",t.lineCap="round",t.pointerEvents=DV.None,t.stroke=this.properties.stroke,t.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset)}getLinePoints(){let t,{nodeData:e,resetInvalidToZero:i}=this,{connectMissingData:a}=this.properties;if(0===e.length)return[];let s=this.axes[DL.Radius],o=this.axes[DL.Angle],r=o?.isReversed(),n=s?.isReversed()&&!r?[...e].reverse():e,l=[],h=!1;return n.forEach((e,s)=>{let{x:o,y:r}=e.point,n=isNaN(o)||isNaN(r);n||(t??(t=e)),n&&!a&&(o=0,r=0);let d=0===s||!i&&!a&&(n||h);l.push({x:o,y:r,moveTo:d}),h=n}),void 0!==t&&l.push({x:t.point.x,y:t.point.y,moveTo:!1}),l}animateSinglePath(t,e,i){let{path:a}=t;a.clear(!0);let s=this.getAxisInnerRadius(),o=this.axes[DL.Radius],r=o?.isReversed()?this.radius+s-o?.scale.convert(0):s;e.forEach(t=>{let{x:e,y:s,arc:o,radius:n=0,startAngle:l=0,endAngle:h=0,moveTo:d}=t,c=Math.atan2(s,e),p=r*Math.cos(c)*(1-i)+e*i,u=r*Math.sin(c)*(1-i)+s*i;o?a.arc(e,s,n,l,h):d?a.moveTo(p,u):a.lineTo(p,u)}),t.checkPathDirty()}animatePaths(t){let e=this.getLinePoints(),i=this.getLineNode();i&&this.animateSinglePath(i,e,t)}animateEmptyUpdateReady(){let{itemSelection:t,labelSelection:e}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:t=>this.animatePaths(t),onStop:()=>this.animatePaths(1)}),DR(this,i,"added",t),DE(this,"labels",i,e)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t),this.resetPaths()}animateReadyResize(t){super.animateReadyResize(t),this.resetPaths()}resetPaths(){let t=this.getLineNode();if(t){let{path:e}=t,i=this.getLinePoints();for(let{x:a,y:s,moveTo:o}of(t.fill=void 0,t.stroke=this.properties.stroke,t.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset,e.clear(!0),i))o?e.moveTo(a,s):e.lineTo(a,s);t.checkPathDirty()}}getFormattedMarkerStyle(t){let{angleKey:e,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,t.datum,{angleKey:e,radiusKey:i},!0)}computeFocusBounds(t){return DF(this,t)}};DZ.className="RadarSeries";var{FillGradientDefaults:DQ,FillPatternDefaults:Dq,FillImageDefaults:DJ,Property:D0}=a.n1,D1=class extends DA{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new DQ,this.fillPatternDefaults=new Dq,this.fillImageDefaults=new DJ,this.fillOpacity=1}};n([D0],D1.prototype,"fill",2),n([D0],D1.prototype,"fillGradientDefaults",2),n([D0],D1.prototype,"fillPatternDefaults",2),n([D0],D1.prototype,"fillImageDefaults",2),n([D0],D1.prototype,"fillOpacity",2);var{Group:D2,Path:D4,PointerEvents:D5,Selection:D3,ChartAxisDirection:D6,applyShapeStyle:D8,getShapeFill:D9,getShapeStyle:D7}=a.n1,Mt=class extends DZ{constructor(t){super(t),this.properties=new D1,this.areaGroup=this.contentGroup.appendChild(new D2({name:"radar-area"})),this.areaSelection=D3.select(this.areaGroup,D4),this.resetInvalidToZero=!0,this.areaGroup.zIndex=-1}updatePathSelections(){let t=this.visible?[!0]:[];this.areaSelection.update(t),super.updatePathSelections()}getAreaNode(){return this.areaSelection.at(0)}getMarkerFill(t){return t?.fill??this.properties.marker.fill??this.properties.fill}beforePathAnimation(){super.beforePathAnimation();let t=this.getAreaNode(),{fillOpacity:e,fill:i}=this.properties;D8(t,D7({fill:i,fillOpacity:e},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults),void 0,this.getShapeFillBBox()),t.pointerEvents=D5.None,t.stroke=void 0}animatePaths(t){super.animatePaths(t),this.animateSinglePath(this.getAreaNode(),this.getAreaPoints(),t)}getAreaPoints(){let t=this.getLinePoints(),e=t=>{let e=this.axes[t];return e instanceof a.n1.PolarAxis?e:void 0},i=e(D6.Radius),s=e(D6.Angle);if(!i?.isReversed())return t;let o=s?.getAxisLinePoints()?.points??[];return t.concat(...o)}resetPaths(){super.resetPaths();let t=this.getAreaNode();if(t){let{path:e}=t,i=this.getAreaPoints(),a=D9(this.properties.fill,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults),s=this.getShapeFillBBox();D8(t,{fill:a,stroke:void 0,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset},void 0,s),t.lineJoin=t.lineCap="round",e.clear(!0),i.forEach(({x:t,y:i,moveTo:a,arc:s,radius:o=0,startAngle:r=0,endAngle:n=0})=>{s?e.arc(t,i,o,r,n):a?e.moveTo(t,i):e.lineTo(t,i)}),e.closePath(),t.checkPathDirty()}}};Mt.className="RadarAreaSeries",Mt.type="radar-area";var{commonSeriesOptionsDefs:Me,radarAreaSeriesThemeableOptionsDef:Mi}=a.n1,Ma={...Mi,...Me,type:(0,s.mw)((0,s.dY)("radar-area")),angleKey:(0,s.mw)(s.Yj),radiusKey:(0,s.mw)(s.Yj),angleName:s.Yj,radiusName:s.Yj},{ThemeConstants:{POLAR_AXIS_TYPE:Ms}}=a.n1,Mo={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-area",moduleFactory:t=>new Mt(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Ms.ANGLE_CATEGORY},{type:Ms.RADIUS_NUMBER}],themeTemplate:Dk},Mr=class extends DZ{updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}};Mr.className="RadarLineSeries",Mr.type="radar-line";var{commonSeriesOptionsDefs:Mn,radarLineSeriesThemeableOptionsDef:Ml}=a.n1,Mh={...Ml,...Mn,type:(0,s.mw)((0,s.dY)("radar-line")),angleKey:(0,s.mw)(s.Yj),radiusKey:(0,s.mw)(s.Yj),angleName:s.Yj,radiusName:s.Yj},{POLAR_AXIS_TYPE:Md}=a.n1.ThemeConstants,Mc={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-line",moduleFactory:t=>new Mr(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Md.ANGLE_CATEGORY},{type:Md.RADIUS_NUMBER}],themeTemplate:DS},{SeriesProperties:Mp,FillGradientDefaults:Mu,FillPatternDefaults:Mg,FillImageDefaults:My,SeriesTooltip:Mf,Property:Mm,Label:Mx}=a.n1,Mb=class extends Mp{constructor(){super(...arguments),this.fill="black",this.fillGradientDefaults=new Mu,this.fillPatternDefaults=new Mg,this.fillImageDefaults=new My,this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new Mx,this.tooltip=new Mf}};n([Mm],Mb.prototype,"angleKey",2),n([Mm],Mb.prototype,"radiusKey",2),n([Mm],Mb.prototype,"angleName",2),n([Mm],Mb.prototype,"radiusName",2),n([Mm],Mb.prototype,"fill",2),n([Mm],Mb.prototype,"fillGradientDefaults",2),n([Mm],Mb.prototype,"fillPatternDefaults",2),n([Mm],Mb.prototype,"fillImageDefaults",2),n([Mm],Mb.prototype,"fillOpacity",2),n([Mm],Mb.prototype,"stroke",2),n([Mm],Mb.prototype,"strokeWidth",2),n([Mm],Mb.prototype,"strokeOpacity",2),n([Mm],Mb.prototype,"lineDash",2),n([Mm],Mb.prototype,"lineDashOffset",2),n([Mm],Mb.prototype,"cornerRadius",2),n([Mm],Mb.prototype,"itemStyler",2),n([Mm],Mb.prototype,"rotation",2),n([Mm],Mb.prototype,"stackGroup",2),n([Mm],Mb.prototype,"normalizedTo",2),n([Mm],Mb.prototype,"label",2),n([Mm],Mb.prototype,"tooltip",2);var{SectorBox:Mv,motion:MS}=a.n1;function Mk(t){return{toFn:(e,i,a)=>{let s,o,r,n,l;return"removed"===a?l=new Mv(s=t,o=t,r=i.innerRadius,n=i.outerRadius):(s=i.startAngle,o=i.endAngle,r=isNaN(i.innerRadius)?e.innerRadius:i.innerRadius,n=isNaN(i.outerRadius)?e.outerRadius:i.outerRadius,l=i.clipSector),{startAngle:s,endAngle:o,innerRadius:r,outerRadius:n,clipSector:l}},fromFn:(e,i,a)=>{let s,o,r,n,l;return"removed"===(a=function(t,e,i){if("updated"===i){if(null==t.previousDatum||isNaN(t.previousDatum.innerRadius)||isNaN(t.previousDatum.outerRadius))return"added";if(isNaN(e.innerRadius)||isNaN(e.outerRadius))return"removed"}return"added"===i&&null!=t.previousDatum?"updated":i}(e,i,a))||"updated"===a?(s=e.startAngle,o=e.endAngle,r=e.innerRadius,n=e.outerRadius,l=e.clipSector):(s=t,o=t,r=i.innerRadius,n=i.outerRadius),l??(l=new Mv(s,o,r,n)),{startAngle:s,endAngle:o,innerRadius:r,outerRadius:n,clipSector:l,phase:MS.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a]}}}}function MD(t,e){return{centerX:0,centerY:0,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clipSector:e.clipSector}}var{ChartAxisDirection:MM,PolarAxis:Mw,diff:MI,groupAccumulativeValueProperty:MC,keyProperty:MA,normaliseGroupTo:ML,valueProperty:MT,fixNumericExtent:MN,resetLabelFn:MO,seriesLabelFadeInAnimation:MP,seriesLabelFadeOutAnimation:ME,animationValidation:MR,angleBetween:MB,createDatumId:Mz,CategoryScale:MF,Sector:M_,SectorBox:MW,motion:MG,isGradientFill:Mj,applyShapeStyle:MV,getShapeStyle:M$}=a.n1,MH=class extends a.n1.SeriesNodeEvent{constructor(t,e,i,a){super(t,e,i,a),this.angleKey=a.properties.angleKey,this.radiusKey=a.properties.radiusKey}},MY=class extends a.n1.PolarSeries{constructor(t){super({moduleCtx:t,categoryKey:"radiusValue",useLabelLayer:!0,canHaveAxes:!0,animationResetFns:{item:MD,label:MO}}),this.properties=new Mb,this.NodeEvent=MH,this.groupScale=new MF,this.circleCache={r:0,cx:0,cy:0}}get defaultShapeStyle(){let t=this.axes[MM.Angle]?.scale;return{...this.properties.fillGradientDefaults.toJson(),rotation:a.n1.toDegrees(t.range[0])+90}}nodeFactory(){return new M_}getSeriesDomain(t){let{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t!==MM.Angle)return e.getDomain(this,"radiusValue","key",i);{let t=e.getDomain(this,"angleValue-end","value",i);return MN([t[0]>0?0:t[0],t[1]<0?0:t[1]])}}async processData(t){let{angleKey:e,radiusKey:i,normalizedTo:a}=this.properties,o=!this.ctx.animationManager.isSkipped(),r=this.getStackId(),n=`${r}-trailing`,l=[];(0,s.vM)(a)&&l.push(ML([r,n],Math.abs(a))),o&&(this.processedData&&l.push(MI(this.id,this.processedData)),l.push(MR()));let h=this.visible?{}:{forceValue:0},d=this.axes[MM.Radius]?.scale.type,c=this.axes[MM.Angle]?.scale.type;await this.requestDataModel(t,this.data,{props:[MA(i,d,{id:"radiusValue"}),MT(e,c,{id:"angleValue-raw",invalidValue:null,...h}),...MC(e,"normal","current",{id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:r,separateNegative:!0,...h},c),...MC(e,"trailing","current",{id:"angleValue-start",invalidValue:null,groupId:n,separateNegative:!0,...h},c),...l],groupByKeys:!0,groupByData:!1}),this.animationState.transition("updateData")}didCircleChange(){let t=this.radius,e=this.centerX,i=this.centerY,a=this.circleCache;return(t!==a.r||e!==a.cx||i!==a.cy)&&(this.circleCache={r:t,cx:e,cy:i},!0)}maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;let{nodeData:t=[]}=this.createNodeData()??{};this.nodeData=t,this.nodeDataRefresh=!1}getAxisInnerRadius(){let t=this.axes[MM.Radius];return t instanceof Mw?this.radius*t.innerRadiusRatio:0}createNodeData(){let{processedData:t,dataModel:e}=this;if(!e||!t||"grouped"!==t.type)return;let i=this.axes[MM.Angle],a=this.axes[MM.Radius],s=i?.scale,o=a?.scale;if(!s||!o)return;let r=e.resolveKeysById(this,"radiusValue",t),n=e.resolveColumnById(this,"angleValue-start",t),l=e.resolveColumnById(this,"angleValue-end",t),h=e.resolveColumnById(this,"angleValue-raw",t),d=e.resolveProcessedDataIndexById(this,"angleValue-range"),c=0;a instanceof tG&&(c=a.groupPaddingInner);let{groupScale:p}=this,{index:u,visibleGroupCount:g}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);p.domain=Array.from({length:g}).map((t,e)=>String(e)),p.range=[0,Math.abs(o.bandwidth??0)],p.paddingInner=g>1?c:0;let y=p.bandwidth>=1?p.bandwidth:p.rawBandwidth,f=i.isReversed(),m=a.isReversed(),x=m?this.radius:this.getAxisInnerRadius(),b=(m?this.getAxisInnerRadius():this.radius)+x,{angleKey:v,radiusKey:S,angleName:k,radiusName:D,label:M}=this.properties,w=(t,e,i,a)=>{let s=this.getLabelText(M,{value:e,datum:t,angleKey:v,radiusKey:S,angleName:k,radiusName:D});if(s)return{x:i,y:a,text:s,textAlign:"center",textBaseline:"middle"}},I=[],C={itemId:S,nodeData:I,labelData:I};if(!this.visible)return C;let{dataSources:A}=t,L=A.get(this.id)??[];for(let{datumIndex:i,group:a}of e.forEachGroupDatum(this,t)){let t=L[i],e=r[i];if(null==e)return;let c=h[i],g=n[i],m=l[i],x=c>=0&&!Object.is(c,-0),v=a.aggregation[d][+!!x],S=x===f,k=s.convert(g,{clamp:!0}),D=s.convert(m,{clamp:!0}),M=s.convert(0,{clamp:!0}),C=s.convert(v,{clamp:!0});S&&([M,C]=[C,M],[k,D]=[D,k]);let A=b-o.convert(e)+p.convert(String(u)),T=A+y,N=(A+T)/2,O=k+MB(k,D)/2,P=Math.cos(O)*N,E=Math.sin(O)*N,R=this.properties.label.enabled?w(t,c,P,E):void 0,B=new MW(k,D,A,T);I.push({series:this,datum:t,datumIndex:i,point:{x:P,y:E,size:0},midPoint:{x:P,y:E},label:R,angleValue:c,radiusValue:e,innerRadius:A,outerRadius:T,startAngle:M,endAngle:C,clipSector:B,reversed:S,index:i})}return C}update({seriesRect:t}){let e=this.checkResize(t);this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}getItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle.item:void 0;return M$({fill:i?.fill??e.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke??e.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity,lineDash:i?.lineDash??e.lineDash,lineDashOffset:i?.lineDashOffset??e.lineDashOffset,cornerRadius:e.cornerRadius},this.defaultShapeStyle,e.fillPatternDefaults,e.fillImageDefaults)}getItemStyleOverrides(t,e,i,a){let s,{id:o,properties:r}=this,{angleKey:n,radiusKey:l,itemStyler:h}=r;return null!=h&&(s=this.cachedDatumCallback(Mz(t,a?"highlight":"node"),()=>this.callWithContext(h,{seriesId:o,datum:e,highlighted:a,angleKey:n,radiusKey:l,...i}))),M$(s,this.defaultShapeStyle,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateSectorSelection(t,e){let i=[];if(e){let t=this.ctx.highlightManager?.getActiveHighlight();t?.datum&&t.series===this&&i.push(t)}else i=this.nodeData;let s=this.getItemBaseStyle(e),o=this.getShapeFillBBox();t.update(i,void 0,t=>this.getDatumId(t)).each((t,i)=>{let{datum:r,datumIndex:n}=i,l=this.getItemStyleOverrides(String(n),r,s,e),h=l?.cornerRadius??s.cornerRadius,d=l?.fill??s.fill;MV(t,s,l,o,a.n1.isGradientFill(d)&&"item"!==d.bounds?{centerX:0,centerY:0}:void 0),t.lineJoin="round",t.inset=null!=t.stroke?t.strokeWidth/2:0,t.startInnerCornerRadius=r.reversed?h:0,t.startOuterCornerRadius=r.reversed?h:0,t.endInnerCornerRadius=r.reversed?0:h,t.endOuterCornerRadius=r.reversed?0:h,e&&(t.startAngle=i.startAngle,t.endAngle=i.endAngle,t.clipSector=i.clipSector,t.innerRadius=i.innerRadius,t.outerRadius=i.outerRadius)})}updateLabels(){let{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}getBarTransitionFunctions(){let t=this.axes[MM.Angle]?.scale,e=0;if(!t)return Mk(e);let i=Math.min(t.domain[0],t.domain[1]),a=Math.max(t.domain[0],t.domain[1]);return i<=0&&a>=0&&(e=t.convert(0)),Mk(e)}animateEmptyUpdateReady(){let{labelSelection:t}=this,e=this.getBarTransitionFunctions();MG.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),MP(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){let{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getBarTransitionFunctions();MG.fromToMotion(this.id,"datums",e,[t],i),ME(this,"labels",e,this.labelSelection)}getTooltipContent(t){let{id:e,dataModel:i,processedData:a,axes:s,properties:o}=this,{angleKey:r,angleName:n,radiusKey:l,radiusName:h,tooltip:d}=o,c=s[MM.Angle],p=s[MM.Radius];if(!i||!a||!c||!p)return;let u=a.dataSources.get(this.id)?.[t],g=i.resolveKeysById(this,"radiusValue",a)[t],y=i.resolveColumnById(this,"angleValue-raw",a)[t];if(null==g)return;let f=this.getItemBaseStyle(!1);return Object.assign(f,this.getItemStyleOverrides(String(t),t,f,!1)),this.formatTooltipWithContext(d,{heading:p.formatDatum(g),symbol:this.legendItemSymbol(),data:[{label:n,fallbackLabel:r,value:c.formatDatum(y)}]},{seriesId:e,datum:u,title:n,angleKey:r,angleName:n,radiusKey:l,radiusName:h,...f})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}legendItemSymbol(){let{fill:t,stroke:e,fillOpacity:i,strokeOpacity:a,strokeWidth:s,lineDash:o,lineDashOffset:r,fillPatternDefaults:n,fillImageDefaults:l}=this.properties,h=M$({fill:t??"rgba(0, 0, 0, 0)",stroke:e??"rgba(0, 0, 0, 0)",fillOpacity:i,strokeOpacity:a,strokeWidth:s,lineDash:o,lineDashOffset:r},this.defaultShapeStyle,n,l);return Mj(h.fill)&&(h.fill={...h.fill,gradient:"linear",rotation:0,reverse:!1}),{marker:h}}getLegendData(t){if("category"!==t)return[];let{id:e,visible:i}=this,{angleKey:a,angleName:s,showInLegend:o}=this.properties;return[{legendType:"category",id:e,itemId:a,seriesId:e,enabled:i,label:{text:s??a},symbol:this.legendItemSymbol(),hideInLegend:!o}]}getDatumId(t){return Mz(t.radiusValue)}computeLabelsBBox(){return null}getStackId(){let t=this.seriesGrouping?.groupIndex??this.id;return`radialBar-stack-${t}-xValues`}};MY.className="RadialBarSeries",MY.type="radial-bar";var{commonSeriesOptionsDefs:MK,radialBarSeriesThemeableOptionsDef:MU}=a.n1,MX={...MU,...MK,type:(0,s.mw)((0,s.dY)("radial-bar")),angleKey:(0,s.mw)(s.Yj),radiusKey:(0,s.mw)(s.Yj),angleName:s.Yj,radiusName:s.Yj,grouped:s.zM,stacked:s.zM,stackGroup:s.Yj,normalizedTo:s.ai},{ThemeConstants:{POLAR_AXIS_TYPE:MZ}}=a.n1,MQ={series:{fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"conic",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"}}},axes:{[MZ.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},{POLAR_AXIS_TYPE:Mq}=a.n1.ThemeConstants,MJ={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-bar",moduleFactory:t=>new MY(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:Mq.ANGLE_NUMBER},{type:Mq.RADIUS_CATEGORY}],themeTemplate:MQ,stackable:!0,groupable:!0},{Property:M0}=a.n1,M1=class extends kA{};n([M0],M1.prototype,"columnWidthRatio",2),n([M0],M1.prototype,"maxColumnWidthRatio",2);var{ChartAxisDirection:M2,PolarAxis:M4,RadialColumnShape:M5,getRadialColumnWidth:M3}=a.n1,M6=class extends kv{constructor(t){super(t,{animationResetFns:{item:kO}}),this.properties=new M1}getStackId(){let t=this.seriesGrouping?.groupIndex??this.id;return`radarColumn-stack-${t}-yValues`}nodeFactory(){return new M5}getColumnTransitionFunctions(){var t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();let e=kT();return{toFn:(i,a,s)=>{let o,r,n,l,h,{startAngle:d,endAngle:c}=e.to(a);return"removed"===s?(o=i.innerRadius,r=i.innerRadius,n=i.columnWidth,l=i.axisInnerRadius,h=i.axisOuterRadius):(o=isNaN(a.innerRadius)?t:a.innerRadius,r=isNaN(a.outerRadius)?t:a.outerRadius,n=isNaN(a.columnWidth)?i.columnWidth:a.columnWidth,l=a.axisInnerRadius,h=a.axisOuterRadius),{innerRadius:o,outerRadius:r,columnWidth:n,axisInnerRadius:l,axisOuterRadius:h,startAngle:d,endAngle:c}},fromFn:(i,a,s)=>{let o,r,n,l,h;s=kN(i,a,s),e.calculate(i,a,s);let{startAngle:d,endAngle:c}=e.from(a);return"removed"===s||"updated"===s?(o=i.innerRadius,r=i.outerRadius,n=i.columnWidth,l=i.axisInnerRadius,h=i.axisOuterRadius):(o=t,r=t,n=a.columnWidth,l=a.axisInnerRadius,h=a.axisOuterRadius),{innerRadius:o,outerRadius:r,columnWidth:n,axisInnerRadius:l,axisOuterRadius:h,startAngle:d,endAngle:c,phase:kL.NODE_UPDATE_STATE_TO_PHASE_MAPPING[s]}}}}isRadiusAxisCircle(){let t=this.axes[M2.Radius];return t instanceof M4&&"circle"===t.shape}updateItemPath(t,e,i){t.isBeveled=this.isRadiusAxisCircle(),t.isRadiusAxisReversed=this.isRadiusAxisReversed(),i&&(t.innerRadius=e.innerRadius,t.outerRadius=e.outerRadius,t.startAngle=e.startAngle,t.endAngle=e.endAngle,t.columnWidth=e.columnWidth,t.axisInnerRadius=e.axisInnerRadius,t.axisOuterRadius=e.axisOuterRadius)}getColumnWidth(t,e){let{columnWidthRatio:i=.5,maxColumnWidthRatio:a=.5}=this.properties;return M3(t,e,this.radius,i,a)}};M6.className="RadialColumnSeries",M6.type="radial-column";var{commonSeriesOptionsDefs:M8,radialColumnSeriesThemeableOptionsDef:M9}=a.n1,M7={...M9,...M8,type:(0,s.mw)((0,s.dY)("radial-column")),angleKey:(0,s.mw)(s.Yj),radiusKey:(0,s.mw)(s.Yj),angleName:s.Yj,radiusName:s.Yj,grouped:s.zM,stacked:s.zM,stackGroup:s.Yj,normalizedTo:s.ai},{ThemeConstants:{POLAR_AXIS_TYPE:wt,POLAR_AXIS_SHAPE:we}}=a.n1,wi={$path:["./shape",we.CIRCLE,{$find:[{$not:[{$isOperation:"./shape"}]},{$path:".."}]}]},wa={series:{fill:{$palette:"fill"},stroke:{$palette:"stroke"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:0,label:{enabled:!1,fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"}}},axes:{[wt.ANGLE_CATEGORY]:{shape:wi,groupPaddingInner:0,paddingInner:0,label:{spacing:10}},[wt.RADIUS_NUMBER]:{shape:wi,innerRadiusRatio:.5}}},{POLAR_AXIS_TYPE:ws}=a.n1.ThemeConstants,wo={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-column",moduleFactory:t=>new M6(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:ws.ANGLE_CATEGORY},{type:ws.RADIUS_NUMBER}],themeTemplate:wa,stackable:!0,groupable:!0},{SvgPath:wr,Rotatable:wn,Translatable:wl,Scalable:wh}=a.n1,wd=class extends wn(wh(wl(wr))){constructor(){super(...arguments),this.scalingCenterX=.5,this.scalingCenterY=.5,this.rotationCenterX=.5,this.rotationCenterY=.5}};wd.defaultPathData="M0.50245 0.53745C0.481767 0.53745 0.465 0.520683 0.465 0.5C0.465 0.479317 0.481767 0.46255 0.50245 0.46255L1 0.500012L0.50245 0.53745Z";var{BaseProperties:wc,SeriesTooltip:wp,SeriesProperties:wu,PropertiesArray:wg,AxisLabel:wy,Property:wf,Label:wm}=a.n1,wx=class extends wm{};n([wf],wx.prototype,"spacing",2);var wb=class extends wc{constructor(){super(...arguments),this.label=new wx}};n([wf],wb.prototype,"text",2),n([wf],wb.prototype,"value",2),n([wf],wb.prototype,"shape",2),n([wf],wb.prototype,"placement",2),n([wf],wb.prototype,"spacing",2),n([wf],wb.prototype,"size",2),n([wf],wb.prototype,"rotation",2),n([wf],wb.prototype,"fill",2),n([wf],wb.prototype,"fillOpacity",2),n([wf],wb.prototype,"stroke",2),n([wf],wb.prototype,"strokeWidth",2),n([wf],wb.prototype,"strokeOpacity",2),n([wf],wb.prototype,"lineDash",2),n([wf],wb.prototype,"lineDashOffset",2),n([wf],wb.prototype,"label",2);var wv=class extends wc{constructor(){super(...arguments),this.enabled=!0,this.fills=new wg(a.n1.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};n([wf],wv.prototype,"enabled",2),n([wf],wv.prototype,"fills",2),n([wf],wv.prototype,"fillMode",2),n([wf],wv.prototype,"fill",2),n([wf],wv.prototype,"fillOpacity",2),n([wf],wv.prototype,"stroke",2),n([wf],wv.prototype,"strokeWidth",2),n([wf],wv.prototype,"strokeOpacity",2),n([wf],wv.prototype,"lineDash",2),n([wf],wv.prototype,"lineDashOffset",2);var wS=class extends wc{constructor(){super(...arguments),this.values=void 0,this.step=void 0,this.minSpacing=0,this.maxSpacing=1e3}};n([wf],wS.prototype,"values",2),n([wf],wS.prototype,"step",2),n([wf],wS.prototype,"minSpacing",2),n([wf],wS.prototype,"maxSpacing",2);var wk=class extends wy{},wD=class extends wc{constructor(){super(...arguments),this.min=0,this.max=1,this.fills=new wg(a.n1.StopProperties),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black",this.interval=new wS,this.label=new wk}};n([wf],wD.prototype,"min",2),n([wf],wD.prototype,"max",2),n([wf],wD.prototype,"fills",2),n([wf],wD.prototype,"fillMode",2),n([wf],wD.prototype,"fill",2),n([wf],wD.prototype,"fillOpacity",2),n([wf],wD.prototype,"stroke",2),n([wf],wD.prototype,"strokeWidth",2),n([wf],wD.prototype,"strokeOpacity",2),n([wf],wD.prototype,"lineDash",2),n([wf],wD.prototype,"lineDashOffset",2),n([wf],wD.prototype,"defaultFill",2),n([wf],wD.prototype,"interval",2),n([wf],wD.prototype,"label",2);var wM=class extends wc{constructor(){super(...arguments),this.enabled=!0,this.spacing=0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};n([wf],wM.prototype,"enabled",2),n([wf],wM.prototype,"radiusRatio",2),n([wf],wM.prototype,"spacing",2),n([wf],wM.prototype,"fill",2),n([wf],wM.prototype,"fillOpacity",2),n([wf],wM.prototype,"stroke",2),n([wf],wM.prototype,"strokeWidth",2),n([wf],wM.prototype,"strokeOpacity",2),n([wf],wM.prototype,"lineDash",2),n([wf],wM.prototype,"lineDashOffset",2);var ww=class extends ux{};n([wf],ww.prototype,"text",2);var wI=class extends ub{};n([wf],wI.prototype,"text",2);var wC=class extends wu{constructor(){super(...arguments),this.startAngle=0,this.endAngle=0,this.segmentation=new x6,this.defaultColorRange=[],this.targets=new wg(wb),this.defaultTarget=new wb,this.outerRadiusRatio=1,this.innerRadiusRatio=1,this.cornerRadius=0,this.cornerMode="container",this.spacing=0,this.scale=new wD,this.bar=new wv,this.needle=new wM,this.label=new ww,this.secondaryLabel=new wI,this.tooltip=new wp}};n([wf],wC.prototype,"value",2),n([wf],wC.prototype,"startAngle",2),n([wf],wC.prototype,"endAngle",2),n([wf],wC.prototype,"segmentation",2),n([wf],wC.prototype,"defaultColorRange",2),n([wf],wC.prototype,"targets",2),n([wf],wC.prototype,"defaultTarget",2),n([wf],wC.prototype,"outerRadiusRatio",2),n([wf],wC.prototype,"innerRadiusRatio",2),n([wf],wC.prototype,"outerRadius",2),n([wf],wC.prototype,"innerRadius",2),n([wf],wC.prototype,"cornerRadius",2),n([wf],wC.prototype,"cornerMode",2),n([wf],wC.prototype,"spacing",2),n([wf],wC.prototype,"scale",2),n([wf],wC.prototype,"bar",2),n([wf],wC.prototype,"needle",2),n([wf],wC.prototype,"label",2),n([wf],wC.prototype,"secondaryLabel",2),n([wf],wC.prototype,"tooltip",2);var{SectorBox:wA}=a.n1;function wL(t,e,i){return Math.max(t,i.startAngle)<=Math.min(e,i.endAngle)}function wT(t){return null!=t.clipStartAngle&&null!=t.clipEndAngle}function wN(t,e){let{clipStartAngle:i,clipEndAngle:a,innerRadius:s,outerRadius:o}=t;return new wA(i,e?i:a,s,o)}function wO(t,e){let i=t?"initial":"update";return{node:{fromFn(e,a){let s,o=e.previousDatum,{startAngle:r,endAngle:n}=o??a,l=null!=o&&wT(o)?wN(o,t):void 0,h=wT(a)?wN(a,t):void 0;return null!=l&&null!=h?s=l:null==l&&null!=h?(s=h,r=a.startAngle,n=a.endAngle):null!=l&&null==h?(s=void 0,r=a.startAngle,n=a.endAngle):t&&(n=r),{startAngle:r,endAngle:n,clipSector:s,phase:i}},toFn(t,e){let i,{startAngle:a,endAngle:s}=e;return wT(e)&&(i=wN(e,!1)),{startAngle:a,endAngle:s,clipSector:i}},applyFn(t,e){let{startAngle:i,endAngle:a}=e,{clipSector:s}=e;null!=s&&(s=new wA(Math.max(i,s.startAngle),Math.min(a,s.endAngle),s.innerRadius,s.outerRadius));let o=null==s||wL(i,a,s);t.startAngle=i,t.endAngle=a,t.clipSector=s,t.visible=o}},needle:{fromFn(a){let{angle:s}=a.previousDatum??a.datum;return t&&(s=e),{rotation:s,phase:i}},toFn(t,e){let{angle:i}=e;return{rotation:i}}}}}function wP(t,e){let{startAngle:i,endAngle:a}=e,s=function(t){let{startAngle:e,endAngle:i,clipStartAngle:a,clipEndAngle:s,innerRadius:o,outerRadius:r}=t;if(null!=a&&null!=s)return new wA(Math.max(a,e),Math.min(s,i),o,r)}(e),o=null==s||wL(i,a,s);return{startAngle:i,endAngle:a,clipSector:s,visible:o}}function wE(t,e){let{angle:i}=e;return{rotation:i}}var wR={top:0,middle:.5,bottom:1},{fromToMotion:wB,resetMotion:wz,CachedTextMeasurerPool:wF,SeriesNodePickMode:w_,StateMachine:wW,createDatumId:wG,normalizeAngle360:wj,normalizeAngle360Inclusive:wV,isBetweenAngles:w$,sectorBox:wH,toDegrees:wY,toRadians:wK,BBox:wU,Group:wX,PointerEvents:wZ,Selection:wQ,Sector:wq,SectorBox:wJ,Text:w0,Marker:w1,getColorStops:w2}=a.n1,w4={inside:90,middle:0,outside:-90},w5=[{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"},{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"}],w3=[{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"},{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"}],w6=class extends a.n1.Series{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[w_.EXACT_SHAPE_MATCH,w_.NEAREST_NODE]}),this.centerX=0,this.centerY=0,this.radius=0,this.textAlign="center",this.verticalAlign="middle",this.properties=new wC,this.scale=new tt,this.scaleGroup=this.contentGroup.appendChild(new wX({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new wX({name:"itemGroup"})),this.itemNeedleGroup=this.contentGroup.appendChild(new wX({name:"itemNeedleGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new wX({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new wX({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new wX({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new wX({name:"itemTargetLabelGroup"})),this.tickGroup=this.contentGroup.appendChild(new wX({name:"tickGroup"})),this.scaleSelection=wQ.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=wQ.select(this.itemGroup,()=>this.nodeFactory()),this.needleSelection=wQ.select(this.itemNeedleGroup,wd),this.targetSelection=wQ.select(this.itemTargetGroup,()=>this.markerFactory()),this.targetLabelSelection=wQ.select(this.itemTargetLabelGroup,w0),this.labelSelection=wQ.select(this.itemLabelGroup,w0),this.highlightTargetSelection=wQ.select(this.highlightTargetGroup,()=>this.markerFactory()),this.tickSelection=wQ.select(this.tickGroup,a.n1.TransformableText),this.datumUnion=new xX,this.animationState=new wW("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.scaleGroup.pointerEvents=wZ.None,this.tickGroup.pointerEvents=wZ.None,this.itemNeedleGroup.pointerEvents=wZ.None,this.itemLabelGroup.pointerEvents=wZ.None}get hasData(){return null!=this.properties.value}nodeFactory(){return new wq}markerFactory(){let t=new w1;return t.size=1,t}processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(t){let{min:e,max:i}=this.properties.scale;return xQ(t,{min:e,max:i})}layoutScale(){let{scale:t,properties:e}=this,{seriesRectWidth:i,seriesRectHeight:a}=this.nodeDataDependencies,{scale:o,outerRadius:r}=this.properties,{min:n,max:l,label:h,interval:d}=o,c=wK(e.startAngle-90),p=wK(e.endAngle-90),u=wV(p-c)>Math.PI,g=u||w$(1.5*Math.PI,c,p),y=u||w$(0*Math.PI,c,p),f=u||w$(.5*Math.PI,c,p),m=u||w$(+Math.PI,c,p),x=wH({startAngle:c,endAngle:p,innerRadius:0,outerRadius:.5}),b=-(2*(x.x+x.width/2)),v=-(2*(x.y+x.height/2)),S=Math.min(i/x.width,a/x.height);t.domain=[n,l],t.range=[c,p],t.arcLength=S/2;let{maxSpacing:k,minSpacing:D}=d,{arcLength:M}=t,w=k?Math.floor(M/k):1,I=D?Math.floor(M/D):1/0,C=Math.max(w,Math.min(I,Math.floor(4/Math.PI*Math.abs(t.range[0]-t.range[1])))),A=d.values??t.ticks({nice:!1,interval:d.step,minTickCount:w,maxTickCount:I,tickCount:C})?.ticks??[],L=A.reduce((t,e)=>Math.max(t,"number"==typeof e?(0,s.o3)(e):0),0),T=t.tickFormatter({domain:t.domain,ticks:A,fractionDigits:L,specifier:"string"==typeof h.format?h.format:void 0}),N=h.getFont(),O=A.map((e,i)=>{let a;h.formatter&&(a=xJ(this.ctx,h.formatter,{value:e,index:i,domain:t.domain,boundSeries:void 0})),void 0===a&&(a=T(e));let{width:s,height:o}=wF.measureText(a,{font:N});return{index:i,value:e,text:a,width:s,height:o}}),P=O.reduce((t,e)=>Math.max(t,e.width),0),E=O.reduce((t,e)=>Math.max(t,e.height),0),R=Math.max(.5*S-(h.enabled?Math.max(P,E)+h.spacing:0),0),B=r??R;return this.centerX=i/2+b*B,this.centerY=a/2+v*B,this.radius=B,this.textAlign=m&&!y?"right":!m&&y?"left":"center",this.verticalAlign=g&&!f?"bottom":!g&&f?"top":"middle",O}createConicGradient(t,e){let{scale:i}=this,{domain:a,range:s}=i,[o,r]=s,{defaultColorRange:n}=this.properties,l=wj((o+r)/2+Math.PI),h=wV(r-o);return{type:"gradient",gradient:"conic",colorSpace:"oklch",colorStops:w2(t,n,a,e).map(({color:t,stop:e})=>({stop:e=((e=(o+h*(e=Math.min(Math.max(e,0),1))-l)/(2*Math.PI))%1+1)%1,color:t})),rotation:wY(l)+90}}getShapeFillBBox(){let{centerX:t,centerY:e,radius:i}=this;return new wU(t-i,e-i,2*i,2*i)}getTargets(){let{properties:t}=this,e=t.defaultTarget;return Array.from(t.targets).map(t=>{let{text:i=e.text,value:a=e.value??0,shape:s=e.shape??"triangle",rotation:o=e.rotation??0,strokeWidth:r=e.strokeWidth??0,placement:n=e.placement??"middle",spacing:l=e.spacing??0,size:h=e.size??0,fill:d=e.fill??"black",fillOpacity:c=e.fillOpacity??1,stroke:p=e.stroke??"black",strokeOpacity:u=e.strokeOpacity??1,lineDash:g=e.lineDash??[0],lineDashOffset:y=e.lineDashOffset??0}=t,{enabled:f=e.label.enabled,color:m=e.label.color??"black",fontStyle:x=e.label.fontStyle??"normal",fontWeight:b=e.label.fontWeight??"normal",fontSize:v=e.label.fontSize,fontFamily:S=e.label.fontFamily,spacing:k=e.label.spacing??0}=t.label;return{text:i,value:a,shape:s,placement:n,spacing:l,size:h,rotation:o,fill:d,fillOpacity:c,stroke:p,strokeWidth:r,strokeOpacity:u,lineDash:g,lineDashOffset:y,label:{enabled:f,color:m,fontStyle:x,fontWeight:b,fontSize:v,fontFamily:S,spacing:k}}})}getTargetRadius(t){let{radius:e,properties:i}=this,{innerRadiusRatio:a,outerRadiusRatio:s}=i,{placement:o,spacing:r,size:n}=t,l=e*s,h=e*a;switch(o){case"inside":return Math.max(h-r-n/2,0);case"outside":return l+r+n/2;default:return(h+l)/2}}getTargetLabel(t){let e,i,a,s,{scale:o}=this,{value:r,size:n,placement:l,label:h}=t,{spacing:d,color:c,fontStyle:p,fontWeight:u,fontSize:g,fontFamily:y}=h,f=o.convert(r),m=wj(f)/(Math.PI/2)|0,x=n/2+d;switch(l){case"outside":({textAlign:e,textBaseline:i}=w5[m]),a=x*Math.cos(f),s=x*Math.sin(f);break;case"inside":({textAlign:e,textBaseline:i}=w3[m]),a=-x*Math.cos(f),s=-x*Math.sin(f);break;default:e="center",i="bottom",a=0,s=-x}return{offsetX:a,offsetY:s,fill:c,textAlign:e,textBaseline:i,fontStyle:p,fontWeight:u,fontSize:g,fontFamily:y,lineHeight:void 0}}createNodeData(){let t=this.layoutScale(),{id:e,scale:i,properties:a,radius:s,centerX:o,centerY:r}=this,{value:n,innerRadiusRatio:l,outerRadiusRatio:h,segmentation:d,cornerRadius:c,cornerMode:p,needle:u,bar:g,scale:y,label:f,secondaryLabel:m}=a,{outerRadius:x=s*h,innerRadius:b=s*l}=a,v=this.getTargets(),S=[],k=[],D=[],M=[],w=[],I="item"===p,C=i.convert(i.domain[0]),A=i.convert(n),L=Math.ceil(wV(A-C)*s),T=d.enabled?d.interval.getSegments(i,L):void 0,N=g.enabled?g.fill??this.createConicGradient(g.fills,g.fillMode):"rgba(0,0,0,0)",O=y.fill??(g.enabled&&0===y.fills.length?y.defaultFill:void 0)??this.createConicGradient(y.fills,y.fillMode);if(null==T&&I){let t={value:n,segmentStart:Math.min(...i.domain),segmentEnd:Math.max(...i.domain)},e=Math.min(c,(x-b)/2)/((b+x)/2);S.push({series:this,itemId:"value",datum:t,datumIndex:{type:0},type:0,centerX:o,centerY:r,outerRadius:x,innerRadius:b,startAngle:C-e,endAngle:A+e,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:c,endCornerRadius:c,fill:N}),w.push({series:this,itemId:"scale",datum:t,datumIndex:{type:0},type:0,centerX:o,centerY:r,outerRadius:x,innerRadius:b,startAngle:i.range[0]-e,endAngle:i.range[1]+e,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:c,endCornerRadius:c,fill:O})}else{T??(T=i.domain);for(let t=0;t<T.length-1;t++){let e=T[t],a=T[t+1],s={value:n,segmentStart:e,segmentEnd:a},l=0===t,h=t===T.length-2,d=i.convert(e),p=i.convert(a);S.push({series:this,itemId:`value-${t}`,datum:s,datumIndex:{type:0},type:0,centerX:o,centerY:r,outerRadius:x,innerRadius:b,startAngle:d,endAngle:p,clipStartAngle:C,clipEndAngle:A,startCornerRadius:I||l?c:0,endCornerRadius:I||h?c:0,fill:N}),w.push({series:this,itemId:`scale-${t}`,datum:s,datumIndex:{type:0},type:0,centerX:o,centerY:r,outerRadius:x,innerRadius:b,startAngle:d,endAngle:p,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:I||l?c:0,endCornerRadius:I||h?c:0,fill:O})}}if(!u.enabled&&f.enabled){let{text:t,color:e,fontSize:i,minimumFontSize:a,fontStyle:s,fontWeight:l,fontFamily:h,lineHeight:d,formatter:c=t=>this.formatLabel(t.value)}=f;M.push({label:"primary",centerX:o,centerY:r,text:t,value:n,fill:e,fontSize:i,minimumFontSize:a,fontStyle:s,fontWeight:l,fontFamily:h,lineHeight:d,formatter:c})}if(!u.enabled&&m.enabled){let{text:t,color:e,fontSize:i,minimumFontSize:a,fontStyle:s,fontWeight:l,fontFamily:h,lineHeight:d,formatter:c}=m;M.push({label:"secondary",centerX:o,centerY:r,text:t,value:n,fill:e,fontSize:i,minimumFontSize:a,fontStyle:s,fontWeight:l,fontFamily:h,lineHeight:d,formatter:c})}if(u.enabled){let t=null!=u.radiusRatio?s*u.radiusRatio:b;t=Math.max(t-u.spacing,0);let e=i.convert(n);D.push({centerX:o,centerY:r,radius:t,angle:e,series:this})}for(let t=0;t<v.length;t+=1){let e=v[t],{value:a,text:s,size:n,shape:l,fill:h,fillOpacity:d,stroke:c,strokeWidth:p,strokeOpacity:u,lineDash:g,lineDashOffset:y}=e;if(a<Math.min(...i.domain)||a>Math.max(...i.domain))continue;let f=this.getTargetRadius(e),m=i.convert(a),x=wK(e.rotation+w4[e.placement]);k.push({series:this,itemId:`target-${t}`,midPoint:{x:f*Math.cos(m)+o,y:f*Math.sin(m)+r},datum:{value:a},datumIndex:{type:1,index:t},type:1,value:a,text:s,centerX:o,centerY:r,shape:l,radius:f,angle:m,rotation:x,size:n,fill:h,fillOpacity:d,stroke:c,strokeOpacity:u,strokeWidth:p,lineDash:g,lineDashOffset:y,label:this.getTargetLabel(e)})}return{itemId:e,nodeData:S,needleData:D,targetData:k,labelData:M,scaleData:w,tickData:t}}updateSelections(t){(this.nodeDataRefresh||t)&&(this.contextNodeData=this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(t){if(null!=t&&t.series===this&&1===t.type)return t}update({seriesRect:t}){let{datumSelection:e,labelSelection:i,needleSelection:a,targetSelection:s,targetLabelSelection:o,scaleSelection:r,highlightTargetSelection:n,tickSelection:l}=this,h=this.checkResize(t);this.updateSelections(h),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let d=this.contextNodeData?.nodeData??[],c=this.contextNodeData?.labelData??[],p=this.contextNodeData?.needleData??[],u=this.contextNodeData?.targetData??[],g=this.contextNodeData?.scaleData??[],y=this.contextNodeData?.tickData??[],f=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=this.updateScaleSelection({scaleData:g,scaleSelection:r}),this.updateScaleNodes({scaleSelection:r}),this.needleSelection=this.updateNeedleSelection({needleData:p,needleSelection:a}),this.updateNeedleNodes({needleSelection:a}),this.targetSelection=this.updateTargetSelection({targetData:u,targetSelection:s}),this.updateTargetNodes({targetSelection:s,isHighlight:!1}),this.targetLabelSelection=this.updateTargetLabelSelection({targetData:u,targetLabelSelection:o}),this.updateTargetLabelNodes({targetLabelSelection:o}),this.datumSelection=this.updateDatumSelection({nodeData:d,datumSelection:e}),this.updateDatumNodes({datumSelection:e}),this.labelSelection=this.updateLabelSelection({labelData:c,labelSelection:i}),this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=this.updateTargetSelection({targetData:null!=f?[f]:[],targetSelection:n}),this.updateTargetNodes({targetSelection:n,isHighlight:!0}),this.tickSelection=this.updateTickSelection({tickData:y,tickSelection:l}),this.updateTickNodes({tickSelection:l}),h&&this.animationState.transition("resize"),this.animationState.transition("update")}updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>wG(t.nodeData.length,e.itemId))}updateDatumNodes(t){let{datumSelection:e}=t,{ctx:i,properties:s}=this,{bar:o,segmentation:r}=s,n=r.spacing??0,{fillOpacity:l,stroke:h,strokeOpacity:d,lineDash:c,lineDashOffset:p}=o,u=this.getStrokeWidth(o.strokeWidth),g=i.animationManager.isSkipped(),y=this.getShapeFillBBox();e.each((t,e)=>{let{centerX:i,centerY:s,innerRadius:o,outerRadius:r,startCornerRadius:f,endCornerRadius:m,fill:x}=e;t.centerX=i,t.centerY=s,t.innerRadius=o,t.outerRadius=r,t.pointerEvents=this.properties.bar.enabled?a.n1.PointerEvents.All:a.n1.PointerEvents.None,t.fill=x,t.fillBBox=y,t.fillOpacity=l,t.stroke=h,t.strokeOpacity=d,t.strokeWidth=u,t.lineDash=c,t.lineDashOffset=p,t.startOuterCornerRadius=f,t.startInnerCornerRadius=f,t.endOuterCornerRadius=m,t.endInnerCornerRadius=m,t.radialEdgeInset=(n+t.strokeWidth)/2,t.concentricEdgeInset=t.strokeWidth/2,(g||null==t.previousDatum)&&t.setProperties(wP(t,e))}),this.datumUnion.update(e,this.itemGroup,a.n1.Sector,(t,e,i)=>{t.clipSector??(t.clipSector=new wJ(NaN,NaN,NaN,NaN)),t.centerX=e.centerX,t.centerY=e.centerY,t.outerRadius=t.clipSector.outerRadius=e.outerRadius,t.innerRadius=t.clipSector.innerRadius=e.innerRadius,t.startAngle=t.clipSector.startAngle=e.startAngle,t.startInnerCornerRadius=e.startInnerCornerRadius,t.startOuterCornerRadius=e.startOuterCornerRadius,t.endAngle=i.endAngle,t.clipSector.endAngle=i.clipSector?.endAngle??i.endAngle,t.endInnerCornerRadius=i.endInnerCornerRadius,t.endOuterCornerRadius=i.endOuterCornerRadius,t.pointerEvents=a.n1.PointerEvents.None})}updateScaleSelection(t){return t.scaleSelection.update(t.scaleData,void 0,e=>wG(t.scaleData.length,e.itemId))}updateScaleNodes(t){let{scaleSelection:e}=t,{scale:i,segmentation:a}=this.properties,s=a.spacing??0,{fillOpacity:o,stroke:r,strokeOpacity:n,strokeWidth:l,lineDash:h,lineDashOffset:d}=i,c=this.getShapeFillBBox();e.each((t,e)=>{let{centerX:i,centerY:a,innerRadius:p,outerRadius:u,startCornerRadius:g,endCornerRadius:y,fill:f}=e;t.centerX=i,t.centerY=a,t.innerRadius=p,t.outerRadius=u,t.fill=f,t.fillBBox=c,t.fillOpacity=o,t.stroke=r,t.strokeOpacity=n,t.strokeWidth=l,t.lineDash=h,t.lineDashOffset=d,t.startOuterCornerRadius=g,t.startInnerCornerRadius=g,t.endOuterCornerRadius=y,t.endInnerCornerRadius=y,t.radialEdgeInset=(s+t.strokeWidth)/2,t.concentricEdgeInset=t.strokeWidth/2,t.setProperties(wP(t,e))})}updateNeedleSelection(t){return t.needleSelection.update(t.needleData,void 0,()=>wG([]))}updateNeedleNodes(t){let{needleSelection:e}=t,{fill:i,fillOpacity:a,stroke:s,strokeOpacity:o,strokeWidth:r,lineDash:n,lineDashOffset:l}=this.properties.needle,h=this.ctx.animationManager.isSkipped();e.each((t,e)=>{let{centerX:d,centerY:c,radius:p}=e,u=2*p;t.d=wd.defaultPathData,t.fill=i,t.fillOpacity=a,t.stroke=s,t.strokeOpacity=o,t.strokeWidth=r/u,t.lineDash=n.map(t=>t/u),t.lineDashOffset=l/u,t.translationX=d,t.translationY=c,t.scalingX=u,t.scalingY=u,h&&t.setProperties(wE(t,e))})}updateTargetSelection(t){return t.targetSelection.update(t.targetData,void 0,t=>t.itemId)}updateTargetNodes(t){let{targetSelection:e,isHighlight:i}=t,a=i?this.properties.highlightStyle.item:void 0;e.each((t,e)=>{let{centerX:i,centerY:s,angle:o,radius:r,shape:n,size:l,rotation:h,fill:d,fillOpacity:c,stroke:p,strokeOpacity:u,strokeWidth:g,lineDash:y,lineDashOffset:f}=e;t.shape="line"===n?x0:n,t.size=l,t.fill=a?.fill??d,t.fillOpacity=a?.fillOpacity??c,t.stroke=a?.stroke??p,t.strokeOpacity=a?.strokeOpacity??u,t.strokeWidth=a?.strokeWidth??g,t.lineDash=a?.lineDash??y,t.lineDashOffset=a?.lineDashOffset??f,t.translationX=i+r*Math.cos(o),t.translationY=s+r*Math.sin(o),t.rotation=o+h})}updateTargetLabelSelection(t){return t.targetLabelSelection.update(t.targetData,void 0,t=>t.itemId)}updateTargetLabelNodes(t){let{targetLabelSelection:e}=t;e.each((t,e)=>{let{centerX:i,centerY:a,radius:s,angle:o,text:r}=e,{offsetX:n,offsetY:l,fill:h,fontStyle:d,fontWeight:c,fontSize:p,fontFamily:u,textAlign:g,textBaseline:y}=e.label;if(null==r){t.visible=!1;return}t.visible=!0,t.x=i+s*Math.cos(o)+n,t.y=a+s*Math.sin(o)+l,t.text=r,t.fill=h,t.fontStyle=d,t.fontWeight=c,t.fontSize=p,t.fontFamily=u,t.textAlign=g,t.textBaseline=y})}updateLabelSelection(t){return t.labelSelection.update(t.labelData,void 0,t=>t.label)}updateLabelNodes(t){let{labelSelection:e}=t,i=this.ctx.animationManager.isSkipped();e.each((t,e)=>{t.fill=e.fill,t.fontStyle=e.fontStyle,t.fontWeight=e.fontWeight,t.fontFamily=e.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}updateTickSelection(t){return t.tickSelection.update(t.tickData,void 0,t=>t.index)}updateTickNodes(t){let{scale:e,radius:i,centerX:a,centerY:s,properties:o}=this,{enabled:r,color:n,fontFamily:l,fontSize:h,fontStyle:d,fontWeight:c,spacing:p}=o.scale.label,u=wK(o.scale.label.rotation??0);t.tickSelection.each((t,o)=>{if(!r){t.visible=!1;return}t.visible=!0,t.text=o.text,t.fill=n,t.fontFamily=l,t.fontSize=h,t.fontStyle=d,t.fontWeight=c,t.textAlign="center",t.textBaseline="middle";let g=e.convert(o.value),{width:y,height:f}=o,m=Math.abs(i*Math.cos(g)),x=Math.abs(i*Math.sin(g)),b=Math.hypot(Math.min(Math.max(Math.abs(i/Math.tan(g)),m-y/2),m+y/2),Math.min(Math.max(Math.abs(i*Math.tan(g)),x-f/2),x+f/2)),v=a+(b+p)*Math.cos(g),S=s+(b+p)*Math.sin(g);t.x=v,t.y=S,t.rotationCenterX=v,t.rotationCenterY=S,t.rotation=u})}labelsHaveExplicitText(){for(let{datum:t}of this.labelSelection)if(null==t.text)return!1;return!0}formatLabelText(t){let{labelSelection:e,radius:i,textAlign:a,verticalAlign:s}=this,{spacing:o,innerRadiusRatio:r}=this.properties;!function(t,e,i,a,s,o){let r,n,l,h,d,{padding:c,textAlign:p,verticalAlign:u}=a;if(i.each((t,e)=>{"primary"===e.label?r=e:"secondary"===e.label&&(n=e)}),null==r)return;let g=xq(t.id,e,r,o?.label);if(null==g)return;let y=null!=n?xq(t.id,e,n,o?.secondaryLabel):void 0,f={padding:c},m="center"===p?2:1,x="middle"===u?2:1,b=t=>({width:Math.sqrt(Math.max(s**2-(t/x)**2,0))*m,height:Math.min(t,x*s),meta:null});if(null!=n&&null!=y){let t=uc(g,r,y,n,f,b);l=t?.label,h=t?.secondaryLabel,d=t?.height??0}else{let t=up(g,r,f,b);l=t?.[0],h=void 0,d=t?.[0].height??0}let v=d*wR[u];i.each((t,e)=>{let i;if("primary"===e.label?i=l:"secondary"===e.label&&(i=h),null==i){t.visible=!1;return}t.visible=!0,t.text=i.text,t.fontSize=i.fontSize,t.lineHeight=i.lineHeight,t.textAlign=p,t.textBaseline="middle";let a="primary"===e.label?i.height/2:d-i.height/2;t.y=e.centerY+a-v,t.x=e.centerX})}(this,this.ctx,e,{padding:o,textAlign:a,verticalAlign:s},i*r,t)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),wz([this.datumSelection],wP),wz([this.needleSelection],wE),this.formatLabelText()}resetAnimation(t){"initial"===t?this.animationState.transition("reset"):"ready"===t&&this.animationState.transition("skip")}animateLabelText(t={}){let e,i,a,s,{animationManager:o}=this.ctx;if(this.labelSelection.each((o,r)=>{o.opacity=1,"primary"===r.label?(e=o.previousDatum?.value??t.from??r.value,i=r.value):"secondary"===r.label&&(a=o.previousDatum?.value??t.from??r.value,s=r.value)}),this.labelsHaveExplicitText());else if(null==i||null==s)this.formatLabelText();else if(e===i&&a===s)this.formatLabelText({label:i,secondaryLabel:s});else{let r=`${this.id}_labels`;o.animate({id:r,groupId:"label",from:{label:e,secondaryLabel:a},to:{label:i,secondaryLabel:s},phase:t.phase??"update",onUpdate:t=>this.formatLabelText(t)})}}animateEmptyUpdateReady(){let{animationManager:t}=this.ctx,{node:e,needle:i}=wO(!0,this.scale.range[0]);wB(this.id,"node",t,[this.datumSelection],e,(t,e)=>e.itemId),wB(this.id,"needle",t,[this.needleSelection],i,()=>"needle"),wB(this.id,"label",t,[this.labelSelection],xZ,(t,e)=>e.label),this.animateLabelText({from:this.properties.scale.min,phase:"initial"})}animateWaitingUpdateReady(){let{animationManager:t}=this.ctx,{node:e,needle:i}=wO(!1,this.scale.range[0]);wB(this.id,"node",t,[this.datumSelection],e,(t,e)=>e.itemId),wB(this.id,"needle",t,[this.needleSelection],i,()=>"needle"),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getSeriesDomain(){return[NaN,NaN]}getSeriesRange(t,e){return[NaN,NaN]}getLegendData(){return[]}getTooltipContent(t){let e,i,{id:a,properties:s}=this,{tooltip:o}=s;if(0===t.type?(e=s.value,i=s.label.text):{value:e,text:i}=s.targets[t.index],null!=e)return this.formatTooltipWithContext(o,{data:[{label:i,fallbackLabel:"Value",value:this.formatLabel(e)}]},{seriesId:a,title:void 0,datum:void 0,value:e})}pickNodeClosestDatum(t){return x1(this,t)}pickFocus(t){return x2(this,t)}getCaptionText(){let{value:t}=this.properties,e=[];return e.push(this.formatLabel(t)),this.labelSelection.each((t,i)=>{let a=xq(this.id,this.ctx,i);null!=a&&e.push(a)}),e.join(". ")}getCategoryValue(t){}datumIndexForCategoryValue(t){}};w6.className="RadialGaugeSeries",w6.type="radial-gauge";var{FONT_SIZE_RATIO:w8}=a.n1,w9={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"radial-gauge",moduleFactory:t=>new w6(t),tooltipDefaults:{range:10},themeTemplate:{minWidth:200,minHeight:200,tooltip:{enabled:!1},series:{outerRadiusRatio:1,innerRadiusRatio:.8,startAngle:270,endAngle:450,defaultColorRange:{$if:[{$eq:[{$palette:"type"},"inbuilt"]},{$interpolate:[{$palette:"secondDivergingColors"},5]},a.n1.SAFE_RANGE2_OPERATION]},scale:{defaultFill:{$path:["./1",{$palette:"fill"},{$palette:"hierarchyColors"}]},stroke:{$path:["./2",a.n1.SAFE_STROKE_FILL_OPERATION,{$palette:"hierarchyColors"}]},label:{fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:12}},bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:2},defaultTarget:{fill:{$ref:"foregroundColor"},stroke:{$ref:"foregroundColor"},size:10,shape:"triangle",placement:"outside",spacing:5,label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"},spacing:5}},needle:{enabled:!1,fill:{$ref:"foregroundColor"},spacing:10},label:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:56,minimumFontSize:18/56,fontFamily:{$ref:"fontFamily"},color:{$ref:"textColor"}},secondaryLabel:{enabled:!0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[w8.LARGE]},minimumFontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},color:{$ref:"subtleTextColor"}}}}},w7={type:"series",name:"radial-gauge",chartType:"gauge",enterprise:!0,options:a.n1.radialGaugeSeriesOptionsDef,create:t=>new w6(t)};function It(t){t.nodes.sort((t,e)=>Math.round((t.datum.y-e.datum.y)*100)/100||-(t.datum.size-e.datum.size))}function Ie(t,e,i,a,s,o,r,n){let l=(i-t)/(a-e),h=(r-s)/(n-o),d=(l*h*(o-e)+t*h-s*l)/(h-l);return t<i?d>t&&d<Math.min(i,r):d<t&&d>Math.max(i,r)}function Ii(t,e){let i=!1,a=t.nodes.filter(t=>1===e(t).length),s=!0;for(let t=0;s&&t<a.length;t+=1){s=!1;for(let t=0;t<a.length-1;t+=1){let{datum:o}=a[t],r=e(a[t])[0].node.datum,{datum:n}=a[t+1],l=e(a[t+1])[0].node.datum;if(!(Ie(o.x,o.y,r.x,r.y,n.x,n.y,l.x,l.y)||Ie(o.x,o.y+o.height/2,r.x,r.y+r.height/2,n.x,n.y+n.height/2,l.x,l.y+l.height/2)||Ie(o.x,o.y+o.height,r.x,r.y+r.height,n.x,n.y+n.height,l.x,l.y+l.height)))continue;let h=a[t];a[t]=a[t+1],a[t+1]=h;let d=o.y;o.y=n.y+n.height-o.height,n.y=d,i=!0,s=!0}}return i}function Ia(t,e,i,a){return t.nodes.forEach(({datum:t,linksBefore:e,linksAfter:s})=>{let o=1===a?s:e,r=function(t){if(0===t.length)return;let e=0,i=0;for(let{node:{datum:a}}of t)e+=a.y*a.size,i+=a.size;return e/i}(1===a?e:s);if(null!=r){let e=0!==o.length?i:1;t.y=t.y+(r-t.y)*e}}),function(t,e){let{nodes:i}=t,{seriesRectHeight:a,nodeSpacing:s}=e;It(t);let o=0,r=0;for(let{datum:t}of i){let e=Math.max(r-t.y,0);t.y+=e,o+=e,r=t.y+t.height+s}if(r-s<a)return o>0;let n=a;for(let t=i.length-1;t>=0;t-=1){let{datum:e}=i[t],a=Math.min(n-(e.y+e.height),0);e.y+=a,o+=a,n=e.y-s}return!0}(t,e)}function Is(t,e,i){let a=!1;for(let s of t)a=Ia(s,e,i,1)||a;return a}function Io(t){let e=!1;for(let i=t.length-1;i>=0;i-=1)e=function(t){let e=!1;return It(t),e=Ii(t,t=>t.linksBefore)||e,e=Ii(t,t=>t.linksAfter)||e}(t[i])||e;return e}var{BBox:Ir,Path:In,SceneChangeDetection:Il,splitBezier:Ih}=a.n1;function Id(t,e,i,a,s,o,r,n,l,h){let d,c;if(s!==i&&l!==r){let t=-(a-e)/(s-i),h=-(n-o)/(l-r);d=(r-i+t*e-h*o)/(t-h),c=t*(d-e)+i}else if(s===i&&l!==r)c=-(n-o)/(l-r)*((d=e)-n)+l;else if(s!==i&&l===r)c=-(a-e)/(s-i)*((d=n)-e)+i;else throw Error("Offsetting flat bezier curve");let p=Math.hypot(i-c,e-d),u=(p+h)/p,g=Math.hypot(l-c,n-d),y=(g+h)/g,f=d+(a-d)*u,m=c+(s-c)*u,x=d+(o-d)*y,b=c+(r-c)*y,v=d+(n-d)*y,S=c+(l-c)*y;t.cubicCurveTo(f,m,x,b,v,S)}var Ic=class extends In{constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0}computeBBox(){let t=Math.min(this.x1,this.x2),e=Math.max(this.x1,this.x2)-t,i=Math.min(this.y1,this.y2),a=Math.max(this.y1,this.y2)-i+this.height;return new Ir(t,i,e,a)}updatePath(){let{path:t,inset:e}=this;t.clear();let i=this.x1+e,a=this.x2-e,s=this.y1+e,o=this.y2+e,r=this.height-2*e;if(r<0||i>a)return;let n=s+r/2,l=(i+a)/2,h=s+r/2,d=(i+a)/2,c=o+r/2,p=o+r/2;if(t.moveTo(i,n-r/2),1>Math.abs(this.y2-this.y1)||this.x2-this.x1<this.height*Math.SQRT2)t.cubicCurveTo(l,h-r/2,d,c-r/2,a,p-r/2),t.lineTo(a,p+r/2),t.cubicCurveTo(d,c+r/2,l,h+r/2,i,n+r/2);else{let[e,u]=Ih(i,n,l,h,d,c,a,p,.5),g=(o>s?1:-1)*r/2;Id(t,e[0].x,e[0].y,e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y,g),Id(t,u[0].x,u[0].y,u[1].x,u[1].y,u[2].x,u[2].y,u[3].x,u[3].y,-g),t.lineTo(a,p+r/2),Id(t,u[3].x,u[3].y,u[2].x,u[2].y,u[1].x,u[1].y,u[0].x,u[0].y,g),Id(t,e[3].x,e[3].y,e[2].x,e[2].y,e[1].x,e[1].y,e[0].x,e[0].y,-g)}t.closePath()}};n([Il()],Ic.prototype,"x1",2),n([Il()],Ic.prototype,"x2",2),n([Il()],Ic.prototype,"y1",2),n([Il()],Ic.prototype,"y2",2),n([Il()],Ic.prototype,"height",2),n([Il()],Ic.prototype,"inset",2);var{BaseProperties:Ip,FillGradientDefaults:Iu,FillPatternDefaults:Ig,FillImageDefaults:Iy,SeriesTooltip:If,SeriesProperties:Im,Property:Ix,Label:Ib}=a.n1,Iv=class extends Ib{constructor(){super(...arguments),this.spacing=1}};n([Ix],Iv.prototype,"spacing",2);var IS=class extends Ip{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};n([Ix],IS.prototype,"fill",2),n([Ix],IS.prototype,"fillOpacity",2),n([Ix],IS.prototype,"stroke",2),n([Ix],IS.prototype,"strokeOpacity",2),n([Ix],IS.prototype,"strokeWidth",2),n([Ix],IS.prototype,"lineDash",2),n([Ix],IS.prototype,"lineDashOffset",2),n([Ix],IS.prototype,"itemStyler",2);var Ik=class extends Ip{constructor(){super(...arguments),this.spacing=1,this.width=1,this.alignment="justify",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};n([Ix],Ik.prototype,"spacing",2),n([Ix],Ik.prototype,"width",2),n([Ix],Ik.prototype,"alignment",2),n([Ix],Ik.prototype,"fill",2),n([Ix],Ik.prototype,"fillOpacity",2),n([Ix],Ik.prototype,"stroke",2),n([Ix],Ik.prototype,"strokeOpacity",2),n([Ix],Ik.prototype,"strokeWidth",2),n([Ix],Ik.prototype,"lineDash",2),n([Ix],Ik.prototype,"lineDashOffset",2),n([Ix],Ik.prototype,"itemStyler",2);var ID=class extends Im{constructor(){super(...arguments),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fillGradientDefaults=new Iu,this.fillPatternDefaults=new Ig,this.fillImageDefaults=new Iy,this.defaultColorRange=[],this.defaultPatternFills=[],this.fills=[],this.strokes=[],this.label=new Iv,this.link=new IS,this.node=new Ik,this.tooltip=new If}};n([Ix],ID.prototype,"nodes",2),n([Ix],ID.prototype,"fromKey",2),n([Ix],ID.prototype,"toKey",2),n([Ix],ID.prototype,"idKey",2),n([Ix],ID.prototype,"idName",2),n([Ix],ID.prototype,"labelKey",2),n([Ix],ID.prototype,"labelName",2),n([Ix],ID.prototype,"sizeKey",2),n([Ix],ID.prototype,"sizeName",2),n([Ix],ID.prototype,"fillGradientDefaults",2),n([Ix],ID.prototype,"fillPatternDefaults",2),n([Ix],ID.prototype,"fillImageDefaults",2),n([Ix],ID.prototype,"defaultColorRange",2),n([Ix],ID.prototype,"defaultPatternFills",2),n([Ix],ID.prototype,"fills",2),n([Ix],ID.prototype,"strokes",2),n([Ix],ID.prototype,"label",2),n([Ix],ID.prototype,"link",2),n([Ix],ID.prototype,"node",2),n([Ix],ID.prototype,"tooltip",2);var{Transformable:IM,applyShapeStyle:Iw,SeriesNodePickMode:II,CachedTextMeasurerPool:IC,TextWrapper:IA,TextUtils:IL,createDatumId:IT,getShapeStyle:IN,Rect:IO,BBox:IP}=a.n1,IE=class extends fQ{constructor(t){super({moduleCtx:t,pickModes:[II.NEAREST_NODE,II.EXACT_SHAPE_MATCH]}),this.properties=new ID}isLabelEnabled(){return(null!=this.properties.labelKey||null==this.nodes)&&this.properties.label.enabled}linkFactory(){return new Ic}nodeFactory(){return new IO}createNodeData(){let{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:a,toKey:o,sizeKey:r,label:{spacing:n},node:{spacing:l,width:h,alignment:d}}=this.properties,{nodeGraph:c,links:p,maxPathLength:u}=this.getNodeGraph(t=>({...t,x:NaN,y:NaN,width:h,height:NaN}),t=>({...t,x1:NaN,x2:NaN,y1:NaN,y2:NaN,height:NaN}),{includeCircularReferences:!1}),g=this.isLabelEnabled()?(e-h)*(1-u/(u+1)):0,y=(e-h-2*g)/(u-1),f=[];for(let t=0;t<u;t+=1){let e=g+t*y;f.push({index:t,size:0,nodes:[],x:e})}c.forEach(t=>{let e,{datum:i,linksBefore:s,linksAfter:n,maxPathLengthBefore:l,maxPathLengthAfter:h}=t,c=Math.max(s.reduce((t,{link:e})=>t+e.size,0),n.reduce((t,{link:e})=>t+e.size,0));if(0===s.length&&0===n.length||0===c){t.columnIndex=-1;return}switch(d){case"left":e=f[l];break;case"right":e=f[u-1-h];break;case"center":e=0!==s.length?f[l]:0!==n.length?f[n.reduce((t,e)=>Math.min(t,e.node.maxPathLengthBefore),u)-1]:f[0];break;case"justify":e=0===n.length?f[u-1]:f[l]}i.x=e.x,i.size=c;let p=this.getLabelText(this.properties.label,{datum:i.datum,value:i.label,fromKey:a,toKey:o,sizeKey:r,size:c});i.label=String(p),e.nodes.push(t),e.size+=c,t.columnIndex=e.index}),c.forEach(t=>{let e=1/0,i=0;t.linksAfter.forEach(t=>{let a=t.node,{columnIndex:s}=a;s<e?(e=s,i=a.datum.size):s===e&&(i=Math.max(i,a.datum.size))}),t.closestColumnIndex=e,t.maxSizeOfClosestNodesAfter=i});let m=f.reduce((t,{size:e,nodes:a})=>Math.min(t,(1-(a.length-1)*(l/i))/e),1/0);for(let t=f.length-1;t>=0;t-=1)f[t].nodes.sort((t,e)=>t.closestColumnIndex-e.closestColumnIndex||t.maxSizeOfClosestNodesAfter-e.maxSizeOfClosestNodesAfter||t.datum.size-e.datum.size);!function(t,e){t.forEach(t=>{!function({nodes:t,size:e},{seriesRectHeight:i,nodeSpacing:a,sizeScale:s}){let o=(i-(i*e*s+a*(t.length-1)))/2;t.forEach(({datum:t})=>{let e=i*t.size*s;t.y=o,t.height=e,o+=e+a})}(t,e)});let i=!1;for(let a=0;a<6;a+=1){let a=Is(t,e,1);i=function(t,e,i){let a=!1;for(let i=t.length-1;i>=0;i-=1)a=Ia(t[i],e,.5,-1)||a;return a}(t,e,0);let s=Io(t);if(!a&&!i&&!s)break}i&&(Is(t,e,1),Io(t))}(f,{seriesRectHeight:i,nodeSpacing:l,sizeScale:m});let x=!1;if(c.forEach(({datum:t,linksBefore:e,linksAfter:a})=>{x||(x=t.height<0);let s=t.y+t.height,o=e=>e.sort((e,i)=>{let a=e.node.datum,o=i.node.datum,r=a.y+a.height,n=o.y+o.height;return Math.atan2(a.y-t.y,Math.abs(a.x-t.x))-Math.atan2(o.y-t.y,Math.abs(o.x-t.x))+(Math.atan2(r-s,Math.abs(a.x-t.x))-Math.atan2(n-s,Math.abs(o.x-t.x)))}),r=t.y;o(e).forEach(({link:t})=>{t.y2=r,r+=t.size*i*m});let n=t.y;o(a).forEach(({link:t})=>{t.y1=n,n+=t.size*i*m})}),x)return void s.Vy.warnOnce("There was insufficient space to display the Sankey Series. Reduce the node spacing, or provide a larger container.");let b=[],v=[],{fontSize:S}=this.properties.label,k=this.properties.label.getFont();return f.forEach((t,i)=>{let a=0===i,s=i===f.length-1,o=-1/0;t.nodes.sort((t,e)=>t.datum.y-e.datum.y),t.nodes.forEach(({datum:t})=>{let i;if(t.midPoint={x:t.x+t.width/2,y:t.y+t.height/2},b.push(t),null==t.label)return;let r=a?t.x-n:t.x+t.width+n,l=t.y+t.height/2;if(!a&&!s){let a=l-IL.getLineHeight(S),s=l+IL.getLineHeight(S),o=e;c.forEach(({datum:e})=>{e.x>t.x&&Math.max(e.y,a)<=Math.min(e.y+e.height,s)&&(o=Math.min(o,e.x-n))});let r=o-t.x-2*n;i=IA.wrapText(t.label,{maxWidth:r,maxHeight:t.height,font:this.properties.label,textWrap:"never",overflow:"hide"})}if(null==i||""===i){let e=a||s?n:2*n;i=IA.wrapText(t.label,{maxWidth:y-e,maxHeight:t.height,font:this.properties.label,textWrap:"never"})}if(""===i)return;let{height:h}=IC.measureText(i,{font:k,textAlign:"left",textBaseline:"middle"}),d=l-h/2,p=l+h/2;d>=o&&(v.push({x:r,y:l,leading:a,text:i}),o=p)})}),p.forEach(t=>{let{fromNode:e,toNode:a,size:s}=t;t.height=i*s*m,t.x1=e.x+h,t.x2=a.x,t.midPoint={x:(t.x1+t.x2)/2,y:(t.y1+t.y2)/2+t.height/2},b.push(t)}),{itemId:t,nodeData:b,labelData:v}}updateLabelSelection(t){let e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}updateLabelNodes(t){let{labelSelection:e}=t,{color:i,fontStyle:a,fontWeight:s,fontSize:o,fontFamily:r}=this.properties.label;e.each((t,{x:e,y:n,leading:l,text:h})=>{t.visible=!0,t.x=e,t.y=n,t.text=h,t.fill=i,t.fontStyle=a,t.fontWeight=s,t.fontSize=o,t.fontFamily=r,t.textAlign=l?"right":"left",t.textBaseline="middle"})}updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>IT([t.type,t.id]))}getBaseNodeStyle(t){let{properties:e}=this,{fill:i,fillOpacity:a,stroke:s,strokeOpacity:o,lineDash:r,lineDashOffset:n}=e.node,l=t?e.highlightStyle.item:void 0;return IN({fill:l?.fill??i,fillOpacity:l?.fillOpacity??a,stroke:l?.stroke??s,strokeOpacity:l?.strokeOpacity??o,strokeWidth:l?.strokeWidth??this.getStrokeWidth(e.node.strokeWidth),lineDash:l?.lineDash??r,lineDashOffset:l?.lineDashOffset??n},e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults)}getNodeStyleOverrides(t,e,i,a,s,o,r){let n,{id:l,properties:h}=this,{fills:d,strokes:c,defaultColorRange:p,defaultPatternFills:u}=h,{itemStyler:g}=h.node,y=o.fill??d[i%d.length],f=o.stroke??c[i%c.length],m=p[i%p.length].map(t=>({color:t})),x=u[i%u.length];if(r||(n??(n={}),n.fill=y,n.stroke=f),null!=g){let i=this.cachedDatumCallback(IT(t,"node",r?"highlight":"node"),()=>{let{fillOpacity:t=1,strokeOpacity:i=1,strokeWidth:n=0,lineDash:h=[],lineDashOffset:d=0}=o;return this.callWithContext(g,{seriesId:l,datum:e,highlighted:r,label:s,size:a,fill:y,fillOpacity:t,stroke:f,strokeOpacity:i,strokeWidth:n,lineDash:h,lineDashOffset:d})});n??(n={}),Object.assign(n,i)}return IN(n,{...this.properties.fillGradientDefaults.toJson(),colorStops:m},{...this.properties.fillPatternDefaults.toJson(),fill:x,stroke:x},this.properties.fillImageDefaults)}updateNodeNodes(t){let{datumSelection:e,isHighlight:i}=t,a=this.getBaseNodeStyle(i),s=this.getShapeFillBBox();e.each((t,e)=>{let{datumIndex:o,size:r,label:n}=e,l=this.getNodeStyleOverrides(String(o.index),e.datum,o.index,r,n,a,i);t.x=e.x,t.y=e.y,t.width=Math.max(e.width,0),t.height=Math.max(e.height,0),Iw(t,a,l,s)})}getShapeFillBBox(){let t=new IP(0,0,this._nodeDataDependencies?.seriesRectWidth??0,this._nodeDataDependencies?.seriesRectHeight??0);return{series:t,axis:t}}updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,t=>IT([t.type,t.index,t.fromNode.id,t.toNode.id]))}getBaseLinkStyle(t){let{properties:e}=this,{fill:i,fillOpacity:a,stroke:s,strokeOpacity:o,lineDash:r,lineDashOffset:n}=e.link,l=t?e.highlightStyle.item:void 0;return IN({fill:l?.fill??i,fillOpacity:l?.fillOpacity??a,stroke:l?.stroke??s,strokeOpacity:l?.strokeOpacity??o,strokeWidth:l?.strokeWidth??this.getStrokeWidth(e.link.strokeWidth),lineDash:l?.lineDash??r,lineDashOffset:l?.lineDashOffset??n},e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults)}getLinkStyleOverrides(t,e,i,a,s){let o,{id:r,properties:n}=this,{fills:l,strokes:h,defaultColorRange:d,defaultPatternFills:c}=n,{itemStyler:p}=n.link,u=a.fill??l[i%l.length],g=a.stroke??h[i%h.length],y=d[i%d.length].map(t=>({color:t})),f=c[i%c.length];return s||(o??(o={}),o.fill=u,o.stroke=g),null!=p&&(o??(o={}),Object.assign(o,this.cachedDatumCallback(IT(t,"link",s?"highlight":"node"),()=>{let{fillOpacity:t=1,strokeOpacity:i=1,strokeWidth:o=0,lineDash:n=[],lineDashOffset:l=0}=a;return this.callWithContext(p,{seriesId:r,datum:e,highlighted:s,fill:u,fillOpacity:t,stroke:g,strokeOpacity:i,strokeWidth:o,lineDash:n,lineDashOffset:l})}))),IN(o,{...this.properties.fillGradientDefaults.toJson(),colorStops:y},{...this.properties.fillPatternDefaults.toJson(),fill:f,stroke:f},this.properties.fillImageDefaults)}updateLinkNodes(t){let{datumSelection:e,isHighlight:i}=t,a=this.getBaseLinkStyle(i),s=this.getShapeFillBBox();e.each((t,e)=>{let{datumIndex:o}=e,r=e.fromNode.datumIndex,n=this.getLinkStyleOverrides(String(o.index),e.datum,r.index,a,i);t.x1=e.x1,t.y1=e.y1,t.x2=e.x2,t.y2=e.y2,t.height=e.height,Iw(t,a,n,s),t.inset=t.strokeWidth/2})}getTooltipContent(t){let e,{id:i,linksProcessedData:a,nodesProcessedData:s,properties:o}=this,{fromKey:r,toKey:n,sizeKey:l,sizeName:h,tooltip:d}=o,c=this.contextNodeData?.nodeData.find(e=>e.datumIndex.type===t.type&&e.datumIndex.index===t.index);if(null==c)return;let p=0===c.type?c.fromNode.index:c.index,u=0===c.type?`${c.fromNode.label} - ${c.toNode.label}`:c.label,g=0===t.type?a?.dataSources.get(this.id)?.[t.index]:s?.dataSources.get(this.id)?.[t.index],y=c.size;if(0===c.type){let i=c.fromNode.datumIndex,a=this.getBaseLinkStyle(!1);Object.assign(a,this.getLinkStyleOverrides(String(t.index),g,i.index,a,!1)),e=a}else{let i=c.label,a=this.getBaseNodeStyle(!1);Object.assign(a,this.getNodeStyleOverrides(String(t.index),g,t.index,y,i,a,!1)),e=a}return this.formatTooltipWithContext(d,{title:u,symbol:this.legendItemSymbol(c.type,p,e),data:null!=l?[{label:h,fallbackLabel:l,value:String(y)}]:[]},{seriesId:i,datum:g,title:u,fromKey:r,toKey:n,sizeKey:l,sizeName:h,size:y,...e})}computeFocusBounds(t){if(t instanceof IO){let{x:e,y:i,width:a,height:s}=t,o=new IP(e,i,a,s);return IM.toCanvas(this.contentGroup,o)}return t}};IE.className="SankeySeries",IE.type="sankey";var{commonSeriesOptionsDefs:IR,sankeySeriesThemeableOptionsDef:IB}=a.n1,Iz={...IB,...IR,type:(0,s.mw)((0,s.dY)("sankey")),fromKey:(0,s.mw)(s.Yj),toKey:(0,s.mw)(s.Yj),sizeKey:s.Yj,sizeName:s.Yj};Iz.fillGradientDefaults=(0,s._L)(s.wi),Iz.fillPatternDefaults=(0,s._L)(s.GY),Iz.fillImageDefaults=(0,s._L)(s.Zd),Iz.defaultColorRange=(0,s._L)((0,s.jk)((0,s.jk)(s.yW))),Iz.defaultPatternFills=(0,s._L)((0,s.jk)(s.yW));var IF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"sankey",moduleFactory:t=>new IE(t),tooltipDefaults:{range:"exact"},themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,defaultColorRange:{$palette:"gradients"},defaultPatternFills:a.n1.SAFE_FILLS_OPERATION,highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:{$ref:"fontFamily"},fontSize:{$ref:"fontSize"},fontWeight:{$ref:"fontWeight"},color:{$ref:"textColor"},spacing:10},node:{spacing:20,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0}},legend:{enabled:!1,toggleSeries:!1}}},{HierarchySeriesProperties:I_,HighlightStyle:IW,SeriesTooltip:IG,Property:Ij}=a.n1,IV=class extends IW{constructor(){super(...arguments),this.label=new ux,this.secondaryLabel=new ux}};n([Ij],IV.prototype,"fill",2),n([Ij],IV.prototype,"fillOpacity",2),n([Ij],IV.prototype,"stroke",2),n([Ij],IV.prototype,"strokeWidth",2),n([Ij],IV.prototype,"strokeOpacity",2),n([Ij],IV.prototype,"label",2),n([Ij],IV.prototype,"secondaryLabel",2);var I$=class extends I_{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlightStyle=new IV,this.label=new ux,this.secondaryLabel=new ub,this.tooltip=new IG}};n([Ij],I$.prototype,"sizeName",2),n([Ij],I$.prototype,"labelKey",2),n([Ij],I$.prototype,"secondaryLabelKey",2),n([Ij],I$.prototype,"fillOpacity",2),n([Ij],I$.prototype,"strokeWidth",2),n([Ij],I$.prototype,"strokeOpacity",2),n([Ij],I$.prototype,"cornerRadius",2),n([Ij],I$.prototype,"sectorSpacing",2),n([Ij],I$.prototype,"padding",2),n([Ij],I$.prototype,"itemStyler",2),n([Ij],I$.prototype,"highlightStyle",2),n([Ij],I$.prototype,"label",2),n([Ij],I$.prototype,"secondaryLabel",2),n([Ij],I$.prototype,"tooltip",2);var{fromToMotion:IH,normalizeAngle360:IY,createDatumId:IK,Sector:IU,Group:IX,ScalableGroup:IZ,Selection:IQ,TransformableText:Iq,BBox:IJ,applyShapeStyle:I0,getShapeStyle:I1}=a.n1,I2=class extends a.n1.HierarchyNode{constructor(){super(...arguments),this.label=void 0,this.secondaryLabel=void 0,this.contentHeight=0,this.bbox=void 0,this.startAngle=0,this.endAngle=0}},I4=class extends a.n1.HierarchySeries{constructor(){super(...arguments),this.NodeClass=I2,this.properties=new I$,this.scalingGroup=this.contentGroup.appendChild(new IZ),this.sectorGroup=this.scalingGroup.appendChild(new IX),this.sectorLabelGroup=this.scalingGroup.appendChild(new IX),this.highlightSectorGroup=this.scalingGroup.appendChild(new IX),this.datumSelection=IQ.select(this.sectorGroup,IU),this.labelSelection=IQ.select(this.sectorLabelGroup,IX),this.highlightSelection=IQ.select(this.highlightSectorGroup,IU)}processData(){super.processData(),function t(e,i=0,a=2*Math.PI/e.sumSize){for(let s of e.children){let e=i+s.sumSize*a;s.startAngle=i,s.endAngle=e,t(s,i,a),i=e}}(this.rootNode)}updateSelections(){let t=this.ctx.highlightManager?.getActiveHighlight();if(this.highlightSelection.update(null!=t?[t]:[],void 0,t=>this.getDatumId(t)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;let{chart:e}=this;if(null==e||null==e.seriesRect)return;let i=Array.from(this.rootNode);this.datumSelection.update(i,void 0,t=>this.getDatumId(t)),this.labelSelection.update(i,t=>{t.append([new Iq({tag:0}),new Iq({tag:1})])},t=>this.getDatumId(t))}getItemBaseStyle(t){let{properties:e}=this,i=t?e.highlightStyle:void 0;return I1({fill:i?.fill,fillOpacity:i?.fillOpacity??e.fillOpacity,stroke:i?.stroke,strokeWidth:i?.strokeWidth??this.getStrokeWidth(e.strokeWidth),strokeOpacity:i?.strokeOpacity??e.strokeOpacity},e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults)}getItemStyleOverrides(t,e,i,a,s,o){let{id:r,properties:n,colorScale:l}=this,{fills:h,strokes:d,itemStyler:c}=n,p=t[0],u=s.fill??h[p%h.length],g=s.stroke??d[p%d.length],y={};return o||(y.fill=null!=a?l.convert(a):u,y.stroke=g),null!=c&&Object.assign(y,this.cachedDatumCallback(IK(t.join(":"),o?"highlight":"node"),()=>this.callWithContext(c,{seriesId:r,datum:e,depth:i,highlighted:o,fill:u,stroke:g,...s}))),I1(y,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateNodes(){let{chart:t,data:e,maxDepth:i}=this;if(null==t||null==e)return;let{width:s,height:o}=t.seriesRect,{sectorSpacing:r=0,padding:n=0,cornerRadius:l,childrenKey:h,colorKey:d,colorName:c,labelKey:p,secondaryLabelKey:u,sizeKey:g,sizeName:y}=this.properties;this.contentGroup.translationX=s/2,this.contentGroup.translationY=o/2;let f=.5*r,m=Math.min(s,o)/2,x=m/(i+1),b=-Math.PI/2,v={series:new IJ(-m,-m,2*m,2*m),axis:new IJ(-m,-m,2*m,2*m)};this.rootNode?.walk(t=>{let{startAngle:e,endAngle:i}=t;if(null!=t.depth){let a=(e+i)/2+b,s=(t.depth+.5)*x;t.midPoint.x=Math.cos(a)*s,t.midPoint.y=Math.sin(a)*s}}),this.rootNode?.walk(t=>{let e,i,a,{datum:s,depth:o,startAngle:r,endAngle:l,parent:m,sumSize:v}=t;if(t.label=void 0,t.secondaryLabel=void 0,t.contentHeight=0,null!=s&&null!=o&&null!=p){let t=s[p];e=this.getLabelText(this.properties.label,{depth:o,datum:s,childrenKey:h,colorKey:d,colorName:c,labelKey:p,secondaryLabelKey:u,sizeKey:g,sizeName:y,value:t})}if(""===e&&(e=void 0),null!=s&&null!=o&&null!=u){let t=s[u];i=this.getLabelText(this.properties.secondaryLabel,{depth:o,datum:s,childrenKey:h,colorKey:d,colorName:c,labelKey:p,secondaryLabelKey:u,sizeKey:g,sizeName:y,value:t})}if(""===i&&(i=void 0),null==o)return;let S=o*x+f,k=(o+1)*x-f,D=S>f?f/S:f,M=k>f?f/k:f,w=l+D-(r+D),I=l+M-(r+M),C=ug(e,this.properties.label,i,this.properties.secondaryLabel,{padding:n},t=>{let e,i;if(0===o&&m?.sumSize===v)return{width:2*Math.sqrt(k**2-(.5*t)**2),height:t,meta:0};let a=Math.min(2*Math.sqrt(k**2-(S+t)**2),w<Math.PI?2*S*Math.tan(.5*w):1/0),s=Math.PI/4;return 0===o?i=Math.sqrt(k**2-((e=t)/2)**2)-t/(2*Math.tan(.5*I)):IY(w)<s?i=Math.sqrt(k**2-((e=2*S*Math.tan(.5*w))/2)**2)-S:(i=0,e=0),a>=i?{width:a,height:t,meta:1}:{width:i,height:e,meta:2}});if(null==C)return;let{width:A,height:L,meta:T,label:N,secondaryLabel:O}=C,P=b+(r+l)/2,E=(Math.sin(P)>=0?3:12)&(Math.cos(P)>=0?6:9);switch(T){case 0:a=0;break;case 1:{let t=Math.sqrt((k-n)**2-(A/2)**2);a=Math.min(k-(x-L)*.58,t);break}case 2:a=0===o?(L/(2*Math.tan(.5*w))+.5*A+(Math.sqrt(k**2-(.5*L)**2)-.5*A))*.5:(S+k)*.5}if(null!=N){let{fontStyle:e="normal",fontFamily:i,fontWeight:s="normal",color:o="black"}=this.properties.label;t.label={...N,fontStyle:e,fontFamily:i,fontWeight:s,color:o,labelPlacement:T,circleQuarter:E,radius:a,theta:P}}if(null!=O){let{fontStyle:e="normal",fontFamily:i,fontWeight:s="normal",color:o="black"}=this.properties.secondaryLabel;t.secondaryLabel={...O,fontStyle:e,fontFamily:i,fontWeight:s,color:o,labelPlacement:T,circleQuarter:E,radius:a,theta:P}}t.contentHeight=C.height});let S=(t,e,i,s)=>{let{datum:o,datumIndex:r,depth:n,colorValue:h,startAngle:d,endAngle:c}=t;if(null==n){e.visible=!1;return}e.visible=!0;let p=this.getItemStyleOverrides(r,o,n,h,i,s),u=p.fill??i.fill,g=p.strokeWidth??i.strokeWidth;I0(e,i,p,a.n1.isGradientFill(u)&&"item"!==u.bounds?v:void 0),e.centerX=0,e.centerY=0,e.innerRadius=n*x,e.outerRadius=(n+1)*x,e.startAngle=d+b,e.endAngle=c+b,e.inset=f+.5*g,e.cornerRadius=l},k=this.getItemBaseStyle(!1);this.datumSelection.each((t,e)=>{S(e,t,k,!1)});let D=this.getItemBaseStyle(!0);this.highlightSelection.each((t,e)=>{S(e,t,D,!0)});let M=(t,e,i,a)=>{let s,{depth:o,contentHeight:r}=t,n=0===i,l=n?t.label:t.secondaryLabel;if(null==o||null==l){e.visible=!1;return}let{labelPlacement:h,circleQuarter:d,radius:c,theta:p}=l;switch(a&&(s=(n?this.properties.highlightStyle.label:this.properties.highlightStyle.secondaryLabel).color),e.text=l.text,e.fontSize=l.fontSize,e.lineHeight=l.lineHeight,e.fontStyle=l.fontStyle,e.fontFamily=l.fontFamily,e.fontWeight=l.fontWeight,e.fill=s??l.color,h){case 0:e.textAlign="center",e.textBaseline="top",e.translationX=0,e.translationY=(n?0:r-l.height)-.5*r,e.rotation=0;break;case 1:{let t=(3&d)!=0,i=!t===n?c:c-(r-l.height);e.textAlign="center",e.textBaseline=t?"bottom":"top",e.translationX=Math.cos(p)*i,e.translationY=Math.sin(p)*i,e.rotation=t?p-.5*Math.PI:p+.5*Math.PI;break}case 2:{let t=(6&d)!=0,i=!t===n?(r-l.height)*.5:(l.height-r)*.5;e.textAlign="center",e.textBaseline="middle",e.translationX=Math.cos(p)*c+Math.cos(p+Math.PI/2)*i,e.translationY=Math.sin(p)*c+Math.sin(p+Math.PI/2)*i,e.rotation=t?p:p+Math.PI}}e.visible=!0},w=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.selectByClass(Iq).forEach(t=>{let e=t.closestDatum();M(e,t,t.tag,e===w)})}getTooltipContent(t){let{id:e,properties:i}=this,{labelKey:s,secondaryLabelKey:o,childrenKey:r,sizeKey:n,sizeName:l,colorKey:h,colorName:d,tooltip:c}=i,p=t.reduce((t,e)=>t?.children[e],this.rootNode);if(null==p)return;let{datum:u,depth:g}=p;if(null==u||null==g)return;let y=[],f=null!=n?u[n]:void 0;null!=f&&y.push({label:l,fallbackLabel:n,value:f});let m=null!=h?u[h]:void 0;null!=m&&y.push({label:d,fallbackLabel:h,value:m});let x=this.getItemBaseStyle(!1);Object.assign(x,this.getItemStyleOverrides(t,u,g,m,x,!1));let b=I1({shape:"square",fill:x.fill,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0},i.fillGradientDefaults,i.fillPatternDefaults,i.fillImageDefaults);return a.n1.isGradientFill(b.fill)&&(b.fill={...b.fill,gradient:"linear",rotation:0,reverse:!1}),this.formatTooltipWithContext(c,{title:null!=s?u[s]:void 0,symbol:{marker:b},data:y},{seriesId:e,datum:u,title:void 0,depth:g,labelKey:s,secondaryLabelKey:o,childrenKey:r,sizeKey:n,sizeName:l,colorKey:h,colorName:d,...x})}createNodeData(){}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.datumSelection.selectByClass(IU))}animateEmptyUpdateReady(){IH(this.id,"nodes",this.ctx.animationManager,[this.scalingGroup],{toFn:()=>({scalingX:1,scalingY:1}),fromFn:()=>({scalingX:0,scalingY:0})})}computeFocusBounds(t){return t}};I4.className="SunburstSeries",I4.type="sunburst";var{commonSeriesOptionsDefs:I5,sunburstSeriesThemeableOptionsDef:I3,without:I6}=a.n1,I8={...I3,...I6(I5,["highlightStyle"]),type:(0,s.mw)((0,s.dY)("sunburst")),labelKey:s.Yj,secondaryLabelKey:s.Yj,childrenKey:s.Yj,sizeKey:s.Yj,colorKey:s.Yj,sizeName:s.Yj,colorName:s.Yj},{FONT_SIZE_RATIO:I9}=a.n1,I7={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"sunburst",moduleFactory:t=>new I4(t),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},colorRange:{$palette:"divergingColors"},fillGradientDefaults:{type:"gradient",gradient:"radial",bounds:"series",colorStops:{$palette:"gradient"},rotation:0,reverse:!0},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,label:{fontFamily:{$ref:"fontFamily"},fontSize:{$rem:[I9.LARGE]},minimumFontSize:{$round:[{$mul:[{$ref:"fontSize"},.75]}]},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{fontFamily:{$ref:"fontFamily"},fontSize:{$rem:[I9.SMALLEST]},minimumFontSize:{$round:[{$mul:[{$ref:"fontSize"},7/12]}]},fontWeight:{$ref:"fontWeight"},color:{$ref:"backgroundColor"},overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlightStyle:{label:{color:{$ref:"backgroundColor"}},secondaryLabel:{color:{$ref:"backgroundColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}},gradientLegend:{enabled:!0}}},{BaseProperties:Ct,HierarchySeriesProperties:Ce,HighlightStyle:Ci,SeriesTooltip:Ca,Property:Cs,Label:Co}=a.n1,Cr=class extends Co{constructor(){super(...arguments),this.spacing=0}};n([Cs],Cr.prototype,"spacing",2);var Cn=class extends Ct{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new Cr}};n([Cs],Cn.prototype,"fill",2),n([Cs],Cn.prototype,"fillOpacity",2),n([Cs],Cn.prototype,"stroke",2),n([Cs],Cn.prototype,"strokeWidth",2),n([Cs],Cn.prototype,"strokeOpacity",2),n([Cs],Cn.prototype,"cornerRadius",2),n([Cs],Cn.prototype,"textAlign",2),n([Cs],Cn.prototype,"gap",2),n([Cs],Cn.prototype,"padding",2),n([Cs],Cn.prototype,"interactive",2),n([Cs],Cn.prototype,"label",2);var Cl=class extends Ct{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new ux,this.secondaryLabel=new ub}};n([Cs],Cl.prototype,"fill",2),n([Cs],Cl.prototype,"fillOpacity",2),n([Cs],Cl.prototype,"stroke",2),n([Cs],Cl.prototype,"strokeWidth",2),n([Cs],Cl.prototype,"strokeOpacity",2),n([Cs],Cl.prototype,"cornerRadius",2),n([Cs],Cl.prototype,"textAlign",2),n([Cs],Cl.prototype,"verticalAlign",2),n([Cs],Cl.prototype,"gap",2),n([Cs],Cl.prototype,"padding",2),n([Cs],Cl.prototype,"label",2),n([Cs],Cl.prototype,"secondaryLabel",2);var Ch=class extends Ct{constructor(){super(...arguments),this.label=new ux}};n([Cs],Ch.prototype,"fill",2),n([Cs],Ch.prototype,"fillOpacity",2),n([Cs],Ch.prototype,"stroke",2),n([Cs],Ch.prototype,"strokeWidth",2),n([Cs],Ch.prototype,"strokeOpacity",2),n([Cs],Ch.prototype,"label",2);var Cd=class extends Ct{constructor(){super(...arguments),this.label=new ux,this.secondaryLabel=new ub}};n([Cs],Cd.prototype,"fill",2),n([Cs],Cd.prototype,"fillOpacity",2),n([Cs],Cd.prototype,"stroke",2),n([Cs],Cd.prototype,"strokeWidth",2),n([Cs],Cd.prototype,"strokeOpacity",2),n([Cs],Cd.prototype,"label",2),n([Cs],Cd.prototype,"secondaryLabel",2);var Cc=class extends Ci{constructor(){super(...arguments),this.group=new Ch,this.tile=new Cd}};n([Cs],Cc.prototype,"group",2),n([Cs],Cc.prototype,"tile",2);var Cp=class extends Ce{constructor(){super(...arguments),this.highlightStyle=new Cc,this.tooltip=new Ca,this.group=new Cn,this.tile=new Cl,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}};n([Cs],Cp.prototype,"sizeName",2),n([Cs],Cp.prototype,"labelKey",2),n([Cs],Cp.prototype,"secondaryLabelKey",2),n([Cs],Cp.prototype,"itemStyler",2),n([Cs],Cp.prototype,"highlightStyle",2),n([Cs],Cp.prototype,"tooltip",2),n([Cs],Cp.prototype,"group",2),n([Cs],Cp.prototype,"tile",2),n([Cs],Cp.prototype,"undocumentedGroupFills",2),n([Cs],Cp.prototype,"undocumentedGroupStrokes",2);var{TextUtils:Cu,TextWrapper:Cg,createDatumId:Cy,Rect:Cf,Group:Cm,BBox:Cx,Selection:Cb,Text:Cv,Transformable:CS,applyShapeStyle:Ck,getShapeStyle:CD}=a.n1,CM=class extends a.n1.HierarchyNode{constructor(){super(...arguments),this.labelValue=void 0,this.secondaryLabelValue=void 0,this.label=void 0,this.secondaryLabel=void 0,this.bbox=void 0,this.padding=void 0}},Cw=new Cv;function CI(t){return t.children.length>0?t.sumSize-t.sizeValue:t.sizeValue}var CC={left:0,center:.5,right:1},CA={top:0,middle:.5,bottom:1};a.n1.Group;var CL=class extends a.n1.HierarchySeries{constructor(){super(...arguments),this.NodeClass=CM,this.properties=new Cp,this.rectGroup=this.contentGroup.appendChild(new Cm),this.datumSelection=Cb.select(this.rectGroup,Cf),this.labelSelection=Cb.select(this.labelGroup,Cm),this.highlightSelection=Cb.select(this.rectGroup,Cf)}groupTitleHeight(t,e){let{labelValue:i}=t,{label:a}=this.properties.group;if(null!=i){if(a.fontSize>e.width/3||a.fontSize>e.height/3)return;let{height:t}=function(t,e){let{fontStyle:i,fontWeight:a,fontSize:s,fontFamily:o}=e;Cw.setProperties({text:t,fontStyle:i,fontWeight:a,fontSize:s,fontFamily:o,textAlign:"left",textBaseline:"top"});let{width:r,height:n}=Cw.getBBox();return{width:r,height:n}}(i,a);return Math.max(t,a.fontSize)}}getNodePadding(t,e){if(null==t.parent)return{top:0,right:0,bottom:0,left:0};if(0===t.children.length){let{padding:t}=this.properties.tile;return{top:t,right:t,bottom:t,left:t}}let{label:{spacing:i},padding:a}=this.properties.group,s=this.groupTitleHeight(t,e);return{top:a+(null!=s?s+i:0),right:a,bottom:a,left:a}}sortChildren({children:t}){let e=Array.from(t,(t,e)=>e).filter(e=>CI(t[e])>0).sort((e,i)=>CI(t[i])-CI(t[e]));return{sortedChildrenIndices:e,childAt:i=>t[e[i]]}}squarify(t,e){let{datum:i,children:a}=t;if(e.width<=0||e.height<=0){t.bbox=void 0,t.padding=void 0,t.midPoint.x=NaN,t.midPoint.y=NaN;return}let s=null!=i?this.getNodePadding(t,e):{top:0,right:0,bottom:0,left:0};null==t.parent?(t.bbox=void 0,t.padding=void 0,t.midPoint.x=NaN,t.midPoint.y=NaN):(t.bbox=e,t.padding=s,t.midPoint.x=e.x+e.width/2,t.midPoint.y=e.y);let{sortedChildrenIndices:o,childAt:r}=this.sortChildren(t),n=o.every(t=>0===a[t].children.length),l=e.width-s.left-s.right,h=e.height-s.top-s.bottom;if(l<=0||h<=0)return;let d=o.length,c=0,p=0,u=1/0,g=o.reduce((t,e)=>t+CI(a[e]),0),y=new Cx(e.x+s.left,e.y+s.top,l,h),f=y.clone(),m=0;for(;m<d;){let t=CI(r(m)),e=CI(r(p)),i=f.width<f.height;c+=t;let a=i?f.height:f.width,s=i?f.width:f.height,o=s*e/c,l=a*c/g,h=Math.abs(1-Math.max(o,l)/Math.min(o,l));if(h<u){u=h,m++;continue}c-=t,l=a*c/g;let d=i?f.x:f.y;for(let t=p;t<m;t++){let e=r(t),a=CI(e),o=i?d:f.x,h=i?f.y:d,p=s*a/c,u=new Cx(o,h,i?p:l,i?l:p);this.applyGap(y,u,n),this.squarify(e,u),g-=a,d+=p}i?(f.y+=l,f.height-=l):(f.x+=l,f.width-=l),p=m,c=0,u=1/0}let x=f.width<f.height,b=x?f.x:f.y;for(let t=p;t<d;t++){let e=r(t),i=x?b:f.x,a=x?f.y:b,s=CI(e)/g,o=f.width*(x?s:1),l=f.height*(x?1:s),h=new Cx(i,a,o,l);this.applyGap(y,h,n),this.squarify(e,h),b+=x?o:l}}applyGap(t,e,i){let a=i?.5*this.properties.tile.gap:.5*this.properties.group.gap,o=t=>({left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height}),r=o(t),n=o(e);["top","right","bottom","left"].forEach(t=>{(0,s.YX)(r[t],n[t])||e.shrink(a,t)})}createNodeData(){}getGroupBaseStyle(t){let{properties:e}=this,{group:i}=e,a=t?e.highlightStyle.group:void 0;return CD({fill:a?.fill??i.fill,fillOpacity:a?.fillOpacity??i.fillOpacity,stroke:a?.stroke??i.stroke,strokeWidth:a?.strokeWidth??i.strokeWidth,strokeOpacity:a?.strokeOpacity??i.strokeOpacity},e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults)}getGroupStyleOverrides(t,e,i,a,s){let{id:o,properties:r}=this,{undocumentedGroupFills:n,undocumentedGroupStrokes:l,itemStyler:h}=r,d=a.fill??n[Math.min(i??0,n.length)],c=a.stroke??l[Math.min(i??0,l.length)],p={};return s||(p.fill=d,p.stroke=c),null!=h&&Object.assign(p,this.cachedDatumCallback(Cy(t.join(":"),s?"highlight":"node"),()=>this.callWithContext(h,{seriesId:o,datum:e,depth:i,highlighted:s,fill:d,stroke:c,...a}))),CD(p,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}getTileBaseStyle(t){let{properties:e}=this,{tile:i}=e,a=t?e.highlightStyle.tile:void 0;return CD({fill:a?.fill??i.fill,fillOpacity:a?.fillOpacity??i.fillOpacity,stroke:a?.stroke??i.stroke,strokeWidth:a?.strokeWidth??i.strokeWidth,strokeOpacity:a?.strokeOpacity??i.strokeOpacity},e.fillGradientDefaults,e.fillPatternDefaults,e.fillImageDefaults)}getTileStyleOverrides(t,e,i,a,s,o){let{id:r,properties:n,colorScale:l}=this,{fills:h,strokes:d,itemStyler:c}=n,p=t[0],u=s.fill??h[p%h.length],g=s.stroke??d[p%d.length],y={};return o||(y.fill=null!=a?l.convert(a):u,y.stroke=g),null!=c&&Object.assign(y,this.cachedDatumCallback(Cy(t.join(":"),o?"highlight":"node"),()=>this.callWithContext(c,{seriesId:r,datum:e,depth:i,highlighted:o,fill:u,stroke:g,...s}))),CD(y,this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults)}updateSelections(){let t=this.ctx.highlightManager?.getActiveHighlight();if(null==t||this.properties.group.interactive||0===t.children.length||(t=void 0),this.highlightSelection.update(null!=t?[t]:[],void 0,t=>this.getDatumId(t)),!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;let{seriesRect:e}=this.chart??{};if(!e)return;let i=Array.from(this.rootNode);this.datumSelection.update(i,void 0,t=>this.getDatumId(t)),this.labelSelection.update(i,t=>{t.append([new Cv({tag:0}),new Cv({tag:1})])},t=>this.getDatumId(t))}updateNodes(){let{rootNode:t,data:e}=this,{childrenKey:i,colorKey:a,colorName:s,labelKey:o,secondaryLabelKey:r,sizeKey:n,sizeName:l,highlightStyle:h,tile:d,group:c}=this.properties,{seriesRect:p}=this.chart??{};if(!p||!e)return;this.rootNode?.walk(t=>{let e,h,{datum:p,depth:u,children:g}=t,y=0===g.length,f=y?d.label:c.label;if(null!=p&&null!=u&&null!=o){let t=p[o];e=this.getLabelText(f,{depth:u,datum:p,childrenKey:i,colorKey:a,colorName:s,labelKey:o,secondaryLabelKey:r,sizeKey:n,sizeName:l,value:t})}if(""===e&&(e=void 0),y&&null!=p&&null!=u&&null!=r){let t=p[r];h=this.getLabelText(d.secondaryLabel,{depth:u,datum:p,childrenKey:i,colorKey:a,colorName:s,labelKey:o,secondaryLabelKey:r,sizeKey:n,sizeName:l,value:t})}""===h&&(h=void 0),t.labelValue=e,t.secondaryLabelValue=h});let{width:u,height:g}=p;this.squarify(t,new Cx(0,0,u,g)),this.rootNode?.walk(t=>{let{bbox:e,children:i,labelValue:a,secondaryLabelValue:s}=t;if(t.label=void 0,t.secondaryLabel=void 0,null!=e)if(0===i.length){let i={width:e.width,height:e.height,meta:null},o=ug(a,this.properties.tile.label,s,this.properties.tile.secondaryLabel,{padding:d.padding},()=>i);if(null==o)return;let{height:r,label:n,secondaryLabel:l}=o,{textAlign:h,verticalAlign:c,padding:p}=d,u=CC[h]??.5,g=e.x+p+(e.width-2*p)*u,y=CA[c]??.5,f=e.y+p+.5*r+(e.height-2*p-r)*y;if(null!=n){let{fontStyle:e="normal",fontFamily:i,fontWeight:a="normal",color:s="black"}=this.properties.tile.label;t.label={text:n.text,fontSize:n.fontSize,lineHeight:n.lineHeight,fontStyle:e,fontFamily:i,fontWeight:a,color:s,textAlign:h,verticalAlign:"middle",x:g,y:f-(r-n.height)*.5}}if(null!=l){let{fontStyle:e="normal",fontFamily:i,fontWeight:a="normal",color:s="black"}=this.properties.tile.secondaryLabel;t.secondaryLabel={text:l.text,fontSize:l.fontSize,lineHeight:l.fontSize,fontStyle:e,fontFamily:i,fontWeight:a,color:s,textAlign:h,verticalAlign:"middle",x:g,y:f+(r-l.height)*.5}}}else{if(null==a)return;let{padding:i,textAlign:s}=c,o=this.groupTitleHeight(t,e);if(null==o)return;let r=e.width-2*i,n=Cg.wrapText(a,{maxWidth:e.width-2*i,font:c.label,textWrap:"never"}),l=CC[s]??.5,{fontStyle:h="normal",fontFamily:d,fontWeight:p="normal",color:u="black"}=this.properties.group.label;t.label={text:n,fontSize:c.label.fontSize,lineHeight:Cu.getLineHeight(c.label.fontSize),fontStyle:h,fontFamily:d,fontWeight:p,color:u,textAlign:s,verticalAlign:"middle",x:e.x+i+r*l,y:e.y+i+.5*o}}});let y={series:new Cx(0,0,u,g),axis:new Cx(0,0,u,g)},f=(t,e,i,a,s)=>{let{bbox:o}=t;if(null==o){e.visible=!1;return}let{datum:r,depth:n=-1,datumIndex:l,colorValue:h}=t,p=0===t.children.length,u=p?a:i,g=p?this.getTileStyleOverrides(l,r,n,h,u,s):this.getGroupStyleOverrides(l,r,n,u,s);e.crisp=!0,Ck(e,u,g,y),e.cornerRadius=p?d.cornerRadius:c.cornerRadius,e.zIndex=[0,n,+!!s];let f=t.parent?.children.every(t=>0===t.children.length),m=null!=t.parent?t.parent.bbox:void 0,x=null!=t.parent?t.parent.padding:void 0;!0===f&&null!=m&&null!=x?(e.clipBBox=o,e.x=m.x+x.left,e.y=m.y+x.top,e.width=m.width-(x.left+x.right),e.height=m.height-(x.top+x.bottom)):(e.clipBBox=void 0,e.x=o.x,e.y=o.y,e.width=o.width,e.height=o.height),e.visible=!0},m=this.getGroupBaseStyle(!1),x=this.getTileBaseStyle(!1);this.datumSelection.each((t,e)=>f(e,t,m,x,!1));let b=this.getGroupBaseStyle(!0),v=this.getTileBaseStyle(!0);this.highlightSelection.each((t,e)=>{f(e,t,b,v,!0)});let S=(t,e,i,a)=>{let s,o=0===t.children.length,r=0===i?t.label:t.secondaryLabel;if(null==r){e.visible=!1;return}if(a){let{tile:t,group:e}=h;s=t.secondaryLabel.color,o?0===i&&(s=t.label.color):s=e.label.color}e.text=r.text,e.fontSize=r.fontSize,e.lineHeight=r.lineHeight,e.fontStyle=r.fontStyle,e.fontFamily=r.fontFamily,e.fontWeight=r.fontWeight,e.fill=s??r.color,e.textAlign=r.textAlign,e.textBaseline=r.verticalAlign,e.x=r.x,e.y=r.y,e.visible=!0,e.zIndex=1},k=this.ctx.highlightManager?.getActiveHighlight();this.labelSelection.selectByClass(Cv).forEach(t=>{let e=t.closestDatum();S(e,t,t.tag,e===k)})}pickNodesExactShape(t){let e=super.pickNodesExactShape(t);return e.sort((t,e)=>e.datumIndex.length-t.datumIndex.length),e}pickNodeClosestDatum(t){let e=this.pickNodesExactShape(t);return 0!==e.length?{datum:e[0],distance:0}:this.pickNodeNearestDistantObject(t,this.datumSelection.nodes())}getTooltipContent(t){let e,{id:i,properties:s}=this,{labelKey:o,secondaryLabelKey:r,childrenKey:n,sizeKey:l,sizeName:h,colorKey:d,colorName:c,tooltip:p}=s,u=t.reduce((t,e)=>t?.children[e],this.rootNode);if(null==u)return;let{datum:g,depth:y,children:f}=u;if(null==g||null==y)return;let m=0===f.length,x=[],b=null!=l?g[l]:void 0;null!=b&&x.push({label:h,fallbackLabel:l,value:b});let v=null!=d?g[d]:void 0;null!=v&&x.push({label:c,fallbackLabel:d,value:v}),m?Object.assign(e=this.getTileBaseStyle(!1),this.getTileStyleOverrides(t,g,y,v,e,!1)):Object.assign(e=this.getGroupBaseStyle(!1),this.getGroupStyleOverrides(t,g,y,e,!1));let S=CD({shape:"square",fill:e.fill,fillOpacity:1,stroke:void 0,strokeWidth:0,strokeOpacity:1,lineDash:[0],lineDashOffset:0},this.properties.fillGradientDefaults,this.properties.fillPatternDefaults,this.properties.fillImageDefaults);a.n1.isGradientFill(S.fill)&&(S.fill={...S.fill,gradient:"linear",rotation:0,reverse:!1});let k=m?{marker:S}:void 0;return this.formatTooltipWithContext(p,{title:null!=o?g[o]:void 0,symbol:k,data:x},{seriesId:i,datum:g,title:void 0,depth:y,labelKey:o,secondaryLabelKey:r,childrenKey:n,sizeKey:l,sizeName:h,colorKey:d,colorName:c,...e})}computeFocusBounds(t){return CS.toCanvas(this.contentGroup,t.getBBox())}};CL.className="TreemapSeries",CL.type="treemap";var{commonSeriesOptionsDefs:CT,treemapSeriesThemeableOptionsDef:CN,without:CO}=a.n1,CP={...CN,...CO(CT,["highlightStyle"]),type:(0,s.mw)((0,s.dY)("treemap")),labelKey:s.Yj,secondaryLabelKey:s.Yj,childrenKey:s.Yj,sizeKey:s.Yj,colorKey:s.Yj,sizeName:s.Yj,colorName:s.Yj};CP.fillGradientDefaults=(0,s._L)(s.wi),CP.fillPatternDefaults=(0,s._L)(s.GY),CP.fillImageDefaults=(0,s._L)(s.Zd),CP.undocumentedGroupFills=(0,s._L)((0,s.jk)(s.yW)),CP.undocumentedGroupStrokes=(0,s._L)((0,s.jk)(s.yW));var{FONT_SIZE_RATIO:CE}=a.n1,CR={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"treemap",moduleFactory:t=>new CL(t),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{fills:{$palette:"fills"},strokes:{$palette:"strokes"},colorRange:{$palette:"divergingColors"},fillGradientDefaults:{type:"gradient",gradient:"linear",bounds:"item",colorStops:{$palette:"gradient"},rotation:0,reverse:!1},fillPatternDefaults:a.n1.FILL_PATTERN_DEFAULTS,fillImageDefaults:a.n1.FILL_IMAGE_DEFAULTS,undocumentedGroupFills:{$palette:"hierarchyColors"},undocumentedGroupStrokes:{$palette:"secondHierarchyColors"},group:{label:{enabled:!0,color:{$ref:"textColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$ref:"fontSize"},fontFamily:{$ref:"fontFamily"},spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left"},tile:{label:{enabled:!0,color:{$ref:"backgroundColor"},fontStyle:void 0,fontWeight:{$ref:"fontWeight"},fontSize:{$rem:[1.5]},minimumFontSize:{$rem:[CE.SMALLER]},fontFamily:{$ref:"fontFamily"},wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{enabled:!0,color:{$ref:"backgroundColor"},fontStyle:void 0,fontWeight:void 0,fontSize:{$ref:"fontSize"},minimumFontSize:{$rem:[CE.SMALLER]},fontFamily:{$ref:"fontFamily"},wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:0,padding:3,gap:1},highlightStyle:{group:{label:{color:{$ref:"textColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},tile:{label:{color:{$ref:"backgroundColor"}},secondaryLabel:{color:{$ref:"backgroundColor"}},fill:"rgba(255,255,255, 0.33)",stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},gradientLegend:{enabled:!0}}};a.n1.ModuleRegistry;var CB=[{type:"axis",name:"ordinal-time",chartType:"cartesian",enterprise:!0,options:dR,create:t=>new td(t)},pt,ur,{type:"series",name:"cone-funnel",chartType:"cartesian",enterprise:!0,options:xm,create:t=>new xg(t)},{type:"series",name:"funnel",chartType:"cartesian",enterprise:!0,options:xK,create:t=>new x$(t)},uK,u2,g6,yj,fA,{type:"axis",name:"angle-number",chartType:"polar",enterprise:!0,options:dB,create:t=>new to(t)},{type:"axis",name:"angle-category",chartType:"polar",enterprise:!0,options:dz,create:t=>new X(t)},{type:"axis",name:"radius-number",chartType:"polar",enterprise:!0,options:dF,create:t=>new tY(t)},{type:"axis",name:"radius-category",chartType:"polar",enterprise:!0,options:d_,create:t=>new tG(t)},{type:"series",name:"nightingale",chartType:"polar",enterprise:!0,options:kV,create:t=>new kW(t)},{type:"series",name:"radar-area",chartType:"polar",enterprise:!0,options:Ma,create:t=>new Mt(t)},{type:"series",name:"radar-line",chartType:"polar",enterprise:!0,options:Mh,create:t=>new Mr(t)},{type:"series",name:"radial-bar",chartType:"polar",enterprise:!0,options:MX,create:t=>new MY(t)},{type:"series",name:"radial-column",chartType:"polar",enterprise:!0,options:M7,create:t=>new M6(t)},{type:"chart",name:"flow-proportion",enterprise:!0,options:d$,detect:dV,create:(t,e)=>new dj(t,e)},{type:"series",name:"chord",chartType:"flow-proportion",enterprise:!0,options:mS,create:t=>new mx(t)},{type:"series",name:"sankey",chartType:"flow-proportion",enterprise:!0,options:Iz,create:t=>new IE(t)},{type:"chart",name:"gauge",enterprise:!0,options:dU,detect:dK,create:(t,e)=>new dY(t,e)},bU,w7,{type:"chart",name:"hierarchy",enterprise:!0,options:dq,detect:dQ,create:(t,e)=>new dZ(t,e)},{type:"series",name:"sunburst",chartType:"hierarchy",enterprise:!0,options:I8,create:t=>new I4(t)},{type:"series",name:"treemap",chartType:"hierarchy",enterprise:!0,options:CP,create:t=>new CL(t)},{type:"chart",name:"standalone",enterprise:!0,options:d2,detect:d1,create:(t,e)=>new d0(t,e)},{type:"series",name:"pyramid",chartType:"standalone",enterprise:!0,options:Df,create:t=>new Du(t)},{type:"chart",name:"topology",enterprise:!0,options:ct,detect:d7,create:(t,e)=>new d9(t,e)},{type:"series",name:"map-line",chartType:"topology",enterprise:!0,options:vL,create:t=>new vw(t)},{type:"series",name:"map-line-background",chartType:"topology",enterprise:!0,options:vj,create:t=>new vW(t)},{type:"series",name:"map-marker",chartType:"topology",enterprise:!0,options:Sy,create:t=>new Sc(t),validate(t,e,i){let a=(0,s.tf)(t,e,i),{cleared:o,invalid:r}=a;if(o?.idKey==null&&(o?.latitudeKey==null||o?.longitudeKey==null)){let t=t=>i?`${i}.${t}`:t,e=`Either \`${t("idKey")}\` or both \`${t("latitudeKey")}\` and \`${t("longitudeKey")}\` are required.`;r.push(new s.yI("required",e,null,i))}return a}},{type:"series",name:"map-shape",chartType:"topology",enterprise:!0,options:SV,create:t=>new S_(t)},{type:"series",name:"map-shape-background",chartType:"topology",enterprise:!0,options:S8,create:t=>new S5(t)},{type:"plugin",name:"annotations",chartType:"cartesian",options:fW,create:()=>null},{type:"plugin",name:"navigator",chartType:"cartesian",options:f_,create:()=>null},{type:"plugin",name:"initialState",options:cS,create:()=>null}],Cz={xMin:0,xMax:1,yMin:2,yMax:3,span:4};function CF(t,e){return Array.from({length:t},(t,i)=>{let a=4*i;return(e[a+0]+e[a+1])/2|0})}var{ChartAxisDirection:C_,ContinuousScale:CW,DiscreteTimeScale:CG}=a.n1,Cj=class extends a.n1.BarSeries{aggregateData(t,e){if(e?.type!=="ungrouped")return;let i=this.axes[C_.X];if(null==i||!(CW.is(i.scale)||CG.is(i.scale)))return;let a=t.resolveKeysById(this,"xValue",e),s=t.resolveColumnById(this,"yValue-raw",e),{index:o}=t.resolveProcessedDataDefById(this,"xValue");return function(t,e,i){if(t.length<1e3)return;let[a,s]=pa(i),o=pi(t,5),{indexData:r,valueData:n}=pr(t,e,e,a,s,o),l=CF(o,r),h=[{maxRange:o,indexData:r,indices:l,indexes:Cz}];for(;o>64;)({indexData:r,valueData:n,maxRange:o}=pn(r,n,o)),l=CF(o,r),h.push({maxRange:o,indexData:r,indices:l,indexes:Cz});return h.reverse(),h}(a,s,e.domain.keys[o])}},{BarSeriesModule:CV}=a.n1,C$={...CV,type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"bar",moduleFactory:t=>new Cj(t)};function CH(t,e,i,a,s,o){let r=t[o];if(null==r)return!1;let n=po(ps(r,e,i),s);return o===a[n+0]||o===a[n+1]||o===a[n+2]||o===a[n+3]}var{ChartAxisDirection:CY,ContinuousScale:CK,DiscreteTimeScale:CU}=a.n1,CX=class extends a.n1.LineSeries{aggregateData(t,e){let i=this.axes[CY.X];if(null==i||!(CK.is(i.scale)||CU.is(i.scale)))return;let a=t.resolveColumnById(this,"xValue",e);return function(t,e,i){if(t.length<1e3)return;let[a,s]=pa(i),o=pi(t,10),{indexData:r,valueData:n}=pr(t,e,e,a,s,o),l=[];for(let e=0;e<t.length;e+=1)CH(t,a,s,r,o,e)&&l.push(e);let h=[{maxRange:o,indices:l}];for(;l.length>10&&o>64;)({maxRange:o}=pn(r,n,o,{inPlace:!0})),l=l.filter(CH.bind(null,t,a,s,r,o)),h.push({maxRange:o,indices:l});return h.reverse(),h}(a,t.resolveColumnById(this,"yValueRaw",e),t.getDomain(this,"xValue","value",e))}},{LineSeriesModule:CZ}=a.n1,CQ={...CZ,type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"line",moduleFactory:t=>new CX(t)},Cq=`.ag-watermark{position:absolute;bottom:20px;right:25px;font-weight:700;font-family:Impact,sans-serif;font-size:19px;opacity:.7;animation:1s ease-out 3s ag-watermark-fadeout;color:#9b9b9b;pointer-events:none;&:before{content:"";display:block;height:40px;width:170px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-size:170px 40px}>span{padding-left:.7rem}}@keyframes ag-watermark-fadeout{0%{opacity:.5}to{opacity:0}}.ag-charts-dialog{display:flex;flex-direction:column;font-size:var(--ag-charts-chrome-font-size-large)}.ag-charts-dialog__tabs{display:flex;flex-direction:column}.ag-charts-dialog__header{border-bottom:1px solid var(--ag-charts-border-color);display:flex}.ag-charts-dialog__tab-list{display:flex;gap:calc(var(--ag-charts-spacing) * 2)}.ag-charts-dialog__drag-handle{align-items:center;color:inherit;cursor:grab;display:flex;padding:1px 6px;text-align:center}.ag-charts-dialog__drag-handle--dragging{cursor:grabbing}.ag-charts-dialog__tab-button{background:none;border:0;border-bottom:2px solid transparent;border-radius:0;color:var(--ag-charts-chrome-subtle-text-color);margin-bottom:-1px;padding:var(--input-padding) calc(var(--input-padding) / 2)}.ag-charts-dialog__tab-button:hover{background:none}.ag-charts-dialog__tab-button--active{border-color:var(--ag-charts-accent-color);color:inherit}.ag-charts-dialog__drag-handle+.ag-charts-dialog__tab-button{margin-left:calc(var(--ag-charts-spacing) * -2)}.ag-charts-button.ag-charts-dialog__close-button{background:none;border:0;margin-left:auto;padding:1px 6px}.ag-charts-dialog__close-button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-dialog__tab-panel{display:none;flex-direction:column;gap:calc(var(--ag-charts-spacing) * 4);margin:0 calc(var(--ag-charts-spacing) * 4);padding:calc(var(--ag-charts-spacing) * 4) 0}.ag-charts-dialog__tab-panel--active{display:flex}.ag-charts-dialog__input-group-line{display:flex;gap:16px 18px;flex-wrap:wrap}.ag-charts-dialog__input-group{align-items:center;display:flex;font-size:var(--ag-charts-chrome-font-size)}.ag-charts-dialog__input-group-label{color:var(--ag-charts-chrome-subtle-text-color);margin-right:5px}.ag-charts-dialog__input-group-label[for]{cursor:pointer}.ag-charts-dialog__button{border-radius:0;margin-right:-1px}.ag-charts-dialog__button.ag-charts-dialog__button--active{background:var(--ag-charts-button-focus-background-color);border-color:var(--ag-charts-input-focus-border-color);color:var(--ag-charts-input-focus-text-color);z-index:var(--input-layer-active)}.ag-charts-dialog__button:first-child,.ag-charts-dialog__input-group-label+.ag-charts-dialog__button{border-bottom-left-radius:var(--ag-charts-input-border-radius);border-top-left-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__button:last-child{border-bottom-right-radius:var(--ag-charts-input-border-radius);border-top-right-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__color-picker-button{--color: #000;background:var(--color);border:none;color:transparent;height:26px;width:26px}.ag-charts-dialog__color-picker-button:hover{background:var(--color)}.ag-charts-dialog__color-picker-button--multi-color,.ag-charts-dialog__color-picker-button--multi-color:hover{background:linear-gradient(135deg,red 0%,#ff0 calc(100% * 1 / 6),#0f0 calc(100% * 2 / 6),#0ff 50%,#00f calc(100% * 4 / 6),#f0f calc(100% * 5 / 6),red 100%)}.ag-charts-color-picker{width:190px;padding:8px;--h: 0;--s: 0;--v: 0;--a: 0;--color: #000;--color-a: #000;--thumb-size: 18px;--inner-width: 172px;--track-height: 12px;--palette-height: 136px;--checker: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>');--multi-color: linear-gradient( 135deg, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-color-picker__content{display:flex;flex-direction:column}.ag-charts-color-picker__palette{position:relative;width:100%;height:var(--palette-height);margin-bottom:8px;background:linear-gradient(to bottom,#0000,#000),linear-gradient(to right,#fff,#fff0) hsl(var(--h),100%,50%);border-radius:calc(var(--ag-charts-border-radius) * 1.5);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__palette:after{content:"";position:absolute;display:block;top:calc(var(--thumb-size) * -.5 + (1 - var(--v)) * 100%);left:calc(var(--thumb-size) * -.5 + var(--s) * 100%);background:var(--color);width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__palette:focus-visible:after{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),0 0 0 2px #fff8,var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-row{display:flex;gap:8px;align-items:center;margin-bottom:4px;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input,.ag-charts-color-picker__alpha-input{-webkit-appearance:none;display:block;position:relative;padding:0;margin:0 calc(var(--inset) * -1);border:0;height:var(--thumb-size);width:auto;background:transparent;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038;transform:translateZ(0)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{background:transparent}.ag-charts-color-picker__alpha-input--opaque::-webkit-slider-thumb{background:var(--color)}.ag-charts-color-picker__hue-input:focus-visible::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-webkit-slider-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input:before,.ag-charts-color-picker__alpha-input:before{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button{width:36px;margin-left:var(--inset);height:var(--track-height);border-radius:calc(var(--ag-charts-border-radius) * 99);border:0;background:var(--multi-color);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__multi-color-button--hidden{display:none}.ag-charts-color-picker__multi-color-button--active{box-shadow:inset 0 0 0 1px #0003;outline-offset:1px;outline:2px solid #2196f3}.ag-charts-color-picker__hue-input{flex:1 0 0}.ag-charts-color-picker__hue-input:before{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__alpha-input{margin-bottom:7px}.ag-charts-color-picker__alpha-input:before{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__color-field{display:flex;border:var(--ag-charts-border);background:var(--ag-charts-background-color);border-radius:var(--ag-charts-border-radius);overflow:hidden}.ag-charts-color-picker__color-field:has(:focus-visible){border-color:var(--ag-charts-accent-color);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-label{width:16px;height:16px;margin:7px 0 7px 7px;color:transparent;background:linear-gradient(to right,var(--color-a),var(--color-a)),var(--checker) top left / 4px 4px;border-radius:calc(var(--ag-charts-border-radius) / 2);box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__color-label--multi-color{background:var(--multi-color)}.ag-charts-color-picker__color-input{flex:1;min-width:0;padding:7px 7px 7px 8px;border:0;margin:0;color:inherit;background:transparent;font-variant:tabular-nums}.ag-charts-color-picker__color-input:focus-visible{border:none;outline:none}.ag-charts-annotations__line-stroke-width-menu,.ag-charts-annotations__line-style-type-menu,.ag-charts-annotations__text-size-menu{border-top-left-radius:0;border-top-right-radius:0;.ag-charts-menu__row:first-child{border-radius:0}}.ag-charts-annotations__text-size-menu{--item-padding: 4px 8px;min-width:34px;text-align:center}.ag-charts-annotations__line-stroke-width-menu{--item-padding: 6px;column-gap:6px}.ag-charts-annotations__line-style-type-menu{--item-padding: 6px;column-gap:0}.ag-charts-annotations__stroke-width-button:before{background:var(--ag-charts-foreground-color);content:"";margin-right:var(--toolbar-button-padding);height:min(var(--stroke-width),20px);width:12px}.ag-charts-annotations__stroke-width-button[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-annotations__color-picker-button{--emblem: var(--color)}.ag-charts-annotations__color-picker-button--multi-color{--emblem: linear-gradient( to right, #f00 0% , #ff0 calc(100% * 1 / 6), #0f0 calc(100% * 2 / 6), #0ff 50% , #00f calc(100% * 4 / 6), #f0f calc(100% * 5 / 6), #f00 100% )}.ag-charts-annotations__color-picker-button:after{content:"";display:block;position:absolute;bottom:3px;left:5px;right:5px;height:4px;border-radius:99px;box-shadow:inset 0 0 0 1px color-mix(in srgb,var(--ag-charts-foreground-color) 10%,transparent);background:var(--emblem)}.ag-charts-annotations__color-picker-button[aria-disabled=true]:after{filter:grayscale(1);opacity:.5}.ag-charts-annotations__toolbar-menu{min-width:200px}.ag-charts-annotations__axis-button--hidden{display:none}.ag-charts-annotations__axis-button{background-color:var(--ag-charts-crosshair-label-background-color);border-radius:calc(var(--ag-charts-border-radius) / 2);border:none;box-sizing:border-box;color:var(--ag-charts-crosshair-label-text-color);cursor:pointer;font-family:var(--ag-charts-chrome-font-family);font-size:var(--ag-charts-chrome-font-size);font-weight:var(--ag-charts-chrome-font-weight);left:0;line-height:16px;overflow:hidden;padding:0;position:absolute;top:0;user-select:none;white-space:nowrap;z-index:var(--ag-charts-layer-annotations)}.ag-charts-annotations__axis-button:hover{opacity:.8;color:var(--ag-charts-background-color)}.ag-charts-dialog--annotation-settings{min-height:233px;width:289px}.ag-charts-dialog--annotation-settings .ag-charts-textarea{height:calc(10px * 2 + var(--textarea-line-height) * 1em * 3 + 2px);overflow-y:auto;resize:vertical}.ag-charts-context-menu{font-family:var(--ag-charts-chrome-font-family);font-size:calc(var(--ag-charts-chrome-font-size) * (13 / 12));font-weight:var(--ag-charts-chrome-font-weight);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-context-menu__cover{position:fixed;left:0;top:0}.ag-charts-context-menu__menu{background:var(--ag-charts-chrome-background-color);border-radius:var(--ag-charts-border-radius);border:var(--ag-charts-border);box-shadow:var(--ag-charts-shadow);color:var(--ag-charts-chrome-text-color);display:table;flex-direction:column;padding:.5em 0;transition:transform .1s ease;white-space:nowrap}.ag-charts-context-menu__menu:focus{outline:none}.ag-charts-context-menu__item{align-items:center;background:none;border:none;box-sizing:border-box;color:inherit;display:table-row;font:inherit;justify-content:space-between;text-align:left;width:100%;-webkit-appearance:none;-moz-appearance:none}.ag-charts-context-menu__icon>img{width:var(--ag-charts-icon-size);height:var(--ag-charts-icon-size)}.ag-charts-context-menu__icon,.ag-charts-context-menu__label,.ag-charts-context-menu__rightarrowhead{display:table-cell;vertical-align:middle}.ag-charts-context-menu__cellpadding{padding:.5em 1em}.ag-charts-context-menu__icon{padding-right:0}.ag-charts-context-menu__item[data-focus-override=true],.ag-charts-context-menu__item:focus,.ag-charts-context-menu__item:active{background:var(--ag-charts-focus-color)}.ag-charts-context-menu__item[data-focus-visible-override=true]:focus,.ag-charts-context-menu__item:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-context-menu__item[data-focus-visible-override=false]{outline:inherit;box-shadow:inherit;z-index:inherit}.ag-charts-context-menu__item[aria-disabled=true]{border:none;color:color-mix(in srgb,var(--ag-charts-input-text-color) 50%,transparent);text-align:left}.ag-charts-context-menu__item[aria-disabled=true]:focus{background:inherit;cursor:inherit}.ag-charts-context-menu__divider{display:table-row}.ag-charts-context-menu__divider>div{padding:5px 0}.ag-charts-context-menu__divider>div:after{content:"";display:block;border-top:1px solid #babfc7}.ag-charts-context-menu__divider.ag-charts-dark-context-menu{background:#2196f31a}.ag-charts-crosshair-label{position:absolute;left:0;top:0;user-select:none;pointer-events:none;font-family:var(--ag-charts-font-family);font-size:var(--ag-charts-font-size);font-weight:var(--ag-charts-font-weight);overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-crosshair);box-sizing:border-box}.ag-charts-crosshair-label-content{padding:0 8px;border-radius:calc(var(--ag-charts-border-radius) / 2);line-height:calc(var(--ag-charts-font-size) + 8px);background-color:var(--ag-charts-crosshair-label-background-color);color:var(--ag-charts-crosshair-label-text-color)}.ag-charts-crosshair-label--hidden{visibility:hidden!important}.ag-charts-text-input{position:absolute}.ag-charts-text-input__textarea{--placeholder-text-color: var(--ag-charts-input-placeholder-text-color);display:block;height:100%;width:100%;border:0;background:none;line-height:1.38;outline:none;transform:translateY(.09em)}.ag-charts-text-input__textarea[placeholder]:empty:before{content:attr(placeholder);color:var(--placeholder-text-color);font-weight:400}.ag-charts-text-input__textarea[placeholder]:not(:empty):before{content:""}.ag-charts-chart-toolbar__menu{min-width:200px}.ag-charts-range-buttons .ag-charts-toolbar__button{padding:var(--toolbar-button-padding) calc(var(--toolbar-button-padding) * 1.5)}.ag-charts-zoom-buttons{align-items:center;display:flex;height:44px;justify-content:center;overflow:hidden;padding-bottom:10px;pointer-events:none;width:100%;.ag-charts-toolbar{--toolbar-size: 24px;--toolbar-button-padding: 1px;display:flex;font-size:var(--ag-charts-chrome-font-size);height:var(--toolbar-size);justify-content:center;opacity:1;pointer-events:auto;transition:opacity .2s ease-in-out,transform .4s ease-in-out;.ag-charts-toolbar__button--first{border-bottom-left-radius:var(--ag-charts-border-radius);border-top-left-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__button--last{border-bottom-right-radius:var(--ag-charts-border-radius);border-top-right-radius:var(--ag-charts-border-radius)}.ag-charts-toolbar__label{padding-left:var(--ag-charts-spacing);padding-right:var(--ag-charts-spacing)}.ag-charts-toolbar__icon+.ag-charts-toolbar__label{padding-left:0}.ag-charts-toolbar__button--gap{margin-left:var(--toolbar-gap)}&.ag-charts-zoom-buttons__toolbar--hidden{opacity:0;transition:opacity .4s ease-in-out,transform .4s ease-in-out}}}.ag-charts-shared-toolbar{gap:var(--toolbar-gap);.ag-charts-toolbar__button{border-radius:var(--ag-charts-border-radius);margin:0}}
`;a.n1.ModuleRegistry.registerMany(CB),a.n1.moduleRegistry.register(Z,tr,tQ,ne,nc,C$,ld,c7,uo,mk,xb,xU,u1,nx,nN,nY,nZ,ls,bK,CQ,vT,vV,Sf,S$,S9,l$,hh,dP,uY,kX,tc,Mo,Mc,MJ,wo,tj,w9,tK,yG,g3,l0,Dx,IF,l2,I7,hM,CR,fC,dx),a.n1.enterpriseModule.isEnterprise=!0,a.n1.enterpriseModule.styles=Cq,a.n1.enterpriseModule.licenseManager=t=>new c(t.container?.ownerDocument??("undefined"==typeof document?void 0:document)),a.n1.enterpriseModule.injectWatermark=dE,a.xv,a.Mo,a.LW,a.a9,a.ui.create.bind(a.ui),a.ui.__createSparkline.bind(a.ui),c.setGridContext.bind(c),c.setLicenseKey.bind(c)}}]);